/*!
┌(ixi))┐)┐)┐)┐)┐)┐
*/

this.pixiv = this.pixiv || {}, this.pixiv.templates = this.pixiv.templates || {}, 
this.pixiv.templates["booth-items"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = "function", k = a.escapeExpression;
        return '\t<li class="_booth-item">\n\t\t<a href="' + k((g = null != (g = c.url || (null != b ? b.url : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "url",
            hash: {},
            data: e
        }) : g)) + '" target="_blank">\n' + (null != (f = c.if.call(h, null != (f = null != b ? b.images : b) ? f["150x150"] : f, {
            name: "if",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.program(4, e, 0),
            data: e
        })) ? f : "") + '\t\t\t<h1 class="title" title="' + k((g = null != (g = c.name || (null != b ? b.name : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "name",
            hash: {},
            data: e
        }) : g)) + '">' + k((c.truncate || b && b.truncate || i).call(h, null != b ? b.name : b, 24, {
            name: "truncate",
            hash: {},
            data: e
        })) + '</h1>\n\t\t</a>\n\t\t<div class="price">&yen;' + k((c.comma || b && b.comma || i).call(h, null != b ? b.price : b, {
            name: "comma",
            hash: {},
            data: e
        })) + '</div>\n\t\t<ul class="user inline-list pipe-separated">\n\t\t\t<li>\n\t\t\t\t<a href="' + k((g = null != (g = c.booth_url || (null != b ? b.booth_url : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "booth_url",
            hash: {},
            data: e
        }) : g)) + '" class="booth-name" title="' + k((g = null != (g = c.booth_name || (null != b ? b.booth_name : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "booth_name",
            hash: {},
            data: e
        }) : g)) + '" target="_blank">\n\t\t\t\t\t<span class="icon-text">' + k((c.truncate || b && b.truncate || i).call(h, null != b ? b.booth_name : b, 8, {
            name: "truncate",
            hash: {},
            data: e
        })) + '</span>\n\t\t\t\t\t<i class="_icon sprites-booth">BOOTH</i>\n\t\t\t\t</a>\n\t\t\t</li>\n' + (null != (f = c.if.call(h, null != b ? b.pixiv_id : b, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\t\t</ul>\n\t</li>\n";
    },
    "2": function(a, b, c, d, e) {
        var f;
        return '\t\t\t\t<img src="' + a.escapeExpression(a.lambda(null != (f = null != b ? b.images : b) ? f["150x150"] : f, b)) + '" class="_thumbnail">\n';
    },
    "4": function(a, b, c, d, e) {
        return '\t\t\t\t<div class="no-image _thumbnail"></div>\n';
    },
    "6": function(a, b, c, d, e) {
        var f;
        return '\t\t\t\t<li>\n\t\t\t\t\t<a href="http://pixiv.me/' + a.escapeExpression((f = null != (f = c.pixiv_id || (null != b ? b.pixiv_id : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "pixiv_id",
            hash: {},
            data: e
        }) : f)) + '" class="user _icon sprites-pixiv" target="_blank">pixiv</a>\n\t\t\t\t</li>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    useData: !0
}), this.pixiv.templates["emoji-list"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression, j = "function";
        return '<li><img src="' + i((c.prop || b && b.prop || h).call(g, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/common/transparent.gif" data-src="' + i((c.prop || b && b.prop || h).call(g, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + "images/emoji/" + i((f = null != (f = c.id || (null != b ? b.id : b)) ? f : h, 
        typeof f === j ? f.call(g, {
            name: "id",
            hash: {},
            data: e
        }) : f)) + '.png" width="42" height="42" class="emoji _lazy-image" data-name="' + i((f = null != (f = c.name || (null != b ? b.name : b)) ? f : h, 
        typeof f === j ? f.call(g, {
            name: "name",
            hash: {},
            data: e
        }) : f)) + '"></li>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.emoji_series || (null != b ? b.emoji_series : b)) ? g : c.helperMissing, 
        h = {
            name: "emoji_series",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.emoji_series || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    useData: !0
}), this.pixiv.templates["follow-option"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "フォロー中", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    "3": function(a, b, c, d, e) {
        return a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "フォローする", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    "5": function(a, b, c, d, e) {
        var f = null != b ? b : {}, g = c.helperMissing, h = a.escapeExpression;
        return '\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t<select name="tag" disabled>\n\t\t\t\t\t\t\t<option value="">' + h((c.t || b && b.t || g).call(f, "フォルダー", {
            name: "t",
            hash: {},
            data: e
        })) + '</option>\n\t\t\t\t\t\t\t<option value="new">' + h((c.t || b && b.t || g).call(f, "新規フォルダー", {
            name: "t",
            hash: {},
            data: e
        })) + "</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t</div>\n";
    },
    "7": function(a, b, c, d, e) {
        var f = null != b ? b : {}, g = c.helperMissing, h = a.escapeExpression;
        return '\t\t\t\t\t\t<a href="/premium.php?ref=bookmark_user" target="_blank" class="item premium-feature">\n\t\t\t\t\t\t<select name="tag" disabled>\n\t\t\t\t\t\t\t<option value="">' + h((c.t || b && b.t || g).call(f, "フォルダー", {
            name: "t",
            hash: {},
            data: e
        })) + '</option>\n\t\t\t\t\t\t</select>\n\t\t\t\t\t\t<i class="_icon sprites-premium"></i>\n\t\t\t\t\t\t<p class="_notes">' + h((c.t || b && b.t || g).call(f, "プレミアム会員になるとユーザーをフォルダーに分類できます", {
            name: "t",
            hash: {},
            data: e
        })) + "</p>\n\t\t\t\t\t</a>\n";
    },
    "9": function(a, b, c, d, e) {
        var f = null != b ? b : {}, g = c.helperMissing, h = a.escapeExpression;
        return '\t\t\t\t\t<div class="action">\n\t\t\t\t\t\t<span class="_button2 unfollow-button">' + h((c.t || b && b.t || g).call(f, "フォロー解除", {
            name: "t",
            hash: {},
            data: e
        })) + '</span>\n\t\t\t\t\t\t<span class="_button2 update-button">' + h((c.t || b && b.t || g).call(f, "更新", {
            name: "t",
            hash: {},
            data: e
        })) + "</span>\n\t\t\t\t\t</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = '<button class="follow-button">\n\t';
        return g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, h = {
            name: "is_follow",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = l.call(b, f, h)), 
        null != f && (m += f), m += "\n\t", g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, 
        h = {
            name: "is_follow",
            hash: {},
            fn: a.noop,
            inverse: a.program(3, e, 0),
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = l.call(b, f, h)), 
        null != f && (m += f), m += '\n</button>\n<span class="follow-more-button-container">\n\t<button class="follow-more-button">\n\t\t<i class="_icon sprites-more"></i>\n\t</button>\n\t<div class="options-wrapper _hidden">\n\t\t<div class="options-container">\n\t\t\t<section class="option">\n', 
        g = null != (g = c.premium || (null != b ? b.premium : b)) ? g : j, h = {
            name: "premium",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.premium || (f = l.call(b, f, h)), null != f && (m += f), 
        g = null != (g = c.premium || (null != b ? b.premium : b)) ? g : j, h = {
            name: "premium",
            hash: {},
            fn: a.noop,
            inverse: a.program(7, e, 0),
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.premium || (f = l.call(b, f, h)), null != f && (m += f), 
        m += '\t\t\t\t<div class="item">\n\t\t\t\t\t<label><input type="checkbox" name="restrict" value="1">' + a.escapeExpression((c.t || b && b.t || j).call(i, "公開しない", {
            name: "t",
            hash: {},
            data: e
        })) + "</label>\n\t\t\t\t</div>\n", g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, 
        h = {
            name: "is_follow",
            hash: {},
            fn: a.program(9, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = l.call(b, f, h)), 
        null != f && (m += f), m + "\t\t\t</section>\n\t\t</div>\n\t</div>\n</span>\n";
    },
    useData: !0
}), this.pixiv.templates["following-booster-dummy"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = a.lambda, h = a.escapeExpression, i = null != b ? b : {};
        return '\t<li data-user_id="' + h(g(b, b)) + '" data-filter="following-booster-loading" class="ui-scroll-view following-booster-' + h(g(b, b)) + " following-booster-dummy" + (null != (f = c.if.call(i, (f = e && e.root) && f.user_name, {
            name: "if",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '" ' + (null != (f = c.if.call(i, (f = e && e.root) && f.user_name, {
            name: "if",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "></li>\n";
    },
    "2": function(a, b, c, d, e) {
        return " following-booster-related-user";
    },
    "4": function(a, b, c, d, e) {
        var f;
        return 'data-related_user="' + a.escapeExpression(a.lambda((f = e && e.root) && f.user_name, b)) + '"';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f;
        return null != (f = c.each.call(null != b ? b : {}, null != b ? b.user_ids : b, {
            name: "each",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    useData: !0
}), this.pixiv.templates["history-detail-item"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = '\t\t\t<a href="/whitecube/illust/' + l((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '" target="_blank" class="action toggle-bookmark';
        return g = null != (g = c.is_bookmarked || (null != b ? b.is_bookmarked : b)) ? g : j, 
        h = {
            name: "is_bookmarked",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_bookmarked || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (m += f), m + '" data-id="' + l((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '">\n\t\t\t\t<i class="_pico-20 _icon-like"></i>\n\t\t\t</a>\n';
    },
    "2": function(a, b, c, d, e) {
        return " on";
    },
    "4": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = a.escapeExpression, n = '\t\t\t<span class="action rate';
        return g = null != (g = c.is_rated || (null != b ? b.is_rated : b)) ? g : j, h = {
            name: "is_rated",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_rated || (f = l.call(b, f, h)), null != f && (n += f), 
        n += '" data-id="' + m((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '">\n\t\t\t\t<i class="_icon-20 _icon-smile"></i>\n\t\t\t</span>\n\t\t\t<a href="/bookmark_add.php?type=illust&amp;illust_id=' + m((c.url_encode || b && b.url_encode || j).call(i, null != b ? b.illust_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '" target="_blank" class="action toggle-bookmark', g = null != (g = c.is_bookmarked || (null != b ? b.is_bookmarked : b)) ? g : j, 
        h = {
            name: "is_bookmarked",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_bookmarked || (f = l.call(b, f, h)), 
        null != f && (n += f), n += '" data-id="' + m((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '">\n\t\t\t\t<i class="_icon-20 _icon-star"></i>\n\t\t\t</a>\n\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + m((c.url_encode || b && b.url_encode || j).call(i, null != b ? b.illust_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '#one_comment" target="_blank" class="action add-comment', g = null != (g = c.is_commented || (null != b ? b.is_commented : b)) ? g : j, 
        h = {
            name: "is_commented",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_commented || (f = l.call(b, f, h)), 
        null != f && (n += f), n + '">\n\t\t\t\t<i class="_icon-20 _icon-comment"></i>\n\t\t\t</a>\n';
    },
    "6": function(a, b, c, d, e) {
        var f, g = a.escapeExpression;
        return '\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + g((c.url_encode || b && b.url_encode || c.helperMissing).call(null != b ? b : {}, null != b ? b.illust_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '" target="_blank" class="image" style="background-image:url(' + g(a.lambda(null != (f = null != b ? b.url : b) ? f["240mw"] : f, b)) + ');"></a>\n';
    },
    "8": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != b ? b.ugoira_meta : b, {
            name: "if",
            hash: {},
            fn: a.program(9, e, 0),
            inverse: a.program(11, e, 0),
            data: e
        })) ? f : "";
    },
    "9": function(a, b, c, d, e) {
        return '\t\t\t<div class="player toggle image"></div>\n';
    },
    "11": function(a, b, c, d, e) {
        var f, g = a.escapeExpression;
        return '\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + g((c.url_encode || b && b.url_encode || c.helperMissing).call(null != b ? b : {}, null != b ? b.illust_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '" target="_blank" class="image" style="background-image:url(' + g(a.lambda(null != (f = null != b ? b.url : b) ? f.m : f, b)) + ');"></a>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression, k = "function";
        return '<header class="header">\n\t<div class="label">\n\t    <a href="/member_illust.php?mode=medium&amp;illust_id=' + j((c.url_encode || b && b.url_encode || i).call(h, null != b ? b.illust_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '" target="_block">\n\t\t   <h1 class="work-title">' + j((c.truncate || b && b.truncate || i).call(h, null != b ? b.illust_title : b, 20, {
            name: "truncate",
            hash: {},
            data: e
        })) + '</h1>\n\t\t</a>\n\n\t\t<a href="/member.php?id=' + j((c.url_encode || b && b.url_encode || i).call(h, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '" target="_block" class="user ui-profile-popup" data-user_id="' + j((g = null != (g = c.user_id || (null != b ? b.user_id : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "user_id",
            hash: {},
            data: e
        }) : g)) + '">\n\t\t\t<img src="' + j((g = null != (g = c.profile_img || (null != b ? b.profile_img : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "profile_img",
            hash: {},
            data: e
        }) : g)) + '" height="20" class="user-icon">\n\t\t\t<span class="icon-text">' + j((c.truncate || b && b.truncate || i).call(h, null != b ? b.user_name : b, 20, {
            name: "truncate",
            hash: {},
            data: e
        })) + '</span>\n\t\t</a>\n\t</div>\n\t<div class="actions">\n' + (null != (f = c.if.call(h, null != b ? b.is_whitecube : b, {
            name: "if",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.program(4, e, 0),
            data: e
        })) ? f : "") + '\t</div>\n</header>\n\n<div class="image-container">\n' + (null != (f = c.if.call(h, null != b ? b.tmp : b, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.program(8, e, 0),
            data: e
        })) ? f : "") + '\n\t<nav class="nav">\n\t\t<span class="prev _hidden"><i class="_icon-20 _icon-rtl"></i></span>\n\t\t<span class="next _hidden"><i class="_icon-20 _icon-ltr"></i></span>\n\t</nav>\n</div>\n';
    },
    useData: !0
}), this.pixiv.templates["history-illust-items"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = a.lambda, h = a.escapeExpression;
        return '\t<h1 class="date">' + h(g((f = e && e.root) && f.date, b)) + '<span class="count">' + h(g((f = e && e.root) && f.count, b)) + "</span></h1>\n";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != b ? b.illust_id : b, {
            name: "if",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "4": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != b ? b.trial : b, {
            name: "if",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.program(7, e, 0),
            data: e
        })) ? f : "";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<span class="_history-item trial" style="background-image:url(' + a.escapeExpression(a.lambda(null != (f = null != b ? b.url : b) ? f["240mw"] : f, b)) + ')"></span>\n';
    },
    "7": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression;
        return '\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + j((c.url_encode || b && b.url_encode || i).call(h, null != b ? b.illust_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '" target="_blank" data-id="' + j((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : i, 
        "function" == typeof g ? g.call(h, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '" class="_history-item show-detail list-item" style="background-image:url(' + j(a.lambda(null != (f = null != b ? b.url : b) ? f["240mw"] : f, b)) + ')">\n\t\t\t\t<div class="status">\n' + (null != (f = c.if.call(h, (f = e && e.root) && f.is_whitecube, {
            name: "if",
            hash: {},
            fn: a.program(8, e, 0),
            inverse: a.program(11, e, 0),
            data: e
        })) ? f : "") + "\t\t\t\t</div>\n\t\t\t</a>\n";
    },
    "8": function(a, b, c, d, e) {
        var f, g, h, i = "\t\t\t\t\t\t";
        return g = null != (g = c.is_bookmarked || (null != b ? b.is_bookmarked : b)) ? g : c.helperMissing, 
        h = {
            name: "is_bookmarked",
            hash: {},
            fn: a.program(9, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.is_bookmarked || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i + "\n";
    },
    "9": function(a, b, c, d, e) {
        return '<span><i class="_pico-20 _icon-like"></i></span>';
    },
    "11": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = "\t\t\t\t\t\t";
        return g = null != (g = c.is_rated || (null != b ? b.is_rated : b)) ? g : j, h = {
            name: "is_rated",
            hash: {},
            fn: a.program(12, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_rated || (f = l.call(b, f, h)), null != f && (m += f), 
        m += "\n\t\t\t\t\t\t", g = null != (g = c.is_bookmarked || (null != b ? b.is_bookmarked : b)) ? g : j, 
        h = {
            name: "is_bookmarked",
            hash: {},
            fn: a.program(14, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_bookmarked || (f = l.call(b, f, h)), 
        null != f && (m += f), m += "\n\t\t\t\t\t\t", g = null != (g = c.is_commented || (null != b ? b.is_commented : b)) ? g : j, 
        h = {
            name: "is_commented",
            hash: {},
            fn: a.program(16, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_commented || (f = l.call(b, f, h)), 
        null != f && (m += f), m + "\n";
    },
    "12": function(a, b, c, d, e) {
        return '<span><i class="_icon-20 _icon-smile"></i></span>';
    },
    "14": function(a, b, c, d, e) {
        return '<span><i class="_icon-20 _icon-star"></i></span>';
    },
    "16": function(a, b, c, d, e) {
        return '<span><i class="_icon-20 _icon-comment"></i></span>';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = "";
        return g = null != (g = c.date || (null != b ? b.date : b)) ? g : j, h = {
            name: "date",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date || (f = l.call(b, f, h)), null != f && (m += f), 
        g = null != (g = c.items || (null != b ? b.items : b)) ? g : j, h = {
            name: "items",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.items || (f = l.call(b, f, h)), null != f && (m += f), 
        m;
    },
    useData: !0
}), this.pixiv.templates["history-novel-items"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = a.lambda, h = a.escapeExpression;
        return '\t<h1 class="date">' + h(g((f = e && e.root) && f.date, b)) + '<span class="count">' + h(g((f = e && e.root) && f.count, b)) + "</span></h1>\n";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != b ? b.id : b, {
            name: "if",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "4": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = a.escapeExpression, k = c.helperMissing, l = "function", m = '\t\t<div class="_history-item novel ' + (null != (f = c.if.call(i, null != b ? b.trial : b, {
            name: "if",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '">\n\t\t\t<div class="thumb">\n\t\t\t\t<a ' + (null != (f = c.unless.call(i, null != b ? b.trial : b, {
            name: "unless",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + ' target="_blank" class="' + (null != (f = c.if.call(i, null != b ? b.trial : b, {
            name: "if",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '">\n\t\t\t\t\t<img src="' + j(a.lambda(null != (f = null != b ? b.url : b) ? f["240mw"] : f, b)) + '">\n\t\t\t\t</a>\n\t\t\t\t<br>' + j((g = null != (g = c.scene || (null != b ? b.scene : b)) ? g : k, 
        typeof g === l ? g.call(i, {
            name: "scene",
            hash: {},
            data: e
        }) : g)) + "P - " + j((g = null != (g = c.text_length || (null != b ? b.text_length : b)) ? g : k, 
        typeof g === l ? g.call(i, {
            name: "text_length",
            hash: {},
            data: e
        }) : g)) + j((c.t || b && b.t || k).call(i, "文字", {
            name: "t",
            hash: {},
            data: e
        })) + '\n\t\t\t</div>\n\t\t\t<div class="details">\n\t\t\t\t<div class="title">\n\t\t\t\t\t<a ' + (null != (f = c.unless.call(i, null != b ? b.trial : b, {
            name: "unless",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + ' target="_blank" class="' + (null != (f = c.if.call(i, null != b ? b.trial : b, {
            name: "if",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '">' + j((g = null != (g = c.title || (null != b ? b.title : b)) ? g : k, 
        typeof g === l ? g.call(i, {
            name: "title",
            hash: {},
            data: e
        }) : g)) + '</a>\n\t\t\t\t</div>\n\t\t\t\t<div class="author">\n\t\t\t\t\t<a href="/novel/member.php?id=' + j((c.url_encode || b && b.url_encode || k).call(i, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '" target="_block" class="user ui-profile-popup" data-user_id="' + j((g = null != (g = c.user_id || (null != b ? b.user_id : b)) ? g : k, 
        typeof g === l ? g.call(i, {
            name: "user_id",
            hash: {},
            data: e
        }) : g)) + '">\n\t\t\t\t\t\t<img src="' + j((g = null != (g = c.profile_img || (null != b ? b.profile_img : b)) ? g : k, 
        typeof g === l ? g.call(i, {
            name: "profile_img",
            hash: {},
            data: e
        }) : g)) + '" height="20" width="20" class="user-icon">\n\t\t\t\t\t\t<span class="icon-text">' + j((g = null != (g = c.user_name || (null != b ? b.user_name : b)) ? g : k, 
        typeof g === l ? g.call(i, {
            name: "user_name",
            hash: {},
            data: e
        }) : g)) + '</span>\n\t\t\t\t\t</a>\n\t\t\t\t</div>\n\t\t\t\t<div class="comment">' + (null != (g = null != (g = c.comment || (null != b ? b.comment : b)) ? g : k, 
        f = typeof g === l ? g.call(i, {
            name: "comment",
            hash: {},
            data: e
        }) : g) ? f : "") + '</div>\n\t\t\t\t<div class="tags">\n';
        return g = null != (g = c.tag_a || (null != b ? b.tag_a : b)) ? g : k, h = {
            name: "tag_a",
            hash: {},
            fn: a.program(9, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === l ? g.call(i, h) : g, c.tag_a || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (m += f), m + '\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div class="status">\n' + (null != (f = c.if.call(i, (f = e && e.root) && f.is_whitecube, {
            name: "if",
            hash: {},
            fn: a.program(11, e, 0),
            inverse: a.program(14, e, 0),
            data: e
        })) ? f : "") + "\t\t\t</div>\n\t\t</div>\n";
    },
    "5": function(a, b, c, d, e) {
        return "trial";
    },
    "7": function(a, b, c, d, e) {
        return 'href="/novel/show.php?id=' + a.escapeExpression((c.url_encode || b && b.url_encode || c.helperMissing).call(null != b ? b : {}, null != b ? b.id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '"';
    },
    "9": function(a, b, c, d, e) {
        var f = a.escapeExpression;
        return '\t\t\t\t\t\t<a href="/novel/tags.php?tag=' + f((c.url_encode || b && b.url_encode || c.helperMissing).call(null != b ? b : {}, b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '">' + f(a.lambda(b, b)) + "</a>\n";
    },
    "11": function(a, b, c, d, e) {
        var f, g, h, i = "\t\t\t\t\t";
        return g = null != (g = c.is_bookmarked || (null != b ? b.is_bookmarked : b)) ? g : c.helperMissing, 
        h = {
            name: "is_bookmarked",
            hash: {},
            fn: a.program(12, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.is_bookmarked || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i + "\n";
    },
    "12": function(a, b, c, d, e) {
        return '<span><i class="_pico-20 _icon-like"></i></span>';
    },
    "14": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = "\t\t\t\t\t";
        return g = null != (g = c.is_rated || (null != b ? b.is_rated : b)) ? g : j, h = {
            name: "is_rated",
            hash: {},
            fn: a.program(15, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_rated || (f = l.call(b, f, h)), null != f && (m += f), 
        m += "\n\t\t\t\t\t", g = null != (g = c.is_bookmarked || (null != b ? b.is_bookmarked : b)) ? g : j, 
        h = {
            name: "is_bookmarked",
            hash: {},
            fn: a.program(17, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_bookmarked || (f = l.call(b, f, h)), 
        null != f && (m += f), m += "\n\t\t\t\t\t", g = null != (g = c.is_commented || (null != b ? b.is_commented : b)) ? g : j, 
        h = {
            name: "is_commented",
            hash: {},
            fn: a.program(19, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_commented || (f = l.call(b, f, h)), 
        null != f && (m += f), m + "\n";
    },
    "15": function(a, b, c, d, e) {
        return '<span><i class="_icon-20 _icon-smile"></i></span>';
    },
    "17": function(a, b, c, d, e) {
        return '<span><i class="_icon-20 _icon-star"></i></span>';
    },
    "19": function(a, b, c, d, e) {
        return '<span><i class="_icon-20 _icon-comment"></i></span>';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = "";
        return g = null != (g = c.date || (null != b ? b.date : b)) ? g : j, h = {
            name: "date",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date || (f = l.call(b, f, h)), null != f && (m += f), 
        g = null != (g = c.items || (null != b ? b.items : b)) ? g : j, h = {
            name: "items",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.items || (f = l.call(b, f, h)), null != f && (m += f), 
        m;
    },
    useData: !0
}), this.pixiv.templates["history-related-items"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression;
        return '\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + j((c.url_encode || b && b.url_encode || i).call(h, null != b ? b.illust_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '" target="_blank" class="_history-related-item update-detail _area-target list-item" data-id="' + j((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : i, 
        "function" == typeof g ? g.call(h, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '" data-filter="lazy-image" data-src="' + j(a.lambda(null != (f = null != b ? b.url : b) ? f["240mw"] : f, b)) + '"></a>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    useData: !0
}), this.pixiv.templates["illust-upload-fails-message"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f;
        return null != (f = c.each.call(null != b ? b : {}, null != b ? b.fails : b, {
            name: "each",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "2": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing;
        return "    " + (null != (f = (c.is || b && b.is || h).call(g, null != b ? b.fail_type : b, "==", "file_type", {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\n    " + (null != (f = (c.is || b && b.is || h).call(g, null != b ? b.fail_type : b, "==", "pixel_size", {
            name: "is",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\n    " + (null != (f = (c.is || b && b.is || h).call(g, null != b ? b.fail_type : b, "==", "file_size", {
            name: "is",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\n    " + (null != (f = (c.is || b && b.is || h).call(g, b, "==", "total_file_size", {
            name: "is",
            hash: {},
            fn: a.program(9, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\n";
    },
    "3": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return i((f = null != (f = c.name || (null != b ? b.name : b)) ? f : h, "function" == typeof f ? f.call(g, {
            name: "name",
            hash: {},
            data: e
        }) : f)) + ": " + i((c.t || b && b.t || h).call(g, "サポートされていないフォーマットです。JPEG/PNG/GIFのいずれかでアップロードしてください", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    "5": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return i((f = null != (f = c.name || (null != b ? b.name : b)) ? f : h, "function" == typeof f ? f.call(g, {
            name: "name",
            hash: {},
            data: e
        }) : f)) + ": " + i((c.t || b && b.t || h).call(g, "画像サイズが大きすぎます。縦×横のピクセル数を60,000,000ピクセル未満に縮小してアップロードし直してください", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    "7": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return i((f = null != (f = c.name || (null != b ? b.name : b)) ? f : h, "function" == typeof f ? f.call(g, {
            name: "name",
            hash: {},
            data: e
        }) : f)) + ": " + i((c.t || b && b.t || h).call(g, "ファイルサイズが大きすぎます。ファイルサイズを8MB以下に縮小してアップロードし直してください", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    "9": function(a, b, c, d, e) {
        return a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "画像の合計ファイルサイズは最大30 MBです", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f;
        return null != (f = c.each.call(null != b ? b : {}, null != b ? b.fail_files : b, {
            name: "each",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    useData: !0
}), this.pixiv.templates["illust-upload-fails"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing;
        return "  " + (null != (f = (c.is || b && b.is || h).call(g, b, "==", "file_type", {
            name: "is",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\n  " + (null != (f = (c.is || b && b.is || h).call(g, b, "==", "pixel_size", {
            name: "is",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\n  " + (null != (f = (c.is || b && b.is || h).call(g, b, "==", "file_size", {
            name: "is",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\n  " + (null != (f = (c.is || b && b.is || h).call(g, b, "==", "total_file_size", {
            name: "is",
            hash: {},
            fn: a.program(8, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\n";
    },
    "2": function(a, b, c, d, e) {
        return "<li>" + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "サポートされていないフォーマットです。JPEG/PNG/GIFのいずれかで投稿してください", {
            name: "t",
            hash: {},
            data: e
        })) + "</li>";
    },
    "4": function(a, b, c, d, e) {
        return "<li>" + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "1枚の画像のピクセル数が大きすぎます。縦×横のピクセル数が60,000,000ピクセル未満になるように、画像を縮小してアップロードを試してください", {
            name: "t",
            hash: {},
            data: e
        })) + "</li>";
    },
    "6": function(a, b, c, d, e) {
        return "<li>" + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "1枚の画像のファイルサイズは最大8 MBです", {
            name: "t",
            hash: {},
            data: e
        })) + "</li>";
    },
    "8": function(a, b, c, d, e) {
        return "<li>" + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "画像の合計ファイルサイズは最大30 MBです", {
            name: "t",
            hash: {},
            data: e
        })) + "</li>";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f;
        return null != (f = c.each.call(null != b ? b : {}, null != b ? b.fails : b, {
            name: "each",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    useData: !0
}), this.pixiv.templates["illust-upload-items"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = '\t<li class="item';
        return g = null != (g = c.fails || (null != b ? b.fails : b)) ? g : j, h = {
            name: "fails",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.fails || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (m += f), m + '" style="background-image:url(' + l((g = null != (g = c.image || (null != b ? b.image : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "image",
            hash: {},
            data: e
        }) : g)) + ')">\n\t\t<div class="remove">\n\t\t\t<i class="_icon-12 _icon-close"></i>\n\t\t</div>\n\t\t<div class="icon-warning">\n\t\t\t<i class="attention"></i>\n\t\t</div>\n\t<div class="illust-file-name">' + l(a.lambda(null != (f = null != b ? b.file : b) ? f.name : f, b)) + "</div>\n</li>\n";
    },
    "2": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = "";
        return g = null != (g = c.file_type || (null != b ? b.file_type : b)) ? g : j, h = {
            name: "file_type",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.file_type || (f = l.call(b, f, h)), 
        null != f && (m += f), g = null != (g = c.file_size || (null != b ? b.file_size : b)) ? g : j, 
        h = {
            name: "file_size",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.file_size || (f = l.call(b, f, h)), 
        null != f && (m += f), m;
    },
    "3": function(a, b, c, d, e) {
        return " fail-file-type";
    },
    "5": function(a, b, c, d, e) {
        return " fail-file-size";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    useData: !0
}), this.pixiv.templates["illust-upload-notices"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f;
        return "  " + (null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, b, "==", "file_type", {
            name: "is",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\n";
    },
    "2": function(a, b, c, d, e) {
        return "<li>" + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "複数の画像フォーマットが存在します。異なるフォーマットはJPEGに変換されて投稿されます", {
            name: "t",
            hash: {},
            data: e
        })) + "</li>";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f;
        return null != (f = c.each.call(null != b ? b : {}, null != b ? b.notices : b, {
            name: "each",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    useData: !0
}), this.pixiv.templates["manga-page"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = "function", k = a.escapeExpression;
        return '\t<li><a href="' + k((g = null != (g = c.href || (null != b ? b.href : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "href",
            hash: {},
            data: e
        }) : g)) + '" target="_blank"' + (null != (f = c.unless.call(h, (f = e && e.root) && f.loggedIn, {
            name: "unless",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + ">" + k((g = null != (g = c.page || (null != b ? b.page : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "page",
            hash: {},
            data: e
        }) : g)) + "</a></li>\n";
    },
    "2": function(a, b, c, d, e) {
        return ' class="require-login" data-ref="manga_viewer_zoom_page"';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.pages || (null != b ? b.pages : b)) ? g : c.helperMissing, 
        h = {
            name: "pages",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.pages || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    useData: !0
}), this.pixiv.templates["manga-thumbnail-list"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = "function", k = a.escapeExpression;
        return '\t<li class="thumbnail-item' + (null != (f = c.unless.call(h, null != b ? b.src : b, {
            name: "unless",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + ' _ui-tooltip" data-position="' + k((g = null != (g = c.position || (null != b ? b.position : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "position",
            hash: {},
            data: e
        }) : g)) + '" data-tooltip="' + k((g = null != (g = c.page || (null != b ? b.page : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "page",
            hash: {},
            data: e
        }) : g)) + '">\n' + (null != (f = c.if.call(h, null != b ? b.src : b, {
            name: "if",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.program(6, e, 0),
            data: e
        })) ? f : "") + "\t</li>\n";
    },
    "2": function(a, b, c, d, e) {
        return " footer-item";
    },
    "4": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '\t\t\t<img src="' + j((f = null != (f = c.src || (null != b ? b.src : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "src",
            hash: {},
            data: e
        }) : f)) + '" width="128" height="128" alt="' + j((f = null != (f = c.page || (null != b ? b.page : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "page",
            hash: {},
            data: e
        }) : f)) + '">\n';
    },
    "6": function(a, b, c, d, e) {
        return '\t\t\t<i class="_icon sprites-dot"></i>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.images || (null != b ? b.images : b)) ? g : c.helperMissing, 
        h = {
            name: "images",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.images || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    useData: !0
}), this.pixiv.templates["notification-approve_friend"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="/mypixiv_all.php">\n\t\t<div class="image">\n\t\t\t<img src="' + l(a.lambda(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんがあなたのマイピク申請を承認しました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-bookmarked"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/novel/bookmark_detail.php?id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/bookmark_detail.php?illust_id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.type : f, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image">\n\t\t\t<img src="' + l(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1人</span>以上のユーザーが<span>「$2」</span>をブックマークしました。", null != (f = null != b ? b.details : b) ? f.count : f, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-booth_item"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.adult : f, {
            name: "if",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.program(6, e, 0),
            data: e
        })) ? f : "";
    },
    "4": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さんが<span>$2 [R-18]</span>と他<span>$3個</span>のアイテムをBOOTHで販売開始しました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さんが<span>$2</span>と他<span>$3個</span>のアイテムをBOOTHで販売開始しました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "8": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.adult : f, {
            name: "if",
            hash: {},
            fn: a.program(9, e, 0),
            inverse: a.program(11, e, 0),
            data: e
        })) ? f : "";
    },
    "9": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さんが<span>$2 [R-18]</span>をBOOTHで販売開始しました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "11": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さんが<span>$2</span>をBOOTHで販売開始しました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "13": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="' + l(n(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.url : f, b)) + '?utm_source=pixiv&utm_medium=popboard&utm_campaign=popboard" target="_blank">\n\t\t<div class="image">\n\t\t\t<img src="' + l(n(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.url : f, b)) + '" alt="" width="48" height="48">\n\t\t</div>\n' + (null != (f = c.if.call(i, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(8, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(13, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-comic_book"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return "\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』と<span>他$3件</span>が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title1 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title2 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.program(9, e, 0),
            data: e
        })) ? f : "";
    },
    "7": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "9": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "11": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="https://comic.pixiv.net/my?ads=popbook#books" class="icon-comic-book" target="_blank">\n\t\t<div class="image">\n\t\t\t<img src="' + l((c.prop || b && b.prop || j).call(i, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'notification/comic.png?1" alt="">\n\t\t</div>\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.details : b) ? f.other_count : f, ">", 0, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(11, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-comic_new"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return "\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』と<span>他$3件</span>が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title1 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title2 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.program(9, e, 0),
            data: e
        })) ? f : "";
    },
    "7": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "9": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "11": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="https://comic.pixiv.net/my?ads=popnew" class="icon-comic-new" target="_blank">\n\t\t<div class="image">\n\t\t\t<img src="' + l((c.prop || b && b.prop || j).call(i, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'notification/comic.png?1" alt="">\n\t\t</div>\n\t\t' + l((c.t || b && b.t || j).call(i, "pixivコミックで", {
            name: "t",
            hash: {},
            data: e
        })) + "\n" + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.details : b) ? f.other_count : f, ">", 0, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(11, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-comment_replied"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f, g = a.lambda, h = a.escapeExpression;
        return '\t\t<a href="/novel/show.php?id=' + h(g(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.target_id : f, b)) + "&amp;comment_id=" + h(g(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.comment_id : f, b)) + '">\n';
    },
    "5": function(a, b, c, d, e) {
        var f, g = a.lambda, h = a.escapeExpression;
        return '\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + h(g(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.target_id : f, b)) + "&amp;comment_id=" + h(g(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.comment_id : f, b)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n' + (null != (f = c.if.call(i, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.is_novel : f, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image"><img src="' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '"></div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんがあなたの<span>コメント</span>に返信しました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.user_name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "<br>\n\t\t<span>&gt; " + l((c.t || b && b.t || j).call(i, "$1さん", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.reply_to_user_name : f, {
            name: "t",
            hash: {},
            data: e
        })) + "</span> " + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.comment : f, b)) + "\n", 
        g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, h = {
            name: "date_time",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-commented"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/novel/show.php?id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/member_illust.php?mode=comment_chk&amp;illust_id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.type : f, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image">\n\t\t\t<img src="' + l(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1人</span>のユーザーが<span>「$2」</span>にコメントしました。", null != (f = null != b ? b.details : b) ? f.count : f, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-content_response"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.from : f) ? f.type : f, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.program(6, e, 0),
            data: e
        })) ? f : "";
    },
    "4": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<a href="/novel/show.php?id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.from : f) ? f.id : f, b)) + '">\n';
    },
    "6": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.from : f) ? f.id : f, b)) + '">\n';
    },
    "8": function(a, b, c, d, e) {
        return '\t\t<a href="/response.php?mode=chk">\n';
    },
    "10": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n' + (null != (f = c.if.call(i, null != b ? b.response_approved : b, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(8, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image">\n\t\t\t<img src="' + l(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんから<span>「$2」</span>へのイメージレスポンスが届きました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.from : f) ? f.user : f) ? f.name : f, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(10, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-fanbox_entry_published"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/whitecube/user/' + l(n(null != (f = null != b ? b.details : b) ? f.user_id : f, b)) + "/fanbox/" + l(n(null != (f = null != b ? b.details : b) ? f.fanbox_entry_id : f, b)) + '">\n\t\t<div class="image">\n\t\t\t<img src="' + l(n(null != (f = null != b ? b.details : b) ? f.user_profile_image_s : f, b)) + '" alt="" width="48" height="48">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんが<span>「$2」</span>で記事を公開しました", null != (f = null != b ? b.details : b) ? f.user_name : f, null != (f = null != b ? b.details : b) ? f.fanbox_plan_title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-favorited"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return "\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さん、<span>$2</span>さんがあなたをフォローしました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[1] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.program(8, e, 0),
            data: e
        })) ? f : "";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$2</span>さんと他<span>$1人</span>のユーザーがあなたをフォローしました。", null != (f = null != b ? b.details : b) ? f.other_count : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "8": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さんがあなたをフォローしました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "10": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="/bookmark.php?type=reg_user">\n\t\t<div class="image">\n\t\t\t<img src="' + l(a.lambda(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.users : b) ? f.length : f, "==", 2, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(10, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-group_application"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/group/?id=' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n\t\t<div class="image">\n\t\t\t<img src="' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "グループ<span>「$1」</span>に<span>$2人</span>以上の参加申請があります。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-group_approve"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/group/?id=' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n\t\t<div class="image">\n\t\t\t<img src="' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "グループ<span>「$1」</span>の参加申請が承認されました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-group_comment"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/group/comment.php?id=' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n\t\t<div class="image">\n\t\t\t<img src="' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "グループ<span>「$1」</span>のあなたの投稿に<span>$2件</span>以上のコメントがありました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-group_content_reference"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/group/comment.php?id=' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n\t\t<div class="image">\n\t\t\t<img src="' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "グループ<span>「$1」</span>にあなたの作品が紹介されました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-group_like"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/group/comment.php?id=' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n\t\t<div class="image">\n\t\t\t<img src="' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "グループ<span>「$1」</span>のあなたの投稿に<span>$2人</span>以上が「いいね！」と言っています。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-more"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/msgbox.php">\n\t\t\t' + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "他<span>$1件</span>以上の新着メッセージがあります。", null != b ? b.other_count : b, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n\t\t</a>\n";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/notify_all.php">\n\t\t\t' + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "他<span>$1件</span>以上の新着通知があります。", null != b ? b.other_count : b, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n\t\t</a>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f;
        return '<li class="continue unread">\n' + (null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, null != b ? b.notification_type : b, "==", "message", {
            name: "is",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.program(3, e, 0),
            data: e
        })) ? f : "") + "</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-ranked_in"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/ranking.php?mode=' + l(n(null != (f = null != b ? b.details : b) ? f.context : f, b)) + "&amp;content=" + l(n(null != (f = null != b ? b.details : b) ? f.type : f, b)) + '">\n\t\t<div class="image">\n\t\t\t<img src="' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>「$1」</span>が$2で<span>$3位</span>にランクインしました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.category : f, null != (f = null != b ? b.details : b) ? f.position : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-ranobe_book"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return "\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』と<span>他$3件</span>が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title1 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title2 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.program(9, e, 0),
            data: e
        })) ? f : "";
    },
    "7": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "9": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "11": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="https://novel.pixiv.net/my?ads=popbook#books" class="icon-comic-book" target="_blank">\n\t\t<div class="image">\n\t\t\t<img src="' + l((c.prop || b && b.prop || j).call(i, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/notification/novel.png" alt="">\n\t\t</div>\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.details : b) ? f.other_count : f, ">", 0, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(11, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-ranobe_new"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return "\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』と<span>他$3件</span>が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title1 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title2 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.program(9, e, 0),
            data: e
        })) ? f : "";
    },
    "7": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "9": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "11": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="https://novel.pixiv.net/my?ads=popnew" class="icon-comic-new" target="_blank">\n\t\t<div class="image">\n\t\t\t<img src="' + l((c.prop || b && b.prop || j).call(i, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'notification/novel.png" alt="">\n\t\t</div>\n\t\t' + l((c.t || b && b.t || j).call(i, "pixivノベルで", {
            name: "t",
            hash: {},
            data: e
        })) + "\n" + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.details : b) ? f.other_count : f, ">", 0, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(11, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-received_stacc_message"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="/stacc/my/home/all/message_from">\n\t\t<div class="image">\n\t\t\t<img src="' + l(a.lambda(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "フィードで<span>$1</span>さんがあなたへコメントしました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-requested_friend"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="/mypixiv_request.php">\n\t\t<div class="image">\n\t\t\t<img src="' + l(a.lambda(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんからマイピク申請が届きました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-scored"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/novel/bookmark_detail.php?id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/bookmark_detail.php?illust_id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.type : f, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image">\n\t\t\t<img src="' + l(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>「$1」</span>の評価点数が<span>$2点</span>を超えました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.score : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-sensei_new_course"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="' + l(a.lambda(null != (f = null != b ? b.details : b) ? f.target_url : f, b)) + '?utm_source=pixiv&utm_medium=popboard&utm_campaign=notify_new_course" target="_blank">\n\t\t<div class="image">\n\t\t\t<img src="' + l((c.prop || b && b.prop || j).call(i, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'notification/sensei.png" alt="" width="48" height="48">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "【sensei】新しく「$1」コースが追加されました！動画の視聴は<span>こちら</span>から。", null != (f = null != b ? b.details : b) ? f.course_name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-sensei_tmp_premium_limit"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="' + l(a.lambda(null != (f = null != b ? b.details : b) ? f.target_url : f, b)) + '?utm_source=pixiv&utm_medium=popboard&utm_campaign=notify_trial_expiration" target="_blank">\n\t\t<div class="image">\n\t\t\t<img src="' + l((c.prop || b && b.prop || j).call(i, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'notification/sensei.png" alt="" width="48" height="48">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "【sensei】実践編講座のお試し期間が$1で終了します！実践編講座の視聴は<span>こちら</span>から。", null != (f = null != b ? b.details : b) ? f.limit_date : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-sketch_newbie"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.sketch_item : f) ? f.url : f, b)) + '?utm_source=pixiv&utm_medium=popboard_newbie&utm_campaign=popboard_newbie" target="_blank">\n\t\t<div class="image">\n\t\t\t<img src="' + l(n(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.sketch_item : f) ? f.user : f) ? f.img : f, b)) + '" alt="" width="48" height="48">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんがpixiv Sketchを始めました！", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.sketch_item : f) ? f.user : f) ? f.user_name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["notification-tagged"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/novel/show.php?id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.type : f, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image">\n\t\t\t<img src="' + l(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + '" alt="">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>「$1」</span>に<span>$2</span>タグが追加されました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.tag : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates.pager = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return '\t\t\t<a href="' + i((f = null != (f = c.url || (null != b ? b.url : b)) ? f : h, 
        "function" == typeof f ? f.call(g, {
            name: "url",
            hash: {},
            data: e
        }) : f)) + '" rel="prev" class="_button" title="' + i((c.t || b && b.t || h).call(g, "前へ", {
            name: "t",
            hash: {},
            data: e
        })) + '">\n\t\t\t\t<i class="_icon sprites-prev-linked"></i>\n\t\t\t</a>\n';
    },
    "3": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = "\t\t\t";
        return g = null != (g = c.current || (null != b ? b.current : b)) ? g : j, h = {
            name: "current",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.current || (f = l.call(b, f, h)), null != f && (m += f), 
        m += "\n\t\t\t", g = null != (g = c.current || (null != b ? b.current : b)) ? g : j, 
        h = {
            name: "current",
            hash: {},
            fn: a.noop,
            inverse: a.program(6, e, 0),
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.current || (f = l.call(b, f, h)), null != f && (m += f), 
        m + "\n";
    },
    "4": function(a, b, c, d, e) {
        var f;
        return '<li class="current">' + a.escapeExpression((f = null != (f = c.page || (null != b ? b.page : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "page",
            hash: {},
            data: e
        }) : f)) + "</li>";
    },
    "6": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '<li><a href="' + j((f = null != (f = c.url || (null != b ? b.url : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "url",
            hash: {},
            data: e
        }) : f)) + '">' + j((f = null != (f = c.page || (null != b ? b.page : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "page",
            hash: {},
            data: e
        }) : f)) + "</a></li>";
    },
    "8": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return '\t\t\t<a href="' + i((f = null != (f = c.url || (null != b ? b.url : b)) ? f : h, 
        "function" == typeof f ? f.call(g, {
            name: "url",
            hash: {},
            data: e
        }) : f)) + '" rel="next" class="_button" title="' + i((c.t || b && b.t || h).call(g, "次へ", {
            name: "t",
            hash: {},
            data: e
        })) + '">\n\t\t\t\t<i class="_icon sprites-next-linked"></i>\n\t\t\t</a>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = '<div class="pager-container">\n\t<span class="prev">\n';
        return g = null != (g = c.prev || (null != b ? b.prev : b)) ? g : j, h = {
            name: "prev",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.prev || (f = l.call(b, f, h)), null != f && (m += f), 
        m += '\t</span>\n\t<ul class="page-list">\n', g = null != (g = c.pages || (null != b ? b.pages : b)) ? g : j, 
        h = {
            name: "pages",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.pages || (f = l.call(b, f, h)), null != f && (m += f), 
        m += '\t</ul>\n\t<span class="next">\n', g = null != (g = c.next || (null != b ? b.next : b)) ? g : j, 
        h = {
            name: "next",
            hash: {},
            fn: a.program(8, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.next || (f = l.call(b, f, h)), null != f && (m += f), 
        m + "\t</span>\n</div>\n";
    },
    useData: !0
}), this.pixiv.templates["profile-popup-loading"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = '\t\t\t\t\t<a href="/member.php?id=' + a.escapeExpression((c.url_encode || b && b.url_encode || j).call(i, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '" target="_blank" class="user-icon-container">\n';
        return g = null != (g = c.profile_img || (null != b ? b.profile_img : b)) ? g : j, 
        h = {
            name: "profile_img",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.profile_img || (f = l.call(b, f, h)), 
        null != f && (m += f), g = null != (g = c.profile_img || (null != b ? b.profile_img : b)) ? g : j, 
        h = {
            name: "profile_img",
            hash: {},
            fn: a.noop,
            inverse: a.program(4, e, 0),
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.profile_img || (f = l.call(b, f, h)), 
        null != f && (m += f), m + "\t\t\t\t\t</a>\n";
    },
    "2": function(a, b, c, d, e) {
        var f;
        return '\t\t\t\t\t\t\t<img src="' + a.escapeExpression((f = null != (f = c.profile_img || (null != b ? b.profile_img : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "profile_img",
            hash: {},
            data: e
        }) : f)) + '" class="user-icon" width="40">\n';
    },
    "4": function(a, b, c, d, e) {
        return '\t\t\t\t\t\t\t<img src="' + a.escapeExpression((c.prop || b && b.prop || c.helperMissing).call(null != b ? b : {}, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/common/transparent.gif" class="user-icon loading" width="40">\n';
    },
    "6": function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.user_name || (null != b ? b.user_name : b)) ? g : c.helperMissing, 
        h = {
            name: "user_name",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.user_name || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    "7": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return '\t\t\t\t\t<h1><a href="/member.php?id=' + i((c.url_encode || b && b.url_encode || h).call(g, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '" target="_blank" class="user-name">' + i((f = null != (f = c.user_name || (null != b ? b.user_name : b)) ? f : h, 
        "function" == typeof f ? f.call(g, {
            name: "user_name",
            hash: {},
            data: e
        }) : f)) + "</a></h1>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = '<section class="_profile-popup">\n\t<div class="wrapper">\n\t\t<div class="items">\n\t\t\t<div class="_spinner"></div>\n\t\t</div>\n\t\t<div class="user-info">\n\t\t\t<div class="user-profile">\n';
        return g = null != (g = c.user_id || (null != b ? b.user_id : b)) ? g : j, h = {
            name: "user_id",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.user_id || (f = l.call(b, f, h)), null != f && (m += f), 
        m += "\t\t\t</div>\n", g = null != (g = c.user_id || (null != b ? b.user_id : b)) ? g : j, 
        h = {
            name: "user_id",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.user_id || (f = l.call(b, f, h)), null != f && (m += f), 
        m + '\t\t</div>\n\t</div>\n\t<div class="nipple"></div>\n</section>\n';
    },
    useData: !0
}), this.pixiv.templates["profile-popup"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return '\t\t<div class="no-item">' + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "作品がありません", {
            name: "t",
            hash: {},
            data: e
        })) + "</div>\n";
    },
    "3": function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    "4": function(a, b, c, d, e) {
        var f;
        return null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, null != b ? b.type : b, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.program(7, e, 0),
            data: e
        })) ? f : "";
    },
    "5": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '\t\t\t\t<a href="/novel/show.php?id=' + j((f = null != (f = c.id || (null != b ? b.id : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "id",
            hash: {},
            data: e
        }) : f)) + '&amp;ref=profile_card" target="_blank" class="item novel _layout-thumbnail">\n\t\t\t\t\t<h1 class="title">' + j((f = null != (f = c.title || (null != b ? b.title : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "title",
            hash: {},
            data: e
        }) : f)) + '</h1>\n\t\t\t\t\t<div class="word-count">' + j((f = null != (f = c.text_length || (null != b ? b.text_length : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "text_length",
            hash: {},
            data: e
        }) : f)) + " " + j((c.t || b && b.t || h).call(g, "文字", {
            name: "t",
            hash: {},
            data: e
        })) + "</div>\n\t\t\t\t</a>\n";
    },
    "7": function(a, b, c, d, e) {
        var f;
        return null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, null != b ? b.illust_x_restrict : b, "==", 0, {
            name: "is",
            hash: {},
            fn: a.program(8, e, 0),
            inverse: a.program(10, e, 0),
            data: e
        })) ? f : "";
    },
    "8": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression;
        return '\t\t\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + j((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : i, 
        "function" == typeof g ? g.call(h, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '&amp;ref=profile_card" target="_blank" class="item ' + j((c.get_thumbnail_classes || b && b.get_thumbnail_classes || i).call(h, null != b ? b.illust_id : b, null != b ? b.illust_type : b, null != b ? b.illust_page_count : b, null != b ? b.illust_book_style : b, {
            name: "get_thumbnail_classes",
            hash: {},
            data: e
        })) + '" style="background-image:url(' + j(a.lambda(null != (f = null != b ? b.url : b) ? f["480mw"] : f, b)) + ')"></a>\n';
    },
    "10": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, (f = e && e.root) && f.r18_page, {
            name: "if",
            hash: {},
            fn: a.program(11, e, 0),
            inverse: a.program(13, e, 0),
            data: e
        })) ? f : "";
    },
    "11": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression;
        return '\t\t\t\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + j((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : i, 
        "function" == typeof g ? g.call(h, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '&amp;ref=profile_card" target="_blank" class="item  ' + j((c.get_thumbnail_classes || b && b.get_thumbnail_classes || i).call(h, null != b ? b.illust_id : b, null != b ? b.illust_type : b, null != b ? b.illust_page_count : b, null != b ? b.illust_book_style : b, {
            name: "get_thumbnail_classes",
            hash: {},
            data: e
        })) + '" style="background-image:url(' + j(a.lambda(null != (f = null != b ? b.url : b) ? f["480mw"] : f, b)) + ')"></a>\n';
    },
    "13": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return '\t\t\t\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + i((f = null != (f = c.illust_id || (null != b ? b.illust_id : b)) ? f : h, 
        "function" == typeof f ? f.call(g, {
            name: "illust_id",
            hash: {},
            data: e
        }) : f)) + '&amp;ref=profile_card" target="_blank" class="item explicit  ' + i((c.get_thumbnail_classes || b && b.get_thumbnail_classes || h).call(g, null != b ? b.illust_id : b, null != b ? b.illust_type : b, null != b ? b.illust_page_count : b, null != b ? b.illust_book_style : b, {
            name: "get_thumbnail_classes",
            hash: {},
            data: e
        })) + '"></a>\n';
    },
    "15": function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(16, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    "16": function(a, b, c, d, e) {
        var f;
        return null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, null != b ? b.type : b, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.program(17, e, 0),
            data: e
        })) ? f : "";
    },
    "17": function(a, b, c, d, e) {
        var f;
        return null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, null != b ? b.illust_x_restrict : b, "==", 0, {
            name: "is",
            hash: {},
            fn: a.program(18, e, 0),
            inverse: a.program(20, e, 0),
            data: e
        })) ? f : "";
    },
    "18": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression;
        return '\t\t\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + j((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : i, 
        "function" == typeof g ? g.call(h, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '&amp;ref=profile_card" target="_blank" class="item  ' + j((c.get_thumbnail_classes || b && b.get_thumbnail_classes || i).call(h, null != b ? b.illust_id : b, null != b ? b.illust_type : b, null != b ? b.illust_page_count : b, null != b ? b.illust_book_style : b, {
            name: "get_thumbnail_classes",
            hash: {},
            data: e
        })) + '" style="background-image:url(' + j(a.lambda(null != (f = null != b ? b.url : b) ? f["240mw"] : f, b)) + ')"></a>\n';
    },
    "20": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, (f = e && e.root) && f.r18_page, {
            name: "if",
            hash: {},
            fn: a.program(21, e, 0),
            inverse: a.program(13, e, 0),
            data: e
        })) ? f : "";
    },
    "21": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression;
        return '\t\t\t\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + j((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : i, 
        "function" == typeof g ? g.call(h, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '&amp;ref=profile_card" target="_blank" class="item  ' + j((c.get_thumbnail_classes || b && b.get_thumbnail_classes || i).call(h, null != b ? b.illust_id : b, null != b ? b.illust_type : b, null != b ? b.illust_page_count : b, null != b ? b.illust_book_style : b, {
            name: "get_thumbnail_classes",
            hash: {},
            data: e
        })) + '" style="background-image:url(' + j(a.lambda(null != (f = null != b ? b.url : b) ? f["240mw"] : f, b)) + ')"></a>\n';
    },
    "23": function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(24, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    "24": function(a, b, c, d, e) {
        var f;
        return null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, null != b ? b.type : b, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.program(25, e, 0),
            data: e
        })) ? f : "";
    },
    "25": function(a, b, c, d, e) {
        var f;
        return null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, null != b ? b.illust_x_restrict : b, "==", 0, {
            name: "is",
            hash: {},
            fn: a.program(26, e, 0),
            inverse: a.program(28, e, 0),
            data: e
        })) ? f : "";
    },
    "26": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression;
        return '\t\t\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + j((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : i, 
        "function" == typeof g ? g.call(h, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '&amp;ref=profile_card" target="_blank" class="item  ' + j((c.get_thumbnail_classes || b && b.get_thumbnail_classes || i).call(h, null != b ? b.illust_id : b, null != b ? b.illust_type : b, null != b ? b.illust_page_count : b, null != b ? b.illust_book_style : b, {
            name: "get_thumbnail_classes",
            hash: {},
            data: e
        })) + '" style="background-image:url(' + j(a.lambda(null != (f = null != b ? b.url : b) ? f["128x128"] : f, b)) + ')"></a>\n';
    },
    "28": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, (f = e && e.root) && f.r18_page, {
            name: "if",
            hash: {},
            fn: a.program(29, e, 0),
            inverse: a.program(13, e, 0),
            data: e
        })) ? f : "";
    },
    "29": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression;
        return '\t\t\t\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + j((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : i, 
        "function" == typeof g ? g.call(h, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '&amp;ref=profile_card" target="_blank" class="item  ' + j((c.get_thumbnail_classes || b && b.get_thumbnail_classes || i).call(h, null != b ? b.illust_id : b, null != b ? b.illust_type : b, null != b ? b.illust_page_count : b, null != b ? b.illust_book_style : b, {
            name: "get_thumbnail_classes",
            hash: {},
            data: e
        })) + '" style="background-image:url(' + j(a.lambda(null != (f = null != b ? b.url : b) ? f["128x128"] : f, b)) + ')"></a>\n';
    },
    "31": function(a, b, c, d, e) {
        var f = null != b ? b : {}, g = c.helperMissing, h = a.escapeExpression;
        return '\t\t\t\t\t<li class="new-context"><a href="/messages.php?receiver_id=' + h((c.url_encode || b && b.url_encode || g).call(f, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '&amp;ref=profile_card" target="_blank">' + h((c.t || b && b.t || g).call(f, "メッセージを送る", {
            name: "t",
            hash: {},
            data: e
        })) + '</a></li>\n\t\t\t\t\t<li class="new-context"><a href="/user_infomsg.php?id=' + h((c.url_encode || b && b.url_encode || g).call(f, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '&amp;ref=profile_card" target="_blank">' + h((c.t || b && b.t || g).call(f, "ユーザーを報告・ブロック", {
            name: "t",
            hash: {},
            data: e
        })) + "</a></li>\n";
    },
    "33": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = '\t\t<div class="_follow-button-container';
        return g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, h = {
            name: "is_follow",
            hash: {},
            fn: a.program(34, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = l.call(b, f, h)), 
        null != f && (m += f), m += '">\n\t\t\t<button class="follow-button">\n\t\t\t\t', 
        g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, h = {
            name: "is_follow",
            hash: {},
            fn: a.program(36, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = l.call(b, f, h)), 
        null != f && (m += f), m += "\n\t\t\t\t", g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, 
        h = {
            name: "is_follow",
            hash: {},
            fn: a.noop,
            inverse: a.program(38, e, 0),
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = l.call(b, f, h)), 
        null != f && (m += f), m += '\n\t\t\t</button>\n\t\t\t<span class="follow-more-button-container">\n\t\t\t\t<button class="follow-more-button">\n\t\t\t\t\t<i class="_icon sprites-more"></i>\n\t\t\t\t</button>\n\t\t\t\t<div class="options-wrapper">\n\t\t\t\t\t<div class="options-container">\n\t\t\t\t\t\t<section class="option">\n', 
        g = null != (g = c.premium || (null != b ? b.premium : b)) ? g : j, h = {
            name: "premium",
            hash: {},
            fn: a.program(40, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.premium || (f = l.call(b, f, h)), null != f && (m += f), 
        g = null != (g = c.premium || (null != b ? b.premium : b)) ? g : j, h = {
            name: "premium",
            hash: {},
            fn: a.noop,
            inverse: a.program(42, e, 0),
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.premium || (f = l.call(b, f, h)), null != f && (m += f), 
        m += '\t\t\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t\t\t<label><input type="checkbox" name="restrict" value="1">' + a.escapeExpression((c.t || b && b.t || j).call(i, "公開しない", {
            name: "t",
            hash: {},
            data: e
        })) + "</label>\n\t\t\t\t\t\t\t</div>\n", g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, 
        h = {
            name: "is_follow",
            hash: {},
            fn: a.program(44, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = l.call(b, f, h)), 
        null != f && (m += f), m + "\t\t\t\t\t\t</section>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t</div>\n";
    },
    "34": function(a, b, c, d, e) {
        return " following2";
    },
    "36": function(a, b, c, d, e) {
        return a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "フォロー中", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    "38": function(a, b, c, d, e) {
        return a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "フォローする", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    "40": function(a, b, c, d, e) {
        var f = null != b ? b : {}, g = c.helperMissing, h = a.escapeExpression;
        return '\t\t\t\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t\t\t\t<select name="tag" disabled>\n\t\t\t\t\t\t\t\t\t\t<option value="">' + h((c.t || b && b.t || g).call(f, "フォルダー", {
            name: "t",
            hash: {},
            data: e
        })) + '</option>\n\t\t\t\t\t\t\t\t\t\t<option value="new">' + h((c.t || b && b.t || g).call(f, "新規フォルダー", {
            name: "t",
            hash: {},
            data: e
        })) + "</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n";
    },
    "42": function(a, b, c, d, e) {
        var f = null != b ? b : {}, g = c.helperMissing, h = a.escapeExpression;
        return '\t\t \t\t\t\t\t\t<a href="/premium.php?ref=profile_card" target="_blank" class="item premium-feature">\n\t\t\t\t\t\t\t\t\t<select name="tag" disabled>\n\t\t\t\t\t\t\t\t\t\t<option value="">' + h((c.t || b && b.t || g).call(f, "フォルダー", {
            name: "t",
            hash: {},
            data: e
        })) + '</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t<i class="_icon sprites-premium"></i>\n\t\t\t\t\t\t\t\t\t<p class="_notes">' + h((c.t || b && b.t || g).call(f, "プレミアム会員になるとユーザーをフォルダーに分類できます", {
            name: "t",
            hash: {},
            data: e
        })) + "</p>\n\t\t\t\t\t\t\t\t</a>\n";
    },
    "44": function(a, b, c, d, e) {
        var f = null != b ? b : {}, g = c.helperMissing, h = a.escapeExpression;
        return '\t\t\t\t\t\t\t\t<div class="action">\n\t\t\t\t\t\t\t\t\t<span class="_button2 unfollow-button">' + h((c.t || b && b.t || g).call(f, "フォロー解除", {
            name: "t",
            hash: {},
            data: e
        })) + '</span>\n\t\t\t\t\t\t\t\t\t<span class="_button2 update-button">' + h((c.t || b && b.t || g).call(f, "更新", {
            name: "t",
            hash: {},
            data: e
        })) + "</span>\n\t\t\t\t\t\t\t\t</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = a.escapeExpression, j = null != b ? b : {}, k = c.helperMissing, l = "function", m = c.blockHelperMissing, n = '<div class="items layout-' + i(a.lambda(null != (f = null != b ? b.items : b) ? f.length : f, b)) + '">\n' + (null != (f = (c.is || b && b.is || k).call(j, null != (f = null != b ? b.illusts : b) ? f.length : f, "==", 0, {
            name: "is",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + (null != (f = (c.is || b && b.is || k).call(j, null != (f = null != b ? b.items : b) ? f.length : f, "==", 1, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + (null != (f = (c.is || b && b.is || k).call(j, null != (f = null != b ? b.items : b) ? f.length : f, "==", 2, {
            name: "is",
            hash: {},
            fn: a.program(15, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + (null != (f = (c.is || b && b.is || k).call(j, null != (f = null != b ? b.items : b) ? f.length : f, "==", 3, {
            name: "is",
            hash: {},
            fn: a.program(23, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '</div>\n<div class="user-info">\n\t<div class="user-profile">\n\t\t<a href="/member.php?id=' + i((c.url_encode || b && b.url_encode || k).call(j, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '&amp;ref=profile_card" target="_blank" class="user-icon-container">\n\t\t\t<img src="' + i((g = null != (g = c.profile_img || (null != b ? b.profile_img : b)) ? g : k, 
        typeof g === l ? g.call(j, {
            name: "profile_img",
            hash: {},
            data: e
        }) : g)) + '" class="user-icon" width="40">\n\t\t</a>\n\t\t<div class="user-menu-items-wrapper">\n\t\t\t<ul class="user-menu-items">\n\t\t\t\t<li><a href="/member.php?id=' + i((c.url_encode || b && b.url_encode || k).call(j, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '&amp;ref=profile_card" target="_blank">' + i((c.t || b && b.t || k).call(j, "プロフィール", {
            name: "t",
            hash: {},
            data: e
        })) + '</a></li>\n\t\t\t\t<li><a href="/member_illust.php?id=' + i((c.url_encode || b && b.url_encode || k).call(j, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '&amp;ref=profile_card" target="_blank">' + i((c.t || b && b.t || k).call(j, "作品", {
            name: "t",
            hash: {},
            data: e
        })) + '</a></li>\n\t\t\t\t<li><a href="/bookmark.php?id=' + i((c.url_encode || b && b.url_encode || k).call(j, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '&amp;ref=profile_card" target="_blank">' + i((c.t || b && b.t || k).call(j, "ブックマーク", {
            name: "t",
            hash: {},
            data: e
        })) + '</a></li>\n\t\t\t\t<li><a href="/stacc/' + i((c.url_encode || b && b.url_encode || k).call(j, null != b ? b.user_account : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '&amp;ref=profile_card" target="_blank">' + i((c.t || b && b.t || k).call(j, "フィード", {
            name: "t",
            hash: {},
            data: e
        })) + "</a></li>\n";
        return g = null != (g = c.controllable || (null != b ? b.controllable : b)) ? g : k, 
        h = {
            name: "controllable",
            hash: {},
            fn: a.program(31, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === l ? g.call(j, h) : g, c.controllable || (f = m.call(b, f, h)), 
        null != f && (n += f), n += '\t\t\t</ul>\n\t\t</div>\n\t</div>\n\t<h1><a href="/member.php?id=' + i((c.url_encode || b && b.url_encode || k).call(j, null != b ? b.user_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '&amp;ref=profile_card" target="_blank" class="user-name">' + i((g = null != (g = c.user_name || (null != b ? b.user_name : b)) ? g : k, 
        typeof g === l ? g.call(j, {
            name: "user_name",
            hash: {},
            data: e
        }) : g)) + '</a></h1>\n\t<p class="description">' + i((c.truncate || b && b.truncate || k).call(j, null != b ? b.user_comment : b, 16, {
            name: "truncate",
            hash: {},
            data: e
        })) + "</p>\n\n", g = null != (g = c.controllable || (null != b ? b.controllable : b)) ? g : k, 
        h = {
            name: "controllable",
            hash: {},
            fn: a.program(33, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === l ? g.call(j, h) : g, c.controllable || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "</div>\n";
    },
    useData: !0
}), this.pixiv.templates["promotion-comic-novel"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = "function", k = a.escapeExpression;
        return '\t\t<div class="item book _ui-tooltip" data-tooltip="' + k((g = null != (g = c.title || (null != b ? b.title : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "title",
            hash: {},
            data: e
        }) : g)) + '">\n\t\t\t<a href="https://novel.pixiv.net/works/' + k((g = null != (g = c.workId || (null != b ? b.workId : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "workId",
            hash: {},
            data: e
        }) : g)) + "?ads=" + k((g = null != (g = c.mpr || (null != b ? b.mpr : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "mpr",
            hash: {},
            data: e
        }) : g)) + '" target="_blank">\n' + (null != (f = c.if.call(h, null != b ? b.lazy : b, {
            name: "if",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.program(4, e, 0),
            data: e
        })) ? f : "") + '\t\t\t\t<div class="try-read">読んでみる</div>\n\t\t\t</a>\n\t\t</div>\n';
    },
    "2": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression, j = "function";
        return '\t\t\t\t\t<img src="' + i((c.prop || b && b.prop || h).call(g, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/common/transparent.gif" data-src="' + i((f = null != (f = c.imageURL || (null != b ? b.imageURL : b)) ? f : h, 
        typeof f === j ? f.call(g, {
            name: "imageURL",
            hash: {},
            data: e
        }) : f)) + '" width="140" height="190" alt="' + i((f = null != (f = c.title || (null != b ? b.title : b)) ? f : h, 
        typeof f === j ? f.call(g, {
            name: "title",
            hash: {},
            data: e
        }) : f)) + '">\n';
    },
    "4": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '\t\t\t\t\t<img src="' + j((f = null != (f = c.imageURL || (null != b ? b.imageURL : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "imageURL",
            hash: {},
            data: e
        }) : f)) + '" width="140" height="190" alt="' + j((f = null != (f = c.title || (null != b ? b.title : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "title",
            hash: {},
            data: e
        }) : f)) + '">\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = '<div class="items books">\n';
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i + '</div>\n<ul class="pager"></ul>\n';
    },
    useData: !0
}), this.pixiv.templates["promotion-comic"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = "function", k = a.escapeExpression;
        return '\t\t<div class="item book _ui-tooltip" data-tooltip="' + k((g = null != (g = c.title || (null != b ? b.title : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "title",
            hash: {},
            data: e
        }) : g)) + '">\n' + (null != (f = c.if.call(h, null != b ? b.newFlag : b, {
            name: "if",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '\t\t\t<div class="thick">\n\t\t\t\t<a href="https://comic.pixiv.net/magazines/' + k((g = null != (g = c.magazineId || (null != b ? b.magazineId : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "magazineId",
            hash: {},
            data: e
        }) : g)) + '?ads=mpr" target="_blank">\n' + (null != (f = c.if.call(h, null != b ? b.lazy : b, {
            name: "if",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.program(6, e, 0),
            data: e
        })) ? f : "") + "\t\t\t\t</a>\n\t\t\t</div>\n\t\t</div>\n";
    },
    "2": function(a, b, c, d, e) {
        return '\t\t\t\t<ul class="badge">\n\t\t\t\t\t<li class="new">NEW</li>\n\t\t\t\t</ul>\n';
    },
    "4": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression, j = "function";
        return '\t\t\t\t\t\t<img src="' + i((c.prop || b && b.prop || h).call(g, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/common/transparent.gif" data-src="' + i((f = null != (f = c.imageURL || (null != b ? b.imageURL : b)) ? f : h, 
        typeof f === j ? f.call(g, {
            name: "imageURL",
            hash: {},
            data: e
        }) : f)) + '" width="60" height="87" alt="' + i((f = null != (f = c.title || (null != b ? b.title : b)) ? f : h, 
        typeof f === j ? f.call(g, {
            name: "title",
            hash: {},
            data: e
        }) : f)) + '">\n';
    },
    "6": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '\t\t\t\t\t\t<img src="' + j((f = null != (f = c.imageURL || (null != b ? b.imageURL : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "imageURL",
            hash: {},
            data: e
        }) : f)) + '" width="60" height="87" alt="' + j((f = null != (f = c.title || (null != b ? b.title : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "title",
            hash: {},
            data: e
        }) : f)) + '">\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = '<div class="items books">\n';
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i + '</div>\n<ul class="pager"></ul>\n<div class="pager-prev"></div>\n<div class="pager-next"></div>\n';
    },
    useData: !0
}), this.pixiv.templates["promotion-contest-novel"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '\t\t<div class="item contest">\n\t\t\t<a href="' + j((f = null != (f = c.linkURL || (null != b ? b.linkURL : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "linkURL",
            hash: {},
            data: e
        }) : f)) + '" target="_blank">\n\t\t\t\t<img src="' + j((f = null != (f = c.imageURL || (null != b ? b.imageURL : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "imageURL",
            hash: {},
            data: e
        }) : f)) + '" width="548" height="178">\n\t\t\t</a>\n\t\t</div>\n';
    },
    "3": function(a, b, c, d, e) {
        return "";
    },
    "5": function(a, b, c, d, e) {
        return '\t<ul class="pager"></ul>\n\t<div class="pager-prev"></div>\n\t<div class="pager-next"></div>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = '<div class="items contests">\n';
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(i, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (j += f), j + "</div>\n" + (null != (f = c.if.call(i, null != b ? b.items : b, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + (null != (f = c.if.call(i, null != (f = null != b ? b.items : b) ? f[1] : f, {
            name: "if",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "");
    },
    useData: !0
}), this.pixiv.templates["promotion-contest-portal"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '\t\t<div class="item contest">\n\t\t\t<a href="' + j((f = null != (f = c.linkURL || (null != b ? b.linkURL : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "linkURL",
            hash: {},
            data: e
        }) : f)) + '" target="_blank">\n\t\t\t\t<img src="' + j((f = null != (f = c.imageURL || (null != b ? b.imageURL : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "imageURL",
            hash: {},
            data: e
        }) : f)) + '" width="968" height="314">\n\t\t\t</a>\n\t\t</div>\n';
    },
    "3": function(a, b, c, d, e) {
        return "";
    },
    "5": function(a, b, c, d, e) {
        return '\t<ul class="pager"></ul>\n\t<div class="pager-prev"></div>\n\t<div class="pager-next"></div>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = '<div class="items contests">\n';
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(i, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (j += f), j + "</div>\n" + (null != (f = c.if.call(i, null != b ? b.items : b, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + (null != (f = c.if.call(i, null != (f = null != b ? b.items : b) ? f[1] : f, {
            name: "if",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "");
    },
    useData: !0
}), this.pixiv.templates["promotion-melonbooks-dl"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '\t\t<div class="_melonbooks-dl-item">\n\t\t\t<a href="' + j((f = null != (f = c.url || (null != b ? b.url : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "url",
            hash: {},
            data: e
        }) : f)) + '" target="_blank">\n\t\t\t\t<h1 class="title">' + j((f = null != (f = c.name || (null != b ? b.name : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "name",
            hash: {},
            data: e
        }) : f)) + '</h1>\n\t\t\t\t<img src="' + j((f = null != (f = c.image || (null != b ? b.image : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "image",
            hash: {},
            data: e
        }) : f)) + '" width="100" height="100" alt="">\n\t\t\t\t<p class="description">' + j((f = null != (f = c.description || (null != b ? b.description : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "description",
            hash: {},
            data: e
        }) : f)) + "</p>\n\t\t\t</a>\n\t\t</div>\n";
    },
    "3": function(a, b, c, d, e) {
        return '\t\t<p class="_no-item">' + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "商品はまだありません", {
            name: "t",
            hash: {},
            data: e
        })) + "</p>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<aside class="_unit">\n\t<h1 class="unit-title"><a href="' + l((g = null != (g = c.url || (null != b ? b.url : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "url",
            hash: {},
            data: e
        }) : g)) + '" target="_blank">' + l((c.t || b && b.t || j).call(i, "メロンブックスDL", {
            name: "t",
            hash: {},
            data: e
        })) + "</a></h1>\n";
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : j, h = {
            name: "items",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.items || (f = m.call(b, f, h)), null != f && (n += f), 
        g = null != (g = c.items || (null != b ? b.items : b)) ? g : j, h = {
            name: "items",
            hash: {},
            fn: a.noop,
            inverse: a.program(3, e, 0),
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.items || (f = m.call(b, f, h)), null != f && (n += f), 
        n + "</aside>\n";
    },
    useData: !0
}), this.pixiv.templates["promotion-sketch"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != b ? b.posts : b, {
            name: "if",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "2": function(a, b, c, d, e) {
        var f, g, h, i = a.lambda, j = a.escapeExpression, k = null != b ? b : {}, l = c.helperMissing, m = '\t\t<div class="works-illust">\n\t\t\t<p class="worksListOthersTitle">\n\t\t\t\t<a href="' + j(i(null != (f = null != b ? b.user : b) ? f.url : f, b)) + '?utm_source=pixiv&amp;utm_medium=profile&amp;utm_campaign=profile" class="active_gray" target="_blank">' + j((c.t || b && b.t || l).call(k, "pixiv Sketchで投稿した作品", {
            name: "t",
            hash: {},
            data: e
        })) + '</a>&nbsp;<a href="http://sketch.pixiv.net/?utm_source=pixiv&amp;utm_medium=profile&amp;utm_campaign=profile" target="_blank" class="_icon sprites-help _ui-tooltip pixiv_sketch_tooltip" data-tooltip="' + j((c.t || b && b.t || l).call(k, "pixiv Sketchでは落書きや描き途中の絵などを気軽に共有できます！", {
            name: "t",
            hash: {},
            data: e
        })) + '">?</a>\n\t\t\t\t' + (null != (f = c.if.call(k, (f = e && e.root) && f.isMyself, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '\n\t\t\t</p>\n\t\t\t<ul class="_image-items no-user">\n';
        return g = null != (g = c.posts || (null != b ? b.posts : b)) ? g : l, h = {
            name: "posts",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(k, h) : g, c.posts || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (m += f), m + '\t\t\t</ul>\n\t\t\t<div class="_more" style="margin:10px 0;">\n\t\t\t\t<a href="' + j(i(null != (f = null != b ? b.user : b) ? f.url : f, b)) + '?utm_source=pixiv&amp;utm_medium=profile&amp;utm_campaign=profile" target="_blank">' + j((c.t || b && b.t || l).call(k, "pixiv Sketchでもっと見る", {
            name: "t",
            hash: {},
            data: e
        })) + "</a>\n\t\t\t</div>\n\t\t</div>\n";
    },
    "3": function(a, b, c, d, e) {
        var f, g = a.escapeExpression;
        return '<a href="' + g(a.lambda((f = e && e.root) && f.sketchUrlBase, b)) + '/settings?utm_source=pixiv&amp;utm_medium=profile&amp;utm_campaign=profile#pixiv-connect" target="_blank" class="pixiv_sketch_setting">' + g((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "表示の設定", {
            name: "t",
            hash: {},
            data: e
        })) + "</a>";
    },
    "5": function(a, b, c, d, e) {
        var f, g, h = a.escapeExpression;
        return '\t\t\t\t\t<li class="image-item pixiv-sketch-image-item">\n\t\t\t\t\t\t<a target="_blank" href="' + h((g = null != (g = c.url || (null != b ? b.url : b)) ? g : c.helperMissing, 
        "function" == typeof g ? g.call(null != b ? b : {}, {
            name: "url",
            hash: {},
            data: e
        }) : g)) + '?utm_source=pixiv&amp;utm_medium=profile&amp;utm_campaign=profile" class="work _work">\n\t\t\t\t\t\t\t<div class="_layout-thumbnail">\n\t\t\t\t\t\t\t\t<img src="' + h(a.lambda(null != (f = null != (f = null != (f = null != b ? b.thumbnail : b) ? f.photo : f) ? f.sq180 : f) ? f.url : f, b)) + '" class="_thumbnail _pixiv_sketch_thumbnail" width="150" height="150" />\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.data || (null != b ? b.data : b)) ? g : c.helperMissing, 
        h = {
            name: "data",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.data || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    useData: !0
}), this.pixiv.templates.promotion = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h, i = '\t\t\t<div class="items">\n';
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i + "\t\t\t</div>\n";
    },
    "2": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = "function", k = a.escapeExpression, l = a.lambda;
        return '\t\t\t\t\t<section class="item">\n\t\t\t\t\t\t<a href="' + k((g = null != (g = c.market_url || (null != b ? b.market_url : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "market_url",
            hash: {},
            data: e
        }) : g)) + "?utm_source=pixiv&amp;utm_medium=promotion&amp;utm_content=" + k(l((f = e && e.root) && f.content, b)) + '-item&amp;utm_campaign=pixiv-promotion" target="_blank" class="image">\n' + (null != (f = c.if.call(h, null != b ? b.lazy : b, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t\t\t\t\t</a>\n\t\t\t\t\t\t<div class="body">\n\t\t\t\t\t\t\t<h1 class="title">\n\t\t\t\t\t\t\t\t<a href="' + k((g = null != (g = c.market_url || (null != b ? b.market_url : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "market_url",
            hash: {},
            data: e
        }) : g)) + "?utm_source=pixiv&amp;utm_medium=promotion&amp;utm_content=" + k(l((f = e && e.root) && f.content, b)) + '-item&amp;utm_campaign=pixiv-promotion" target="_blank" class="image">' + k((g = null != (g = c.name || (null != b ? b.name : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "name",
            hash: {},
            data: e
        }) : g)) + '</a>\n\t\t\t\t\t\t\t</h1>\n\t\t\t\t\t\t\t<p class="price">&yen;' + k((c.format || b && b.format || i).call(h, null != b ? b.price : b, {
            name: "format",
            hash: {},
            data: e
        })) + "</p>\n\t\t\t\t\t\t\t<p>" + k((c.truncate || b && b.truncate || i).call(h, null != b ? b.description : b, 50, {
            name: "truncate",
            hash: {},
            data: e
        })) + "</p>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</section>\n";
    },
    "3": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return '\t\t\t\t\t\t\t\t<img src="' + i((c.prop || b && b.prop || h).call(g, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/common/transparent.gif" data-src="' + i((f = null != (f = c.image || (null != b ? b.image : b)) ? f : h, 
        "function" == typeof f ? f.call(g, {
            name: "image",
            hash: {},
            data: e
        }) : f)) + '" alt="">\n';
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t\t\t\t\t\t\t<img src="' + a.escapeExpression((f = null != (f = c.image || (null != b ? b.image : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "image",
            hash: {},
            data: e
        }) : f)) + '" alt="">\n';
    },
    "7": function(a, b, c, d, e) {
        return '\t\t\t<p class="_no-item">' + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "商品はまだありません", {
            name: "t",
            hash: {},
            data: e
        })) + "</p>\n";
    },
    "9": function(a, b, c, d, e) {
        return '\t\t<ul class="pager"></ul>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = "function", k = a.escapeExpression;
        return '<div class="wrapper">\n\t<aside class="item-container">\n\t\t<h1 class="service-title">\n\t\t\t<a href="' + k((g = null != (g = c.url || (null != b ? b.url : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "url",
            hash: {},
            data: e
        }) : g)) + "?utm_source=pixiv&amp;utm_medium=promotion&amp;utm_content=" + k((g = null != (g = c.content || (null != b ? b.content : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "content",
            hash: {},
            data: e
        }) : g)) + '-logo&amp;utm_campaign=pixiv-promotion" target="_blank">\n\t\t\t\t<img src="' + k((c.prop || b && b.prop || i).call(h, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/booth/logo.png" alt="BOOTH" width="75" height="25">\n\t\t\t</a>\n\t\t</h1>\n' + (null != (f = c.if.call(h, null != b ? b.items : b, {
            name: "if",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.program(7, e, 0),
            data: e
        })) ? f : "") + "\t</aside>\n" + (null != (f = c.if.call(h, null != b ? b.items : b, {
            name: "if",
            hash: {},
            fn: a.program(9, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "</div>\n";
    },
    useData: !0
}), this.pixiv.templates["ranking-attr-filter-list-item"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " checked";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = a.escapeExpression, n = '<div class="_sub-menu-container">\n\t<ul class="sub-menu">\n\t\t<li><label class="menu-item"><input type="checkbox" name="lo"';
        return g = null != (g = c.lo || (null != b ? b.lo : b)) ? g : j, h = {
            name: "lo",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.lo || (f = l.call(b, f, h)), null != f && (n += f), 
        n += ">" + m((c.t || b && b.t || j).call(i, "未成年", {
            name: "t",
            hash: {},
            data: e
        })) + '</label></li>\n\t\t<li><label class="menu-item"><input type="checkbox" name="furry"', 
        g = null != (g = c.furry || (null != b ? b.furry : b)) ? g : j, h = {
            name: "furry",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.furry || (f = l.call(b, f, h)), null != f && (n += f), 
        n += ">" + m((c.t || b && b.t || j).call(i, "ケモノ", {
            name: "t",
            hash: {},
            data: e
        })) + '</label></li>\n\t\t<li><label class="menu-item"><input type="checkbox" name="bl"', 
        g = null != (g = c.bl || (null != b ? b.bl : b)) ? g : j, h = {
            name: "bl",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.bl || (f = l.call(b, f, h)), null != f && (n += f), 
        n += ">" + m((c.t || b && b.t || j).call(i, "男性同性愛", {
            name: "t",
            hash: {},
            data: e
        })) + '</label></li>\n\t\t<li><label class="menu-item"><input type="checkbox" name="yuri"', 
        g = null != (g = c.yuri || (null != b ? b.yuri : b)) ? g : j, h = {
            name: "yuri",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.yuri || (f = l.call(b, f, h)), null != f && (n += f), 
        n + ">" + m((c.t || b && b.t || j).call(i, "女性同性愛", {
            name: "t",
            hash: {},
            data: e
        })) + "</label></li>\n\t</ul>\n</div>\n";
    },
    useData: !0
}), this.pixiv.templates["ranking-info-modal"] = Handlebars.template({
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression, k = "function";
        return '<div class="info-modal">\n\t<dl class="inline-list">\n\t\t<dt>' + j((c.t || b && b.t || i).call(h, "投稿日時", {
            name: "t",
            hash: {},
            data: e
        })) + "</dt>\n\t\t<dd>" + j((g = null != (g = c.date || (null != b ? b.date : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "date",
            hash: {},
            data: e
        }) : g)) + '</dd>\n\t</dl>\n\t<dl class="inline-list slash-separated">\n\t\t<dt>' + j((c.t || b && b.t || i).call(h, "閲覧数", {
            name: "t",
            hash: {},
            data: e
        })) + "</dt>\n\t\t<dd>" + j((g = null != (g = c.viewCount || (null != b ? b.viewCount : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "viewCount",
            hash: {},
            data: e
        }) : g)) + "</dd>\n\t\t<dt>" + j((c.t || b && b.t || i).call(h, "総合点", {
            name: "t",
            hash: {},
            data: e
        })) + "</dt>\n\t\t<dd>" + j((g = null != (g = c.totalScore || (null != b ? b.totalScore : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "totalScore",
            hash: {},
            data: e
        }) : g)) + '</dd>\n\t</dl>\n\t<div>\n\t\t<textarea class="ui-select-all">' + (null != (g = null != (g = c.text || (null != b ? b.text : b)) ? g : i, 
        f = typeof g === k ? g.call(h, {
            name: "text",
            hash: {},
            data: e
        }) : g) ? f : "") + " " + (null != (g = null != (g = c.url || (null != b ? b.url : b)) ? g : i, 
        f = typeof g === k ? g.call(h, {
            name: "url",
            hash: {},
            data: e
        }) : g) ? f : "") + '</textarea>\n\t</div>\n\t<ul class="share-buttons">\n\t\t<li class="twitter">\n\t\t\t<a href="https://twitter.com/share" class="twitter-share-button" data-url="' + j((g = null != (g = c.url || (null != b ? b.url : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "url",
            hash: {},
            data: e
        }) : g)) + '" data-text="' + j((g = null != (g = c.text || (null != b ? b.text : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "text",
            hash: {},
            data: e
        }) : g)) + " " + j((g = null != (g = c.hashtag || (null != b ? b.hashtag : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "hashtag",
            hash: {},
            data: e
        }) : g)) + '" data-count="none"></a>\n\t\t</li>\n\t\t<li class="facebook">\n\t\t\t<div class="fb-like" data-href="' + j((g = null != (g = c.url || (null != b ? b.url : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "url",
            hash: {},
            data: e
        }) : g)) + '" data-layout="button_count" data-send="false"></div>\n\t\t</li>\n\t</ul>\n</div>\n';
    },
    useData: !0
}), this.pixiv.templates["reply-to"] = Handlebars.template({
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing;
        return '<div class="_reply-to">\n\t' + (null != (f = (c.t || b && b.t || h).call(g, '<span class="user">$1</span>さんに返信', null != b ? b.userName : b, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + '\n\t<span class="action-cancel-reply _ui-tooltip" data-tooltip="' + a.escapeExpression((c.t || b && b.t || h).call(g, "返信を止める", {
            name: "t",
            hash: {},
            data: e
        })) + '"></span>\n</div>\n';
    },
    useData: !0
}), this.pixiv.templates["search-keyword-li"] = Handlebars.template({
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '<li data-keyword="' + j((f = null != (f = c.keyword || (null != b ? b.keyword : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "keyword",
            hash: {},
            data: e
        }) : f)) + '">\n\t<span class="text">' + j((f = null != (f = c.text || (null != b ? b.text : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "text",
            hash: {},
            data: e
        }) : f)) + '</span>\n\t<span class="close"><i class="_pico-12 _icon-remove"></i></span>\n</li>\n';
    },
    useData: !0
}), this.pixiv.templates["showcase-modal-preview"] = Handlebars.template({
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '<a href="/member_illust.php?mode=medium&amp;illust_id=' + j((f = null != (f = c.illust_id || (null != b ? b.illust_id : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "illust_id",
            hash: {},
            data: e
        }) : f)) + '">\n\t<img src="' + j((f = null != (f = c.url || (null != b ? b.url : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "url",
            hash: {},
            data: e
        }) : f)) + '" class="_ui-tooltip" data-tooltip="' + j((f = null != (f = c.illust_title || (null != b ? b.illust_title : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "illust_title",
            hash: {},
            data: e
        }) : f)) + '">\n</a>\n';
    },
    useData: !0
}), this.pixiv.templates["showcase-modal"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f;
        return '\t\t\t\t\t<div class="error">' + a.escapeExpression((f = null != (f = c.error_point || (null != b ? b.error_point : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "error_point",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t\t\t\t\t\t<div class="error">' + a.escapeExpression((f = null != (f = c.error_date || (null != b ? b.error_date : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "error_date",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t\t\t\t\t\t\t<div class="error">' + a.escapeExpression((f = null != (f = c.error_tags || (null != b ? b.error_tags : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "error_tags",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = "function", k = a.escapeExpression;
        return '<section class="showcase-set ui-modal-close" id="showcase-' + k((g = null != (g = c.id || (null != b ? b.id : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "id",
            hash: {},
            data: e
        }) : g)) + '">\n\t<div class="container">\n\t\t<div class="close ui-modal-close"></div>\n\n\t\t<div class="content">\n\t\t\t<h1>' + k((c.t || b && b.t || i).call(h, "ショーケースを設定", {
            name: "t",
            hash: {},
            data: e
        })) + '</h1>\n\t\t\t<form action="/setting_showcase.php" method="POST">\n\t\t\t\t<input type="hidden" name="type" value="1">\n\t\t\t\t<input type="hidden" name="action" value="add">\n\n' + (null != (f = c.if.call(h, null != b ? b.error_point : b, {
            name: "if",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '\t\t\t\t<div class="input-container">\n\t\t\t\t\t<dl>\n\t\t\t\t\t\t<dt>' + k((c.t || b && b.t || i).call(h, "作品ID", {
            name: "t",
            hash: {},
            data: e
        })) + '</dt>\n\t\t\t\t\t\t<dd class="illust-id-container">\n\t\t\t\t\t\t\t<input type="text" class="illust-id" name="illustid" value="' + k((g = null != (g = c.form_illust_id || (null != b ? b.form_illust_id : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "form_illust_id",
            hash: {},
            data: e
        }) : g)) + '" placeholder="' + k((c.t || b && b.t || i).call(h, "作品ID、またはURLを入力", {
            name: "t",
            hash: {},
            data: e
        })) + '"><span class="loading"></span>\n\t\t\t\t\t\t\t<div class="error">' + k((g = null != (g = c.error_illust_id || (null != b ? b.error_illust_id : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "error_illust_id",
            hash: {},
            data: e
        }) : g)) + "</div>\n\t\t\t\t\t\t</dd>\n\n\t\t\t\t\t\t<dt>" + k((c.t || b && b.t || i).call(h, "期間", {
            name: "t",
            hash: {},
            data: e
        })) + '</dt>\n\t\t\t\t\t\t<dd class="date-container">\n\t\t\t\t\t\t\t<input type="text" class="date ui-modal-trigger" name="start_date" value="' + k((g = null != (g = c.form_start_date || (null != b ? b.form_start_date : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "form_start_date",
            hash: {},
            data: e
        }) : g)) + '" placeholder="' + k((c.t || b && b.t || i).call(h, "開始日", {
            name: "t",
            hash: {},
            data: e
        })) + '" readonly>\n\t\t\t\t\t\t\t&nbsp;〜&nbsp;\n\t\t\t\t\t\t\t<input type="text" class="date ui-modal-trigger" name="finish_date" value="' + k((g = null != (g = c.form_finish_date || (null != b ? b.form_finish_date : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "form_finish_date",
            hash: {},
            data: e
        }) : g)) + '" placeholder="' + k((c.t || b && b.t || i).call(h, "終了日", {
            name: "t",
            hash: {},
            data: e
        })) + '" readonly>\n' + (null != (f = c.if.call(h, null != b ? b.error_date : b, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\t\t\t\t\t\t</dd>\n\n\t\t\t\t\t\t<dt>" + k((c.t || b && b.t || i).call(h, "タグ", {
            name: "t",
            hash: {},
            data: e
        })) + '</dt>\n\t\t\t\t\t\t<dd class="tags-container">\n\t\t\t\t\t\t\t<input type="text" class="ui-tag" name="tags" value="' + k((g = null != (g = c.form_tags || (null != b ? b.form_tags : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "form_tags",
            hash: {},
            data: e
        }) : g)) + '">\n' + (null != (f = c.if.call(h, null != b ? b.error_tags : b, {
            name: "if",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '\t\t\t\t\t\t</dd>\n\t\t\t\t\t\t<div class="supplementary">\n\t\t\t\t\t\t\t<ul>\n\t\t\t\t\t\t\t\t<li>' + (null != (f = (c.t || b && b.t || i).call(h, "pixivポイントは、<strong>1タグ1日100pp</strong>から設定が可能です", {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "</li>\n\t\t\t\t\t\t\t\t<li>" + (null != (f = (c.t || b && b.t || i).call(h, "設定できる掲載期間は、<strong>翌日の0時から1日毎</strong>になります", {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "</li>\n\t\t\t\t\t\t\t\t<li>" + (null != (f = (c.t || b && b.t || i).call(h, "掲載開始30分前になると、掲載準備中になります", {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "</li>\n\t\t\t\t\t\t\t\t<li>" + (null != (f = (c.t || b && b.t || i).call(h, "使用したpixivポイントは、掲載準備中以降は払い戻されません", {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + '</li>\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</dl>\n\t\t\t\t</div>\n\n\t\t\t\t<div class="point-container">\n\t\t\t\t\t<div class="preview no-item">?</div>\n\t\t\t\t\t<dl>\n\t\t\t\t\t\t<dt>' + k((c.t || b && b.t || i).call(h, "所持ポイント", {
            name: "t",
            hash: {},
            data: e
        })) + "</dt>\n\t\t\t\t\t\t<dd>" + k((c.format || b && b.format || i).call(h, null != b ? b.total_point : b, {
            name: "format",
            hash: {},
            data: e
        })) + ' <span class="unit" title="' + k((c.t || b && b.t || i).call(h, "pixivポイント", {
            name: "t",
            hash: {},
            data: e
        })) + '">pp</span></dd>\n\t\t\t\t\t\t<dt>' + k((c.t || b && b.t || i).call(h, "使用ポイント", {
            name: "t",
            hash: {},
            data: e
        })) + '</dt>\n\t\t\t\t\t\t<dd><span class="point"></span> <span class="unit" title="' + k((c.t || b && b.t || i).call(h, "pixivポイント", {
            name: "t",
            hash: {},
            data: e
        })) + '">pp</span></dd>\n\t\t\t\t\t</dl>\n\t\t\t\t\t<p><a href="/help.php#11-1">' + k((c.t || b && b.t || i).call(h, "pixivポイントについて", {
            name: "t",
            hash: {},
            data: e
        })) + '</a></p>\n\t\t\t\t</div>\n\t\t\t\t<div class="submit"><input type="submit" value="' + k((c.t || b && b.t || i).call(h, "この内容で設定する", {
            name: "t",
            hash: {},
            data: e
        })) + '"></div>\n\t\t\t</form>\n\t\t</div>\n\t</div>\n</section>\n';
    },
    useData: !0
}), this.pixiv.templates["stamp-tab-content"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = '\t<ul class="sticker-list ui-tab-content _lazy-image-container sticker-' + a.escapeExpression((g = null != (g = c.index || e && e.index) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "index",
            hash: {},
            data: e
        }) : g)) + '">\n';
        return g = null != (g = c.stamps || (null != b ? b.stamps : b)) ? g : j, h = {
            name: "stamps",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.stamps || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (l += f), l + "\t</ul>\n";
    },
    "2": function(a, b, c, d, e) {
        var f = a.escapeExpression, g = null != b ? b : {}, h = c.helperMissing;
        return '\t<li class="sticker" data-id="' + f(a.lambda(b, b)) + '"><img src="' + f((c.prop || b && b.prop || h).call(g, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/common/transparent.gif" width="70" height="70" class="_lazy-image" data-src="' + f((c.prop || b && b.prop || h).call(g, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + "/images/stamp/stamps/" + f((c.url_encode || b && b.url_encode || h).call(g, b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '_s.jpg"></li>\n';
    },
    "4": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression;
        return '\t\t<li class="ui-tab' + (null != (f = (c.is || b && b.is || i).call(h, e && e.index, "==", 0, {
            name: "is",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '" data-target="sticker-' + j((g = null != (g = c.index || e && e.index) ? g : i, 
        "function" == typeof g ? g.call(h, {
            name: "index",
            hash: {},
            data: e
        }) : g)) + '"><img src="' + j((c.prop || b && b.prop || i).call(h, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + "images/stamp/main/" + j((c.url_encode || b && b.url_encode || i).call(h, null != b ? b.slug : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '.png" width="24" height="24"></li>\n';
    },
    "5": function(a, b, c, d, e) {
        return " default";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g = null != b ? b : {};
        return "\n" + (null != (f = c.each.call(g, null != b ? b.stamp_series : b, {
            name: "each",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '\n<ul class="sticker-type-list ui-tabs">\n' + (null != (f = c.each.call(g, null != b ? b.stamp_series : b, {
            name: "each",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '</ul>\n<div class="disabler"><div class="bar"></div></div>\n';
    },
    useData: !0
}), this.pixiv.templates["status-item"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '\t<a href="' + j((f = null != (f = c.link || (null != b ? b.link : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "link",
            hash: {},
            data: e
        }) : f)) + '" class="status-item ' + j((f = null != (f = c.type || (null != b ? b.type : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "type",
            hash: {},
            data: e
        }) : f)) + '">' + j((c.t || b && b.t || h).call(g, null != b ? b.text : b, {
            name: "t",
            hash: {},
            data: e
        })) + "</a>\n";
    },
    "3": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return '\t<span class="status-item ' + i((f = null != (f = c.type || (null != b ? b.type : b)) ? f : h, 
        "function" == typeof f ? f.call(g, {
            name: "type",
            hash: {},
            data: e
        }) : f)) + '">' + i((c.t || b && b.t || h).call(g, null != b ? b.text : b, {
            name: "t",
            hash: {},
            data: e
        })) + "</span>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != b ? b.link : b, {
            name: "if",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.program(3, e, 0),
            data: e
        })) ? f : "";
    },
    useData: !0
}), this.pixiv.templates["tag-items"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = '\t<li>\n\t\t<span class="tag c' + (null != (f = c.if.call(i, null != b ? b.cloud : b, {
            name: "if",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.program(4, e, 0),
            data: e
        })) ? f : "") + '" data-tag="' + l((g = null != (g = c.name || (null != b ? b.name : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "name",
            hash: {},
            data: e
        }) : g)) + '">\n\t\t\t';
        return g = null != (g = c.self || (null != b ? b.self : b)) ? g : j, h = {
            name: "self",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.self || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (m += f), m + "\n\t\t\t" + l((g = null != (g = c.name || (null != b ? b.name : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "name",
            hash: {},
            data: e
        }) : g)) + "\n\t\t</span>\n\t</li>\n";
    },
    "2": function(a, b, c, d, e) {
        var f;
        return a.escapeExpression((f = null != (f = c.cloud || (null != b ? b.cloud : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "cloud",
            hash: {},
            data: e
        }) : f));
    },
    "4": function(a, b, c, d, e) {
        return "6";
    },
    "6": function(a, b, c, d, e) {
        return '<span class="self-tag">*</span>';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.tags || (null != b ? b.tags : b)) ? g : c.helperMissing, 
        h = {
            name: "tags",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.tags || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    useData: !0
}), this.pixiv.templates["tag-order"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return '\t<li class="_clickable current" data-type="name">' + i((c.t || b && b.t || h).call(g, "名前順", {
            name: "t",
            hash: {},
            data: e
        })) + (null != (f = (c.eq || b && b.eq || h).call(g, null != b ? b.order : b, "desc", {
            name: "eq",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.program(4, e, 0),
            data: e
        })) ? f : "") + '</li>\n\t<li class="_clickable" data-type="count">' + i((c.t || b && b.t || h).call(g, "件数順", {
            name: "t",
            hash: {},
            data: e
        })) + "</li>\n";
    },
    "2": function(a, b, c, d, e) {
        return "↓";
    },
    "4": function(a, b, c, d, e) {
        return "↑";
    },
    "6": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return '\t<li class="_clickable" data-type="name">' + i((c.t || b && b.t || h).call(g, "名前順", {
            name: "t",
            hash: {},
            data: e
        })) + '</li>\n\t<li class="_clickable current" data-type="count">' + i((c.t || b && b.t || h).call(g, "件数順", {
            name: "t",
            hash: {},
            data: e
        })) + (null != (f = (c.eq || b && b.eq || h).call(g, null != b ? b.order : b, "desc", {
            name: "eq",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.program(4, e, 0),
            data: e
        })) ? f : "") + "</li>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f;
        return null != (f = (c.eq || b && b.eq || c.helperMissing).call(null != b ? b : {}, null != b ? b.type : b, "name", {
            name: "eq",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.program(6, e, 0),
            data: e
        })) ? f : "";
    },
    useData: !0
}), this.pixiv.templates["ugoku-illust-file-items"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = a.escapeExpression, n = '<li class="item';
        return g = null != (g = c.fail_type || (null != b ? b.fail_type : b)) ? g : j, h = {
            name: "fail_type",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.fail_type || (f = l.call(b, f, h)), 
        null != f && (n += f), g = null != (g = c.fail_size || (null != b ? b.fail_size : b)) ? g : j, 
        h = {
            name: "fail_size",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.fail_size || (f = l.call(b, f, h)), 
        null != f && (n += f), g = null != (g = c.fail_file_size || (null != b ? b.fail_file_size : b)) ? g : j, 
        h = {
            name: "fail_file_size",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.fail_file_size || (f = l.call(b, f, h)), 
        null != f && (n += f), n + '">\n\t<div class="file-name">' + m(a.lambda(null != (f = null != b ? b.file : b) ? f.name : f, b)) + '</div>\n\t<div class="frame">\n\t\t<img src="' + m((g = null != (g = c.image || (null != b ? b.image : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "image",
            hash: {},
            data: e
        }) : g)) + '" width="150">\n\t\t<div class="file-size"><span class="value">' + m((g = null != (g = c.file_size_text || (null != b ? b.file_size_text : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "file_size_text",
            hash: {},
            data: e
        }) : g)) + '</span></div>\n\t\t<div class="delay open-delay-modal ui-modal-trigger _ui-tooltip" data-tooltip="' + m((c.t || b && b.t || j).call(i, "フレームの時間を変更", {
            name: "t",
            hash: {},
            data: e
        })) + '"><span class="value">' + m((g = null != (g = c.delay_text || (null != b ? b.delay_text : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "delay_text",
            hash: {},
            data: e
        }) : g)) + "</span></div>\n\t</div>\n</li>\n";
    },
    "2": function(a, b, c, d, e) {
        return " fail-type";
    },
    "4": function(a, b, c, d, e) {
        return " fail-size";
    },
    "6": function(a, b, c, d, e) {
        return " fail-file-size";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    useData: !0
}), this.pixiv.templates["ugoku-illust-upload-modal"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "完了", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    "3": function(a, b, c, d, e) {
        return a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "情報入力へ", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = a.escapeExpression;
        return '<div class="_ugoku-illust-upload-modal _user-input-modal">\n\t<section class="content">\n\t\t<header class="header">\n\t\t\t<div class="wrapper">\n\t\t\t\t<h1 class="title">' + i((c.t || b && b.t || h).call(g, "フレーム編集", {
            name: "t",
            hash: {},
            data: e
        })) + '</h1>\n\t\t\t\t<button class="_action-button next upload" disabled>\n\t\t\t\t\t' + (null != (f = c.if.call(g, null != b ? b.re_upload : b, {
            name: "if",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.program(3, e, 0),
            data: e
        })) ? f : "") + '\n\t\t\t\t</button>\n\t\t\t\t<span>\n\t\t\t\t\t<button class="back close _action-button">' + i((c.t || b && b.t || h).call(g, "戻る", {
            name: "t",
            hash: {},
            data: e
        })) + '</button>\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</header>\n\n\t\t<div class="preview-container">\n\t\t\t<div class="_ugoku-illust-player-container">\n\t\t\t\t<div class="wrapper">\n\t\t\t\t\t<div class="player toggle"></div>\n\t\t\t\t\t<progress class="preview-progress"></progress>\n\t\t\t\t\t<div class="controls">\n\t\t\t\t\t\t<span class="control-item play">\n\t\t\t\t\t\t\t<img src="' + i((c.prop || b && b.prop || h).call(g, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/ugoku-illust/play.png" width="26" height="26">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class="control-item pause">\n\t\t\t\t\t\t\t<img src="' + i((c.prop || b && b.prop || h).call(g, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/ugoku-illust/pause.png" width="26" height="26">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="error-container">\n\t\t\t<ul class="error-items">\n\t\t\t\t<li class="error-fail-length">' + i((c.t || b && b.t || h).call(g, "うごくイラストの作成には2フレーム以上の画像が必要です", {
            name: "t",
            hash: {},
            data: e
        })) + '</li>\n\t\t\t\t<li class="error-fail-type">' + i((c.t || b && b.t || h).call(g, "すべてのフレームの画像フォーマットを統一してください", {
            name: "t",
            hash: {},
            data: e
        })) + '</li>\n\t\t\t\t<li class="error-fail-size">' + i((c.t || b && b.t || h).call(g, "すべてのフレームの画像サイズを統一してください", {
            name: "t",
            hash: {},
            data: e
        })) + '</li>\n\t\t\t\t<li class="error-fail-file-size">' + i((c.t || b && b.t || h).call(g, "各フレームのファイルサイズは最大8MBです", {
            name: "t",
            hash: {},
            data: e
        })) + '</li>\n\t\t\t\t<li class="error-fail-file-size-total">' + i((c.t || b && b.t || h).call(g, "すべてのフレームの合計ファイルサイズは最大30MBです", {
            name: "t",
            hash: {},
            data: e
        })) + '</li>\n\t\t\t</ul>\n\t\t</div>\n\n\t\t<div class="manage-container">\n\t\t\t<div class="actions">\n\t\t\t\t<button class="_action-button add-item _ui-tooltip" data-tooltip="' + i((c.t || b && b.t || h).call(g, "150枚まで追加できます", {
            name: "t",
            hash: {},
            data: e
        })) + '">\n\t\t\t\t\t<i class="_icon sprites-button-add"></i>\n\t\t\t\t</button>\n\t\t\t</div>\n\n\t\t\t<div class="status-container">\n\t\t\t\t<ul class="status">\n\t\t\t\t\t<li class="status-item total-frames"><span class="value">0</span> フレーム</li>\n\t\t\t\t\t<li class="status-item resolution">0 x 0</li>\n\t\t\t\t\t<li class="status-item total-bytes">0 B</li>\n\t\t\t\t\t<li class="status-item total-delay">00:000</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\n\t\t\t<div class="context-actions">\n\t\t\t\t<button class="_control-button select-all">' + i((c.t || b && b.t || h).call(g, "すべて選択", {
            name: "t",
            hash: {},
            data: e
        })) + '</button>\n\t\t\t\t<button class="_control-button select-none">' + i((c.t || b && b.t || h).call(g, "選択解除", {
            name: "t",
            hash: {},
            data: e
        })) + '</button>\n\t\t\t\t<span class="new-context">\n\t\t\t\t\t<button class="_action-button open-delay-modal ui-modal-trigger" disabled>' + i((c.t || b && b.t || h).call(g, "フレームの時間を変更", {
            name: "t",
            hash: {},
            data: e
        })) + '</button>\n\t\t\t\t\t<button class="_action-button remove" disabled>' + i((c.t || b && b.t || h).call(g, "削除", {
            name: "t",
            hash: {},
            data: e
        })) + '</button>\n\t\t\t\t</span>\n\t\t\t</div>\n\n\t\t\t<ul class="items"></ul>\n\t\t</div>\n\t</section>\n</div>\n';
    },
    useData: !0
}), this.pixiv.templates["ui-tag-item"] = Handlebars.template({
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '<li data-tag="' + j((f = null != (f = c.tag || (null != b ? b.tag : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "tag",
            hash: {},
            data: e
        }) : f)) + '" class="close">\n\t<i class="_icon-14 _icon-tag"></i>\n\t<span class="_icon-text">' + j((f = null != (f = c.tag || (null != b ? b.tag : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "tag",
            hash: {},
            data: e
        }) : f)) + "</span>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["ui-tag"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f = a.lambda, g = a.escapeExpression;
        return '\t\t\t<li data-tag="' + g(f(b, b)) + '" class="close">\n\t\t\t\t<i class="_icon-14 _icon-tag"></i>\n\t\t\t\t<span class="_icon-text">' + g(f(b, b)) + "</span>\n\t\t\t</li>\n";
    },
    "3": function(a, b, c, d, e) {
        return " over";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = '<div class="ui-tag-container">\n\t<ul class="tags">\n';
        return g = null != (g = c.tags || (null != b ? b.tags : b)) ? g : j, h = {
            name: "tags",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.tags || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (m += f), m + '\t</ul>\n\t<input type="text" value="" placeholder="' + l((c.t || b && b.t || j).call(i, "タグ", {
            name: "t",
            hash: {},
            data: e
        })) + '" maxlength="30">\n\t<div class="options _count-container">\n\t\t<span class="count' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.tags : b) ? f.length : f, ">", null != b ? b.max : b, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '">' + l(a.lambda(null != (f = null != b ? b.tags : b) ? f.length : f, b)) + "</span>/" + l((g = null != (g = c.max || (null != b ? b.max : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "max",
            hash: {},
            data: e
        }) : g)) + "\n\t</div>\n</div>\n";
    },
    useData: !0
}), this.pixiv.templates["uploader-image-response-item"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f;
        return 'data-type="illust" data-id="' + a.escapeExpression(a.lambda(null != (f = null != b ? b.illust : b) ? f.illust_id : f, b)) + '"';
    },
    "3": function(a, b, c, d, e) {
        var f;
        return 'data-type="novel" data-id="' + a.escapeExpression(a.lambda(null != (f = null != b ? b.novel : b) ? f.id : f, b)) + '"';
    },
    "5": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + j((f = null != (f = c.illust_id || (null != b ? b.illust_id : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "illust_id",
            hash: {},
            data: e
        }) : f)) + '" target="_blank">\n\t\t\t<img src="' + j((f = null != (f = c.url || (null != b ? b.url : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "url",
            hash: {},
            data: e
        }) : f)) + '" width="150" class="_ui-tooltip" data-tooltip="' + j((f = null != (f = c.illust_title || (null != b ? b.illust_title : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "illust_title",
            hash: {},
            data: e
        }) : f)) + '">\n\t\t</a>\n\t\t<input type="hidden" name="response[]" value="' + j((f = null != (f = c.href || (null != b ? b.href : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "href",
            hash: {},
            data: e
        }) : f)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f, g = null != b ? b : {}, h = c.helperMissing, i = "function", j = a.escapeExpression;
        return '\t\t<a href="/novel/show.php?id=' + j((f = null != (f = c.id || (null != b ? b.id : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "id",
            hash: {},
            data: e
        }) : f)) + '" target="_blank">\n\t\t\t<img src="' + j((f = null != (f = c.url || (null != b ? b.url : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "url",
            hash: {},
            data: e
        }) : f)) + '" width="150" class="_ui-tooltip" data-tooltip="' + j((f = null != (f = c.title || (null != b ? b.title : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "title",
            hash: {},
            data: e
        }) : f)) + '">\n\t\t</a>\n\t\t<input type="hidden" name="response[]" value="' + j((f = null != (f = c.href || (null != b ? b.href : b)) ? f : h, 
        typeof f === i ? f.call(g, {
            name: "href",
            hash: {},
            data: e
        }) : f)) + '">\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = '<li class="image-response-item" ' + (null != (f = c.if.call(i, null != b ? b.illust : b, {
            name: "if",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.program(3, e, 0),
            data: e
        })) ? f : "") + ">\n";
        return g = null != (g = c.illust || (null != b ? b.illust : b)) ? g : j, h = {
            name: "illust",
            hash: {},
            fn: a.program(5, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.illust || (f = l.call(b, f, h)), null != f && (m += f), 
        g = null != (g = c.novel || (null != b ? b.novel : b)) ? g : j, h = {
            name: "novel",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.novel || (f = l.call(b, f, h)), null != f && (m += f), 
        m + '\t<div class="remove action-remove-image-response">\n\t\t<i class="_icon-12 _icon-close"></i>\n\t</div>\n</li>\n';
    },
    useData: !0
}), this.pixiv.templates["uploader-image-response-preview-items"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = "function", k = a.escapeExpression;
        return '\t<li class="image-response-preview-item">\n\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + k((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '" target="_blank">\n\t\t\t<div class="thumbnail" style="background-image:url(' + k((g = null != (g = c.url || (null != b ? b.url : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "url",
            hash: {},
            data: e
        }) : g)) + ')"></div>\n\t\t\t' + k((g = null != (g = c.illust_title || (null != b ? b.illust_title : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "illust_title",
            hash: {},
            data: e
        }) : g)) + '\n\t\t</a>\n\t\t<div class="options _action-button ' + (null != (f = c.if.call(h, null != b ? b.exists : b, {
            name: "if",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.program(4, e, 0),
            data: e
        })) ? f : "") + '" data-type="illust" data-id="' + k((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + '">' + k((c.t || b && b.t || i).call(h, "追加", {
            name: "t",
            hash: {},
            data: e
        })) + "</div>\n\t</li>\n";
    },
    "2": function(a, b, c, d, e) {
        return "_disabled";
    },
    "4": function(a, b, c, d, e) {
        return "action-add-image-response";
    },
    "6": function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = "function", k = a.escapeExpression;
        return '\t<li class="image-response-preview-item">\n\t\t<a href="/novel/show.php?id=' + k((g = null != (g = c.id || (null != b ? b.id : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "id",
            hash: {},
            data: e
        }) : g)) + '" target="_blank">\n\t\t\t<div class="thumbnail" style="background-image:url(' + k((g = null != (g = c.url || (null != b ? b.url : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "url",
            hash: {},
            data: e
        }) : g)) + ')"></div>\n\t\t\t' + k((g = null != (g = c.title || (null != b ? b.title : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "title",
            hash: {},
            data: e
        }) : g)) + '\n\t\t</a>\n\t\t<div class="options _action-button  ' + (null != (f = c.if.call(h, null != b ? b.exists : b, {
            name: "if",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.program(4, e, 0),
            data: e
        })) ? f : "") + '" data-type="novel" data-id="' + k((g = null != (g = c.id || (null != b ? b.id : b)) ? g : i, 
        typeof g === j ? g.call(h, {
            name: "id",
            hash: {},
            data: e
        }) : g)) + '">' + k((c.t || b && b.t || i).call(h, "追加", {
            name: "t",
            hash: {},
            data: e
        })) + "</div>\n\t</li>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = c.blockHelperMissing, m = "";
        return g = null != (g = c.illust || (null != b ? b.illust : b)) ? g : j, h = {
            name: "illust",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.illust || (f = l.call(b, f, h)), null != f && (m += f), 
        g = null != (g = c.novel || (null != b ? b.novel : b)) ? g : j, h = {
            name: "novel",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.novel || (f = l.call(b, f, h)), null != f && (m += f), 
        m;
    },
    useData: !0
}), this.pixiv.templates["user-list-items"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '\t<li class="user-recommendation-item' + (null != (f = c.if.call(i, (f = e && e.root) && f.relatedUser, {
            name: "if",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '" data-id="' + l((g = null != (g = c.user_id || (null != b ? b.user_id : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "user_id",
            hash: {},
            data: e
        }) : g)) + '">\n' + (null != (f = c.if.call(i, (f = e && e.root) && f.relatedUser, {
            name: "if",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '\t\t<a href="/member.php?id=' + l((g = null != (g = c.user_id || (null != b ? b.user_id : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "user_id",
            hash: {},
            data: e
        }) : g)) + '" target="_blank" class="user-icon-container ui-scroll-view" data-src="' + l((g = null != (g = c.profile_img || (null != b ? b.profile_img : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "profile_img",
            hash: {},
            data: e
        }) : g)) + '" data-filter="lazy-image"></a>\n\t\t<h1><a href="/member.php?id=' + l((g = null != (g = c.user_id || (null != b ? b.user_id : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "user_id",
            hash: {},
            data: e
        }) : g)) + '" target="_blank" class="title">' + l((g = null != (g = c.user_name || (null != b ? b.user_name : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "user_name",
            hash: {},
            data: e
        }) : g)) + '</a></h1>\n\t\t<dl class="meta inline-list">\n\t\t\t<dt>' + l((c.t || b && b.t || j).call(i, "イラスト投稿数", {
            name: "t",
            hash: {},
            data: e
        })) + '</dt>\n\t\t\t<dd><a href="/member_illust.php?id=' + l((g = null != (g = c.user_id || (null != b ? b.user_id : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "user_id",
            hash: {},
            data: e
        }) : g)) + (null != (f = c.if.call(i, (f = e && e.root) && f.word, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '" target="_blank">' + l((g = null != (g = c.illust_count || (null != b ? b.illust_count : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "illust_count",
            hash: {},
            data: e
        }) : g)) + '</a></dd>\n\t\t</dl>\n\t\t<p class="caption">' + l((c.truncate || b && b.truncate || j).call(i, null != b ? b.user_comment : b, 36, {
            name: "truncate",
            hash: {},
            data: e
        })) + '</p>\n\n\t\t<div class="_follow-button-container';
        return g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, h = {
            name: "is_follow",
            hash: {},
            fn: a.program(8, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = m.call(b, f, h)), 
        null != f && (n += f), n += '">\n\t\t\t<button class="follow-button">\n\t\t\t\t', 
        g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, h = {
            name: "is_follow",
            hash: {},
            fn: a.program(10, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = m.call(b, f, h)), 
        null != f && (n += f), n += "\n\t\t\t\t", g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, 
        h = {
            name: "is_follow",
            hash: {},
            fn: a.noop,
            inverse: a.program(12, e, 0),
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = m.call(b, f, h)), 
        null != f && (n += f), n += '\n\t\t\t</button>\n\t\t\t<span class="follow-more-button-container">\n\t\t\t\t<button class="follow-more-button">\n\t\t\t\t\t<i class="_icon sprites-more"></i>\n\t\t\t\t</button>\n\t\t\t\t<div class="options-wrapper">\n\t\t\t\t\t<div class="options-container">\n\t\t\t\t\t\t<section class="option">\n' + (null != (f = c.if.call(i, (f = e && e.root) && f.premium, {
            name: "if",
            hash: {},
            fn: a.program(14, e, 0),
            inverse: a.program(16, e, 0),
            data: e
        })) ? f : "") + '\t\t\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t\t\t<label><input type="checkbox" name="restrict" value="1">' + l((c.t || b && b.t || j).call(i, "公開しない", {
            name: "t",
            hash: {},
            data: e
        })) + "</label>\n\t\t\t\t\t\t\t</div>\n", g = null != (g = c.is_follow || (null != b ? b.is_follow : b)) ? g : j, 
        h = {
            name: "is_follow",
            hash: {},
            fn: a.program(18, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.is_follow || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t\t\t\t\t\t</section>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t</div>\n\n" + (null != (f = c.if.call(i, null != b ? b.illusts : b, {
            name: "if",
            hash: {},
            fn: a.program(21, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\t</li>\n";
    },
    "2": function(a, b, c, d, e) {
        return " child";
    },
    "4": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="related-user">' + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "$1さんの関連ユーザー", (f = e && e.root) && f.relatedUser, {
            name: "t",
            hash: {},
            data: e
        })) + "</div>\n";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return "&amp;tag=" + a.escapeExpression(a.lambda((f = e && e.root) && f.word, b));
    },
    "8": function(a, b, c, d, e) {
        return " following2";
    },
    "10": function(a, b, c, d, e) {
        return a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "フォロー中", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    "12": function(a, b, c, d, e) {
        return a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "フォローする", {
            name: "t",
            hash: {},
            data: e
        }));
    },
    "14": function(a, b, c, d, e) {
        var f = null != b ? b : {}, g = c.helperMissing, h = a.escapeExpression;
        return '\t\t\t\t\t\t\t\t<div class="item">\n\t\t\t\t\t\t\t\t\t<select name="tag" disabled>\n\t\t\t\t\t\t\t\t\t\t<option value="">' + h((c.t || b && b.t || g).call(f, "フォルダー", {
            name: "t",
            hash: {},
            data: e
        })) + '</option>\n\t\t\t\t\t\t\t\t\t\t<option value="new">' + h((c.t || b && b.t || g).call(f, "新規フォルダー", {
            name: "t",
            hash: {},
            data: e
        })) + "</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t</div>\n";
    },
    "16": function(a, b, c, d, e) {
        var f = null != b ? b : {}, g = c.helperMissing, h = a.escapeExpression;
        return '\t\t \t\t\t\t\t\t<a href="/premium.php?ref=uarea=user_recommend" target="_blank" class="item premium-feature">\n\t\t\t\t\t\t\t\t\t<select name="tag" disabled>\n\t\t\t\t\t\t\t\t\t\t<option value="">' + h((c.t || b && b.t || g).call(f, "フォルダー", {
            name: "t",
            hash: {},
            data: e
        })) + '</option>\n\t\t\t\t\t\t\t\t\t</select>\n\t\t\t\t\t\t\t\t\t<i class="_icon sprites-premium"></i>\n\t\t\t\t\t\t\t\t\t<p class="_notes">' + h((c.t || b && b.t || g).call(f, "プレミアム会員になるとユーザーをフォルダーに分類できます", {
            name: "t",
            hash: {},
            data: e
        })) + "</p>\n\t\t\t\t\t\t\t\t</a>\n";
    },
    "18": function(a, b, c, d, e) {
        var f, g = null != b ? b : {};
        return '\t\t\t\t\t\t\t\t<div class="action">\n\t\t\t\t\t\t\t\t\t<span class="_button2 unfollow-button">' + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(g, "フォロー解除", {
            name: "t",
            hash: {},
            data: e
        })) + "</span>\n\t\t\t\t\t\t\t\t\t" + (null != (f = c.if.call(g, (f = e && e.root) && f.relatedUser, {
            name: "if",
            hash: {},
            fn: a.program(19, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + "\n\t\t\t\t\t\t\t\t</div>\n";
    },
    "19": function(a, b, c, d, e) {
        return '<span class="_button2 update-button">' + a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "更新", {
            name: "t",
            hash: {},
            data: e
        })) + "</span>";
    },
    "21": function(a, b, c, d, e) {
        var f, g, h, i = '\t\t\t<ul class="images">\n';
        return g = null != (g = c.illusts || (null != b ? b.illusts : b)) ? g : c.helperMissing, 
        h = {
            name: "illusts",
            hash: {},
            fn: a.program(22, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.illusts || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i + "\t\t\t</ul>\n";
    },
    "22": function(a, b, c, d, e) {
        var f, g, h = a.lambda, i = a.escapeExpression, j = null != b ? b : {}, k = c.helperMissing;
        return '\t\t\t\t\t<li class="action-open-thumbnail" data-src="' + i(h(null != (f = null != b ? b.url : b) ? f["480mw"] : f, b)) + '">\n\t\t\t\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + i((g = null != (g = c.illust_id || (null != b ? b.illust_id : b)) ? g : k, 
        "function" == typeof g ? g.call(j, {
            name: "illust_id",
            hash: {},
            data: e
        }) : g)) + "&amp;uarea=user_recommend" + (null != (f = c.if.call(j, (f = e && e.root) && f.word, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '" target="_blank" class="ui-scroll-view ' + i((c.get_thumbnail_classes || b && b.get_thumbnail_classes || k).call(j, null != b ? b.illust_id : b, null != b ? b.illust_type : b, null != b ? b.illust_page_count : b, null != b ? b.illust_book_style : b, {
            name: "get_thumbnail_classes",
            hash: {},
            data: e
        })) + '" data-src="' + i(h(null != (f = null != b ? b.url : b) ? f["128x128"] : f, b)) + '" data-filter="lazy-image">\n\t\t\t\t\t\t\t<span class="layout-effect"></span>\n\t\t\t\t\t\t</a>\n\t\t\t\t\t</li>\n';
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = "";
        return g = null != (g = c.items || (null != b ? b.items : b)) ? g : c.helperMissing, 
        h = {
            name: "items",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = "function" == typeof g ? g.call(null != b ? b : {}, h) : g, c.items || (f = c.blockHelperMissing.call(b, f, h)), 
        null != f && (i += f), i;
    },
    useData: !0
}), this.pixiv.templates["user-search-dummy"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f, g = a.lambda, h = a.escapeExpression;
        return '\t<li data-user_id="' + h(g(null != b ? b.user_id : b, b)) + '" data-illust_ids="' + h(g(null != b ? b.illusts : b, b)) + '" data-illust_count="' + h(g(null != b ? b.count : b, b)) + '" data-filter="user-search-loading" class="ui-scroll-view user-search-' + h(g(null != b ? b.user_id : b, b)) + " user-search-dummy" + (null != (f = c.if.call(null != b ? b : {}, (f = e && e.root) && f.user_name, {
            name: "if",
            hash: {},
            fn: a.program(2, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '"></li>\n';
    },
    "2": function(a, b, c, d, e) {
        return " user-search-related-user";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f;
        return null != (f = c.each.call(null != b ? b : {}, null != b ? b.users : b, {
            name: "each",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    useData: !0
}), this.pixiv.templates["web-notification-notification"] = Handlebars.template({
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        return a.escapeExpression((c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "$1件の更新があります", null != b ? b.count : b, {
            name: "t",
            hash: {},
            data: e
        })) + "\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-approve_friend"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="/mypixiv_all.php">\n\t\t<div class="image _user-icon" style="background-image:url(' + l(a.lambda(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんがあなたのマイピク申請を承認しました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-bookmarked"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/novel/bookmark_detail.php?id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/bookmark_detail.php?illust_id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.type : f, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image" style="background-image:url(' + l(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1人</span>以上のユーザーが<span>「$2」</span>をすき！しました。", null != (f = null != b ? b.details : b) ? f.count : f, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-booth_item"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.adult : f, {
            name: "if",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.program(6, e, 0),
            data: e
        })) ? f : "";
    },
    "4": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さんが<span>$2 [R-18]</span>と他<span>$3個</span>のアイテムをBOOTHで販売開始しました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さんが<span>$2</span>と他<span>$3個</span>のアイテムをBOOTHで販売開始しました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "8": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.adult : f, {
            name: "if",
            hash: {},
            fn: a.program(9, e, 0),
            inverse: a.program(11, e, 0),
            data: e
        })) ? f : "";
    },
    "9": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さんが<span>$2 [R-18]</span>をBOOTHで販売開始しました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "11": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さんが<span>$2</span>をBOOTHで販売開始しました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "13": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="' + l(n(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.items : f) ? f[0] : f) ? f.url : f, b)) + '?utm_source=pixiv&utm_medium=popboard&utm_campaign=popboard" target="_blank">\n\t\t<div class="image _user-icon" style="background-image:url(' + l(n(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.url : f, b)) + ')">\n\t\t</div>\n' + (null != (f = c.if.call(i, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(8, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(13, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-comic_book"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return "\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』と<span>他$3件</span>が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title1 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title2 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.program(9, e, 0),
            data: e
        })) ? f : "";
    },
    "7": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "9": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "11": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="https://comic.pixiv.net/my?ads=popbook#books" class="icon-comic-book" target="_blank">\n\t\t<div class="image" style="background-image:url(' + l((c.prop || b && b.prop || j).call(i, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'notification/comic.png?1)">\n\t\t</div>\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.details : b) ? f.other_count : f, ">", 0, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(11, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-comic_new"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return "\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』と<span>他$3件</span>が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title1 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title2 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.program(9, e, 0),
            data: e
        })) ? f : "";
    },
    "7": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "9": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "11": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="https://comic.pixiv.net/my?ads=popnew" class="icon-comic-new" target="_blank">\n\t\t<div class="image" style="background-image:url(' + l((c.prop || b && b.prop || j).call(i, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'notification/comic.png?1)">\n\t\t</div>\n\t\t' + l((c.t || b && b.t || j).call(i, "pixivコミックで", {
            name: "t",
            hash: {},
            data: e
        })) + "\n" + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.details : b) ? f.other_count : f, ">", 0, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(11, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-comment_replied"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f, g = a.lambda, h = a.escapeExpression;
        return '\t\t<a href="/novel/show.php?id=' + h(g(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.target_id : f, b)) + "&amp;comment_id=" + h(g(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.comment_id : f, b)) + '">\n';
    },
    "5": function(a, b, c, d, e) {
        var f, g = a.lambda, h = a.escapeExpression;
        return '\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + h(g(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.target_id : f, b)) + "&amp;comment_id=" + h(g(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.comment_id : f, b)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n' + (null != (f = c.if.call(i, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.is_novel : f, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image _user-icon" style="background-image:url(' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')"></div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんがあなたの<span>コメント</span>に返信しました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.user_name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "<br>\n\t\t<span>&gt; " + l((c.t || b && b.t || j).call(i, "$1さん", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.reply_to_user_name : f, {
            name: "t",
            hash: {},
            data: e
        })) + "</span> " + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.comment : f, b)) + "\n", 
        g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, h = {
            name: "date_time",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-commented"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/novel/show.php?id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/member_illust.php?mode=comment_chk&amp;illust_id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.type : f, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image" style="background-image:url(' + l(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1人</span>のユーザーが<span>「$2」</span>にコメントしました。", null != (f = null != b ? b.details : b) ? f.count : f, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-content_response"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.from : f) ? f.type : f, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(4, e, 0),
            inverse: a.program(6, e, 0),
            data: e
        })) ? f : "";
    },
    "4": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<a href="/novel/show.php?id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.from : f) ? f.id : f, b)) + '">\n';
    },
    "6": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.from : f) ? f.id : f, b)) + '">\n';
    },
    "8": function(a, b, c, d, e) {
        return '\t\t<a href="/response.php?mode=chk">\n';
    },
    "10": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n' + (null != (f = c.if.call(i, null != b ? b.response_approved : b, {
            name: "if",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(8, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image" style="background-image:url(' + l(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんから<span>「$2」</span>へのイメージレスポンスが届きました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.from : f) ? f.user : f) ? f.name : f, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(10, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-fanbox_entry_published"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/whitecube/user/' + l(n(null != (f = null != b ? b.details : b) ? f.user_id : f, b)) + "/fanbox/" + l(n(null != (f = null != b ? b.details : b) ? f.fanbox_entry_id : f, b)) + '">\n\t\t<div class="image">\n\t\t\t<img src="' + l(n(null != (f = null != b ? b.details : b) ? f.user_profile_image_s : f, b)) + '" alt="" width="48" height="48">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんが<span>「$2」</span>で記事を公開しました", null != (f = null != b ? b.details : b) ? f.user_name : f, null != (f = null != b ? b.details : b) ? f.fanbox_plan_title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-favorited"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return "\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さん、<span>$2</span>さんがあなたをフォローしました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[1] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.program(8, e, 0),
            data: e
        })) ? f : "";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$2</span>さんと他<span>$1人</span>のユーザーがあなたをフォローしました。", null != (f = null != b ? b.details : b) ? f.other_count : f, null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "8": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "<span>$1</span>さんがあなたをフォローしました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "10": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="/bookmark.php?type=reg_user">\n\t\t<div class="image _user-icon" style="background-image:url(' + l(a.lambda(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.url : f, b)) + ')">\n\t\t</div>\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.users : b) ? f.length : f, "==", 2, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(10, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-group_application"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/group/?id=' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n\t\t<div class="image" style="background-image:url(' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "グループ<span>「$1」</span>に<span>$2人</span>以上の参加申請があります。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-group_approve"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/group/?id=' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n\t\t<div class="image" style="background-image:url(' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "グループ<span>「$1」</span>の参加申請が承認されました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-group_comment"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/group/comment.php?id=' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n\t\t<div class="image" style="background-image:url(' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "グループ<span>「$1」</span>のあなたの投稿に<span>$2件</span>以上のコメントがありました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-group_content_reference"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/group/comment.php?id=' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n\t\t<div class="image" style="background-image:url(' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "グループ<span>「$1」</span>にあなたの作品が紹介されました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-group_like"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/group/comment.php?id=' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n\t\t<div class="image" style="background-image:url(' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "グループ<span>「$1」</span>のあなたの投稿に<span>$2人</span>以上が「いいね！」と言っています。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-message"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return "pair";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h = null != b ? b : {}, i = c.helperMissing, j = a.escapeExpression, k = "function";
        return '<li class="' + (null != (f = c.if.call(h, null != b ? b.is_pair : b, {
            name: "if",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "") + '">\n\t<a href="/messages.php?thread_id=' + j((c.url_encode || b && b.url_encode || i).call(h, null != b ? b.thread_id : b, {
            name: "url_encode",
            hash: {},
            data: e
        })) + '">\n\t\t<div class="image _user-icon" style="background-image:url(' + j(a.lambda(null != (f = null != b ? b.icon_url : b) ? f["100x100"] : f, b)) + ');"></div>\n\t\t<div class="message-date">' + j((g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "date_time",
            hash: {},
            data: e
        }) : g)) + '</div>\n\t\t<div class="message-title">' + j((g = null != (g = c.thread_name || (null != b ? b.thread_name : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "thread_name",
            hash: {},
            data: e
        }) : g)) + '</div>\n\t\t<div class="message-text">' + j((g = null != (g = c.latest_content || (null != b ? b.latest_content : b)) ? g : i, 
        typeof g === k ? g.call(h, {
            name: "latest_content",
            hash: {},
            data: e
        }) : g)) + "</div>\n\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-more"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/msgbox.php">\n\t\t\t' + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "他<span>$1件</span>以上の新着メッセージがあります。", null != b ? b.other_count : b, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n\t\t</a>\n";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/notify_all.php">\n\t\t\t' + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "他<span>$1件</span>以上の新着通知があります。", null != b ? b.other_count : b, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n\t\t</a>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f;
        return '<li class="continue unread">\n' + (null != (f = (c.is || b && b.is || c.helperMissing).call(null != b ? b : {}, null != b ? b.notification_type : b, "==", "message", {
            name: "is",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.program(3, e, 0),
            data: e
        })) ? f : "") + "</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-ranked_in"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="/ranking.php?mode=' + l(n(null != (f = null != b ? b.details : b) ? f.context : f, b)) + "&amp;content=" + l(n(null != (f = null != b ? b.details : b) ? f.type : f, b)) + '">\n\t\t<div class="image" style="background-image:url(' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>「$1」</span>が$2で<span>$3位</span>にランクインしました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.category : f, null != (f = null != b ? b.details : b) ? f.position : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-ranobe_book"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return "\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』と<span>他$3件</span>が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title1 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title2 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.program(9, e, 0),
            data: e
        })) ? f : "";
    },
    "7": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "9": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』が発売されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "11": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="https://novel.pixiv.net/my?ads=popbook#books" class="icon-comic-book" target="_blank">\n\t\t<div class="image" style="background-image:url(' + l((c.prop || b && b.prop || j).call(i, "sourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'images/notification/novel.png)">\n\t\t</div>\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.details : b) ? f.other_count : f, ">", 0, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(11, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-ranobe_new"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return "\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』と<span>他$3件</span>が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, null != (f = null != b ? b.details : b) ? f.other_count : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "5": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title1 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(6, e, 0),
            inverse: a.noop,
            data: e
        })) ? f : "";
    },
    "6": function(a, b, c, d, e) {
        var f;
        return null != (f = c.if.call(null != b ? b : {}, null != (f = null != (f = null != b ? b.details : b) ? f.title2 : f) ? f.length : f, {
            name: "if",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.program(9, e, 0),
            data: e
        })) ? f : "";
    },
    "7": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』と『<span>$2</span>』が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, null != (f = null != b ? b.details : b) ? f.title2 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "9": function(a, b, c, d, e) {
        var f;
        return "\t\t\t\t\t" + (null != (f = (c.t || b && b.t || c.helperMissing).call(null != b ? b : {}, "『<span>$1</span>』が更新されました。", null != (f = null != b ? b.details : b) ? f.title1 : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n";
    },
    "11": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="https://novel.pixiv.net/my?ads=popnew" class="icon-comic-new" target="_blank">\n\t\t<div class="image" style="background-image:url(' + l((c.prop || b && b.prop || j).call(i, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'notification/novel.png)">\n\t\t</div>\n\t\t' + l((c.t || b && b.t || j).call(i, "pixivノベルで", {
            name: "t",
            hash: {},
            data: e
        })) + "\n" + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != b ? b.details : b) ? f.other_count : f, ">", 0, {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : ""), g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(11, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-received_stacc_message"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="/stacc/my/home/all/message_from">\n\t\t<div class="image _user-icon" style="background-image:url(' + l(a.lambda(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "フィードで<span>$1</span>さんがあなたへコメントしました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-requested_friend"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="/mypixiv_request.php">\n\t\t<div class="image _user-icon" style="background-image:url(' + l(a.lambda(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんからマイピク申請が届きました。", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.users : f) ? f[0] : f) ? f.name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-scored"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/novel/bookmark_detail.php?id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/bookmark_detail.php?illust_id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.type : f, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image" style="background-image:url(' + l(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>「$1」</span>の評価点数が<span>$2点</span>を超えました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.score : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-sensei_new_course"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="' + l(a.lambda(null != (f = null != b ? b.details : b) ? f.target_url : f, b)) + '?utm_source=pixiv&utm_medium=popboard&utm_campaign=notify_new_course" target="_blank">\n\t\t<div class="image">\n\t\t\t<img src="' + l((c.prop || b && b.prop || j).call(i, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'notification/sensei.png" alt="" width="48" height="48">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "【sensei】新しく「$1」コースが追加されました！動画の視聴は<span>こちら</span>から。", null != (f = null != b ? b.details : b) ? f.course_name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-sensei_tmp_premium_limit"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n\t<a href="' + l(a.lambda(null != (f = null != b ? b.details : b) ? f.target_url : f, b)) + '?utm_source=pixiv&utm_medium=popboard&utm_campaign=notify_trial_expiration" target="_blank">\n\t\t<div class="image">\n\t\t\t<img src="' + l((c.prop || b && b.prop || j).call(i, "commonSourcePath", {
            name: "prop",
            hash: {},
            data: e
        })) + 'notification/sensei.png" alt="" width="48" height="48">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "【sensei】実践編講座のお試し期間が$1で終了します！実践編講座の視聴は<span>こちら</span>から。", null != (f = null != b ? b.details : b) ? f.limit_date : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-sketch_newbie"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = a.lambda, o = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (o += f), 
        o += '">\n\t<a href="' + l(n(null != (f = null != (f = null != b ? b.details : b) ? f.sketch_item : f) ? f.url : f, b)) + '?utm_source=pixiv&utm_medium=popboard_newbie&utm_campaign=popboard_newbie" target="_blank">\n\t\t<div class="image _user-icon" style="background-image:url(' + l(n(null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.sketch_item : f) ? f.user : f) ? f.img : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>$1</span>さんがpixiv Sketchを始めました！", null != (f = null != (f = null != (f = null != b ? b.details : b) ? f.sketch_item : f) ? f.user : f) ? f.user_name : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (o += f), o + "\t</a>\n</li>\n";
    },
    useData: !0
}), this.pixiv.templates["whitecube-notification-tagged"] = Handlebars.template({
    "1": function(a, b, c, d, e) {
        return " unread";
    },
    "3": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/novel/show.php?id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "5": function(a, b, c, d, e) {
        var f;
        return '\t\t<a href="/member_illust.php?mode=medium&amp;illust_id=' + a.escapeExpression(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.id : f, b)) + '">\n';
    },
    "7": function(a, b, c, d, e) {
        var f;
        return '\t\t\t<div class="notified-at">' + a.escapeExpression((f = null != (f = c.date_time || (null != b ? b.date_time : b)) ? f : c.helperMissing, 
        "function" == typeof f ? f.call(null != b ? b : {}, {
            name: "date_time",
            hash: {},
            data: e
        }) : f)) + "</div>\n";
    },
    compiler: [ 7, ">= 4.0.0" ],
    main: function(a, b, c, d, e) {
        var f, g, h, i = null != b ? b : {}, j = c.helperMissing, k = "function", l = a.escapeExpression, m = c.blockHelperMissing, n = '<li class="' + l((g = null != (g = c.type || (null != b ? b.type : b)) ? g : j, 
        typeof g === k ? g.call(i, {
            name: "type",
            hash: {},
            data: e
        }) : g));
        return g = null != (g = c.unread || (null != b ? b.unread : b)) ? g : j, h = {
            name: "unread",
            hash: {},
            fn: a.program(1, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.unread || (f = m.call(b, f, h)), null != f && (n += f), 
        n += '">\n' + (null != (f = (c.is || b && b.is || j).call(i, null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.type : f, "==", "novel", {
            name: "is",
            hash: {},
            fn: a.program(3, e, 0),
            inverse: a.program(5, e, 0),
            data: e
        })) ? f : "") + '\t\t<div class="image" style="background-image:url(' + l(a.lambda(null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.url : f, b)) + ')">\n\t\t</div>\n\t\t' + (null != (f = (c.t || b && b.t || j).call(i, "<span>「$1」</span>に<span>$2</span>タグが追加されました。", null != (f = null != (f = null != b ? b.details : b) ? f.target : f) ? f.title : f, null != (f = null != b ? b.details : b) ? f.tag : f, {
            name: "t",
            hash: {},
            data: e
        })) ? f : "") + "\n", g = null != (g = c.date_time || (null != b ? b.date_time : b)) ? g : j, 
        h = {
            name: "date_time",
            hash: {},
            fn: a.program(7, e, 0),
            inverse: a.noop,
            data: e
        }, f = typeof g === k ? g.call(i, h) : g, c.date_time || (f = m.call(b, f, h)), 
        null != f && (n += f), n + "\t</a>\n</li>\n";
    },
    useData: !0
}), colon.ns("pixiv.libs", {
    "jquery-ui.min.js": "js/lib/jquery-ui/jquery-ui.min.js?dfe3ecf96456f8cafc12a7f48de6b8c8",
    "jquery-ui.min.css": "js/lib/jquery-ui/theme/jquery-ui.min.css?975db0c6fcedec2eebc3d45b66688aeb"
}), colon.config("ga", {}), function(a, b, c) {
    "use strict";
    function d(a) {
        c(aa.iframe("http://www.facebook.com/plugins/likebox.php", c(a).dataset())).appendTo(a);
    }
    function e() {
        var b = aa.context.twitterWidgetOptions;
        b && a.TWTR && c.getScript("//widgets.twimg.com/j/2/widget.js").done(function() {
            new TWTR.Widget(b).render().start();
        });
    }
    function f(b) {
        return a.open(b, "twitter", "width=550,height=450,personalbar=0,toolbar=0,scrollbars=1,resizable=1"), 
        !1;
    }
    function g(b) {
        return a.open(b, "mixi_check", "width=632,height=456,location=yes,resizable=yes,toolbar=no,menubar=no,scrollbars=no,status=no"), 
        !1;
    }
    function h() {
        c("form.ui-prevent-duplicate").submit(function() {
            c('input[type="submit"]', this).addClass("loading").val(c(this).attr("data-text-loading")).prop("disabled", !0);
        });
    }
    function i(a) {
        this.handler = a, this.config = colon.storage.config("auto-view"), this.enableContainer = c("#enable-auto-view"), 
        this.disableContainer = c("#disable-auto-view");
        var b = this.enabled();
        return this.update(b), b;
    }
    function j() {
        aa.toolbar.remove(this.disableContainer), this.enableContainer.remove(), delete aa.autoView;
    }
    function k(a) {
        return a ? (this.enable(), aa.toolbar.add(this.disableContainer), this.enableContainer.hide()) : (this.disable(), 
        aa.toolbar.remove(this.disableContainer), this.enableContainer.show()), !1;
    }
    function l() {
        this.config("enabled", 1), "function" === c.type(this.handler) && this.handler(!0);
    }
    function m() {
        this.config("enabled", null), "function" === c.type(this.handler) && this.handler(!1);
    }
    function n() {
        this.terminate();
    }
    function o() {
        var a = c(this).dataset(), b = 72, d = 16, e = {
            url: a.url,
            type: "3",
            count: "1",
            appKey: "",
            title: a.title + "#",
            pic: a.pic || c('meta[property="og:image"]').attr("content") || "",
            relateUid: "2230227495",
            language: a.language,
            rnd: new Date().valueOf()
        }, f = [];
        for (var g in e) e.hasOwnProperty(g) && f.push(g + "=" + encodeURIComponent(e[g] || ""));
        c('<iframe allowTransparency="true" frameborder="0" scrolling="no" style="vertical-align:middle"src="http://hits.sinajs.cn/A1/weiboshare.html?' + f.join("&") + '" width="' + b + '" height="' + d + '"></iframe>').appendTo(this);
    }
    function q() {
        var a = c(this).dataset(), b = {
            url: a.url,
            desc: "",
            summary: "",
            title: a.title,
            site: "",
            pics: a.pic || c('meta[property="og:image"]').attr("content") || ""
        }, d = [];
        for (var e in b) b.hasOwnProperty(e) && d.push(e + "=" + encodeURIComponent(b[e] || ""));
        c(this).html('<a href="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?' + d.join("&") + '" target="_blank" title="分享到QQ空间"><img src="http://qzonestyle.gtimg.cn/qzone_v6/proj_connect_open/img/qzone_share_txt_s.png" alt="分享到QQ空间" border="0"></a>');
    }
    function r(a) {
        var b = c(a.target), d = b.dataset(), e = d.shareButtonId || 0, f = this.container[e] = this.container[e] || this.template.tmpl(d).appendTo("body"), g = b.offset();
        return colon.ui.modal.toggle(b, f.css({
            top: g.top + b.outerHeight() + 7,
            left: g.left + b.outerWidth() / 2 - f.outerWidth() / 2
        })), e || (c.getScript("http://b.st-hatena.com/js/bookmark_button.js"), c.getScript(aa.sourcePath + "js/stacc/modal.js")), 
        !1;
    }
    function s(a) {
        return a = aa.ui.Tag.trim(a), a ? a.split(ia) : [];
    }
    function t(a, b) {
        a = aa.ui.Tag.trim(a).toLowerCase();
        for (var c = 0, d = b.length; c < d; ++c) if (a === b[c].toLowerCase()) return c;
        return -1;
    }
    function u(a, b, c) {
        a = aa.ui.Tag.trim(a).toLowerCase();
        var d, e = ja.exec(a), f = [];
        e && (a = e[1]);
        for (var g = 0, h = b.length; g < h; ++g) d = aa.ui.Tag.trim(b[g]).toLowerCase(), 
        (e && d === a || d.indexOf(a) !== -1) && (d = c ? c(d) : d, d && f.push(d));
        return f.length ? f : null;
    }
    function v(a) {
        return a.replace(ja, "$1");
    }
    function w(a) {
        return a ? a.toString().replace(ka, "").replace(la, "") : "";
    }
    function x(a, b) {
        this.target = c(a), this.options = c.extend({
            maxCount: 10
        }, b), this.make();
    }
    function y() {
        return this.tags.join(" ");
    }
    function z() {
        var a = this, b = this.target, d = aa.ui.Tag.split(b.val()), e = c.tmpl(this.template, {
            tags: d,
            maxCount: this.options.maxCount
        }).insertBefore(b);
        b.hide(), this.container = e.click(function() {
            a.input[0].focus();
        }).delegate("span.close", "click", c.proxy(this.remove, this)), this.tagsContainer = c("ul.tags", e), 
        this.countContainer = c("span.count", e), this.input = c("input", e).bind("keypress keyup blur", c.proxy(this.update, this)), 
        this.tags = d;
    }
    function A(a) {
        var b, d, e = this.input.val(), f = a.altKey || a.ctrlKey || a.shiftKey, g = "keypress" === a.type && 13 === a.which && !f;
        if (/[\s　]$/.test(e) || g || "blur" === a.type ? (e = aa.ui.Tag.trim(e), e && (b = e.split(/[\s　]+/), 
        this.input.val(""), this.recentValue = "", this.add(b))) : "keyup" !== a.type || "" !== this.recentValue || 8 !== a.which || f ? this.recentValue = e : (d = c("span", this.tagsContainer).get(-1), 
        d && this.remove({
            target: d
        })), g) return !1;
    }
    function B() {
        var a = this.countContainer;
        if (a.length) {
            var b = this.tags.length;
            a.text(b), b > this.options.maxCount ? a.addClass("over") : a.removeClass("over");
        }
    }
    function C(a) {
        var b = !1;
        if (!a) return b;
        "string" === c.type(a) && (a = [ a ]);
        for (var d = 0, e = a.length; d < e; ++d) {
            var f = aa.ui.Tag.trim(a[d]);
            if (f) {
                var g = aa.ui.Tag.find(f, this.tags);
                g === -1 && (c.tmpl(this.itemTemplate, {
                    tag: f
                }).appendTo(this.tagsContainer), this.tags.push(f), b = !0);
            }
        }
        return b && (this.target.val(this.value()).trigger("uiTagUpdate"), this.updateCount()), 
        b;
    }
    function D(a) {
        var b = !1, d = c(a.target).parent(), e = d.attr("data-tag"), f = aa.ui.Tag.find(e, this.tags);
        return f !== -1 && (d.remove(), this.tags.splice(f, 1), this.target.val(this.value()).trigger("uiTagUpdate"), 
        this.updateCount(), b = !0), "undefined" != typeof a.stopPropagation && a.stopPropagation(), 
        b;
    }
    function E() {
        this.input = c("#input_tag"), this.input.length && (this.errorContainer = c("#bookmark_add_alert"), 
        this.countContainer = c("#bookmark_tag_count"), this.tagContainer = c(".bookmark_recommend_tag, .bookmark-recommend-tag"), 
        this.update());
    }
    function F(a) {
        return a = c.trim(a), a ? a.split(/\s+/) : [];
    }
    function G(a, b) {
        a = c.trim(a).toLowerCase();
        for (var d = 0, e = b.length; d < e; ++d) if (a === b[d].toLowerCase()) return d;
        return -1;
    }
    function H(a) {
        var b = this.parse(this.input.val()), c = this.inArray(a, b);
        c === -1 ? b.push(a) : b.splice(c, 1), this.input.val(b.join(" ")), this.update();
    }
    function I() {
        this.verify(), this.match();
    }
    function J() {
        var a = this, b = this.parse(this.input.val());
        c(".tag", this.tags).each(function() {
            var d = c(this);
            a.inArray(d.attr("data-tag"), b) !== -1 ? (d.addClass("on selected"), "checkbox" === d.attr("type") && d.attr("checked", !0)) : (d.removeClass("on selected"), 
            "checkbox" === d.attr("type") && d.attr("checked", !1));
        });
    }
    function K() {
        this.optionContainer = c("section#search-option"), this.sizeSelector("#size-selector"), 
        this.ratioSelector("#ratio-selector"), this.toolSelector("#tool-selector"), this.orderSelector("#order-date-selector", "date"), 
        this.orderSelector("#order-popular_d-selector", "popular_d"), c("form", this.optionContainer).submit(c.proxy(this.submit, this));
    }
    function L(a) {
        if (!a) return {
            wlt: null,
            wgt: null,
            hlt: null,
            hgt: null
        };
        var b = a.split("-"), c = b[0] || null, d = b[1] || null;
        return {
            wlt: c,
            wgt: d,
            hlt: c,
            hgt: d
        };
    }
    function M(a) {
        if (!a && 0 !== a) return {
            scd: null,
            ecd: null
        };
        var b = aa.formatNumber, c = new Date(), d = new Date(c - 864e5 * Math.max(a, 0)), e = [ b(d.getFullYear()), b(d.getMonth() + 1), b(d.getDate()) ].join("-");
        return {
            scd: e,
            ecd: null
        };
    }
    function N(a, b) {
        var d = this;
        c(a).change(function() {
            var a = this.value;
            "__other__" !== a && (p.updateQuery(c.extend(d.parseDateOption(a), {
                order: b,
                p: null
            })), c("#order-" + b + "-selector-current").text(this[this.selectedIndex].text));
        }).unbind("mouseenter");
    }
    function O(a) {
        var b = this;
        c(a).change(function() {
            var a = this.value;
            "__other__" !== a && (p.updateQuery(c.extend(b.parseDateOption(a), {
                p: null
            })), c("#date-selector-current").text(this[this.selectedIndex].text));
        }).unbind("mouseenter");
    }
    function P(a) {
        var b = this;
        c(a).change(function() {
            var a = this.value;
            "__other__" !== a && (p.updateQuery(c.extend(b.parseSizeOption(a), {
                p: null
            })), c("#size-selector-current").text(this[this.selectedIndex].text));
        });
    }
    function Q(a) {
        c(a).change(function() {
            var a = this.value;
            "__other__" !== a && (p.updateQuery({
                ratio: a || "0" === a ? a : null,
                p: null
            }), c("#ratio-selector-current").text(this[this.selectedIndex].text));
        });
    }
    function R(a) {
        var b = this, d = c(a);
        if (d.length) {
            var e = d[0].options.selectedIndex, f = aa.context.tools, g = {
                "2d": 10,
                "3d": 5,
                analog: 5
            }, h = [];
            for (var i in g) h = h.concat(f[i].slice(0, g[i]));
            c(p.template.apply("tool-select", {
                options: h,
                current: aa.context.queries.tool
            })).appendTo(d), d.change(function() {
                var a = this.value;
                return "__other__" === a ? (this.options.selectedIndex = e, void b.openOption()) : void p.updateQuery({
                    tool: a || null,
                    p: null
                });
            });
        }
    }
    function S() {
        var b, d, e, f, g = this.optionContainer, h = aa.context.tools, i = aa.context.queries.tool, j = [];
        if (!ma) {
            for (e in h) {
                for (d = h[e], j.push("<div>" + aa.text[e] + "</div><ul>"), f = 0; b = d[f]; ++f) b = colon.html.escape(b), 
                j.push('<li><label><input type="radio" name="tool" value="' + b + '"' + (b === i ? " checked" : "") + ">" + b + "</label></li>");
                j.push("</ul>");
            }
            c(".tools", g).append(j.join("")).find('input[type="radio"]').change(function() {
                c('input[name="' + ("tool" === this.name ? "toolcat" : "tool") + '"]:checked').prop("checked", !1);
            }), ma = !0;
        }
        a.setTimeout(function() {
            aa.ui.modal.open(g, {
                block: !0
            });
        }, 0);
    }
    function T() {
        var a = this.optionContainer, b = c.extend({
            s_mode: c('input[name="s_mode"]:checked', a).val(),
            word: "",
            tag: null,
            r18: Number((c('input[name="r18"]', a)[0] || {}).checked) || null,
            scd: null,
            ecd: null,
            wlt: null,
            wgt: null,
            hlt: null,
            hgt: null,
            ratio: c('input[name="ratio"]:checked', a).val() || null,
            tool: c('input[name="tool"]:checked', a).val() || null,
            toolcat: c('input[name="toolcat"]:checked', a).val() || null,
            p: null
        }, this.parseDateOption(c('input[name="date"]:checked', a).val()), this.parseSizeOption(c('input[name="size"]:checked', a).val())), d = aa.ui.Tag.trim(c("#word-and").val()), e = aa.ui.Tag.trim(c("#word-or").val()), f = aa.ui.Tag.trim(c("#word-not").val());
        return e && (e = "(" + aa.ui.Tag.split(e).join(" OR ") + ")"), f && (f = "-" + aa.ui.Tag.split(f).join(" -")), 
        b.word = c.trim([ d, e, f ].join(" ")), p.updateQuery("/search.php", b), !1;
    }
    function U(a, b) {
        c("#" + a)["slide" + (b ? "Down" : "Up")]("fast");
    }
    function V() {
        var a, b, d, e;
        a = c(".popular-introduction"), a.length && (d = c(".image-item"), d.length && (b = c(".user-ad-container"), 
        e = function() {
            var c = !b.length || b.hasClass("out") ? 5 : 4, e = d.height("").eq(Math.min(c, d.length - 1)), f = !b.length || b.hasClass("out") ? "100%" : "80%";
            a.css({
                width: f,
                top: e.position().top + e.outerHeight(!0) + 10
            }), e.height(e.outerHeight(!0) + a.outerHeight());
        }, colon.w.on("resize.popularIntroduction", colon.throttle(e)), e()));
    }
    function W(a) {
        var b = c(a).dataset("infoid");
        return !!b && void aa.api.post("/rpc_info_setting.php", {
            mode: "mark_as_read",
            id: b
        }, {
            ajaxSettings: {
                dataType: "text"
            }
        });
    }
    function X(a) {
        this.remove(a), c(a).parent().parent().parent().slideUp("fast");
    }
    function Y(a, b) {
        a = aa.ui.Tag.trim(a).toLowerCase();
        for (var c = 0, d = b.length; c < d; ++c) {
            var e = b[c].split("-"), f = e[1];
            if (a === f.toLowerCase()) return c;
        }
        return -1;
    }
    function Z(a) {
        for (var b = [], c = 0, d = 0, e = a.length; d < e; ++d) {
            var f = a[d].split("-"), g = f[0];
            g > this.date - 100 && (b[c] = a[d], c++);
        }
        return b.join(";");
    }
    function $() {
        var a = c("._search-tutorial-modal");
        return !colon.storage.localStorage("hideSearchTutorialModal") && void a.show();
    }
    function _() {
        var a = c("._search-tutorial-modal");
        colon.storage.localStorage("hideSearchTutorialModal", new Date(), {
            cache: 31536e6
        }), a.hide();
    }
    var aa = a.pixiv = c.extend(!0, a.pixiv, {
        platform: null,
        user: {},
        context: {},
        text: {},
        templates: {},
        config: {
            pTlAPIKey: "18c61f5d457c2c15d866a8bf4f5a414b1d277b93"
        }
    });
    aa.secure = "https:" === a.location.protocol, aa.domain = (/[\-a-z]+\.[a-z]+$/.exec(a.location.hostname) || [])[0], 
    aa.context.type || (aa.context.type = "illust"), c.fn.selectbox = function(a) {
        return a = a || {}, this.each(function() {
            var b = c(this), d = a.current || c("div.current", this), e = a.item_container || c("ul.items", this), f = c("li", e), g = a.default_item || f.filter(".current"), h = a.callback, i = !1;
            b.hover(function() {
                i || (f.each(function() {
                    var a = c(this).click(function(c) {
                        return !a.hasClass("current") && (g.removeClass("current"), g = a.addClass("current"), 
                        d.text(g.text()), b.mouseleave(), h ? h.call(this, c) : void 0);
                    });
                }), i = !0), e.show();
            }, function() {
                e.hide();
            });
        });
    }, c.fn.boxHeight2 = function() {
        var a = 0;
        return this.each(function() {
            var b = c(this);
            a = Math.max(b.height(), a);
        }).height(a);
    }, c.fn.boxHeight = function() {
        var a = [], b = 0, d = 0;
        return this.each(function() {
            var e = c(this);
            e.position().top !== b && (a.length > 1 && c(a).height(d), a = [], d = 0, b = e.position().top), 
            a.push(this), d = Math.max(e.height(), d);
        }), a.length > 1 && c(a).height(d), this;
    }, c.fn.reverse = function() {
        return c(this.get().reverse());
    }, colon.ns("pixiv.pageModule"), aa.page = function(a) {
        var b, d, e, f, g, h = colon.dispatcher;
        for (b in a) {
            for (d = a[b], e = !!d, e || b === aa.context.page && (d = [ /.*/ ]), "array" !== c.type(d) && (d = [ d ]), 
            f = 0; g = d[f]; ++f) g && h.connect(g, aa.page[b]);
            e || h.and();
        }
        h.dispatch();
    };
    var ba = {};
    c.extend(aa, {
        setup: function() {
            c(aa.setupReady), a.onload = aa.setupLoad, a.onunload = aa.setupUnload, aa.context.queries = colon.query.base, 
            colon.query.replace({
                ref: null,
                uarea: null
            }, !0);
        },
        setupBeforeReady: function() {},
        setupReady: function() {
            colon.config({
                text: aa.text,
                templates: aa.templates
            }), aa.body = c("body"), aa.Document && new aa.Document();
            var a = c(".search-container");
            c(".ui-search, .search-form").each(function() {
                var b = c(this), d = c(".text", this), e = c(".clear", this);
                d.focus(function() {
                    a.addClass("focused");
                }).blur(function() {
                    a.removeClass("focused");
                }).keyup(function() {
                    d.val() ? b.addClass("has-text") : b.removeClass("has-text");
                }).keyup(), e.click(function() {
                    d.val("").keyup()[0].focus();
                });
            }), c(".selectbox").selectbox(), c(".ui-selectbox-container").each(function() {
                new aa.ui.Selectbox(this, {
                    sensitive: !0
                });
            }), aa.screen.setup(), aa.context.userId && (new aa.Favorite().initialize(), new aa.MyPixiv().initialize()), 
            aa.Popup.setup(), aa.ui.setup(), aa.AutoView.setup(), aa.suggest.setup(), aa.Notification.setup(), 
            aa.toolbar.setup(), aa.mute.setup(), aa.mute.isAvailable() || aa.thumbnailFilter.setup(), 
            colon.ga.setup(), aa.tracker.setup(), aa.EventTracker.setup(), aa.user.premium || aa.context.popular_search_enable || colon.d.on("click", "a.require-premium", function() {
                var a, b = c(this), d = b.dataset(), e = b.attr("href");
                return "searchModalPremium" === d.title && "ja" === c("html").attr("lang") ? (a = aa.ui.modal.open("#premium-introduction-image-modal", {
                    block: !0
                }), d.width ? c(".introduction-modal", a).css("width", d.width) : c(".introduction-modal", a).css("width", "600px"), 
                d.height ? c(".introduction-modal", a).css("height", d.height) : c(".introduction-modal", a).css("height", "318px"), 
                c("#premium-introduction-image-modal").children().css("padding", "0"), e.match(/^\/premium\.php\?ref=.*/) && a.find("a").attr("href", e)) : (a = aa.ui.modal.open("#premium-introduction-modal", {
                    block: !0
                }), d.width ? c(".introduction-modal", a).css("width", d.width) : c(".introduction-modal", a).css("width", "332px"), 
                c(".title", a).html(aa.text[d.title]), c(".caption", a).html(aa.text[d.caption]), 
                c(".button-container", a).each(function() {
                    "A" === this.tagName && c(this).attr("href", e);
                })), !1;
            }), aa.page({
                userRecommendation: null,
                userSearch: null,
                work: [ "/member_illust.php", "/novel/show.php" ],
                bookmark: "/bookmark.php",
                bookmark_detail: "/bookmark_detail.php",
                "*/bookmark_add": {
                    pathname: /\/bookmark_add\.php$/,
                    search: /.+/
                },
                recommended: "/recommended.php",
                search: /^(?:\/novel)?\/(?:tags(?:_r18)?|search)\.php$/,
                setting_user: "/setting_user.php",
                event_member: "/event_member.php",
                ranking: [ "/ranking.php", "/novel/ranking.php", {
                    pathname: "/ranking_area.php",
                    search: /(?:^|\?|&)type=detail(?:&|$)/
                } ],
                ranking_log: "/ranking_log.php",
                event: "/event.php",
                "novel/preview": "/novel/preview.php",
                "group/create": "/group/create.php",
                group: /^\/group\/.*/,
                notify_all: "/notify_all.php",
                content_upload: [ "/content_upload.php", "/manga_upload.php", "/member_illust_mod.php" ],
                novel_upload: "/novel/upload.php",
                setting_access_block: "/setting_access_block.php",
                authentication_request: "/authentication_request.php",
                welcome: "/welcome.php",
                premium: "/premium.php"
            }), aa.scrollView.setup();
            try {
                var d = function(a) {
                    aa.scrollView.add(".ui-scroll-view", a.target);
                };
                b.body.addEventListener("AutoPagerize_DOMNodeInserted", d, !1), b.body.addEventListener("AutoPatchWork.DOMNodeInserted", d, !1), 
                b.body.addEventListener("AutoPagerAfterInsert", d, !1);
            } catch (a) {}
        },
        setupLoad: function() {
            aa.ui.shareButton.setup();
            var a = aa.widget, b = colon.dispatcher.connect(/^\/user_event(?:_.+)?\.php$/, a.twitterWidget);
            b.dispatch();
        },
        setupUnload: function() {
            colon.storage.cleanup();
        },
        updateQuery: function(b, d, e) {
            "string" !== c.type(b) && (e = d, d = b, b = location.pathname);
            var f = p.queryString(c.extend(p.parseQuery(), d)), g = b + (f ? "?" + f : ""), h = location.pathname + location.search;
            h !== g && (location.hash && (g += location.hash), e ? a.history.replaceState && a.history.replaceState(null, "", g) : location.href = g);
        },
        getTemplate: function(a) {
            var b, d = c("#template-" + a);
            return d.length ? (b = c.trim(d.html()), "raw" !== d.dataset("format") && (b = b.replace(/[\r\n]/g, "")), 
            b) : null;
        },
        createTemplate: function(a, b) {
            var c, d = aa.getTemplate(a);
            if (d) return ba[a] && void 0 === b ? c = ba[a] : (c = Handlebars.compile(d), b && (ba[a] = c)), 
            c;
        },
        shuffle: function(a) {
            for (var b = a.length; --b; ) {
                var c = Math.floor(Math.random() * (b + 1));
                if (b !== c) {
                    var d = a[b];
                    a[b] = a[c], a[c] = d;
                }
            }
            return a;
        },
        camelize: function(a, b) {
            return a = a.replace(/-([a-z]|[0-9])/gi, function(a, b) {
                return b.toUpperCase();
            }), b ? a.charAt(0).toUpperCase() + a.slice(1) : a;
        },
        prefixFilter: function(a, b) {
            var c, d = {}, e = new RegExp("^(" + a + ")([A-Z].+)?$");
            for (var f in b) c = e.exec(f), c && c[1] === a && (c[2] ? d[c[2].charAt(0).toLowerCase() + c[2].slice(1)] = b[f] : d[c[1]] = b[f], 
            delete b[f]);
            return d;
        }
    }), aa.title = function(a) {
        a = "function" === c.type(a) ? a(b.title, aa.title.original) : a, a !== b.title && (b.title = null === a ? aa.title.original : a || "");
    }, aa.title.original = b.title, aa.iframe = function(a, b) {
        return b && (a += "?" + p.queryString(b, !0)), '<iframe src="' + a + '" marginwidth="0" marginheight="0" frameborder="0" allowtransparency="true" scrolling="no"></iframe>';
    }, aa.LoadingIndicator = function(a, b) {
        this.container = c(a), b && (this.type += "-" + b);
    }, aa.LoadingIndicator.prototype = {
        finished: !1,
        type: "loading-indicator",
        container: null,
        start: function() {
            if (!this.finished) return c("." + this.type, this.container).length || c('<div class="' + this.type + '"></div>').appendTo(this.container), 
            this.container.addClass("_loading"), this;
        },
        stop: function() {
            return this.container.removeClass("_loading"), this;
        },
        finish: function(a) {
            return this.stop(), c("." + this.type, this.container).remove(), this.finished = !0, 
            a && (a = null), this;
        }
    }, colon.ns("pixiv.get", {
        "jquery-ui": function() {
            var a;
            return c.ui ? colon.async() : (colon.get.css(aa.sourcePath + aa.libs["jquery-ui.min.css"]), 
            a = aa.sourcePath + aa.libs["jquery-ui.min.js"], colon.req.unite(colon.req.id(a), function() {
                return colon.get.script(a);
            }));
        }
    }), aa.widget = {
        facebookLikeBox: d,
        twitterWidget: e,
        openTwitter: f,
        openMixiCheck: g
    }, aa.userRecommend = {
        stash: null,
        offset: 0,
        indicator: null,
        thumbnailIndicator: null,
        debounceObject: null,
        canceled: !1,
        autoView: null,
        container: null,
        unitContainer: null,
        thumbnailContainer: null,
        thumbnailImage: null,
        setup: function(a, b) {
            return this.container = c(".user-recommendation-items"), this.unitContainer = c(a || ".user-recommendation-unit"), 
            this.thumbnailContainer = c(".thumbnail-popup"), this.indicator = new aa.LoadingIndicator(this.container), 
            this.thumbnailIndicator = new aa.LoadingIndicator(this.thumbnailContainer, "small"), 
            this.debounceObject = colon.debounce(this.openThumbnail, this, 200), colon.d.on({
                mouseenter: this.debounceObject,
                mouseleave: c.proxy(this.closeThumbnail, this)
            }, ".action-open-thumbnail").on("click", ".action-open-setting", c.proxy(aa.follow.setting.open, aa.follow.setting)).on("followed", ".action-open-setting", c.proxy(this.follow, this)).on("unfollowed", ".action-open-setting", this.unfollow), 
            this.autoView = new aa.AutoView(".more", {
                scrollContext: b ? this.unitContainer : null
            }), this.load();
        },
        load: function() {
            var a = this;
            return aa.api.userRecommendation(aa.context.userRecommendSampleUser, 100).always(function() {
                a.indicator.finish(a.indicator);
            }).pipe(function(a, b) {
                return a && !a.error && a.users && a.users.length ? c.Deferred().resolveWith(this, arguments) : c.Deferred().rejectWith(this, [ a, b, a && a.error ]);
            }).done(function(b) {
                a.stash = b.users, a.show(), c(".more", a.unitContainer).on("autoView", function() {
                    a.show();
                });
            }).fail(function(b, d, e) {
                var f = c("._no-item", a.unitContainer);
                e && f.text(e), f.removeClass("hidden");
            });
        },
        append: function(a, b) {
            aa.api.userRecommendation(b, 10).pipe(function(a, b) {
                return a && !a.error && a.users && a.users.length ? c.Deferred().resolveWith(this, arguments) : c.Deferred().rejectWith(this, [ a, b, a && a.error ]);
            }).done(function(b) {
                c(p.template.apply("user-recommendation-item", {
                    relatedUser: c(".title", a).text(),
                    items: b.users
                }, !0)).insertAfter(a), aa.scrollView.update();
            });
        },
        show: function() {
            var b = this.stash.splice(0, 20), d = b.length;
            d && (this.offset || c(".more", this.unitContainer).click(c.proxy(this.show, this)).removeClass("hidden"), 
            this.stash.length || c(".more", this.unitContainer).remove(), this.container.append(p.template.apply("user-recommendation-item", {
                items: b
            }, !0)), this.offset += d, aa.scrollView.update(), a.setTimeout(c.proxy(this.autoView.on, this.autoView)));
        },
        openThumbnail: function(a) {
            var b = this, d = c(a.currentTarget), e = d.offset(), f = d.data();
            return d.data("canceled", !1), f.width && f.height ? (this.showThumbnail(e), void this.showThumbnailImage(d, {
                opacity: 1,
                top: e.top + 128 + 12
            })) : (this.thumbnailIndicator.start(), this.showThumbnail(e).animate({
                opacity: 1,
                top: e.top + 128 + 12
            }, 200), void c("<img>").load(function() {
                d.data("canceled") || (b.thumbnailIndicator.stop(), d.data({
                    width: this.width,
                    height: this.height
                }), b.showThumbnailImage(d));
            }).attr("src", f.src));
        },
        showThumbnail: function(a) {
            var b = this.thumbnailContainer;
            return b.removeClass("hidden").stop(!0, !0).css({
                width: 32,
                height: 32
            }).css({
                opacity: 0,
                top: a.top + 128 + 2,
                left: a.left + 67 - b.outerWidth() / 2
            }), b;
        },
        showThumbnailImage: function(a, b) {
            var d = a.offset(), e = a.data(), f = Math.min(e.height, 480), g = Math.floor(e.width * f / e.height);
            b = c.extend({
                left: Math.floor(d.left + 67 - (g + 6) / 2),
                width: g,
                height: f
            }, b), this.thumbnailContainer.css({
                backgroundImage: "url(" + e.src + ")",
                backgroundSize: g + "px " + f + "px"
            }).stop(!0, !0).animate(b, 200);
        },
        closeThumbnail: function(a) {
            this.debounceObject.cancel(), c(a.currentTarget).data("canceled", !0), this.thumbnailContainer.addClass("hidden").stop(!0, !0), 
            this.thumbnailIndicator.stop();
        },
        follow: function(a) {
            var b = c(a.currentTarget), d = b.data("id");
            b.addClass("following").find("._icon").removeClass("sprites-follow").addClass("sprites-checked").end().find(".text").text(aa.text.following), 
            this.append(b.closest(".user-recommendation-item"), d);
        },
        unfollow: function() {
            var a = c(this);
            a.removeClass("following").find("._icon").removeClass("sprites-checked").addClass("sprites-follow").end().find(".text").text(aa.text.follow);
        }
    }, aa.userSearch = {
        stash: null,
        thumbnailIndicator: null,
        debounceObject: null,
        canceled: !1,
        autoView: null,
        container: null,
        unitContainer: null,
        thumbnailContainer: null,
        thumbnailImage: null,
        setup: function() {
            this.container = c(".user-recommendation-items"), this.unitContainer = c(".user-search-result-container"), 
            this.thumbnailContainer = c(".thumbnail-popup"), this.thumbnailIndicator = new aa.LoadingIndicator(this.thumbnailContainer, "small"), 
            this.debounceObject = colon.debounce(this.openThumbnail, this, 200), colon.d.on({
                mouseenter: this.debounceObject,
                mouseleave: c.proxy(this.closeThumbnail, this)
            }, ".action-open-thumbnail").on("click", ".action-open-setting", c.proxy(aa.follow.setting.open, aa.follow.setting)).on("followed", ".action-open-setting", c.proxy(this.follow, this)).on("unfollowed", ".action-open-setting", this.unfollow);
        },
        append: function(a, b) {
            aa.api.userRecommendation(b, 10).pipe(function(a, b) {
                return a && !a.error && a.users && a.users.length ? c.Deferred().resolveWith(this, arguments) : c.Deferred().rejectWith(this, [ a, b, a && a.error ]);
            }).done(function(b) {
                c(p.template.apply("user-recommendation-item", {
                    relatedUser: c(".title", a).text(),
                    items: b.users
                }, !0)).insertAfter(a), aa.scrollView.update();
            });
        },
        openThumbnail: function(a) {
            var b = this, d = c(a.currentTarget), e = d.offset(), f = d.data();
            return d.data("canceled", !1), f.width && f.height ? (this.showThumbnail(e), void this.showThumbnailImage(d, {
                opacity: 1,
                top: e.top + 128 + 12
            })) : (this.thumbnailIndicator.start(), this.showThumbnail(e).animate({
                opacity: 1,
                top: e.top + 128 + 12
            }, 200), void c("<img>").load(function() {
                d.data("canceled") || (b.thumbnailIndicator.stop(), d.data({
                    width: this.width,
                    height: this.height
                }), b.showThumbnailImage(d));
            }).attr("src", f.src));
        },
        showThumbnail: function(a) {
            var b = this.thumbnailContainer;
            return b.removeClass("hidden").stop(!0, !0).css({
                width: 32,
                height: 32
            }).css({
                opacity: 0,
                top: a.top + 128 + 2,
                left: a.left + 67 - b.outerWidth() / 2
            }), b;
        },
        showThumbnailImage: function(a, b) {
            var d = a.offset(), e = a.data(), f = Math.min(e.height, 480), g = Math.floor(e.width * f / e.height);
            b = c.extend({
                left: Math.floor(d.left + 67 - (g + 6) / 2),
                width: g,
                height: f
            }, b), this.thumbnailContainer.css({
                backgroundImage: "url(" + e.src + ")",
                backgroundSize: g + "px " + f + "px"
            }).stop(!0, !0).animate(b, 200);
        },
        closeThumbnail: function(a) {
            this.debounceObject.cancel(), c(a.currentTarget).data("canceled", !0), this.thumbnailContainer.addClass("hidden").stop(!0, !0), 
            this.thumbnailIndicator.stop();
        },
        follow: function(a) {
            var b = c(a.currentTarget), d = b.data("id");
            b.addClass("following").find("._icon").removeClass("sprites-follow").addClass("sprites-checked").end().find(".text").text(aa.text.following), 
            this.append(b.closest(".user-recommendation-item"), d);
        },
        unfollow: function() {
            var a = c(this);
            a.removeClass("following").find("._icon").removeClass("sprites-checked").addClass("sprites-follow").end().find(".text").text(aa.text.follow);
        }
    }, aa.illustRecommend = {
        filterName: "illust-recommend-load",
        options: {
            count: 12,
            cache: null
        },
        recommendations: null,
        completed: !1,
        autoView: null,
        container: null,
        listContainer: null,
        statusContainer: null,
        loadingContainer: null,
        moreContainer: null,
        setup: function(a) {
            var b = this.container = c("#illust-recommend");
            if (b) {
                a && c.extend(this.options, a), this.listContainer = c("ul._image-items", b), this.statusContainer = c("._no-item", b), 
                this.loadingContainer = c(".loading-indicator", b);
                var d = c("#enable-auto-view"), e = c("#disable-auto-view");
                this.moreContainer = c("._button-lite-large", b).on("autoView", c.proxy(this.load, this)).on("autoViewOn", function() {
                    aa.toolbar.add(e), d.hide();
                }).on("autoViewOff", function() {
                    aa.toolbar.remove(e), d.slideDown();
                }), this.autoView = new aa.AutoView(this.moreContainer).apply();
            }
        },
        load: function() {
            var a = this, b = {
                cache: this.options.cache || 864e5
            };
            this.loadingContainer.show(), this.autoView.pause(), (this.recommendations ? c.Deferred().resolve() : aa.api.get("/rpc/recommender.php", {
                type: "illust",
                sample_illusts: aa.context.illustRecommendSampleIllust,
                num_recommendations: aa.context.illustRecommendLimit
            }, b).then(function(b) {
                return b && b.error ? (a.showStatus(b.error), c.Deferred().reject()) : (a.recommendations = b ? b.recommendations : [], 
                a.recommendations.length ? void 0 : (a.showStatus(null), c.Deferred().reject()));
            }, function(b, c, d) {
                a.showStatus(c && d ? c + ": " + d : void 0);
            })).then(function() {
                var c = a.recommendations.splice(0, a.options.count);
                return c.length ? aa.api.get("/rpc/illust_list.php", {
                    illust_ids: c.join(),
                    verbosity: ""
                }, b) : void a.loadingContainer.hide();
            }).done(function(b) {
                return !b || b.error ? void (b && b.error && a.showStatus(b.error)) : (a.loadingContainer.hide(), 
                c(p.template.apply("illust-recommend-list-item", {
                    items: b
                })).appendTo(a.listContainer), aa.scrollView.update(), void (a.recommendations.length ? a.autoView.restart() : a.completed || (c(a.moreContainer).hide(), 
                a.autoView.complete(), a.completed = !0)));
            });
        },
        showStatus: function(a) {
            var b = null === a;
            this.statusContainer.text(a || this.statusContainer.dataset(b ? "textNoItem" : "textError")).show(), 
            b || this.statusContainer.addClass("_error"), this.loadingContainer.hide(), c(this.moreContainer).remove(), 
            aa.scrollView.unregisterFilter(this.filterName);
        }
    }, aa.illustRecommendOnMemberIllust = {
        options: {
            count: 12
        },
        recommendations: null,
        container: null,
        listContainer: null,
        setup: function(a) {
            var b = this.container = c("#illust-recommend");
            b && (a && c.extend(this.options, a), this.listContainer = c("ul._image-items", b), 
            this.load());
        },
        load: function() {
            var a = this, b = {
                cache: 864e5
            };
            (this.recommendations ? c.Deferred().resolve() : aa.api.get("/rpc/recommender.php", {
                type: "illust",
                sample_illusts: aa.context.illustRecommendSampleIllust,
                num_recommendations: aa.context.illustRecommendLimit
            }, b).then(function(b) {
                return b && b.error ? c.Deferred().reject() : (a.recommendations = b ? b.recommendations : [], 
                a.recommendations.length ? void 0 : c.Deferred().reject());
            })).then(function() {
                var c = a.recommendations.splice(0, a.options.count + 10);
                return c.length ? aa.api.get("/rpc/illust_list.php", {
                    illust_ids: c.join(),
                    verbosity: ""
                }, b) : void a.loadingContainer.hide();
            }).done(function(b) {
                if (b && !b.error) {
                    for (var d = b.length - 1; d > 0; d--) {
                        var e = Math.floor(Math.random() * (d + 1)), f = b[e];
                        b[e] = b[d], b[d] = f;
                    }
                    c(p.template.apply("illust-recommend-list-item", {
                        items: b.splice(0, a.options.count)
                    })).appendTo(a.listContainer), a.container.toggleClass("hide");
                }
            });
        }
    }, aa.rating = {
        rate: 0,
        width: 26,
        height: 26,
        offset: null,
        container: null,
        ratingContainer: null,
        statusContainer: null,
        setup: function() {
            var a = this;
            aa.context.rated || (this.container = c(".score"), this.ratingContainer = c(".rating", this.container).mousemove(function(b) {
                a.update(b.pageX, b.pageY, this);
            }).mouseleave(c.proxy(this.clear, this)), aa.user.loggedIn && this.ratingContainer.click(function() {
                a.apply();
            }), this.statusContainer = c(".status", this.container));
        },
        update: function(a, b, d) {
            var e = this.ratingContainer, f = this.width, g = c(d).offset(), h = b - g.top + 1, i = Math.max(a - Math.ceil(g.left), 0) + 1, j = Math.ceil(i / f);
            if (aa.user.bitter) switch (i -= f * (j - 1), j) {
              case 1:
                j = this.slim(j, i, h, .45, .55);
                break;

              case 2:
                j = this.slim(j, i, h, .4, .6);
            }
            j !== this.rate && (e.removeClass("rate-" + this.rate).addClass("rate-" + j), this.rate = j);
        },
        clear: function() {
            this.ratingContainer.removeClass("rate-" + this.rate), this.rate = 0, this.offset = null;
        },
        slim: function(a, b, d, e, f, g, h) {
            "number" === c.type(g) || (g = e), "number" === c.type(h) || (h = f);
            var i = this.width, j = this.height;
            return b < i * e || b > i * f || d < j * g || d > j * h ? 0 : a;
        },
        apply: function(a) {
            var b, d, e, f;
            this.rate = a = a || this.rate, aa.context.rated || !a || a > 10 || (aa.api.rating(a), 
            b = this.container, d = c(".rated-count", b), e = c(".score-count", b), d.text(+d.text() + 1), 
            e.text(+e.text() + a), f = this.width, this.statusContainer.text("+" + a).css("left", f * a - f / 2).animate({
                marginTop: -20,
                opacity: 0
            }, "slow", function() {
                c(this).remove();
            }), this.ratingContainer.addClass("rated rate-" + a).unbind(), aa.context.rated = !0);
        }
    }, colon.ns("pixiv.ui", {
        updateProcesses: [ "fixed" ],
        setup: function() {
            aa.ui.tab.setup(), aa.ui.fixed.setup(), aa.ui.truncate.setup(), aa.ui.scroll.setup(), 
            aa.ui.focusSelect.setup(), aa.ui.selector.setup(), colon.ui.expander.setup(), colon.ui.Counter.setup(), 
            colon.ui.modal.setup(), colon.ui.Tag.setup(), colon.ui.toggleSwitch.setup(), colon.ua.ie && c(".ui-autofocus:last").focus();
        },
        loadContextShareButton: function(a, b) {
            c("#template-ui-context-share-button").tmpl(b).appendTo(this).filter(".twitter-share-button").each(aa.ui.shareButton.twitter).end().filter(".share-button-facebook").each(aa.ui.shareButton.facebook);
        },
        update: function(a) {
            for (var b, c = this.updateProcesses, d = 0; b = c[d]; ++d) this[b](a);
        }
    }), aa.ui.focusSelect = function(b) {
        a.setTimeout(function() {
            b.select();
        }, 0);
    }, aa.ui.focusSelect.setup = function() {
        colon.d.on("focusin", ".ui-select-all", function(a) {
            aa.ui.focusSelect(a.target);
        });
    }, colon.ns("pixiv.ui.truncate", {
        setup: function() {
            this.update();
        },
        update: function() {
            c(".ui-truncate").each(function() {
                var a = c(this), b = a.dataset();
                a.text(colon.truncate(a.text(), b.maxlength || 140));
            });
        }
    }), colon.ns("pixiv.ui.tab", {
        setup: function() {
            colon.d.on("click", ".ui-tab", c.proxy(this.open, this)).on("click", ".ui-tab-prev", c.proxy(this.prev, this)).on("click", ".ui-tab-next", c.proxy(this.next, this)), 
            this.update();
        },
        update: function() {
            var a = this;
            c(".ui-tab-container.root").each(function() {
                a.restore(this);
            });
        },
        open: function(a) {
            var b = c(a.currentTarget), d = b.siblings().addBack(), e = b.hasClass("_current"), f = b.closest(".ui-tab-container"), g = f.find("> .ui-tab-content"), h = b.dataset("target"), i = g.filter("." + h);
            return d.removeClass("_current"), g.hide().addClass("_hidden"), e && "yes" === b.dataset("toggle") || (b.addClass("_current"), 
            i.show().removeClass("_hidden"), f.trigger("uiTabUpdate", [ b, d ])), colon.lazyImage(i.filter("._lazy-image-container")), 
            f.data("saveState") && colon.storage.localStorage(this.ns + "." + colon.storage.id(f.data("name")), h, 2592e6), 
            this.restore(i.find("> .ui-tab-container")), !1;
        },
        prev: function(a) {
            var b = c(a.currentTarget).closest(".ui-tab-container"), d = c("> .ui-tabs .ui-tab", b), e = d.filter("._current").prev();
            return e.length ? e.click() : b.trigger("uiTabUpdate", [ e, d ]), !1;
        },
        next: function(a) {
            var b = c(a.currentTarget).closest(".ui-tab-container"), d = c("> .ui-tabs .ui-tab", b), e = d.filter("._current").next();
            return e.length ? e.click() : b.trigger("uiTabUpdate", [ e, d ]), !1;
        },
        restore: function(a) {
            if (a = c(a), a.length) {
                var b, d, e = a.data(), f = e.name, g = c("> .ui-tabs .ui-tab", a);
                e.saveState && f && (b = colon.storage.localStorage(this.ns + "." + colon.storage.id(f))) && (d = g.filter('[data-target="' + b + '"]')).length ? d.click() : g.filter(".default").click();
            }
        }
    }), aa.ui.fixed = {
        target: null,
        setup: function() {
            colon.w.on("scroll.uifixed", c.proxy(this.check, this)).on("resize.uifixed", c.proxy(this.resize, this)), 
            this.update();
        },
        update: function(a) {
            this.target = c(".ui-fixed", a), this.check();
        },
        check: function() {
            if (this.target.length) {
                var b = this, d = colon.w.scrollTop(), e = 0;
                this.target.each(function() {
                    var f, g, h = c(this), i = h.data("status") || "off", j = h.data("position"), k = h.parent(), l = k.parent(), m = k.outerHeight(!0), n = l.offset().top + l.innerHeight() + parseInt(l.css("border-top-width"), 10);
                    j || (j = h.data("position", h.offset().top), c(a).width() >= 640 && k.height(m)), 
                    d + e >= j ? (g = d + e + m, g > n ? (f = n - g, f * -1 > m ? b.off(h) : "on:edge" === i ? h.css("top", f) : b.on(h, f, "on:edge"), 
                    m += f) : "on" !== i && b.on(h, e)) : "off" !== i && b.off(h), e += m;
                });
            }
        },
        resize: function() {
            var a = this;
            this.target.each(function() {
                a.position(this);
            });
        },
        position: function(a) {
            a = c(a);
            var b = a.parent();
            "off" !== a.data("status") && a.css({
                left: b.offset().left,
                width: b.width()
            });
        },
        setHeight: function(a) {
            a = c(a);
            var b = a.outerHeight(!0);
            a.parent().height(b);
        },
        on: function(a, b, c) {
            a.data("status", c || "on").addClass("ui-fixed-on").removeClass("ui-fixed-paused").css("top", b), 
            this.position(a);
        },
        pause: function(a) {
            a.data("status", "paused").addClass("ui-fixed-paused");
        },
        off: function(a) {
            a.data("status", "off").removeClass("ui-fixed-on ui-fixed-paused").css({
                top: "",
                left: "",
                width: ""
            });
        }
    }, aa.ui.selector = {
        container: null,
        actions: {},
        setup: function() {
            var a = ".ui-selector";
            this.container = c(a), c("select", this.container).on("change.uiSelector", c.proxy(this.change, this));
        },
        change: function(b) {
            var d = c(b.target.options[b.target.selectedIndex]), e = d.dataset();
            return c(".current", this.container).text(d.text()), e.url ? void (a.location.href = e.url) : void (e.action && this.actions[e.action] && this.actions[e.action](d, e));
        },
        register: function(a, b) {
            this.actions[a] = b;
        },
        unregister: function(a) {
            delete this.actions[a];
        }
    }, c.fn.counter = function() {
        return this.each(function() {
            new aa.ui.Counter(this);
        });
    }, aa.ui.Counter = function(a, b) {
        b ? (this.target = c(a), this.counter = c(b)) : (this.container = c(a), this.target = c("input, textarea", a).eq(0), 
        this.counter = c(".current-count", a)), this.data = c.extend({
            limit: 140
        }, this.target.dataset()), this.target.on("keyup blur", c.proxy(this.update, this)).keyup();
    }, aa.ui.Counter.prototype = {
        container: null,
        target: null,
        counter: null,
        data: null,
        over: !1,
        update: function() {
            var a = this.target.val().length;
            this.counter.text(a), !this.over && a > this.data.limit && (this.over = !0, this.container && this.container.trigger("uiCounterOK", a), 
            this.ng()), this.over && a <= this.data.limit && (this.over = !1, this.container && this.container.trigger("uiCounterNG", a), 
            this.ok());
        },
        ok: function() {
            this.counter.removeClass("over");
        },
        ng: function() {
            this.counter.addClass("over");
        }
    }, aa.ui.form = {
        setup: h
    };
    var ca = /\s+/;
    aa.scrollView = {
        targets: null,
        doneTargets: null,
        filters: {},
        selector: ".ui-scroll-view",
        setup: function() {
            this.update();
        },
        add: function(b, d) {
            if (b = c(b, d), !b.length) return this;
            var e = this.targets, f = !!e;
            return this.targets = (f ? e.add(b) : b).not(this.doneTargets), f || this.watch(), 
            a.setTimeout(c.proxy(this.process, this)), this;
        },
        remove: function(a, b) {
            return a = c(a, b), a.length && this.targets ? (this.targets = this.targets.not(a), 
            this.targets.length || this.clear(), this) : this;
        },
        done: function(a, b) {
            return a = c(a, b), this.remove(a), this.doneTargets = this.doneTargets ? this.doneTargets.add(a) : a, 
            this;
        },
        clear: function() {
            this.unwatch(), this.targets = null;
        },
        reset: function(a) {
            return a || (a = this.selector), this.doneTargets && (this.doneTargets = this.doneTargets.not(a)), 
            this.add(a);
        },
        update: function(a) {
            this.add(a || this.selector);
        },
        watch: function(a) {
            a ? c(a).on("scroll.scroll-view", colon.throttle(this.process, this)) : colon.w.on("scroll.scroll-view resize.scroll-view", colon.throttle(this.process, this));
        },
        unwatch: function(a) {
            a ? c(a).off(".scroll-view") : colon.w.on(".scroll-view");
        },
        process: function() {
            var a = this.targets;
            if (a) {
                for (var b, c, d, e, f, g, h, i = colon.w, j = i.scrollLeft(), k = j + i.width(), l = i.scrollTop(), m = l + i.height(), n = [], o = this.filters, p = 0, q = a.length; p < q; ++p) if (b = a.eq(p), 
                h = b.data(), h && (c = h.filter, c && (g = b.offset(), g.left >= j && g.left < k && g.top >= l - 200 && g.top < m + 500))) {
                    for (d = c.split(ca), f = 0; (e = d[f]) && (!o[e] || o[e](b) !== !0); ++f) ;
                    n.push(b[0]);
                }
                this.done(n);
            }
        },
        registerFilter: function(a, b, d) {
            return b ? this.filters[a] = d ? c.proxy(b, d) : b : this.filters[a] = function(b) {
                b.triggerHandler.call(b, colon.letterCase(a, "prop"));
            }, this;
        },
        unregisterFilter: function(a) {
            return delete this.filters[a], this;
        }
    }, aa.scrollView.registerFilter("lazy-image", function(a) {
        var b = a.dataset("src");
        b && ("IMG" === a[0].nodeName ? a.attr("src", b).load(function() {
            c(this).css("opacity", 1);
        }) : a.css("background-image", "url(" + b + ")"));
    }), aa.scrollView.registerFilter("thumbnail-filter", function(a) {
        var b, d, e, f, g, h, i, j, k, l;
        if (b = aa.mute.isAvailable() ? aa.mute : aa.thumbnailFilter, b.items && b.items.length && "IMG" === a[0].nodeName && (e = a.closest("a").removeClass("thumbnail-filter-positive thumbnail-filter-negative"), 
        !b.config("disabled"))) {
            for (f = a.dataset(), i = aa.tag.parse(f.tags), k = f.userId, g = [], h = [], l = 0; j = i[l]; ++l) b.findTag("positive", j) && g.push('<li class="positive">' + colon.html.escape(j) + "</li>"), 
            b.findTag("negative", j) && h.push('<li class="negative">' + colon.html.escape(j) + "</li>");
            return b.findUser("positive", k) && g.push('<li class="positive">id:' + colon.html.escape(k) + "</li>"), 
            b.findUser("negative", k) && h.push('<li class="negative">id:' + colon.html.escape(k) + "</li>"), 
            (g.length || h.length) && (d = c(".thumbnail-filter-items", e), d.length ? d.empty() : d = c('<ul class="thumbnail-filter-items"></ul>').insertBefore(a), 
            g.length && (e.addClass("thumbnail-filter-positive"), d.append(g.join(""))), h.length) ? (e.addClass("thumbnail-filter-negative"), 
            d.append(h.join("")), a.attr("src", a.dataset("srcFiltered") || aa.sourcePath + "images/filtered.png").css("opacity", 1), 
            !0) : void 0;
        }
    }), aa.AutoView = function(b, d) {
        this.options = d = d || {};
        var e = d.scrollContext = d.scrollContext && c(d.scrollContext);
        this.target = c(b, e), d.enable ? (a.setTimeout(c.proxy(this.on, this)), this.active = !0) : (!e && !d.config && (d.config = colon.storage.config("autoView")), 
        this.active = d.config ? d.config("enabled") : d.active !== !1, this.active && a.setTimeout(c.proxy(this.on, this)));
    }, aa.AutoView.setup = function() {
        aa.scrollView.registerFilter("auto-view");
    }, aa.AutoView.prototype = {
        target: null,
        options: null,
        active: !1,
        paused: !1,
        completed: !1,
        apply: function(a) {
            return this.active && !a ? this : (aa.scrollView.reset(this.target), this);
        },
        cancel: function() {
            return aa.scrollView.done(this.target), this;
        },
        on: function() {
            var a = this.options;
            return aa.scrollView.unwatch(a.scrollContext), aa.scrollView.watch(a.scrollContext), 
            aa.scrollView.reset(this.target), this.active = !0, a.config && a.config("enabled", 1), 
            this.target.triggerHandler("autoViewOn"), this;
        },
        off: function() {
            var a = this.options;
            return aa.scrollView.unwatch(a.scrollContext), aa.scrollView.done(this.target), 
            this.active = !1, a.config && a.config("enabled", null), this.target.triggerHandler("autoViewOff"), 
            this;
        },
        restart: function() {
            return this.active ? (aa.scrollView.reset(this.target), this.paused = !1, this) : this;
        },
        pause: function() {
            return aa.scrollView.done(this.target), this.paused = !0, this;
        },
        complete: function() {
            return this.completed = !0, this.target.triggerHandler("autoViewComplete"), aa.scrollView.unwatch(this.options.scrollContext), 
            this;
        }
    }, aa.autoView = {
        handler: null,
        config: null,
        enableContainer: null,
        disableContainer: null,
        setup: i,
        terminate: j,
        enabled: function() {
            return this.config("enabled");
        },
        update: k,
        enable: l,
        disable: m,
        complete: n
    };
    var da = p.script("https://apis.google.com/js/plusone.js"), ea = p.script("//platform.twitter.com/widgets.js"), fa = {
        ja: "ja_JP",
        en: "en_US",
        fr: "fr_FR",
        ko: "ko_KR",
        ru: "ru_RU",
        th: "th_TH",
        zh: "zh_CN",
        "zh-tw": "zh_TW",
        es: "es_ES"
    }[b.documentElement.lang || "ja"], ga = p.script("//connect.facebook.net/" + fa + "/sdk.js");
    aa.ui.shareButton = {
        container: [],
        template: null,
        setup: function() {
            c('<div id="fb-root"/>').appendTo("body"), this.update();
            var a = c("ul.share-button");
            a.length && (this.template = c("#template-ui-share-container"), a.find(".weibo-button").each(o).end().find(".qq-button").each(q).end().find(".ui-share-button").click(c.proxy(this.open, this)));
        },
        update: function() {
            c(".g-plus, .g-plusone").length && this.google(), c(".twitter-share-button").length && this.twitter(), 
            c(".fb-like").length && this.facebook(), c(".qq-button").length && this.qq();
        },
        google: function() {
            da.load().done(function(b, c) {
                a.gapi && "async" === c && a.gapi.plusone.go();
            });
        },
        twitter: function() {
            ea.load().done(function(b, c) {
                a.twttr && "forward" !== c && (a.twttr.widgets && a.twttr.widgets.load(), "success" === c && a.twttr.ready(function() {
                    a.twttr.events.bind("tweet", function(a) {
                        if (a) {
                            var b = a.target && "IFRAME" === a.target.nodeName ? a.target.src : void 0;
                            aa.tracking.track([ "_trackSocial", "twitter", "tweet", b ]);
                        }
                    }), a.twttr.events.bind("click", function(a) {
                        if (a) {
                            var b = a.target && "IFRAME" === a.target.nodeName ? a.target.src : void 0;
                            aa.tracking.track([ "_trackSocial", "twitter", aa.camelize("click-" + a.region), b ]);
                        }
                    });
                }));
            });
        },
        facebook: function() {
            ga.load().done(function(b, c) {
                a.FB && "forward" !== c && (a.FB.init({
                    appId: aa.config.facebookAppId,
                    version: "v2.3",
                    xfbml: !0
                }), "success" === c && (a.FB.Event.subscribe("edge.create", function(a) {
                    aa.tracking.track([ "_trackSocial", "facebook", "like", a ]);
                }), a.FB.Event.subscribe("edge.remove", function(a) {
                    aa.tracking.track([ "_trackSocial", "facebook", "unlike", a ]);
                }), a.FB.Event.subscribe("message.send", function(a) {
                    aa.tracking.track([ "_trackSocial", "facebook", "send", a ]);
                })));
            });
        },
        weibo: o,
        qq: q,
        open: r
    }, aa.ui.modal = {
        modals: [],
        latestTrigger: null,
        blockCount: 0,
        backgroundSelector: ".ad",
        initialized: !1,
        paused: !1,
        initialize: function() {
            colon.d.on("click.modal", c.proxy(this.click, this)), colon.ui.shortcut.bind("ESC", function() {
                return this.pop(), !1;
            }, this), this.initialized = !0;
        },
        terminate: function() {
            colon.d.off("click.modal"), colon.ui.shortcut.unbind("ESC"), this.initialized = !1;
        },
        current: function(a) {
            var b = this.modals[this.modals.length - 1];
            return a ? (b || {})[a] : b;
        },
        scrollTop: function() {
            var a, b, c;
            if (this.blockCount) for (a = this.modals, c = a.length - 1; b = a[c]; --c) if (b.block) return b.target.scrollTop() - colon.w.scrollTop();
            return null;
        },
        block: function() {
            ++this.blockCount, c(this.backgroundSelector).addClass("_invisible"), c("html").addClass("no-scroll");
        },
        unblock: function() {
            this.blockCount = 0, c(this.backgroundSelector).removeClass("_invisible"), c("html").removeClass("no-scroll");
        },
        pause: function() {
            this.paused = !0;
        },
        restart: function() {
            this.paused = !1;
        },
        click: function(a) {
            var b, d;
            this.paused || (b = c(a.target), d = b.closest(".ui-modal-trigger")[0], b.hasClass("ui-modal-close") || d && d === this.latestTrigger || this.modals.length && !d && !b.closest(this.current("target")).length ? this.pop() : d && (this.latestTrigger = d));
        },
        push: function(a, b) {
            return a = c(a), this.paused ? a : (this.initialized || this.initialize(), b || (b = {}), 
            this.current("block") || this.close(), this.modals.push(c.extend({
                target: a
            }, b)), b.block && (aa.scrollView.add(".ui-scroll-view", a), aa.scrollView.watch(a), 
            this.blockCount || this.block()), a.show().trigger("uimodalopen"));
        },
        pop: function() {
            if (!this.paused) {
                var a, b = this.modals.pop();
                this.latestTrigger = null, b && (a = b.target, b.block && (aa.scrollView.remove(".ui-scroll-view", a), 
                aa.scrollView.unwatch(a), this.blockCount <= 1 && this.unblock()), b.close && b.close(a), 
                b.disposable ? a.remove() : a.hide(), a.trigger("uimodalclose"), this.modals.length || this.terminate());
            }
        },
        clear: function() {
            for (var a = this.modals.length; a--; ) this.pop();
        }
    }, aa.ui.modal.open = aa.ui.modal.push, aa.ui.modal.close = aa.ui.modal.pop, aa.ad = {}, 
    aa.ui.scroll = function(a, b) {
        var d = 0;
        if ("number" === c.type(a) ? d = a : (a = c(a), a.length && (d = a.offset().top)), 
        d) {
            var e = c("#ceiling").outerHeight();
            e && (d -= e), d = Math.max(d, 0);
        }
        var f = c(colon.ua.webkit ? "body" : "html").stop(!0, !0);
        return null === b ? (aa.ui.scroll.scrolling = !1, colon.w.scrollTop(d).promise()) : (aa.ui.scroll.scrolling = !0, 
        colon.d.on("scroll.uiscroll DOMMouseScroll.uiscroll mousewheel.uiscroll", function() {
            return !1;
        }), f.animate({
            scrollTop: d
        }, b || 800, "easeOutExpo", function() {
            colon.d.off("scroll.uiscroll DOMMouseScroll.uiscroll mousewheel.uiscroll"), aa.ui.scroll.scrolling = !1;
        }).promise());
    }, aa.ui.scroll.scrolling = !1, aa.ui.scroll.setup = function() {
        colon.d.on("click.scroll", ".ui-scroll", function(d) {
            var e, f, g, h = c(this);
            if (!h.hasClass("off")) {
                if (e = h.dataset(), f = !!e.hashLink, g = h.data("target") || h.attr("href"), f) {
                    d.preventDefault();
                    var i = a.location.hash;
                    if (i) {
                        if (i === g) return;
                        if (colon.ua.ie) {
                            var j = b.getElementById(i.slice(1));
                            j && c(j).removeClass("target"), c(g).addClass("target");
                        }
                    }
                    a.location.hash = g;
                }
                return aa.ui.scroll(g), h.trigger("uiScroll"), !1;
            }
        }), colon.w.load(function() {
            var c = a.location.hash;
            if (c) {
                var d = b.getElementById(c.slice(1));
                d && aa.ui.scroll(d);
            }
        });
    }, aa.hashParameter = function() {
        return decodeURIComponent((/#(.+)$/.exec(location.href) || [])[1] || "");
    }, aa.hashState = function(a) {
        var b;
        return null === a ? (location.hash = "#", null) : a ? (b = aa.hashState.stringify(a), 
        location.hash = b, b) : aa.hashState.parse(aa.hashParameter());
    }, aa.hashState.stringify = function(a) {
        var b, c, d = [];
        for (b in a) c = a[b], "number" != typeof c && !c || "function" == typeof c || (c === !0 ? d.push(encodeURIComponent(b)) : d.push([ encodeURIComponent(b), encodeURIComponent(a[b]) ].join("=")));
        return d.join("&");
    }, aa.hashState.parse = function(a) {
        for (var b, c, d, e, f = a.split("&"), g = 0, h = {}; b = f[g]; ++g) c = /^([^=]+)=?(.*)$/.exec(b) || [], 
        c[1] && (d = decodeURIComponent(c[1]), e = c[2] && decodeURIComponent(c[2]), e = !e || (isNaN(Number(e)) ? e : Number(e)), 
        h[d] = e);
        return h;
    }, aa.formatNumber = function(a, b) {
        b = b || 2;
        for (var c = a.toString().split(".")[0].length; c++ < b; ) a = "0" + a;
        return a;
    }, aa.supportedInlineSVG = function() {
        var a = b.createElement("div");
        return a.innerHTML = '<svg version="1.1" xmlns="http://www.w3.org/2000/svg"></svg>', 
        "http://www.w3.org/2000/svg" === a.childNodes[0].namespaceURI;
    }, aa.searchURL = function(a, b) {
        var d, e, f, g = /(https?:\/\/[-_.!~*\'()a-zA-Z0-9;\/?:\@&=+\$,%#]+)/g, h = 0;
        if (b) return b = c.makeArray(b), e = a.replace(g, function(a, c) {
            return b[h++] || c;
        });
        if (f = a.match(g), !f) return f;
        for (e = []; d = f[h]; ++h) c.inArray(d, e) === -1 && e.push(d);
        return e;
    };
    var ha = /^https?:\/\/[0-9A-Za-z-]+\.pixiv\.net(?:\/|$)/;
    aa.redirectURL = function(a) {
        return ha.test(a) ? encodeURI(a) : "/jump.php?" + encodeURIComponent(a);
    }, colon.ns("pixiv.api", {
        cache: {},
        pTl: function(a) {
            var b = {
                ajaxSettings: {
                    dataType: "jsonp"
                },
                cache: !0
            };
            return aa.api.get("http://p.tl/api/api_simple.php", {
                url: a,
                key: aa.config.pTlAPIKey
            }, b);
        },
        fetch: function(a, b) {
            return aa.api.get("/rpc/url_fetch.php", {
                url: a,
                size: b
            }, {
                cache: 864e5
            });
        },
        follow: function(a, b, c) {
            return aa.api.post("/bookmark_add.php", {
                mode: "add",
                type: "user",
                user_id: a,
                tag: c,
                restrict: +b || 0,
                format: "json"
            });
        },
        unfollow: function(a) {
            return aa.api.group_old.remove("bookuser", a);
        },
        user: function(a, b, c) {
            var d = isNaN(a) ? (/id=(\d+)/.exec(a) || [])[1] : a;
            return aa.api.get("/rpc/user_fetch.php", {
                id: d,
                size: b,
                options: c.join()
            }, {
                cache: 6e4
            });
        },
        suggest: function(a) {
            return aa.api.get("/rpc/cps.php", {
                keyword: a
            }, {
                cache: 864e5
            });
        },
        rating: function(a) {
            var b = {
                mode: "save",
                i_id: aa.context.illustId,
                u_id: aa.user.id,
                qr: +aa.context.hasQuestionnaire,
                score: a
            };
            return aa.api.post("./rpc_rating.php", b);
        },
        questionnaire: function(a) {
            var b = {
                mode: "save2",
                i_id: aa.context.illustId,
                u_id: aa.user.id,
                qr: +aa.context.hasQuestionnaire,
                num: a
            };
            return aa.api.post("./rpc_rating.php", b);
        },
        userRecommendation: function(a, b, c) {
            return aa.api.recommender.request("user", {
                sample_users: a,
                num_recommendations: b || 10,
                following_booster_model: c || 1
            });
        },
        recommender: {
            request: function(a, b) {
                return aa.api.get("/rpc/recommender.php", c.extend({
                    type: a
                }, b));
            },
            user: function(a, b, c) {
                return aa.api.recommender.request("user", {
                    sample_users: a,
                    num_recommendations: b || 10,
                    nc: Number(c) || 0
                });
            },
            hideUser: function(a) {
                return aa.api.post("/rpc/recommender.php", {
                    type: "user",
                    op: "hide",
                    ignore_user_id: a
                });
            }
        },
        group_old: {
            request: function(a, b, d, e) {
                return aa.api.post("/rpc_group_setting.php", c.extend({
                    mode: a,
                    type: b,
                    id: d
                }, e));
            },
            getMyPixivList: function() {
                return aa.api.group_old.getList("mypixiv");
            },
            getFavoriteList: function() {
                return aa.api.group_old.getList("bookuser");
            },
            getList: function(a, b) {
                return aa.api.get("/rpc_group_setting.php", c.extend({
                    mode: "get",
                    type: a,
                    id: aa.user.id
                }, b));
            },
            removeMyPixiv: function(a) {
                return aa.api.group_old.remove("mypixiv", a);
            },
            removeFavorite: function(a) {
                return aa.api.group_old.remove("bookuser", a);
            },
            remove: function(a, b) {
                return aa.api.group_old.request("del", a, b);
            }
        },
        event: {
            stash: {},
            request: function(a, b, c) {
                return aa.api.post("/event_add.php", {
                    mode: a,
                    type: b,
                    id: c
                });
            },
            deleteImage: function(a, b) {
                return aa.api.event.request("delete_img", a, b);
            },
            calendar: function(a, b) {
                return aa.api.post("/rpc_event_calendar.php", {
                    y: a,
                    m: colon.padding(b)
                }, {
                    cache: aa.api.event.stash
                });
            }
        },
        validation: {
            signup: function(a) {
                return "string" === c.type(a) && (a = p.parseQuery(a)), c.extend(a, {
                    mode: "validation"
                }), aa.api.get("/signup.php", a, {
                    cache: aa.api.cache
                });
            },
            email: function(a) {
                return aa.api.get("/setting_mail_address.php", {
                    mode: "validation",
                    mail_address: a
                }, {
                    cache: aa.api.cache
                });
            },
            illustId: function(a) {
                return aa.api.get("/rpc/setting_showcase_illust.php", {
                    action: "illust_check",
                    illust: a
                }, {
                    cache: aa.api.cache
                });
            }
        },
        bookmarkTag: function(a) {
            return a || (a = "illust"), aa.api.get("/rpc/" + a + "_bookmark_tags.php", {
                attributes: c.makeArray(arguments).slice(1).join().replace("level", "lev") || "none"
            }, {
                cache: aa.api.cache
            });
        }
    }), aa.Validator = function(a, b, d) {
        this.container = c(a).submit(c.proxy(this.submit, this)), this.done = b, this.fail = d;
        var e = c.proxy(this.validate, this), f = c('select.validation-target, .validation-target[type="radio"], .validation-target[type="checkbox"]', a).on("click change", e).first().change().end();
        c(".validation-target", a).not(f).keyup(c.proxy(this.clear, this)).keyup(colon.debounce(this.validate, this, 500)).blur(e);
    }, aa.Validator.prototype = {
        container: null,
        done: null,
        fail: null,
        validate: function(a) {
            var b = this;
            ("keyup" !== a.type || a.target.value) && aa.api.validation.signup(this.container.serialize()).done(function(c) {
                c && b.done && b.done.call(b, a, c.errors);
            }).fail(function(c, d, e) {
                b.fail && b.fail.call(b, a, c, d, e);
            });
        },
        ok: function(a) {
            c(a).closest("dd").removeClass("has-error").find(".validation-ok").show();
        },
        ng: function(a, b) {
            c(a).closest("dd").addClass("has-error").find(".validation-error p").text(b).end().find(".validation-ok").hide();
        },
        clear: function(a) {
            c(a.target).closest("dd").removeClass("has-error").find(".validation-ok").hide();
        },
        submit: function() {
            var a = c(".validation-error", this.container).filter(":visible").length;
            return a && alert(this.container.dataset("textFail")), !a;
        }
    }, aa.Validation = function(a) {
        a = this.container = c(a).submit(c.proxy(this.submit, this)), this.submitButton = c(".submit-container .submit", a);
        var b = c.proxy(this.validate, this), d = c('select.validation-target, .validation-target[type="radio"], .validation-target[type="checkbox"]', a).on("click change", b);
        c(".validation-target", a).not(d).keyup(colon.debounce(this.validate, this, 500)).blur(b).keypress(function(a) {
            13 === a.which && b(a);
        });
    }, aa.Validation.setup = function() {
        c(".validation-form").each(function() {
            new aa.Validation(this);
        });
    }, aa.Validation.prototype = {
        container: null,
        submitButton: null,
        frozen: !1,
        type: {
            required: function(a) {
                return !!c.trim(a.val()) || aa.text.validationFailRequired;
            },
            email: function(a) {
                return /^.+@.+\.\w+$/.test(a.val()) || aa.text.validationFailEmail;
            },
            emailAsync: function(a) {
                return aa.api.validation.email(a.val()).then(function(a) {
                    return a && a.errors && a.errors.mail_address ? a.errors.mail_address : null;
                });
            }
        },
        ok: function(a) {
            c(a).closest("dd").removeClass("has-error").find(".validation-ok").show(), this.ready() && this.enable();
        },
        ng: function(a, b) {
            c(a).closest("dd").addClass("has-error").find(".validation-error .text").text(b).end().find(".validation-ok").hide(), 
            this.disable();
        },
        enable: function() {
            this.submitButton.prop("disabled", !1);
        },
        disable: function() {
            this.submitButton.prop("disabled", !0);
        },
        clear: function(a) {
            c(a).closest("dd").removeClass("has-error").find(".validation-ok").hide();
        },
        validate: function(a) {
            var b, d, e, f, g = this, h = c(a.target);
            if ("keyup" !== a.type || c.trim(h.val())) {
                b = h.closest("dd"), d = (h.dataset("type") || "").split(/\s+/);
                for (var i = 0; (e = d[i]) && (f = this.type[aa.camelize(e)](h), f === !0); ++i) ;
                if (f && f.promise) return void f.done(function(a) {
                    a && !g.frozen ? g.ng(h, a) : g.ok(h);
                });
                switch (f) {
                  case void 0:
                    return;

                  case !0:
                    this.ok(h);
                    break;

                  default:
                    return void this.ng(h, f);
                }
            }
        },
        ready: function() {
            return !c(".has-error", this.container).length;
        },
        freeze: function() {
            this.container.off(), c("select, input, button", this.container).off(), this.frozen = !0;
        },
        submit: function() {
            if (this.container.hasClass("require-password") && c("#password-confirm").is(":hidden")) return aa.ui.modal.open("#password-confirm", {
                block: !0
            }), this.freeze(), !1;
        }
    }, aa.toolbar = {
        container: null,
        timer: null,
        setup: function() {
            this.container = c("#toolbar-items");
        },
        add: function(a) {
            this.container || this.setup(), this.container.find(a).length || a.appendTo(this.container), 
            a.show();
        },
        remove: function(a) {
            this.container && a.animate({
                height: 0,
                marginTop: a.outerHeight(!0)
            }, function() {
                a.css({
                    display: "none",
                    height: "",
                    marginTop: ""
                });
            });
        },
        scroll: function() {
            this.debounce || (this.debounce = colon.debounce(function() {
                this.container.show(), this.debounce = null;
            }, this, 150), this.container.hide()), this.debounce();
        }
    }, aa.questionnaire = {
        container: null,
        listContainer: null,
        statsContainer: null,
        setup: function() {
            var a, b = this;
            if (aa.context.hasQuestionnaire) {
                a = this.container = c(".questionnaire");
                var d = this.listContainer = c(".list", a), e = this.statsContainer = c(".stats", a), f = a.closest(".ui-expander-container").on("collapse", function() {
                    e.add(d).removeClass("visible");
                }).find(".expand");
                a.on("click", ".toggle-stats", function() {
                    e.hasClass("visible") ? e.removeClass("visible") : (e.addClass("visible"), f.click());
                }), aa.context.answered === !1 && a.on("click", ".toggle-list", function() {
                    d.hasClass("visible") ? d.removeClass("visible") : (d.addClass("visible"), f.click());
                }).on("click", "input", function(a) {
                    b.answer(c(a.target).dataset("key")), b.listContainer.toggleClass("visible");
                });
            }
        },
        answer: function(a) {
            var b = this;
            aa.api.questionnaire(a).done(function(d) {
                c(".status", b.container).replaceWith(p.template.apply("questionnaire-result", d));
                var e = c(".answer-" + a, b.statsContainer);
                e.text(+e.text() + 1), b.listContainer.removeClass("visible");
            });
        }
    }, aa.ui.Selectbox = function(a, b) {
        this.container = a = c(a), this.labelContainer = c("> div, .label", a), this.itemContainer = c("> ul, .items", a), 
        this.options = b || {}, this.options.sensitive ? this.container.on("mouseenter mouseleave", c.proxy(this.toggle, this)) : this.labelContainer.click(c.proxy(this.toggle, this)), 
        this.container.on("click", "li:not(.selected)", c.proxy(this.select, this));
    }, aa.ui.Selectbox.prototype = {
        options: null,
        container: null,
        labelContainer: null,
        itemContainer: null,
        toggle: function() {
            this.itemContainer.is(":visible") ? aa.ui.modal.pop() : aa.ui.modal.push(this.itemContainer);
        },
        select: function(b) {
            if (!(b.isDefaultPrevented() || this.options.select && this.options.select(b) === !1)) {
                var d = c(b.target);
                aa.ui.modal.pop(), this.labelContainer.text(d.text() + " ▾");
                var e = d.dataset();
                e.url && (a.location.href = e.url), this.itemContainer.removeClass("selected"), 
                d.addClass("selected");
            }
        }
    }, aa.ui.Tag = x, aa.ui.Tag.split = s, aa.ui.Tag.find = t, aa.ui.Tag.match = u, 
    aa.ui.Tag.normalize = v, aa.ui.Tag.trim = w;
    var ia = /[\s\xA0　]+/, ja = /^"(.+)"$/, ka = /^[\s\xA0　]+/, la = /[\s\xA0　]+$/;
    aa.ui.Tag.prototype = {
        target: null,
        options: null,
        recentValue: "",
        container: null,
        tagsContainer: null,
        countContainer: null,
        input: null,
        tags: null,
        template: [ '<div class="ui-tag-container">', '<ul class="tags">', '{{each tags}}<li data-tag="{{= $value}}">{{= $value}}<span class="close">×</span></li>{{/each}}', "</ul>", '<input type="text" value="">', '<div class="count"><span class="count{{if tags.length > maxCount}} over{{/if}}">{{= tags.length}}</span>/{{= maxCount}}</div>', "</div>" ].join(""),
        itemTemplate: '<li data-tag="{{= tag}}">{{= tag}}<span class="close">×</span></li>',
        value: y,
        make: z,
        update: A,
        updateCount: B,
        add: C,
        remove: D
    }, aa.tag = {
        maxCount: 10,
        over: !1,
        input: null,
        tags: null,
        errorContainer: null,
        countContainer: null,
        setup: E,
        parse: F,
        inArray: G,
        toggle: H,
        update: I,
        verify: function() {
            var a = this.parse(this.input.val()), b = a.length;
            b > this.maxCount ? this.over || (this.over = !0, this.errorContainer.show(), this.countContainer.css("color", "#ff0000")) : this.over && (this.over = !1, 
            this.errorContainer.hide(), this.countContainer.css("color", "")), this.countContainer && this.countContainer.text(b);
        },
        match: J
    }, aa.follow = {}, aa.follow.setting = {
        target: null,
        id: null,
        initialized: !1,
        container: null,
        initialize: function() {
            var a, b, d = this;
            return !this.initialized && (this.initialized = !0, a = this.container.on("submit", ".action-follow", c.proxy(this.follow, this)).on("click", ".action-unfollow", c.proxy(this.unfollow, this)), 
            void (aa.user.premium && (b = new aa.LoadingIndicator(a), aa.api.userFolder(aa.user.id).done(function(a) {
                var c, e = [];
                for (c in a.tag_a) e.push(c);
                d.folders = e, d.updateFolder(), b.finish();
            }))));
        },
        newFolder: function() {
            var b, d = a.prompt(aa.text.specifyFolderName);
            d && (d = d.replace(/\s+/g, ""), d && (this.folders.push(d), this.folders.sort(), 
            b = c.inArray(d, this.folders), b = b === -1 ? 1 : b + 1, c(this.folderItem(d)).insertAfter(c("option", this.container).eq(b)).prop("selected", !0)));
        },
        folderItem: function(a) {
            "array" !== c.type(a) && (a = [ a ]);
            for (var b, d = [], e = 0; b = a[e]; ++e) b = colon.html.escape(b), d[e] = '<option value="' + b + '">' + b + "</option>";
            return d.join("");
        },
        updateFolder: function() {
            var a = this;
            c("select", this.container).append(this.folderItem(this.folders)).change(function() {
                "new" === this.value && 1 === this.selectedIndex && a.newFolder();
            }).prop("disabled", !1);
        },
        follow: function(a) {
            var b = c(a.target);
            return aa.api.follow(this.id, c('input[name="restrict"]:checked', b).val(), c("select", b).val()).done(function() {
                aa.ProfileCard.folderCache && aa.ProfileCard.folderCache(null);
            }), this.target.trigger("followed"), this.close(), !1;
        },
        unfollow: function() {
            aa.api.unfollow(this.id), this.target.trigger("unfollowed"), this.close();
        },
        open: function(a) {
            var b = this.target = c(a.currentTarget), d = b.offset(), e = colon.ui.modal.scrollTop() || 0, f = this.initialized;
            this.id = b.dataset("id"), this.initialized || (this.container = c(".follow-setting-modal"), 
            this.initialize()), colon.ui.modal.push(this.container), c(this.container).css({
                top: e + d.top + b.outerHeight() + 2,
                left: d.left
            }).find(".contents").html(p.template.apply("follow-setting", {
                following: b.hasClass("following")
            })), f && this.updateFolder();
        },
        close: function() {
            colon.ui.modal.pop();
        }
    }, aa.Favorite = function() {}, aa.Favorite.prototype = {
        _name: "group_old",
        name: "favorite",
        type: "bookuser",
        preference: null,
        button: null,
        groups: null,
        initialize: function() {
            this.preference = c("#favorite-preference"), this.button = c("#favorite-button").click(c.proxy(this.toggle, this));
        },
        toggle: function() {
            return this.preference.is(":visible") ? this.close() : this.open(), !1;
        },
        open: function() {
            aa.screen.close(this), this.groups || this.initializePreferenceContainer(), this.preference.show();
            var a = this.button;
            a.hasClass("added") && this.button.addClass("open");
        },
        initializePreferenceContainer: function() {
            var a = this, b = this.preference;
            aa.screen.register(this), c("div.close", b).click(c.proxy(this.close, this)), c("input.remove", b).click(c.proxy(this.remove, this)), 
            aa.user.premium && (c("select", b).change(function() {
                "new" === this.value && 1 === this.selectedIndex && a.addGroup();
            }), aa.api[this._name].getList(a.type).done(function(d) {
                var e, f = d.tag_a;
                if (c.isArray(f)) e = f; else {
                    e = [];
                    for (var g in f) e.push(g);
                }
                a.groups = e, c("select", b).append(a.makeGroup(e)).parent().removeClass("loading").end().prop("disabled", !1);
            }));
        },
        makeGroup: function(a) {
            c.isArray(a) || (a = [ a ]);
            for (var b, d = [], e = 0; b = a[e]; ++e) b = colon.html.escape(b), d[e] = '<option value="' + b + '">' + b + "</option>";
            return d.join("");
        },
        addGroup: function() {
            var b = a.prompt("新規フォルダ名を指定してください");
            if (b && (b = c.trim(b.replace(/ +/g, "")))) {
                this.groups.push(b), this.groups.sort();
                var d = c.inArray(b, this.groups);
                d = d === -1 ? 1 : d + 1, c(this.makeGroup(b)).insertAfter(c("option", this.preference).eq(d)).prop("selected", !0);
            }
        },
        close: function() {
            return this.preference.hide(), this.button.removeClass("open"), !1;
        },
        add: function() {},
        remove: function() {
            aa.api[this._name].remove(this.type, aa.context.userId), this.removed();
        },
        removed: function() {
            var a = this.button;
            a.removeClass("following").addClass("follow").find(".text").text(this.button.dataset("textFollow")), 
            c("form", this.preference).attr("action", "/bookmark_add.php").append('<input type="hidden" name="mode" value="add">').find("input.remove").remove(), 
            this.close();
        }
    }, aa.search = {
        optionContainer: null,
        setup: K,
        parseSizeOption: L,
        parseDateOption: M,
        dateSelector: O,
        sizeSelector: P,
        ratioSelector: Q,
        toolSelector: R,
        orderSelector: N,
        openOption: S,
        submit: T
    };
    var ma = !1;
    aa.MyPixiv = function() {}, aa.MyPixiv.prototype = c.extend(new aa.Favorite(), {
        name: "mypixiv",
        type: "mypixiv",
        initialize: function() {
            this.preference = c("#mypixiv-preference"), this.button = c("#mypixiv-button"), 
            aa.context.myPixiv && this.button.click(c.proxy(this.toggle, this));
        },
        removed: function() {
            c("#mypixiv-button").removeClass("added").attr("title", "マイピク申請"), this.button.unbind("click"), 
            this.close();
        }
    }), aa.Popup = function(a) {
        this.context = a, c(".trigger", a).click(c.proxy(this.toggle, this));
    }, aa.Popup.setup = function() {
        c(".popup").each(function() {
            new aa.Popup(this);
        });
    }, aa.Popup.prototype = {
        context: null,
        container: null,
        load: function() {
            this.container = c(".container", this.context).find(".close").click(c.proxy(this.close, this)).end(), 
            aa.screen.register(this);
        },
        toggle: function() {
            return this.container || this.load(), this.container.is(":visible") ? this.close() : this.open();
        },
        open: function() {
            aa.screen.close(this);
            var a = this.container.show().find(":text, textarea")[0];
            return a && a.focus(), "function" == typeof this.openComplete && this.openComplete(), 
            !1;
        },
        openComplete: null,
        close: function() {
            return this.container.hide(), "function" == typeof this.closeComplete && this.closeComplete(), 
            !1;
        },
        closeComplete: null
    }, aa.verification = function(a, b, d) {
        if (a) {
            b || (b = ".verification"), d = d ? c(d) : colon.d;
            var e = aa.camelize("verification-" + a);
            return aa.verification.add(a), {
                assign: function(f) {
                    d.on("click." + e, b, function() {
                        var b = {};
                        b[a] = "function" === c.type(f) ? f() : f, p.updateURL(this, b);
                    });
                },
                cancel: function() {
                    d.off("click." + e);
                }
            };
        }
    }, c.extend(aa.verification, {
        keys: [],
        add: function() {
            var a, b, d, e = aa.verification, f = c.makeArray(arguments);
            for (b = 0, d = f.length; b < d; ++b) a = f[b], c.inArray(a, e.keys) === -1 && e.keys.push(a);
            return e;
        },
        clear: function() {
            var a, b, c, d = aa.verification, e = d.keys;
            if (e.length) {
                for (a = {}, b = 0, c = e.length; b < c; ++b) a[e[b]] = null;
                return p.updateQuery(a, !0), d;
            }
        }
    }), aa.setting = {
        toggle: U
    }, aa.logOutLanguage = {
        set: function(a) {
            colon.storage.cookie("user_language", a, {
                expires: 5184e6,
                domain: ".pixiv.net"
            });
        }
    }, aa.logOnLanguage = {
        set: function(a) {
            return aa.api.post("/rpc_language_setting.php", {
                mode: "set",
                user_language: a
            }), !0;
        },
        reload: function(b) {
            this.set(b), a.setTimeout(function c() {
                p.logOnLanguage.set(b) ? location.reload() : a.setTimeout(c, 100);
            }, 100);
        }
    }, aa.hideTopInfo = {
        remove: W,
        hide: X,
        find: Y,
        update: Z
    }, aa.searchTutorialModal = {
        show: $,
        hide: _
    }, colon.ns("pixiv.tagEditor", {
        tags: null,
        container: "#tag-editor",
        tagContainer: ".work-tags",
        show: function(a) {
            this.tags = a.tags;
            var b = c(this.container).html(a.html);
            b.is(":hidden") && (c(this.tagContainer).slideUp("fast"), b.slideDown("fast"));
        },
        update: function() {
            this.tags && c(this.tagContainer + " .tags-container").html(p.template.apply("work-tags", {
                tags: this.tags
            })), this.tags = null;
        }
    }), c.extend(aa.page, {
        signup: function() {
            var a = [ "pixiv_id", "user_name", "mail_address", "password", "password_again", "sex", "birthday_year", "birthday_month", "birthday_day", "user_language" ];
            new aa.Validator("#signupForm1", function(b, d) {
                var e, f = b.target, g = f.name;
                if (g) {
                    0 === g.indexOf("birthday") && c(f).nextAll(".validation-ok").is(":visible") && d && d.birthday && this.ng(f, d.birthday);
                    for (var h, i = 0; h = a[i]; ++i) e = 0 === h.indexOf("birthday") ? "birthday" : h, 
                    e === g && d && d[e] && this.ng(f, d[e]), (!d || !d[e]) && this.ok(c('*[name="' + h + '"]', this.container));
                }
            });
        },
        work: function() {
            aa.rating.setup(), aa.questionnaire.setup(), c("._comment-form").length ? aa.comment.setup() : aa.comments.setup(), 
            aa.embed.setup(), aa.illustRecommendOnMemberIllust.setup({
                count: 3
            }), "bookmark" === aa.context.queries.action && aa.bookmarkModal.open();
            var a = c(".tag-container .tag-cloud"), b = a.find(".tag-orig");
            b.remove();
            var d = b.dataset("tag");
            a.find("li").each(function() {
                var a = c(this);
                if (a.children("span").dataset("tag") === d) return b = a, a.remove(), !1;
            }), a.prepend(b);
        },
        search: function() {
            aa.search.setup(), V();
        },
        content_upload: function() {
            var b = c(".settings");
            b.find(".has-options input").click(function() {
                aa.ui.toggleState(c(this).closest(".has-options").next());
            }).each(function() {
                var a = c(this);
                a.is(":checked") && a.triggerHandler("click");
            }).end().find("input").click(function() {
                var a = c(this), d = c(".rating-explicit-target", b), e = d[0].disabled;
                a.hasClass("rating-explicit") ? !e && c(".rating-explicit", b).filter(":checked").length && d.prop("disabled", !0).last().prop("checked", !0).end().parent().addClass("disabled") : e && a.hasClass("rating-general") && d.prop({
                    disabled: !1,
                    checked: !1
                }).parent().removeClass("disabled");
            }), c("#form-upload").submit(function() {
                return c('*[name="tag[]"]', this).length && !aa.ui.Tag.trim(c('*[name="tag[]"]', this).val()) || !c("*[name=x_restrict_sexual]", this).filter(":checked").length || c("*[name=sexual]", this).not(":disabled").length && !c("*[name=sexual]", this).filter(":checked").length ? (a.alert(aa.text.requiredError), 
                !1) : !!a.confirm(aa.text.uploadConfirm) && void c(".submit", this).prop("disabled", !0).addClass("disabled");
            });
            var d = c(".files tbody");
            d.length && c(".add-file-input").click(function() {
                var a, b = +c("tr:last-child input", d).attr("name").slice(4), e = [];
                for (a = 1; a <= 5; ++a) e[a] = p.template.apply("file", {
                    page: b + a
                });
                d.append(e.join(""));
            });
        },
        novel_upload: function() {
            aa.tag.setup(), c("#view_tag0, #category_tags").on("click", ".tag", function() {
                return aa.tag.toggle(c(this).dataset("tag")), !0;
            });
        },
        ranking: function() {
            aa.ranking.setup(), colon.d.on("click", ".rank h1 a", function() {
                aa.tracking.event("ranking", "rank-3", c(this).attr("href").slice(1));
            }).on("uimodalopen", ".share ul", function() {
                aa.tracking.event("ranking", "openShare", c(this).dataset("rank"));
            }).on("uimodalopen", ".info-modal", function() {
                aa.tracking.event("ranking", "openShare-3", c(this).dataset("rank"));
            });
        },
        bookmark: function() {
            aa.illustRecommend.setup();
        },
        bookmark_detail: function() {
            aa.illustRecommend.setup({
                count: 15
            });
        },
        "*/bookmark_add": function() {
            aa.illustRecommend.setup({
                count: 15
            }), aa.bookmarkTag.setup(".tag-cloud-container"), c(".ui-counter").counter();
            var a = c(".tag-container .tag-cloud"), b = a.find(".tag-orig");
            b.remove();
            var d = b.dataset("tag");
            a.find("li").each(function() {
                var a = c(this);
                if (a.children("span").dataset("tag") === d) return b = a, a.remove(), !1;
            }), a.prepend(b), c(".layout-body").on("click", ".tag", function() {
                return aa.tag.toggle(c(this).dataset("tag")), !1;
            }), aa.tag.setup();
        },
        recommended: function() {
            aa.illustRecommend.setup({
                count: 12,
                cache: 3e4
            });
        },
        setting_user: function() {
            c("input.ui-tag").each(function() {
                new aa.ui.Tag(this, {
                    maxCount: 20
                });
            });
            var a = c("#over-18"), b = c("#enable-thumbnail-filter");
            a.prop("checked") && a.click(), b.prop("checked") && b.click();
        },
        event_member: function() {
            aa.myList.setup();
        },
        ranking_log: function() {
            aa.rankingCalendar.setup();
        },
        event: function() {
            a.load_calendar(aa.context.year, aa.context.month);
        },
        "novel/preview": function() {
            c(".insert-marker")[0].disabled = c(".body-marker")[0].disabled = !0, c(".after-read")[0].style.display = "none";
            var b;
            try {
                b = a.opener.document;
            } catch (a) {}
            if (b) {
                var d = b.getElementsByName("title");
                if (d && d[0]) {
                    var e = d[0].value;
                    c(".novel-headinfo > .title")[0].textContent = e;
                }
                var f = b.getElementsByName("view_mode");
                if (f && f[0]) {
                    var g = f[0].value;
                    aa.context.serialized_value = JSON.stringify({
                        view_mode: g
                    });
                }
                var h = b.getElementById("novel_text") && b.getElementById("novel_text").value;
                if (h) {
                    var i = c(".novel-content")[0];
                    i.dataset.userid = aa.context.userId;
                    var j = b.getElementsByName("id");
                    if (j && j[0]) {
                        var k = j[0].value;
                        i.dataset.workid = k;
                    }
                    var l = b.getElementsByName("restrict");
                    if (l && l[0]) {
                        var m = l[0].value;
                        i.dataset.permission = m;
                    }
                    var n = b.getElementsByName("x_restrict");
                    if (n && n[0]) {
                        var o = n[0].value;
                        i.dataset.explicit = o;
                    }
                    return void (c("#novel_text")[0].value = h);
                }
            }
            c("#novel_text")[0].value = "本文が取得できませんでした。\nこのウィンドウを閉じて、本文入力ページからもう一度プレビューを実行してください。";
        },
        "group/create": function() {
            new aa.group.Create();
        },
        group: function() {
            aa.group && aa.group.setup();
        },
        setting_access_block: function() {
            var a = c("#add-user-container");
            a.length && c(".input-block-user").focus(function() {
                c(this).keydown();
            }).click(function() {
                return !1;
            }).keydown(colon.debounce(function() {
                var b = aa.ui.Tag.trim(c(this).val());
                b && aa.api.user(b, "s", [ "access_blocking" ]).done(function(b) {
                    return b ? (a.is(":hidden") && aa.ui.modal.open(a), void c("ul", a).empty().html(p.template.apply("block-user", b))) : void a.hide();
                }).fail(function() {
                    a.hide();
                });
            }, null, 500));
        },
        authentication_request: function() {
            colon.storage.cookie("show_welcome_modal", "1", {
                expires: 864e5
            });
            var a = ".one_column>div";
            c(a).css({
                "background-color": "#ffffcc"
            }), setTimeout(function() {
                c(a).css({
                    "background-color": "#ffffff"
                }), setTimeout(function() {
                    c(a).css({
                        "background-color": "#ffffcc"
                    }), setTimeout(function() {
                        c(a).css({
                            "background-color": "#ffffff"
                        });
                    }, 200);
                }, 200);
            }, 200);
        },
        welcome: function() {
            colon.storage.cookie("show_welcome_modal", "1", {
                expires: 864e5
            });
        },
        premium: function() {
            c(".premium-lp__payment-types input").change(function() {
                var a = c(this).dataset("payment-type");
                c(".premium-lp__premium-register-buttons .premium-lp__premium-register-button:not(.hidden)").addClass("hidden"), 
                c('.premium-lp__premium-register-buttons .premium-lp__premium-register-button[data-payment-type="' + a + '"]').removeClass("hidden");
            });
        },
        notify_all: function() {
            var a = aa.context.notificationItems;
            a && new aa.Notification("all").create(a, !0);
        },
        userRecommendation: function() {
            aa.userRecommend.setup();
        },
        userSearch: function() {
            aa.userSearch.setup();
        }
    }), aa.setup();
}(this, document, jQuery), function() {
    "use strict";
    colon.ns("pixiv", {
        transparentImage: pixiv.sourcePath + "images/common/transparent.gif"
    });
}.call(this), window.require = function(a) {
    "use strict";
    switch (a) {
      case "pixiv":
        return window.pixiv;

      case "colon":
        return window.colon;

      case "jquery":
        return window.jQuery;
    }
}, jQuery(function(a) {
    "use strict";
    function b(a, b, c) {
        throw "undefined" == typeof b && (b = ""), "undefined" == typeof c && (c = ""), 
        new Error("Assertion Failed: " + a + ", " + b + ", " + c);
    }
    function c(a, b, c) {
        throw new Error("Assertion Failed: " + a + ", " + b + " != " + c);
    }
    function d() {
        var c = [];
        return a('iframe[src^="http://d.pixiv.org/show"]').each(function() {
            var d, e, f = a(this).attr("src");
            return /zone_id=([^&]+)/.test(f) ? d = RegExp.$1 : b("zone_idが取得できない"), /segments=([^&]+)/.test(f) ? e = RegExp.$1 : b("segmentが取得できない"), 
            "click" === d && "jack2" === e || void c.push({
                zone: d,
                segment: e
            });
        }), c;
    }
    setTimeout(function() {
        function e(b, c) {
            var d = a.isArray(c) ? a.inArray(b, c) !== -1 : b === c;
            return d;
        }
        function f(a, b) {
            for (var c = 0; c < b.length; c++) if (e(a, b[c][0])) return void b.splice(c, 1);
        }
        function g(a, b, c, d) {
            for (var f = 0; f < d.length; f++) if (e(c, d[f][0])) return void d.splice(f, 1, [ a, b ]);
        }
        function h(b, d, f) {
            var g = " (" + d + ")", h = 0;
            a.each(b, function(a, b) {
                for (;a + h < f.length - 1 && !e(b.zone, f[a + h][0]); ) h++;
                a += h, a >= f.length && c("広告の数、またはzoneが不正" + g + " " + a, null, b.zone), e(b.zone, f[a][0]) || c("zoneが不正" + g + " " + a, f[a][0], b.zone), 
                e(b.segment, f[a][1]) || c("segmentが不正" + g + " " + a + " " + f[a][0], f[a][1], b.segment);
            }), b.length < f.length - h.length && c("広告の数が不正" + g, f.length - h.length, b.length);
        }
        function i(b) {
            var c = [ [ [ z, t ], C ], [ y, C ], [ x, H ], [ [ B, t ], C ], [ u, C ], [ [ A, t ], C ], [ [ v, t ], C ], [ [ w, t ], C ] ];
            if (q) {
                b += ":abroad", g([ v, t ], D, v, c), g([ w, t ], D, w, c);
                var d = E;
                "zh" === p ? d = G : "zh-tw" === p && (d = F), g(B, d, B, c);
            } else r && s ? (b += ":female", g([ v, t ], J, v, c)) : "1" === a.cookie("a_type") && (b += ":illustup", 
            g([ v, t ], H, v, c));
            h(K, b, c);
        }
        function j(b) {
            var c = [ [ [ z, t ], C ], [ x, H ], [ u, C ], [ A, C ], [ [ v, t ], C ], [ [ w, t ], C ] ];
            q ? (b += ":abroad", f(A, c), g([ v, t ], D, v, c), g([ w, t ], D, w, c)) : r && s ? (b += ":female", 
            g([ v, t ], J, v, c)) : "1" === a.cookie("a_type") && (b += ":illustup", g([ v, t ], H, v, c)), 
            h(K, b, c);
        }
        function k(b) {
            a('script[data-name="info-layout"][data-value="spotlight"]').length || h(K, b, [ [ u, C ], [ x, H ], [ [ v, t ], I ], [ [ w, t ], I ] ]);
        }
        function l() {
            var a = "mypage";
            i(a);
        }
        function m() {
            var a = "novel_index";
            j(a);
        }
        function n() {
            var a = "info";
            k(a);
        }
        if ("pixiv" in window) {
            var o = function() {
                return "user" in pixiv && "loggedIn" in pixiv.user || b("ログイン状態が取得できない"), pixiv.user.loggedIn;
            }(), p = a("html").attr("lang"), q = function() {
                return p || b("言語設定が取得できない"), "ja" !== p;
            }(), r = function() {
                return "user" in pixiv && "gender" in pixiv.user && "female" === pixiv.user.gender;
            }(), s = function() {
                return !!a('noscript[data-female-ad-term="running"]').get(0);
            }(), t = {
                toString: function() {
                    return "NONE";
                }
            }, u = "branding", v = "header", w = "footer", x = "click", y = "left_comic", z = "logo_side", A = "branding_under", B = "top_info", C = "noseg", D = "abroad", E = "abroad_en", F = "abroad_han", G = "abroad_kan", H = "jack1", I = "gray", J = "female", K = d();
            a("one_column_body .errorArea").get(0) || ("/" === location.pathname && pixiv.user && pixiv.user.id ? l() : "/novel/" === location.pathname || "/novel/index.php" === location.pathname ? o && m() : 0 === location.pathname.indexOf("/info.php") && n());
        }
    }, 500);
}), function(a, b, c) {
    "use strict";
    pixiv.bookmarkTag = {
        config: null,
        data: null,
        type: "count",
        order: "desc",
        tagsName: null,
        tagsCount: null,
        container: null,
        tagContainer: null,
        inputContainer: null,
        setup: function(a, b) {
            if (a = c(a), a.length) {
                var d = this;
                this.container = a, this.inputContainer = c(b), this.tagContainer = c(".tag-cloud", a), 
                this.load(), this.container.on("click", ".tag-order li", function() {
                    return d.toggle(c(this).dataset("type")), !1;
                });
            }
        },
        show: function() {
            if (this.container) {
                for (var a, b = this.get().tags, d = this.data, e = [], f = 0; a = b[f]; ++f) e[f] = {
                    name: a,
                    cloud: d[a].lev
                };
                this.tagContainer.html(colon.template("tag-items", {
                    tags: e
                })), c(".tag-order", this.container).html(colon.template("tag-order", {
                    type: this.type,
                    order: this.order
                })), pixiv.tag.update();
            }
        },
        get: function(a, b) {
            a || (a = this.type), b || (b = this.order);
            var d, e, f = this[pixiv.camelize("tags-" + a)];
            return f ? (f.tags || (f.tags = c.extend([], this.tagsName.tags), e = this.data, 
            d = "asc" === b ? function(a, b) {
                return e[a].total - e[b].total;
            } : function(a, b) {
                return e[b].total - e[a].total;
            }, f.tags.sort(d), f.order = b), b !== f.order && (f.order = b, f.tags.reverse()), 
            this.config("type", a), this.type = a, this.config("order", b), this.order = b, 
            f) : null;
        },
        load: function() {
            var a = this;
            this.tagContainer.show();
            var b = pixiv.context.tags ? colon.async(JSON.parse(pixiv.context.tags)) : pixiv.api.bookmarkTag(pixiv.context.type, "level", "total");
            return b.always(function() {
                a.tagContainer.removeClass("loading-indicator");
            }).done(function(b) {
                a.data = b, a.initialize(), a.show();
            }).fail(function() {});
        },
        initialize: function() {
            var a, b, c = this.data, d = [];
            for (var e in c) d.push(e);
            d.sort(), this.tagsCount = {
                order: null,
                tags: null
            }, this.tagsName = {
                order: "asc",
                tags: d
            }, this.config = colon.storage.config("bookmark_tag"), a = this.config("type"), 
            a && (this.type = a), b = this.config("order"), b && (this.order = b);
        },
        toggle: function(a) {
            a === this.type ? this.order = "desc" === this.order ? "asc" : "desc" : this.type = a, 
            this.show();
        }
    };
}(this, document, jQuery), function(a, b, c) {
    "use strict";
    function d(a, b) {
        this.container = a, this.update(b);
    }
    function e(a) {
        for (var b = this.positionsTop, c = this.positionsLeft, d = b[0] || 0, e = 0, f = 0, g = b.length - 1; g >= 0; --g) {
            var h = b[g] || 0;
            h <= d && (d = h, e = c[g], f = g);
        }
        return this.positionsTop[f] = d + 30 + a, {
            top: d,
            left: e
        };
    }
    function f(a) {
        a && this.updateOption(a), this.positionsTop = new Array(this.columnCount);
        for (var b, c = this.container.childNodes, d = 0; b = c[d]; ++d) 1 === b.nodeType && this.addPosition(b);
        this.updateHeight();
    }
    function g(a) {
        for (var b, d = c.createDocumentFragment(), e = 0; b = a[e]; ++e) this.addPosition(b), 
        d.appendChild(b);
        this.updateHeight(), this.container.appendChild(d);
    }
    function h() {
        var a = Math.max.apply(Math, this.positionsTop);
        a && (this.container.style.height = a + "px");
    }
    function i(a) {
        for (var b = this.columnWidth = a.columnWidth || this.columnWidth, c = this.columnMargin = a.columnMargin || this.columnMargin, d = this.columnCount = Math.max(a.columnCount || this.columnCount, 1), e = [ 0 ], f = 1; f < d; ++f) e[f] = b * f + c * f;
        this.positionsLeft = e;
    }
    function j(a) {
        var b = a.style, c = $(a).dataset(), d = c.width ? Math.min(c.height / c.width * 320, 640) : $(a).height(), e = this.position(d);
        b.top = e.top + "px", b.left = e.left + "px";
    }
    a.Brickmaker = d, a.Brickmaker.prototype = {
        container: null,
        positionsTop: null,
        positionsLeft: null,
        columnCount: 1,
        columnWidth: 320,
        columnMargin: 40,
        position: e,
        update: f,
        add: g,
        updateHeight: h,
        updateOption: i,
        addPosition: j
    };
}(this, this, document), function(a) {
    "use strict";
    var b = require("jquery"), c = b, d = require("colon"), e = require("pixiv");
    a.countStrlen = function(a, b, d) {
        if (!a || !b || !d) return !1;
        var e = c("#" + a).val().replace(/\r\n?/, "\n").length;
        d < e ? c("#" + b).html('<span class="error">' + e + "</span>") : c("#" + b).html(e);
    }, a.countTags = function(a, b, d) {
        if (!a || !b || !d) return !1;
        var e = c.trim(c("#" + a).val()), f = e.split(/\s+|　+/);
        if (!f) return !1;
        var g = f.length;
        c("#" + b).html(g > d ? '<span class="error">' + g + "</span>" : g);
    }, function(a) {
        function b(b) {
            return b.replace(f, function(b) {
                var c = e.redirectURL(d.html.unescape(b));
                return c = a(c), '<a href="' + c + '" target="_blank">' + b + "</a>";
            });
        }
        function c(b) {
            return b.replace(g, function(b, c, e) {
                var f = encodeURIComponent(d.html.unescape(e));
                return f = a(f), c + '<a href="http://twitter.com/search?q=' + f + '" target="_blank">' + e + "</a>";
            });
        }
        e.addURLLink = b, e.addHashTagLink = c;
        var f = new RegExp("https?://[^/@\\s]+\\.([,.]?[-_!~*a-zA-Z0-9;/?:&=+$%#])+", "g"), g = /(^|[^a-zA-Z0-9])(#[a-zA-Z0-9_]*[a-zA-Z_]+[a-zA-Z0-9_]*)/g;
    }(d.html.escape), e.screen = {
        stash: [],
        setup: function() {
            c(a).click(function(a) {
                c(a.target).parents(".dialog").length || e.screen.close();
            });
        },
        register: function(a) {
            "object" == typeof a && "function" == typeof a.close && e.screen.stash.push(a);
        },
        unregister: function(a) {
            for (var b, c = e.screen.stash, d = 0; b = c[d]; ++d) a === b && c.splice(d, 1);
        },
        close: function(a) {
            for (var b, c = e.screen.stash, d = 0; b = c[d]; ++d) b !== a && b.close();
        }
    }, e.applyTemplate = function() {
        var a = /#\{([^|}]+)(?:\|(.*?)\|)?\}/g;
        return function(b, c, e) {
            return b && c ? b.replace(a, function(a, b, f) {
                return b = c[b], b || "" === b || 0 === b || (b = f || ""), e === !1 ? b : d.html.escape(b);
            }) : b;
        };
    }(), e.tracking = {
        setup: function() {
            d.d.on("click.tracking ", ".click-tracking", this.event).on("focusin.tracking", ".focus-tracking", this.event);
        },
        track: function(a) {
            try {
                _gaq.push(a);
            } catch (a) {}
        },
        event: function(a) {
            "object" === c.type(a) ? (a = c(this).dataset(), a.category && a.action && e.tracking.track([ "_trackEvent", a.category, a.action, a.label, a.value ? +a.value : void 0 ])) : (a = c.makeArray(arguments), 
            a.unshift("_trackEvent"), e.tracking.track(a));
        },
        pageview: function() {
            var a = c.makeArray(arguments);
            a.unshift("_trackPageview"), e.tracking.track(a);
        }
    }, e.tracker = {
        categories: {},
        category: null,
        config: {},
        setup: function() {
            var a = this;
            d.d.on("click submit", ".ae", function(b) {
                var d, f = c(this).dataset(), g = f.aeCategory || a.category;
                g && (d = [ g, f.aeAction + (e.context.self ? "Self" : "") ], "submit" === b.type || "click" === b.type && "A" === this.tagName && "_blank" !== this.target ? a.add(d) : e.tracking.event.apply(null, d));
            });
        },
        pageCategory: function() {
            var a, b, d, e, f = this.categories;
            for (a in f) {
                b = f[a], e = !0, "object" !== c.type(b) && (b = {
                    pathname: b
                });
                for (d in b) if (!b[d].test(location[d])) {
                    e = !1;
                    break;
                }
                if (e) return void (this.category = a);
            }
        },
        send: function() {
            var a = d.storage.localStorage("refs");
            if (a) {
                for (var b, c = 0; b = a[c]; ++c) e.tracking.event.apply(null, b);
                d.storage.localStorage("refs", null);
            }
        },
        add: function(a) {
            var b = d.storage.localStorage("refs") || [];
            b.push(a), d.storage.localStorage("refs", b);
        },
        on: function(a) {
            var b, f, g, h, i, j = this, k = location.pathname + location.search;
            a || (a = this.config), i = function(a) {
                var b = a.data.option[2];
                "function" === c.type(b) && (b = b.apply(this, arguments)), "array" === c.type(b) && ("submit" === a.type || "change" === a.type || "click" === a.type && "A" === this.tagName && "_blank" !== this.target ? j.add(b) : e.tracking.event.apply(null, b));
            };
            for (b in a) if (new RegExp(b).test(k)) for (g = "function" === c.type(a[b]) ? a[b]() : a[b], 
            f = 0; h = g[f]; ++f) d.d.on(h[1] + ".tracker", h[0], {
                option: h
            }, i);
        },
        off: function() {
            d.d.off(".tracker");
        }
    }, e.EventTracker = {
        setup: function() {
            "/bookmark.php" === location.pathname && location.search.match(/type=user/) && c('.column-action-menu input[type="submit"]').click(function() {
                try {
                    _gaq.push([ "_trackEvent", "pixiv", "ModBookmarkUser", c(this).attr("name"), c(".list_box input:checked").length ]);
                } catch (a) {}
            }), "/mypixiv_all.php" === location.pathname && c('.column-action-menu input[type="submit"]').click(function() {
                try {
                    _gaq.push([ "_trackEvent", "pixiv", "ModMypixivUser", c(this).attr("name"), c(".list_box input:checked").length ]);
                } catch (a) {}
            });
        }
    }, d.ns("pixiv.ui", {
        toggleState: function(a) {
            var b = c(a).hasClass("disabled");
            return b ? this.enable(a) : this.disable(a), b;
        },
        enable: function(a) {
            c(a).removeClass("disabled").find("input").each(function() {
                var a = c(this);
                a.closest(".disabled").length || a.prop("disabled", !1);
            });
        },
        disable: function(a) {
            c(a).addClass("disabled").find("input button").prop("disabled", !0);
        }
    });
}(window), function(a, b, c) {
    "use strict";
    pixiv.embed = {
        url: "http://source.pixiv.net/source/",
        input: null,
        select: null,
        setup: function() {
            var a = pixiv.embed;
            pixiv.context.embedId && (a.input = c("#embed-input"), a.select = c("#embed-select").change(a.change).change());
        },
        focus: function(b) {
            a.setTimeout(function() {
                b.target.select();
            }, 0);
        },
        change: function(a) {
            var b, d, e, f, g, h, i, j = pixiv.embed, k = pixiv.context;
            e = c(this).val().split("|"), f = k.embedId, g = e[0], h = e[1], "v1" === g ? i = '<iframe src="http://embed.pixiv.net/code.php?id=' + f + '" width="380" height="168" style="background:transparent" frameborder="0" marginwidth="0" marginheight="0" scrolling="no"></iframe>' : (b = colon.html.escape("http://www.pixiv.net/member_illust.php?mode=medium&illust_id=" + k.illustId), 
            d = colon.html.escape("http://www.pixiv.net/member.php?id=" + k.userId), i = [ '<script src="' + j.url + 'embed.js" data-id="' + f + '" data-size="' + g + '" data-border="' + h + '" charset="utf-8"></script>', "<noscript>", "<p>", '<a href="' + b + '" target="_blank">' + colon.html.escape(k.illustTitle) + "</a> ", 'by <a href="' + d + '" target="_blank">' + colon.html.escape(k.userName) + "</a> ", 'on <a href="http://www.pixiv.net/" target="_blank">pixiv</a>', "</p>", "</noscript>" ].join("")), 
            j.input.val(i), a.originalEvent && j.input[0].focus();
        },
        showSample: function() {
            c("#embed-sample").length || (c(p.template.get("embed-sample")).appendTo("body"), 
            c.getScript(pixiv.embed.url + "embed.js?20110525").done(function() {
                __pixiv__.embed();
            })), pixiv.ui.modal.open("#embed-sample", {
                block: !0
            });
        }
    };
}(this, document, jQuery), function(a, b, c) {
    "use strict";
    c.fn.findBy = function(a, b) {
        return this.closest(b).find(a);
    };
    var d = function() {}, e = function(a) {
        var b = this, e = function() {
            return b.apply(this, arguments);
        };
        return c.extend(e, this), d.prototype = this.prototype, e.prototype = new d(), c.extend(e.prototype, a), 
        e.prototype.constructor = e, e;
    }, f = function(a) {
        return function() {
            return a++;
        };
    }(0), g = function(a) {
        return a || (a = {}), function(b, c, d) {
            return a[b] || (a[b] = c.call(d)), a[b];
        };
    }, h = a.View = function(a) {
        this.container = a || this.container || "<div/>", this.compile("container"), this.container.length && (this.addEvent(), 
        this.parent && this.parent.register(this), this.loadOnce = g(), this.initialize && this.initialize.apply(this, arguments));
    };
    h.extend = e, h.template = function(a) {
        return Handlebars.compile(a);
    }, h.confirm = function(b, c) {
        var d = a.confirm(b), e = d && c && c();
        return e || d;
    };
    var i = {
        tab: function() {
            var a = function(a) {
                a.container = a.element.closest(".ui-tab-container");
            };
            return {
                events: [ [ "click", ".ui-tab", "select-tab", {
                    container: a
                } ] ],
                selectTab: function(a) {
                    var b = a.data.target, d = c.camelCase(b);
                    this[d] ? this[d](a) : c("." + b, a.container).show(), a.elements.not(a.element).removeClass("active"), 
                    a.element.addClass("active"), c(".ui-tab-content", a.container).not("." + b).hide();
                },
                clear: function(a) {
                    c(a).empty();
                }
            };
        }
    };
    h.prototype = {
        parent: null,
        container: "body",
        contents: null,
        stash: null,
        events: null,
        initialize: null,
        include: function() {
            for (var a = arguments.length ? [ c.makeArray(arguments) ] : this.mixins, b = 0, d = a.length; b < d; ++b) {
                var e = a[b], f = c.extend(!0, {}, i[e]);
                if (this[e] || (this[e] = {}), f.events) {
                    for (var g = 0, h = f.events.length; g < h; ++g) {
                        var j = c.extend(f.events[g][3], {
                            mixinContext: this[e]
                        });
                        this.addEvent(j);
                    }
                    delete f.events;
                }
                c.extend(this[e], f);
            }
        },
        register: function(a) {
            this.contents = this.contents ? this.contents.add(a) : c(a);
        },
        unregister: function(a) {
            this.contents && (this.contents = this.contents.not(a));
        },
        trigger: function(a, b) {
            return b ? c(b, this.container).trigger(a) : this.container.trigger(a);
        },
        compile: function() {
            for (var a, b = 0, d = arguments.length; b < d; ++b) a = arguments[b], a && (this[a] = c(this[a]));
        },
        addEvent: function() {
            function a(b, d) {
                return function(e) {
                    var f = c(this), g = f.dataset(f), h = pixiv.prefixFilter("text", g);
                    a.call(j, {
                        name: b,
                        element: f,
                        elements: j.find(d),
                        data: g,
                        text: h,
                        event: e
                    });
                };
            }
            var b, d, e, g, h, i, j = this, k = this.container, l = arguments.length ? [ c.makeArray(arguments) ] : this.events;
            if (l) {
                arguments.length && this.events.push(l[0]);
                for (var m = 0, n = l.length; m < n; ++m) b = l[m], d = b[0], e = b[1], g = b[2], 
                h = b[3], i = b[4], "function" === c.type(g) ? k.on(d + "." + f(), e, a(g, e)) : k.on(d + "." + g, e, this.handler(g, e, h)), 
                b[4] = !0;
            }
        },
        removeEvent: function(a) {
            return this.container.off("." + a);
        },
        handler: function(a, b, d) {
            var e = this, f = pixiv.camelize(a), g = 0 === a.indexOf("toggle-");
            d || (d = {});
            var i = function(b, c, d) {
                return e.template(a, b, c, d);
            }, j = function(b, c) {
                return e.storage(a, b, c);
            }, k = function(a) {
                var k = c(this);
                if (k.hasClass("ui-loading")) return !1;
                var l = k.dataset(), m = pixiv.prefixFilter("text", l), n = e.find(b), o = (e.handlers || {})[f], p = e[f], q = function(a) {
                    return h.confirm(m.confirm, a && c.proxy(a, e));
                };
                if (o ? p && g && (o = function() {
                    var a = e.handlers[f].apply(e, arguments);
                    return a && p.apply(e, arguments), a;
                }) : o = p, o) {
                    if (o = o.call(e, {
                        element: k,
                        elements: n,
                        data: l,
                        text: m,
                        template: i,
                        storage: j,
                        confirm: q,
                        event: a
                    }), "boolean" === c.type(o)) return o;
                    o && (k.addClass("ui-loading"), c.when(o).always(function() {
                        k.removeClass("ui-loading");
                    }).done(function() {
                        var b = c.makeArray(arguments), d = k.dataset(), f = pixiv.prefixFilter("text", d);
                        b.unshift({
                            element: k,
                            elements: n,
                            data: d,
                            text: f,
                            template: i,
                            storage: j,
                            confirm: q,
                            event: a
                        }), g || p && p.apply(e, b);
                    }).fail(function() {
                        if (g) {
                            var b = k.dataset(), c = pixiv.prefixFilter("text", b);
                            p.call(e, {
                                element: k,
                                elements: n,
                                data: b,
                                text: c,
                                template: i,
                                storage: j,
                                confirm: q,
                                event: a
                            });
                        }
                    }));
                }
                return d.cancel === !1;
            };
            return d.debounce ? colon.debounce(k, null, "number" === c.type(d.debounce) ? d.debounce : void 0) : k;
        },
        storage: function(a, b, c) {
            if (a) {
                if (this.stash || (this.stash = {}), this.stash[a] || (this.stash[a] = {}), !b) return this.stash[a];
                switch (c) {
                  case null:
                    delete this.stash[a][b];
                    break;

                  case void 0:
                    return this.stash[a][b] || (this.stash[a][b] = {}), this.stash[a][b];

                  default:
                    return this.stash[a][b] = c, c;
                }
            }
        },
        template: function(a, b, d, e) {
            var f, g = this.templates[a], i = "";
            return g && "string" !== c.type(g) || (i = g || c("#template-" + a).html() || "", 
            e && e.pre || (i = i.replace(/[\n\r]+/g, "")), this.templates[a] = g = h.template(i)), 
            f = g(b), d ? d.html(f) : f;
        },
        find: function(a) {
            return c(a, this.container);
        },
        remove: function(a) {
            return (a ? this.find(a) : this.container).remove();
        }
    };
}(this, this.document, this.jQuery || this.Zepto), function(a, b, c) {
    "use strict";
    var d = a.pixiv;
    d.group = {
        setup: function() {
            new d.group.Header(), new d.group.Timeline(), new d.group.Edit(), new d.group.GroupList(), 
            new d.group.MemberList(), new d.group.ImageList(), new d.group.Invite(), d.ui.painter.setup();
        }
    }, d.group.Header = a.View.extend({
        container: "#contents header",
        width: 782,
        height: null,
        events: [ [ "click", ".action-leave-group", "leave-group" ], [ "click", ".action-select-cover", "select-cover" ], [ "change", ".input-cover", "submit-cover" ], [ "click", ".action-reposition-cover", "reposition-cover" ], [ "click", ".action-apply-reposition", "apply-reposition" ], [ "click", ".action-cancel-reposition", "cancel-reposition" ] ],
        handlers: {
            applyReposition: function() {
                var b = this, e = this.find(".cover"), f = e.css("background-position"), g = parseInt(f.split(" ")[1], 10);
                return "%" !== f.slice(-1) && (g = g / (160 - this.height) * 100, e.css("background-position", "0 " + g + "%")), 
                e.off("mousedown").removeClass("dragging"), d.body.addClass("unselectable"), d.api.post("/group/edit.php", {
                    mode: "slide_cover",
                    position_y: g,
                    format: "json",
                    group_id: d.context.groupId
                }).fail(function(d, e, f) {
                    var g = c.parseJSON(d.responseText);
                    a.alert(g && g.error + (g.hint ? "\n\n" + g.hint : "") || e + ": " + (f || "error")), 
                    b.trigger("click.reposition-cover", ".action-reposition-cover");
                });
            }
        },
        leaveGroup: function(a) {
            return a.confirm(function() {
                c("#leave-group").submit();
            });
        },
        selectCover: function(a) {
            return colon.ua.ie ? void (location.href = "/group/edit.php?mode=cover&id=" + d.context.groupId) : void a.element.findBy('input[type="file"]', "form").val("").click();
        },
        submitCover: function() {
            this.find("form").submit();
        },
        repositionCover: function(a) {
            var b, c, e = this, f = a.element.closest(".cover");
            return this.height ? void this.addRepositionEvent(a, f) : (b = d.context.coverImage, 
            void (b && (c = new Image(), c.onload = function() {
                e.height = e.width * c.height / c.width, e.addRepositionEvent(a, f);
            }, c.src = b)));
        },
        addRepositionEvent: function(a, b) {
            var c = this, e = !1;
            b.addClass("dragging").find(".menu").addClass("hidden"), this.find(".edit-cover").show(), 
            this.storage("cover", "background-position", b.css("background-position")), b.on("mousedown", function(a) {
                var f = parseFloat(b.css("background-position").split(" ")[1]), g = a.clientY, h = c.height;
                e || (f = (160 - h) * (f / 100), e = !0), d.body.addClass("unselectable"), colon.d.on("mousemove", function(a) {
                    var c = f + (a.clientY - g), d = h > 160 ? Math.min(0, Math.max(c, 160 - h)) : Math.max(0, Math.min(c, 160 - h));
                    b.css("background-position", "0 " + d + "px");
                }).on("mouseup", function() {
                    colon.d.off("mousemove mouseup"), d.body.removeClass("unselectable");
                });
            });
        },
        applyReposition: function() {
            this.find(".cover .menu").removeClass("hidden"), this.find(".edit-cover").hide();
        },
        cancelReposition: function() {
            this.find(".cover").off("mousedown").removeClass("dragging").css("background-position", this.storage("cover", "background-position")).find(".menu").removeClass("hidden"), 
            this.find(".edit-cover").hide();
        }
    }), d.group.Invite = a.View.extend({
        container: "#contents div.invite",
        events: [ [ "click", ".action-enable-invite", "enable-invite" ], [ "click", ".toggle-action", "toggle" ] ],
        handlers: {
            enableInvite: function() {
                return d.api.post("/group/edit.php", {
                    group_id: d.context.groupId,
                    mode: "reset_invite_key",
                    format: "json"
                });
            }
        },
        templates: {
            "enable-invite": null
        },
        enableInvite: function(a, b) {
            a.template(b, this.container), this.removeEvent("enable-invite");
        },
        toggle: function() {
            this.find(".action-box").toggle();
        }
    }), d.group.Timeline = a.View.extend({
        container: "#timeline",
        listContainer: null,
        config: null,
        initialize: function() {
            this.listContainer = this.find("> ul"), this.config = colon.storage.config("group"), 
            this.config("no_hint") || this.addEvent("click", ".hint .close", "close-hint");
        },
        mixins: [ "tab" ],
        events: [ [ "click", ".imgadd", "toggle-add-image" ], [ "click", ".imgpaint", "toggle-paint" ], [ "focus", ".inputbox textarea", "focus-form" ], [ "keydown", "textarea", "work-detail", {
            debounce: 500
        } ], [ "submit", "form.action-post", "post" ], [ "submit", "form.action-comment", "comment" ], [ "click", "#more a", "more" ], [ "click", ".action-like", "toggle-like" ], [ "click", ".action-reply", "reply" ], [ "click", ".action-cancel-reply", "cancel-reply" ], [ "click", ".action-likes", "likes", {
            cancel: !1
        } ], [ "click", ".action-remove", "toggle-remove" ], [ "click", ".comment a.more", "more-comment" ], [ "click", ".action-add-comment", "show-comment-panel" ], [ "click", ".action-report-spam", "report-spam" ], [ "click", ".toggle-context-menu", "toggle-context-menu" ], [ "click", ".action-open-image", "open-image" ] ],
        templates: {
            "toggle-like": null,
            likes: null,
            post: null,
            "open-image": null,
            "work-detail": null
        },
        handlers: {
            post: function(b) {
                var e = b.element[0];
                return !!e.image.value || d.api.post("/group/comment.php", {
                    group_id: d.context.groupId,
                    format: "partial_html",
                    mode: "post",
                    body: d.ui.Tag.trim(e.body.value),
                    paint: c(".imgpaint.active", b.element).length ? e.paint.value : void 0
                }).fail(function(b, d, e) {
                    var f = c.parseJSON(b.responseText);
                    a.alert(f && f.error + (f.hint ? "\n\n" + f.hint : "") || d + ": " + (e || "error"));
                });
            },
            comment: function(b) {
                var e = b.element[0];
                return !!e.image.value || d.api.post("/group/comment.php", {
                    group_id: d.context.groupId,
                    format: "partial_html",
                    mode: "post_child",
                    parent_id: e.parent_id.value,
                    reply_id: !e.reply_id.disabled && e.reply_id.value || void 0,
                    body: d.ui.Tag.trim(e.body.value),
                    paint: c(".imgpaint.active", b.element).length ? e.paint.value : void 0
                }).fail(function(b, d, e) {
                    var f = c.parseJSON(b.responseText);
                    a.alert(f && f.error + (f.hint ? "\n\n" + f.hint : "") || d + ": " + (e || "error"));
                });
            },
            more: function(a) {
                return d.api.get("/group/?format=partial_html", a.data);
            },
            toggleLike: function(a) {
                return d.api.post("/group/comment.php?format=json", a.data);
            },
            reply: function(a) {
                var b = a.element.closest("li.post"), d = a.element.findBy(".user", ".meta").text();
                this.trigger("click", c(".action-add-comment", b)), c('input[name="reply_id"]', b).val(a.data.reply_id).prop("disabled", !1), 
                c(".reply-to", b).removeClass("hidden").find(".user").text(d);
            },
            cancelReply: function(a) {
                a.element.closest(".reply-to").addClass("hidden"), a.element.findBy('input[name="reply_id"]', "li.post").prop("disabled", !0);
            },
            likes: function(a) {
                return d.api.get("/group/rpc/like_users.php", {
                    type: a.data.type,
                    comment_id: a.data.comment_id,
                    format: "json"
                }, {
                    cache: a.storage("cache")
                });
            },
            toggleRemove: function(b) {
                return a.confirm(b.text.confirm) && d.api.post("/group/comment.php?format=json", b.data).done(function() {
                    colon.dispatcher.connect("/group/comment.php", function() {
                        location.href = "/group/?id=" + d.context.groupId;
                    }).dispatch();
                });
            },
            moreComment: function(a) {
                return d.api.get("/group/comment.php?format=partial_html", a.data);
            },
            reportSpam: function(b) {
                return b.confirm(function() {
                    return d.api.post("/group/comment.php?format=json", b.data).fail(function(b, d, e) {
                        var f = c.parseJSON(b.responseText);
                        a.alert(f && f.error + (f.hint ? "\n\n" + f.hint : "") || d + ": " + (e || "error"));
                    });
                });
            }
        },
        toggleAddImage: function(a) {
            var b = a.element, c = b.siblings().removeClass("active");
            b.closest("form").find(".paintcontainer").hide().find("input").prop("disabled", !0);
            var d = b.toggleClass("active").findBy(".filecontainer", "form").toggle().find("input");
            d.prop("disabled", !d.prop("disabled"));
            var e = a.element.findBy(".work-detail-container", "form");
            c.addBack().filter(".active").length ? e.slideUp("fast") : e.show();
        },
        togglePaint: function(a) {
            var b, e = a.element, f = e.siblings().removeClass("active");
            if (e.closest("form").find(".filecontainer").hide().find("input").prop("disabled", !0), 
            !e.hasClass("active") && (b = c(".drawr-paint", e.closest("form")), !b.hasClass("parsed"))) {
                var g = d.ui.painter.painterList;
                b.dataset("paintid", g.length), g.push(new d.ui.DrawrPainter(b));
            }
            var h = e.toggleClass("active").closest("form").find(".paintcontainer").toggle().find("input");
            h.prop("disabled", !h.prop("disabled"));
            var i = a.element.findBy(".work-detail-container", "form");
            f.addBack().filter(".active").length ? i.slideUp("fast") : i.show();
        },
        focusForm: function(a) {
            var b = this, e = a.element.closest("form");
            if (!e.hasClass("focus")) {
                this.find("form.focus").each(function() {
                    b.unfocusForm({
                        element: c(this)
                    });
                }), e.addClass("focus").find(".attachmentbar").show().closest("li.post div.inputbox").find("img.usericon, div.controller").show();
                var f = e.find(".recently-viewed");
                if (!f.children().length && window.localStorage && window.JSON) {
                    var g;
                    try {
                        g = JSON.parse(localStorage["recently_viewed" + d.user.id]), g.length || (g = []);
                    } catch (a) {
                        g = [];
                    }
                    var h = Date.now ? Date.now() : +new Date();
                    c.each(g.slice(-8).reverse(), function(b, d) {
                        h - d.time > 72e5 || c('<div class="recently-viewed-item"></div>').append(c(new Image()).attr("src", d.img)).appendTo(f).on("click", function() {
                            var b = null;
                            "illust" === d.type ? b = "http://www.pixiv.net/member_illust.php?mode=medium&illust_id=" + d.id : "novel" === d.type && (b = "http://www.pixiv.net/novel/show.php?id=" + d.id), 
                            b && (a.element.val(b + " " + a.element.val()), a.element.focus().trigger("keydown"));
                        });
                    }), 0 === f.children().length && (e.find(".recently-viewed-header").hide(), e.find(".recently-viewed").hide());
                }
            }
        },
        unfocusForm: function(a) {
            a.element.removeClass("focus").find(".attachmentbar").hide().closest("li.post div.inputbox").find("img.usericon, div.controller").hide();
        },
        workDetailLoading: !1,
        workDetail: function(a) {
            var b = this, c = (d.searchURL(a.element.val()) || [])[0], e = a.element.findBy(".work-detail-container", "form"), f = this.workDetailLoading;
            return c ? void (f || (this.workDetailLoading = !0, d.api.fetch(c).always(function(c, d) {
                b.workDetailLoading = !1, e.find(".work-detail").remove(), "success" !== d && "cache" !== d || "pixiv_illust" !== c.urlType && "pixiv_novel" !== c.urlType || (c.detail.url = c.detail.url, 
                e.append(a.template(c.detail)));
            }))) : void e.find(".work-detail").remove();
        },
        post: function(a, b) {
            if (d.context.max) return location.href = "/group/?id=" + d.context.groupId, !1;
            var e = c(b.html);
            this.listContainer.prepend(e), colon.ui.expander.add(e), c("#post-body").val(""), 
            a.element.find(".imgpaint.active").removeClass("active").end().find(".paintcontainer").hide().find("input").prop("disabled", !0), 
            c(".work-detail-container", a.element).empty().show();
            var f = c(".drawr-paint", a.element).dataset("paintid");
            return d.ui.painter.painterList[f] && d.ui.painter.painterList[f].clearCanvas(), 
            !1;
        },
        comment: function(a, b) {
            var e = c("#post-" + a.element[0].parent_id.value), f = c(b.html), g = c("> .comment", e);
            g.length || (g = c('<div class="comment"/>').insertBefore(c(".inputbox", e))), g.append(f), 
            colon.ui.expander.add(f), c("textarea", a.element).val(""), a.element.find(".imgpaint.active").removeClass("active").end().find(".paintcontainer").hide(), 
            c(".work-detail-container", a.element).empty().show();
            var h = c(".drawr-paint", a.element).dataset("paintid");
            d.ui.painter.painterList[h] && d.ui.painter.painterList[h].clearCanvas();
        },
        more: function(b, e) {
            var f = c(e.html), g = "/group/?id=" + b.data.id + "&max=" + b.data.max;
            this.listContainer.append(f), colon.ui.expander.add(f), null !== e.max ? (b.element.dataset("max", e.max), 
            a.history.replaceState && a.history.replaceState(null, b.data.max, g)) : (b.element.remove(), 
            this.removeEvent("more")), d.tracking.pageview("group", "more", g);
        },
        toggleLike: function(a) {
            var b = a.data.mode;
            if (b) {
                var c = a.element.parent(), e = +c.dataset("total") || 0, f = {
                    liked: 0 === b.indexOf("add"),
                    comment_id: a.data.comment_id,
                    suffix: (/_child$/.exec(b) || [ "" ])[0]
                };
                f.type = f.suffix ? "comment" : "post", f.total = f.liked ? e + 1 : e - 1, a.template(f, c), 
                c.dataset("total", f.total);
                var g = c.closest("li.post").getId(), h = "post" === f.type ? "" : "#comment-" + f.comment_id, i = "/group/comment.php?id=" + g + h;
                d.tracking.event("group", f.liked ? "like" : "unlike", i);
            }
        },
        likes: function(a, b) {
            if (b.likeUsers.length) {
                var e = a.element, f = c(a.template({
                    users: b.likeUsers
                })).appendTo(e);
                d.ui.modal.open(f, {
                    disposable: !0
                }), f.width(24 * Math.min(b.likeUsers.length, 5)).css("left", 6 - f.outerWidth() / 2), 
                d.tracking.event("group", "openLikes");
            }
        },
        toggleRemove: function(a) {
            a.data.mode.indexOf("_child") === -1 ? c("#post-" + a.data.comment_id).slideToggle() : c("#comment-" + a.data.comment_id).slideToggle();
        },
        moreComment: function(a, b) {
            var d = a.element, e = c(b.html).insertAfter(d);
            colon.ui.expander.add(e), null !== b.max_id ? d.dataset("max_id", b.max_id) : d.remove();
        },
        showCommentPanel: function(a) {
            var b = a.element.closest("li.post").find(".inputbox").show(), e = c("textarea", b).focus();
            d.ui.scroll(Math.max(b.offset().top, colon.w.scrollTop()) - 100, "normal").done(function() {
                e[0].focus();
            });
        },
        reportSpam: function(a) {
            a.element.siblings().length > 1 ? a.element.remove() : a.element.closest(".action").remove();
        },
        toggleContextMenu: function(a) {
            a.element.closest(".action").find(".action-box").toggle();
        },
        openImage: function(a) {
            var b = c("#image-modal"), e = c(".content", b).empty();
            d.ui.modal.open(b, {
                block: !0
            });
            var f = new Image();
            f.onload = function() {
                var d = !!a.data.title;
                c(".ui-modal", b).animate({
                    width: d ? Math.max(f.width, 200) : f.width,
                    height: d ? Math.max(f.height, 150) : f.height
                }, 300, function() {
                    a.data.original = a.data.src.replace(/_m\.(jpg|png|gif)$/, ".$1"), e.html(a.template(a.data));
                });
            }, f.src = a.data.src;
            var g = a.element.closest("li.post").getId(), h = a.element.closest("div.post"), i = h.length ? "#" + h[0].id : "";
            d.tracking.event("group", "openImage", "/group/comment.php?id=" + g + i);
        },
        closeHint: function(a) {
            var b = this.find(".hint");
            a.element.closest(".hint").slideUp("fast", function() {
                b.remove();
            }), this.config("no_hint", 1);
        }
    }), d.group.Edit = a.View.extend({
        container: "#page-group-edit #contents",
        initialize: function() {
            new d.ui.Tag(this.find(".ui-tag")), new d.ui.Counter(this.find(".ui-count-target"), this.find(".ui-count-counter"));
        },
        events: [ [ "click", ".action-delete-icon", "delete-icon" ], [ "click", 'input[name="publish_status"]', "toggle-accept-checkbox", {
            cancel: !1
        } ], [ "click", 'input[name="age_limit"]', "toggle-warning", {
            cancel: !1
        } ] ],
        handlers: {
            deleteIcon: function(a) {
                return confirm(a.text.confirm) && d.api.post("/group/edit.php", c.extend({
                    mode: "delete_icon",
                    format: "json"
                }, a.data));
            }
        },
        deleteIcon: function(a) {
            var b = a.element.closest("dd").find("img");
            b.attr("src", b.dataset("noIcon")), a.element.remove();
        },
        toggleAcceptCheckbox: function(a) {
            var b = a.element.findBy(".notes:last", "dd");
            a.elements.last().prop("checked") ? (this.find(".accept-status").addClass("ui-disabled"), 
            this.find('input[name="accept_status"]').prop({
                checked: !1,
                disabled: !0
            }), b.addClass("warning")) : (this.find(".accept-status").removeClass("ui-disabled"), 
            this.find('input[name="accept_status"]').prop("disabled", !1), b.removeClass("warning"));
        },
        toggleWarning: function(a) {
            a.element.findBy(".notes", "dd").toggleClass("warning");
        }
    }), d.group.GroupList = a.View.extend({
        container: "#group-list",
        listContainer: null,
        initialize: function() {
            this.listContainer = this.find(".group-items");
        },
        events: [ [ "click", "._more a", "more" ] ],
        handlers: {
            more: function(a) {
                return d.api.get("/group/group_list.php?format=partial_html", a.data);
            }
        },
        more: function(a, b) {
            this.listContainer.append(b.html), null !== b.max_id ? (a.element.dataset("max_id", b.max_id), 
            d.tracking.pageview("group", "group_list", "more")) : (a.element.remove(), this.removeEvent("more"));
        }
    }), d.group.ImageList = a.View.extend({
        container: "#page-group #images",
        listContainer: null,
        initialize: function() {
            this.listContainer = this.find("> ul");
        },
        events: [ [ "click", ".more a", "more" ] ],
        handlers: {
            more: function(a) {
                return d.api.get("/group/images.php?format=partial_html", a.data);
            }
        },
        more: function(a, b) {
            this.listContainer.append(b.html), null !== b.max_id ? (a.element.dataset("max_id", b.max_id), 
            d.tracking.pageview("group", "images", "more")) : (a.element.remove(), this.removeEvent("more"));
        }
    }), d.group.MemberList = a.View.extend({
        container: "#page-group .members",
        listContainer: null,
        initialize: function() {
            this.listContainer = this.find("> ul");
        },
        events: [ [ "click", ".action-remove", "toggle-remove" ], [ "click", ".action-toggle-permission", "toggle-permission" ], [ "click", ".more a", "more" ] ],
        handlers: {
            toggleRemove: function(a) {
                return confirm(a.text.confirm) && d.api.post("/group/members.php", c.extend({
                    group_id: d.context.groupId,
                    format: "json",
                    mode: "unjoin"
                }, a.data));
            },
            togglePermission: function(b) {
                var e = b.data.user_id === d.user.id;
                return (!e || a.confirm(b.text.confirmSelf)) && d.api.post("/group/members.php", c.extend({
                    group_id: d.context.groupId,
                    format: "json",
                    mode: "change_permission"
                }, b.data)).done(function() {
                    e && location.reload();
                }).fail(function(b, d, e) {
                    var f = c.parseJSON(b.responseText);
                    a.alert(f && f.error + (f.hint ? "\n\n" + f.hint : "") || d + ": " + (e || "error"));
                });
            },
            more: function(a) {
                return d.api.get("/group/members.php?format=partial_html", a.data);
            }
        },
        toggleRemove: function(a) {
            a.element.closest("li").toggle();
        },
        togglePermission: function(a) {
            var b = {};
            a.data.permission === d.context.GROUP_USER_PERMISSION_MEMBER ? (b.text = a.text.toAdmin, 
            b.permission = d.context.GROUP_USER_PERMISSION_ADMIN) : (b.text = a.text.toMember, 
            b.permission = d.context.GROUP_USER_PERMISSION_MEMBER), a.element.val(b.text).dataset("permission", b.permission);
        },
        more: function(a, b) {
            this.listContainer.append(b.html), null !== b.max_id ? (a.element.dataset("max_id", b.max_id), 
            d.tracking.pageview("group", "members", "more")) : (a.element.remove(), this.removeEvent("more"));
        }
    }), d.Document = a.View.extend({
        cache: {},
        events: [ [ "click", ".action-show-create-group-modal", "show-create-group-modal" ], [ "click", ".action-show-join-group-modal", "show-join-group-modal" ], [ "click", ".open-add-pickup-modal", "open-add-pickup-modal" ], [ "click", ".open-edit-pickup-modal", "open-edit-pickup-modal" ], [ "focus", ".ui-auto-select", "auto-select" ], [ "click", ".ui-selectbox li", "selectbox-select", {
            cancel: !1
        } ] ],
        showCreateGroupModal: function() {
            var a = this;
            d.api.get("/group/create.php", {
                format: "partial_html"
            }, {
                cache: this.cache
            }).done(function(b) {
                a.loadOnce("create-group-modal", function() {
                    d.body.append(d.createTemplate("create-group")(b)), new d.group.Create();
                }), d.ui.modal.open(".create-group-modal", {
                    block: !0
                }), c('.create-group-modal input[type="text"]').focus(), d.tracking.event("group", "showCreateGroupModal", location.href);
            });
        },
        showJoinGroupModal: function() {
            var a = this;
            d.api.get("/group/", {
                id: d.context.groupId,
                section: "join_rule",
                format: "partial_html"
            }, {
                cache: this.cache
            }).done(function(b) {
                a.loadOnce("join-group-modal", function() {
                    d.body.append(d.createTemplate("join-group")(b)), d.ui.modal.open(".join-group-modal", {
                        block: !0
                    });
                }), c('.join-group-modal input[type="checkbox"]').focus(), c(".join-group-modal .terms-check").on("change", function(a) {
                    c('.join-group-modal input[type="submit"]').prop("disabled", !a.target.checked);
                });
            });
        },
        openAddPickupModal: function(a) {
            d.api.get("/group/comment.php", {
                format: "json",
                mode: "show_pickup_post",
                group_id: d.context.groupId,
                comment_id: a.data.commentId
            }).done(function(b) {
                for (var e, f, g = "object" === c.type(b.group.pickupPosts) ? b.group.pickupPosts.detail.posts : [], h = a.data.commentId, i = 0; f = g[i]; ++i) if (f.id === h) {
                    e = f.title, g.splice(i, 1);
                    break;
                }
                c.extend(b, {
                    full: g.length >= 10,
                    id: h,
                    title: e
                });
                var j = c(p.template.apply("add-pickup-modal", b)).appendTo(d.body);
                new d.group.PickupPost(j, b), d.ui.modal.open(j, {
                    block: !0,
                    disposable: !0
                }).find(".ui-focus").focus(), c('input[type="text"]', j).focus();
            });
        },
        openEditPickupModal: function() {
            d.api.get("/group/comment.php", {
                format: "json",
                mode: "show_pickup_post",
                group_id: d.context.groupId
            }).done(function(a) {
                var b = c(p.template.apply("edit-pickup-modal", a)).appendTo(d.body);
                new d.group.PickupPost(b, a), d.ui.modal.open(b, {
                    block: !0,
                    disposable: !0
                });
            });
        },
        autoSelect: function(a) {
            setTimeout(function() {
                a.element.select();
            });
        },
        selectboxSelect: function(a) {
            a.element.findBy("> span", ".ui-selectbox").text(a.element.text());
        }
    }), d.group.Create = a.View.extend({
        container: ".create-group-container",
        initialize: function() {
            new d.ui.Counter(this.find(".ui-count-target"), this.find(".ui-count-counter"));
        },
        events: [ [ "submit", ".action-create-group", "create-group" ], [ "click", 'input[name="publish_status"]', "toggle-accept-checkbox", {
            cancel: !1
        } ], [ "click", 'input[name="age_limit"]', "toggle-warning", {
            cancel: !1
        } ] ],
        handlers: {
            createGroup: function(b) {
                if (!b.element[0].title.value) return alert("グループ名を入力してください"), !1;
                var e = b.element.serializeArray();
                return e.push({
                    name: "format",
                    value: "json"
                }), d.api.post("/group/create.php", e).fail(function(b, d, e) {
                    try {
                        var f = c.parseJSON(b.responseText);
                        if (f.error) return void a.alert(f.error + (f.hint ? "\n\n" + f.hint : "") || d + ": " + (e || "error"));
                        var g = f.inputGroup.error, h = [];
                        for (var i in g) h.push(g[i]);
                        a.alert(h.join("\n"));
                    } catch (b) {
                        a.alert("エラーが発生しました");
                    }
                });
            }
        },
        createGroup: function(a, b) {
            location.href = "/group/?id=" + b.group_id, d.ui.modal.close();
        },
        toggleAcceptCheckbox: function(a) {
            var b = a.element.findBy(".notes:last", "dd");
            a.elements.last().prop("checked") ? (this.find(".accept-status").addClass("ui-disabled"), 
            this.find('input[name="accept_status"]').prop({
                checked: !1,
                disabled: !0
            }), b.addClass("warning")) : (this.find(".accept-status").removeClass("ui-disabled"), 
            this.find('input[name="accept_status"]').prop("disabled", !1), b.removeClass("warning"));
        },
        toggleWarning: function(a) {
            a.element.findBy(".notes", "dd").toggleClass("warning");
        }
    });
    var e = p.script("//ajax.googleapis.com/ajax/libs/jqueryui/1.10.3/jquery-ui.min.js");
    d.group.PickupPost = a.View.extend({
        data: null,
        changed: !1,
        initialize: function(a, b) {
            var d, f = this;
            this.container = c(a), this.data = b, d = "object" === c.type(b.group.pickupPosts) ? b.group.pickupPosts.detail.posts : [], 
            d.length > 1 && e.load().done(function(d, e) {
                if ("forward" !== e) {
                    var g = c(".handle", a);
                    if (g.length) {
                        var h, i = "object" === c.type(b.group.pickupPosts) ? b.group.pickupPosts.detail.posts : [];
                        g.show(), c(".items", a).sortable({
                            axis: "y",
                            handle: g,
                            start: function(a, b) {
                                h = c(".item", this).index(b.item);
                            },
                            update: function(a, b) {
                                var d = c(".item", this).index(b.item), e = i.splice(h, 1)[0];
                                i.splice(d, 0, e), f.changed = !0;
                            }
                        });
                    }
                }
            });
        },
        events: [ [ "submit", ".add", "add" ], [ "submit", ".apply", "apply" ], [ "change", ".item-title", "rename" ], [ "click", ".remove", "remove" ], [ "click", ".cancel", "cancel" ] ],
        handlers: {
            add: function(b) {
                for (var e, f = "object" === c.type(this.data.group.pickupPosts) ? this.data.group.pickupPosts.detail.posts : [], g = [], h = 0; e = f[h]; ++h) e.id !== this.data.id && g.push({
                    name: "posts[" + h + "][id]",
                    value: e.id
                }, {
                    name: "posts[" + h + "][title]",
                    value: e.title
                });
                return g.push({
                    name: "posts[" + h + "][id]",
                    value: this.data.id
                }, {
                    name: "posts[" + h + "][title]",
                    value: c(".input-title", b.element).val()
                }, {
                    name: "mode",
                    value: "set_pickup_post"
                }, {
                    name: "group_id",
                    value: this.data.group.id
                }, {
                    name: "update_time",
                    value: f.length ? this.data.group.pickupPosts.update_time_unix : ""
                }), d.api.post("/group/comment.php", g).done(function() {
                    location.reload();
                }).fail(function(b, d, e) {
                    try {
                        var f = c.parseJSON(b.responseText);
                        if (f.error) return void a.alert(f.error + (f.hint ? "\n\n" + f.hint : "") || d + ": " + (e || "error"));
                        var g = f.inputs.error, h = [];
                        for (var i in g) h.push(g[i]);
                        a.alert(h.join("\n"));
                    } catch (b) {
                        a.alert("エラーが発生しました");
                    }
                });
            },
            apply: function() {
                for (var b, e = "object" === c.type(this.data.group.pickupPosts) ? this.data.group.pickupPosts.detail.posts : [], f = [], g = 0; b = e[g]; ++g) f.push({
                    name: "posts[" + g + "][id]",
                    value: b.id
                }, {
                    name: "posts[" + g + "][title]",
                    value: b.title
                });
                return f.push({
                    name: "mode",
                    value: "set_pickup_post"
                }, {
                    name: "group_id",
                    value: this.data.group.id
                }, {
                    name: "update_time",
                    value: e.length ? this.data.group.pickupPosts.update_time_unix : ""
                }), d.api.post("/group/comment.php", f).done(function() {
                    location.reload();
                }).fail(function(b, d, e) {
                    try {
                        var f = c.parseJSON(b.responseText);
                        if (f.error) return void a.alert(f.error + (f.hint ? "\n\n" + f.hint : "") || d + ": " + (e || "error"));
                        var g = f.inputs.error, h = [];
                        for (var i in g) h.push(g[i]);
                        a.alert(h.join("\n"));
                    } catch (b) {
                        a.alert("エラーが発生しました");
                    }
                });
            },
            pickupPost: function(b) {
                var e = b.element.serializeArray();
                return e.push({
                    name: "format",
                    value: "partial_html"
                }), d.api.post("/group/comment.php", e).done(function() {
                    location.reload();
                }).fail(function(b, d, e) {
                    try {
                        var f = c.parseJSON(b.responseText);
                        if (f.error) return void a.alert(f.error + (f.hint ? "\n\n" + f.hint : "") || d + ": " + (e || "error"));
                        var g = f.inputs.error, h = [];
                        for (var i in g) h.push(g[i]);
                        a.alert(h.join("\n"));
                    } catch (b) {
                        a.alert("エラーが発生しました");
                    }
                });
            }
        },
        openRenameModal: function(a) {
            var b = this;
            c.extend(a.data, {
                rename: !0
            });
            var e = c(p.template.apply("add-pickup-modal", a.data)).appendTo(d.body).on("submit", ".add", function() {
                for (var f, g = "object" === c.type(b.data.group.pickupPosts) ? b.data.group.pickupPosts.detail.posts : [], h = 0; f = g[h]; ++h) if (f.id === a.data.id) {
                    f.title = c(".input-title", e).val(), a.element.findBy(".item-title", ".item").text(f.title);
                    break;
                }
                return d.ui.modal.close(), !1;
            });
            d.ui.modal.open(e, {
                block: !0,
                disposable: !0
            }).find(".ui-focus").focus();
        },
        index: function(a, b) {
            for (var c, d = -1, e = 0; c = b[e]; ++e) if (a === c.id) {
                d = e;
                break;
            }
            return d;
        },
        remove: function(a) {
            c(a.element).closest(".item").slideUp("fast");
            var b = this.data.group.pickupPosts.detail.posts, d = this.index(a.data.id, b);
            d > -1 && b.splice(d, 1), b.length < 10 && c(".submit", this.container).prop("disabled", !1), 
            this.changed = !0;
        },
        rename: function(a) {
            var b = a.element.val();
            if (d.ui.Tag.trim(b)) {
                var c = this.data.group.pickupPosts.detail.posts, e = this.index(a.data.id, c);
                c[e].title = b, this.changed = !0;
            }
        },
        cancel: function() {
            this.changed ? a.confirm(d.text.cancelConfirm) && d.ui.modal.close() : d.ui.modal.close();
        }
    });
}(this, document, jQuery), function(window, $) {
    window.ef1 = function() {
        $("#tag_area").slideUp("fast", window.ef2);
    }, window.ef2 = function() {
        $("#tag_edit").slideDown("fast");
    }, window.ef3 = function() {
        $("#tag_edit").slideUp("fast", window.ef4);
    }, window.ef4 = function() {
        $("#tag_area").slideDown("fast");
    }, window.ef5 = function() {
        $("#tag_history").slideDown("fast");
    }, window.ef6 = function() {
        $("#tag_history").slideUp("fast");
    }, pixiv.comments = {
        setup: function() {
            $(".comment-show-button").on("click", function() {
                var a = $(this).closest(".comment-area");
                pixiv.api.post("rpc_comment_history.php", {
                    i_id: pixiv.context.illustId,
                    u_id: pixiv.context.userId
                }, {
                    ajaxSettings: {
                        dataType: "json"
                    }
                }).done(function(b) {
                    b.error || (a.addClass("comment-open"), b.data.html_array && (b.data.html_array.length ? a.find(".comment-list").append(b.data.html_array.join("")) : a.addClass("comment-none")), 
                    b.data.more ? a.addClass("comment-more") : a.removeClass("comment-more"));
                });
            });
            var a = 1;
            $(".comment-more-button").on("click", function() {
                var b = $(this).closest(".comment-area");
                pixiv.api.post("rpc_comment_history.php", {
                    i_id: pixiv.context.illustId,
                    u_id: pixiv.context.userId,
                    p: ++a
                }, {
                    ajaxSettings: {
                        dataType: "json"
                    }
                }).done(function(a) {
                    a.error || (a.data.html_array && a.data.html_array.length && b.find(".comment-list").append(a.data.html_array.join("")), 
                    a.data.more ? b.addClass("comment-more") : b.removeClass("comment-more"));
                });
            }), $(".comment-area").on("click", ".comment-delete-icon", function() {
                if (confirm("コメントを削除しますか？")) {
                    var a = $(this).closest(".comment-item");
                    pixiv.api.post("rpc_delete_comment.php", {
                        i_id: pixiv.context.illustId,
                        del_id: a.dataset("commentId")
                    }, {
                        ajaxSettings: {
                            dataType: "json"
                        }
                    }).done(function(b) {
                        b.error || a.remove();
                    });
                }
            });
        }
    }, window.select_illust = function(a) {
        var b = $("#i_" + a)[0], c = $("#li_" + a);
        b.checked ? c.addClass("display_works_edited selected") : c.removeClass("display_works_edited selected");
    }, window.showHide = function(a, b) {
        document.getElementById(a) && ("none" === document.getElementById(a).style.display ? (document.getElementById(b).style.display = "none", 
        document.getElementById(a).style.display = "block") : (document.getElementById(a).style.display = "none", 
        document.getElementById(b).style.display = "block"));
    }, window.startTagEdit = function() {
        pixiv.api.post("rpc_tag_edit.php", {
            mode: "first",
            i_id: pixiv.context.illustId,
            u_id: pixiv.context.userId,
            e_id: pixiv.user.id
        }).done(function(a) {
            pixiv.tagEditor.show(a);
        });
    }, window.startTagHistory = function() {
        pixiv.api.post("rpc_tag_edit.php", {
            mode: "history",
            i_id: pixiv.context.illustId,
            u_id: pixiv.context.userId,
            e_id: pixiv.user.id
        }, {
            ajaxSettings: {
                dataType: "text"
            }
        }).done(function(a, b, c) {
            window.on_loaded_history(c);
        });
    }, window.addTag = function() {
        var a = $("#add_tag").val();
        a && ($("#add_tag_area").html("Loading ..."), pixiv.api.post("rpc_tag_edit.php", {
            mode: "add_tag",
            i_id: pixiv.context.illustId,
            u_id: pixiv.context.userId,
            e_id: pixiv.user.id,
            value: a
        }).done(function(a) {
            pixiv.tagEditor.show(a);
        }));
    }, window.delTag = function(a) {
        var b = jQuery("#tag" + a).text();
        if (b) {
            if ("novel" !== jQuery("#rpc_t_id").text() && !confirm("このタグを削除しますか？\n*投稿者にユーザーIDが通知されます。")) return;
            jQuery("#del_btn_" + a).text("Loading ..."), window.form_disabled(), pixiv.api.post("rpc_tag_edit.php", {
                mode: "del_tag",
                i_id: pixiv.context.illustId,
                u_id: pixiv.context.userId,
                e_id: pixiv.user.id,
                tag: b
            }).done(function(a) {
                pixiv.tagEditor.show(a);
            });
        }
    }, window.getBackTag = function(a) {
        var b = jQuery("#h_tag" + a).text();
        b && (jQuery("#getback_btn_" + a).text("Loading ..."), window.form_disabled(), pixiv.api.post("rpc_tag_edit.php", {
            mode: "add_tag",
            type: "getback",
            i_id: pixiv.context.illustId,
            u_id: pixiv.context.userId,
            e_id: pixiv.user.id,
            tag: b
        }).done(function(a) {
            pixiv.tagEditor.show(a);
        }));
    }, window.history_clear = function() {
        jQuery("#history_clear_btn").text("Loading ..."), window.form_disabled(), pixiv.api.post("rpc_tag_edit.php", {
            mode: "clear",
            i_id: pixiv.context.illustId,
            u_id: pixiv.context.userId,
            e_id: pixiv.user.id
        }).done(function(a) {
            pixiv.tagEditor.show(a);
        });
    }, window.lockTag = function(a) {
        var b = Number(jQuery("#lock_tag" + a).prop("checked")), c = jQuery("#tag" + a).text();
        pixiv.api.post("rpc_tag_edit.php", {
            mode: "lock_tag",
            i_id: pixiv.context.illustId,
            u_id: pixiv.context.userId,
            e_id: pixiv.user.id,
            lock: b,
            tag: c
        }, {
            ajaxSettings: {
                dataType: "text"
            }
        }).done(function(a, b, c) {
            window.on_loaded_tag2(c);
        });
    }, window.infoTag = function() {
        var a = jQuery("#infotag").val(), b = jQuery("#tag" + a).text(), c = jQuery("#info_tag_result");
        a ? b && (c.css("display", "block").text("Loading ..."), window.form_disabled(), 
        pixiv.api.post("rpc_tag_edit.php", {
            mode: "info_tag",
            i_id: pixiv.context.illustId,
            u_id: pixiv.context.userId,
            e_id: pixiv.user.id,
            num: a,
            tag: b
        }, {
            ajaxSettings: {
                dataType: "text"
            }
        }).done(function(a, b, c) {
            window.on_loaded_tag3(c);
        })) : c.css("display", "block").text("選択してください");
    }, window.on_loaded_tag2 = function() {}, window.on_loaded_tag3 = function(a) {
        var b = new window.ShowTags2();
        b.display(a);
    }, window.on_loaded_history = function(a) {
        var b = new window.ShowHistory();
        b.display(a);
    }, window.showTags = function() {
        this.display = function(a) {
            for (var b = "", c = 0; c < a.html.length; c++) b += a.html[c];
            if (jQuery("#tag_edit").html(b), jQuery("#tag_edit").is(":hidden") && window.ef1(), 
            "add_tag" === a.mode || "del_tag" === a.mode) {
                for (b = "", c = 0; c < a.tag_a.length; c++) b += a.tag_a[c];
                jQuery("#tags").html(b);
            }
        };
    }, window.ShowHistory = function() {
        this.display = function(a) {
            for (var b = JSON.parse(a.responseText), c = "", d = 0; d < b.html.length; d++) c += b.html[d];
            jQuery("#tag_history").html(c), jQuery("#tag_history").is(":hidden") && window.ef5(), 
            jQuery("#tag_history_btn").html('<a href="javascript:void(0);" onclick="endTagHistory(' + b.i_id + "," + b.u_id + "," + b.e_id + ')">閉じる</a>');
        };
    }, window.ShowTags2 = function() {
        this.decode = function(oj) {
            eval("var res = " + oj.responseText);
        }, this.display = function() {
            jQuery("#info_tag_result").text("報告しました"), window.form_undisabled();
        };
    }, window.endTagEdit = function() {
        var a = jQuery("#tag-editor");
        a.is(":visible") && (pixiv.tagEditor.update(), a.slideUp("fast"), jQuery(".work-tags").slideDown("fast"));
    }, window.endTagHistory = function(a, b, c) {
        jQuery("#tag_history").is(":visible") && window.ef6(), jQuery("#tag_history_btn").html('<a href="javascript:void(0);" onclick="startTagHistory(' + a + "," + b + "," + c + ')">表示する</a>');
    }, window.form_disabled = function() {
        var a, b, c = document.getElementById("rpc").getElementsByTagName("tr");
        document.getElementById("add_tag_area").getElementsByTagName("input").length > 0 && (document.getElementById("add_tag_area").getElementsByTagName("input")[0].disabled = !0, 
        document.getElementById("add_tag_area").getElementsByTagName("input")[1].disabled = !0), 
        document.getElementById("infoTagArea") && document.getElementById("infoTagArea").getElementsByTagName("input")[0] && (document.getElementById("infoTagArea").getElementsByTagName("input")[0].disabled = !0), 
        document.getElementById("info_tag_btn") && document.getElementById("info_tag_btn").getElementsByTagName("input")[0] && (document.getElementById("info_tag_btn").getElementsByTagName("input")[0].disabled = !0);
        for (var d = 0; d < c.length; d++) {
            a = c[d].getElementsByTagName("input").length;
            for (var e = 0; e < a; e++) b = c[d].getElementsByTagName("input")[e], !b || "checkbox" !== b.type && "radio" !== b.type && "button" !== b.type && "submit" !== b.type || (b.disabled = !0);
        }
        return !0;
    }, window.form_undisabled = function() {
        var a, b, c = jQuery("#rpc tr");
        jQuery("#add_tag_area input").prop("disabled", !1), jQuery("#history_clear_btn input").prop("disabled", !1);
        for (var d = 0; d < c.length; d++) {
            a = c[d].getElementsByTagName("input").length;
            for (var e = 0; e < a; e++) b = c[d].getElementsByTagName("input")[e], !b || "checkbox" !== b.type && "radio" !== b.type && "button" !== b.type && "submit" !== b.type || (b.disabled = !1);
        }
        return !0;
    }, window.bookmarkToggle = function(a, b) {
        var c, d, e, f, g, h, i = document.getElementById(a).getElementsByTagName("ul");
        if ("flat" === b) {
            if ("" !== i[0].className) {
                c = document.getElementById(a).getElementsByTagName("li");
                var j;
                for (e = 0, d; d = c[e]; ++e) j = e % 2 === 0 ? "bg_white" : "bg_gray", "level0" === d.className ? d.style.display = "list-item" : d.getElementsByTagName("a")[0].getElementsByTagName("span")[0].className = "", 
                $(d).removeClass("bg_white bg_gray").addClass(j);
                "none" === document.getElementById(a).style.display && (document.getElementById(a).style.display = "block"), 
                i[0].className = "", document.getElementById(a).style.padding = "0", document.getElementById("book_outlist").style.display = "none", 
                f = document.getElementById("bookmark_toggle_btn").getElementsByTagName("a"), f[0].getElementsByTagName("span")[0].className = "book_flat_on", 
                f[1].getElementsByTagName("span")[0].className = "book_cloud_off", g = "." + location.hostname.replace(/(\w+)\./, ""), 
                h = new Date(), h.setTime(h.getTime() + 2592e6), h = h.toGMTString(), document.cookie = "bookToggle=flat; expires=" + h + "; domain=" + g + "; path=/";
            }
        } else if ("cloud" === b && "tagCloud" !== i[0].className) {
            for (c = document.getElementById(a).getElementsByTagName("li"), e = 0; e < c.length; e++) c[e].className = c[e].className.replace(/bg_white|bg_gray/g, ""), 
            c[e].className = c[e].className.replace(/ /g, ""), "level0" === c[e].className ? c[e].style.display = "none" : c[e].getElementsByTagName("a")[0].getElementsByTagName("span")[0].className = "cnt";
            i[0].className = "tagCloud", document.getElementById("book_outlist").style.display = "block", 
            f = document.getElementById("bookmark_toggle_btn").getElementsByTagName("a"), f[0].getElementsByTagName("span")[0].className = "book_flat_off", 
            f[1].getElementsByTagName("span")[0].className = "book_cloud_on", g = "." + location.hostname.replace(/(\w+)\./, ""), 
            h = new Date(), h.setTime(h.getTime() + 2592e6), h = h.toGMTString(), document.cookie = "bookToggle=cloud; expires=" + h + "; domain=" + g + "; path=/";
        }
    }, window.markAllUser = function(a) {
        return jQuery("#" + a).find('*[id^="li_"]').each(function() {
            var a = jQuery('input[type="checkbox"]', this);
            a.length && (a.prop("checked", !0), jQuery(this).addClass("display_works_edited selected"));
        }), !0;
    }, window.unmarkAllUser = function(a) {
        return jQuery("#" + a).find('*[id^="li_"]').each(function() {
            var a = jQuery('input[type="checkbox"]', this);
            a.length && (a.prop("checked", !1), jQuery(this).removeClass("display_works_edited selected"));
        }), !0;
    }, window.group_add = function(a) {
        var b;
        if ("new" === a.value && 1 === a.selectedIndex) {
            var c = prompt("新規フォルダ名を指定してください", "");
            if (null !== c && (c = c.replace(/ +/g, ""), c = c.replace(/　+/g, ""), "" !== c)) {
                var d = a.length;
                "未分類" === c && (c = "");
                var e = encodeURIComponent(c), f = c, g = [], h = [], i = 0;
                for (b = 0; b < d; b++) {
                    if (e === a.options[b].value) {
                        i = 1, a.options[b].selected = !0;
                        break;
                    }
                    g[b] = a.options[b].value, h[b] = a.options[b].text;
                }
                if (0 === i) {
                    for (i = 0, d = g.length, b = 0; b < d; b++) 2 !== b ? 0 === i ? a.options[b] = new Option(h[b], g[b]) : a.options[b + 1] = new Option(h[b], g[b]) : (a.options[b] = new Option(f, e), 
                    a.options[b + 1] = new Option(h[b], g[b]), i = 1);
                    2 === d && (a.options[2] = new Option(f, e)), a.options[2].selected = !0;
                }
            }
        }
    }, window.markAllCheckboxByName = function(a) {
        for (var b = document.getElementsByName(a), c = 0; c < b.length; c++) "checkbox" === b[c].type && (b[c].checked = !0);
        return !0;
    }, window.unmarkAllCheckboxByName = function(a) {
        for (var b = document.getElementsByName(a), c = 0; c < b.length; c++) "checkbox" === b[c].type && (b[c].checked = !1);
        return !0;
    }, window.add_input = function() {
        var a = $("#normalUpLoad")[0], b = a.getElementsByTagName("li"), c = b.length - 1, d = document.createElement("li"), e = document.createElement("span"), f = document.createElement("input");
        d.setAttribute("class", "selectFile"), d.className = "selectFile", e.appendChild(document.createTextNode("　　　" + c + "ページ　")), 
        f.setAttribute("type", "file"), f.setAttribute("name", "page" + c), f.setAttribute("size", "40"), 
        f.setAttribute("onchange", "input_check(" + c + ")"), f.setAttribute("class", "upload_input"), 
        f.className = "upload_input", d.appendChild(e), d.appendChild(f);
        var g = b[c - 2];
        g.appendChild(d);
    }, window.input_check = function(a) {
        $(".upload_input")[a + 1] || window.add_input();
    }, window.upload = function() {
        $("#form_area").hide(), $("#uploading").show();
    }, window.show_tag_area = function(a) {
        var b = $("#view_tag" + a), c = $("#btn_show" + a), d = $("#btn_hide" + a);
        "none" === b.css("display") ? (b.show(), c.hide(), d.show()) : (b.hide(), c.show(), 
        d.hide());
    }, $(function() {
        $(".content_upload_tags .tagCloud").each(function() {
            function a() {
                clearTimeout(k), k = setTimeout(function() {
                    c.animate({
                        "max-height": c.get(0).scrollHeight
                    }, 150);
                }, 200);
            }
            function b() {
                clearTimeout(k), k = setTimeout(function() {
                    c.animate({
                        "max-height": "150"
                    }, 150);
                }, 400);
            }
            var c = $(this), d = [];
            if (colon.test.storage && window.JSON) try {
                d = JSON.parse(localStorage["recent_tags" + pixiv.user.id]), d.length || (d = []);
            } catch (a) {
                d = [];
            }
            var e = c.find(".tag_orig");
            e.remove();
            for (var f = function() {
                if ($(this).text() === h) return c.prepend(this), i = !0, !1;
            }, g = d.length; --g >= 0; ) {
                var h = d[g], i = !1;
                c.find("li").each(f), i || d.splice(g, 1);
            }
            var j = e.text();
            c.find("li").each(function() {
                if ($(this).text() === j) return e = $(this), $(this).remove(), !1;
            }), c.prepend(e), colon.test.storage && window.JSON && c.parents("form").on("submit", function() {
                var a = $.trim($(this).find('input[name="tag[]"]').prop("value")).split(/ +/).reverse();
                $(a).each(function(a, b) {
                    var c = $.inArray(b, d);
                    c >= 0 && d.splice(c, 1), d.unshift(b);
                }), d = d.slice(0, 30), localStorage["recent_tags" + pixiv.user.id] = JSON.stringify(d);
            });
            var k = null;
            c.hover(a, b), c.css({
                "max-height": c.get(0).scrollHeight
            }), b(), c.css("overflow-y", "hidden");
        });
    }), window.add_form = function(a, b) {
        var c = $("#tag" + a + "-" + b).text(), d = $("#input_tag" + a), e = d.val().split(/\s+/), f = $.inArray(c, e), g = f !== -1;
        e.splice(g ? f : e.length, g ? 1 : 0, g ? void 0 : c), d.val($.trim(e.join(" "))), 
        window.tag_chk(e);
    }, window.openClose = function(a, b) {
        a = $("string" === $.type(a) ? "#" + a : a), b = $("string" === $.type(b) ? "#" + b : b), 
        a[0].checked && b.is(":hidden") ? b.stop(!0, !0).slideDown("fast") : b.stop(!0, !0).slideUp("fast");
    }, window.update_input_tag = function() {
        window.tag_chk($("#input_tag0").val().split(/\s+|　+/));
    }, window.tag_chk = function(a) {
        a = $.grep(a, function(a) {
            return a;
        });
        var b = $("#bookmark_add_alert")[0], c = $("#bookmark_tag_count")[0], d = a.length;
        d > 10 ? (b.style.display = "block", c.style.color = "#ff0000") : (b.style.display = "none", 
        c.style.color = "#666666"), c.innerHTML = d;
    }, $(function() {
        var a = $("#input_tag0");
        if (a.length) {
            var b = a.val(), c = b.split(/\s+|　+/);
            window.tag_chk(c);
        }
    }), window.delete_img = function(a, b) {
        pixiv.api.event.deleteImage(b, a).done(function(a) {
            "ok" === a.result && ("big" === a.type ? jQuery("#big_img").html('<input name="big" type="file" size="30">') : jQuery("#small_img").html('<input name="small" type="file" size="30">'));
        });
    }, window.load_calendar = function(a, b) {
        jQuery("#calendar").text("Loading..."), pixiv.api.event.calendar(a, b).done(function(a) {
            var b = a.year, c = a.month;
            jQuery("#calendar_now").text(b + "/" + c).attr("href", "?d=" + b + c), jQuery("#calendar_prev")[0].onclick = function() {
                window.load_calendar(a.prev_year, a.prev_month);
            }, jQuery("#calendar_next")[0].onclick = function() {
                window.load_calendar(a.next_year, a.next_month);
            }, jQuery("#calendar").html(a.calendar);
        });
    }, pixiv.api.myList = function(a, b) {
        b = b || {};
        var c = {
            e_id: pixiv.context.eventId,
            u_id: pixiv.user.id,
            d_id: b.day || pixiv.context.day,
            f_id: b.floor || pixiv.context.floor
        };
        return b.hall && (c.h_id = b.hall), "array" === $.type(a) ? (c.mode = "save", c.value = a.join()) : (c.mode = "delete", 
        c.id = a), pixiv.api.post("/rpc_event_map.php", c);
    }, pixiv.myList = {
        setup: function() {
            $("input.add-my-list").click(pixiv.myList.add), $("input.remove-my-list").click(pixiv.myList.remove);
        },
        add: function() {
            var a = $(this), b = $.makeArray(a.dataset("circle-id")), c = {
                hall: a.dataset("hall"),
                day: a.dataset("day")
            };
            pixiv.api.myList(b, c).done($.proxy(pixiv.myList.addHandler, this));
        },
        addHandler: function() {
            var a = $(this);
            a.replaceWith([ '<a href="/event_member.php?event_id=' + pixiv.context.eventId + '&amp;mode=mylist">', a.dataset("complete"), "</a>" ].join(""));
        },
        remove: function() {
            var a = $(this), b = a.dataset("circle-id"), c = {
                hall: a.dataset("hall"),
                day: a.dataset("day")
            };
            pixiv.api.myList(b, c).done($.proxy(pixiv.myList.removeHandler, this));
        },
        removeHandler: function() {
            var a = $(this);
            a.replaceWith(a.dataset("complete"));
        }
    }, window.formatStr = function(a, b) {
        a = $("#" + a)[0];
        var c = window.getSelected(a);
        if (c) return window.setSelection(a, "<" + b + ">" + c + "</" + b + ">"), !1;
    }, window.inertColor = function(a, b) {
        a = $("#" + a)[0];
        var c = window.getSelected(a);
        if (c) return window.setSelection(a, '<span style="color:' + b + ';">' + c + "</span>"), 
        window.paletteClose(), !1;
    }, window.getSelected = function(a) {
        if (document.selection) {
            a.focus();
            var b = document.selection.createRange();
            return b.text;
        }
        a.focus();
        var c = a.textLength, d = a.selectionStart, e = a.selectionEnd;
        return 1 !== e && 2 !== e || (e = c), a.value.substring(d, e);
    }, window.setSelection = function(a, b) {
        if (document.selection) {
            a.focus();
            var c = document.selection.createRange();
            c.text = b;
        } else {
            var d = a.textLength, e = a.selectionStart, f = a.selectionEnd;
            1 !== f && 2 !== f || (f = d), a.value = a.value.substring(0, e) + b + a.value.substr(f, d), 
            a.selectionStart = e + b.length, a.selectionEnd = e + b.length;
        }
        a.focus();
    }, window.insertLink = function(a, b) {
        a = document.getElementById(a);
        var c = window.getSelected(a), d = "";
        b ? c.match(/@/) && (d = c) : d = c.match(/^https?:/) ? c : c.match(/^(\w+\.)+\w{2,5}\/?/) ? "http://" + c : c.match(/ /) ? "http://" : "http://" + c;
        var e = prompt(b ? "メールアドレスを入力してください。" : "リンク先URLを入力してください。", d);
        return null !== e && ("" === c && (c = e), b && (e = "mailto:" + e), window.setSelection(a, '<a href="' + e + '">' + c + "</a>")), 
        !1;
    }, window.chkTextarea = function(a, b) {
        var c, d = 66;
        "big" === b ? c = 32 : "small" === b && (c = -32), a = document.getElementById(a);
        var e = parseInt(a.style.height, 10);
        if (a && e) {
            var f;
            e && (f = e + c), f >= d ? e && (a.style.height = f + "px") : e && (a.style.height = d + "px");
        }
        return !1;
    }, window.makePalette = function(a) {
        for (var b = "http://source.pixiv.net/source/images/spacer.gif", c = "http://source.pixiv.net/source/images/close3.gif", d = [ "#000000", "#7f7f7f", "#bfbfbf", "#fe3a20", "#febc15", "#bfbd00", "#53c900", "#00c1ff", "#f97ff8", "#8d0000", "#d9944f", "#867c2f", "#008e46", "#303acc", "#bf2d96", "#3e027d" ], e = 0, f = 0, g = 0, h = ""; e < 4; ) {
            for (;f < 4; ) h += '<div class="color">', h += '<a href="javascript:void(0);" onclick="inertColor(\'' + a + "', '" + d[g] + "')\">", 
            h += '<img src="' + b + '" border="0" width="14" height="14" style="background-color:' + d[g] + '">', 
            h += "</a></div>", g++, f++;
            h += '<div class="clear"></div>', f = 0, e++;
        }
        h += "</table>";
        var i = "";
        i += '<div class="title" onClick="paletteClose();">パレット</div>', i += '<div class="close"><a href="javascript:void(0)" onclick="paletteClose()"><img src="' + c + '"></a></div>', 
        i += '<div class="clear"></div>', i += '<div class="palette">' + h + "</div>", $("#color_palette").html(i);
    }, window.paletteToggle = function() {
        var a = $("#color_palette");
        "none" === a.css("display") ? (a.css("left", 30), a.show()) : a.hide();
    }, window.paletteOpen = function() {
        var a = $("#color_palette");
        a.css("left", 30), a.show();
    }, window.paletteClose = function() {
        var a = $("#color_palette");
        a.hide();
    }, pixiv.rankingCalendar = {
        year: null,
        prev: !0,
        next: !0,
        container: null,
        selectorContainer: null,
        lastYearContainer: null,
        nextYearContainer: null,
        setup: function() {
            var a = pixiv.rankingCalendar, b = a.container = $("div.calender_ranking_navi");
            a.selectorContainer = $("div.calendar-selector", b), a.year = pixiv.context.currentYear, 
            a.lastYearContainer = $("a.last-year", b).click(a.showLastYearList), a.nextYearContainer = $("a.next-year", b).click(a.showNextYearList), 
            a.showList();
        },
        showLastYearList: function() {
            var a = pixiv.rankingCalendar;
            return a.prev && a.showList(a.year - 1), !1;
        },
        showNextYearList: function() {
            var a = pixiv.rankingCalendar;
            return a.next && a.showList(a.year + 1), !1;
        },
        showList: function(a) {
            var b = pixiv.rankingCalendar;
            a = a || b.year;
            var c = $("#calendar-selector-" + a, b.container);
            c.length && (b.selectorContainer.hide(), c.show(), b.year = a, a <= 2007 ? (b.prev = !1, 
            b.lastYearContainer.addClass("disabled")) : (b.prev = !0, b.lastYearContainer.removeClass("disabled")), 
            a >= new Date().getFullYear() ? (b.next = !1, b.nextYearContainer.addClass("disabled")) : (b.next = !0, 
            b.nextYearContainer.removeClass("disabled")));
        }
    }, window.markAllRows = function(a) {
        for (var b, c = document.getElementById(a).getElementsByTagName("tr"), d = 0; d < c.length; d++) b = c[d].getElementsByTagName("input")[0], 
        b && "checkbox" === b.type && (b.checked || (b.checked = !0));
        return !0;
    }, window.unmarkAllRows = function(a) {
        for (var b, c = document.getElementById(a).getElementsByTagName("tr"), d = 0; d < c.length; d++) b = c[d].getElementsByTagName("input")[0], 
        b && "checkbox" === b.type && b.checked && (b.checked = !1);
        return !0;
    }, colon.test.storage && window.JSON && ("/member_illust.php" === location.pathname && location.search.indexOf("illust_id=") >= 0 || "/novel/show.php" === location.pathname) && location.search.indexOf("id=") >= 0 && $(function() {
        if (pixiv.user.id) {
            var a, b;
            try {
                a = JSON.parse(localStorage["recently_viewed" + pixiv.user.id]), a.length || (b = []);
            } catch (b) {
                a = [];
            }
            for (var c = pixiv.context.illustId, d = Date.now ? Date.now() : +new Date(), e = a.length; --e >= 0; ) {
                var f = a[e];
                (f.id === c || d - f.time > 864e5) && (a.splice(e, 1), e--);
            }
            var g;
            if ("/member_illust.php" === location.pathname) g = $('meta[property="og:image"]').attr("content"), 
            g && a.push({
                type: "illust",
                img: g,
                time: d,
                id: c,
                author: pixiv.context.userName
            }); else if ("/novel/show.php" === location.pathname) try {
                g = document.querySelector('a[href$="mode=cover"] img').src, g && a.push({
                    type: "novel",
                    img: g,
                    time: d,
                    id: c,
                    author: pixiv.context.userName
                });
            } catch (a) {}
            a = a.slice(-20), colon.storage.localStorage("recently_viewed" + pixiv.user.id, a);
        }
    }), window.impLtad = function(a, b) {
        var c = document.createElement("script");
        c.type = "text/javascript", c.async = !0, c.src = "http://d.pixiv.org/show?zone_id=" + a + "&segments=" + b + "&_=" + Math.round(1e10 * Math.random());
        var d = document.getElementsByTagName("script")[0];
        d.parentNode.insertBefore(c, d);
    }, $(function() {
        function a() {
            var a = colon.storage.cookie(e);
            if (!a) return null;
            var b = a.split("_"), c = +b[0], d = b[1], f = +b[2];
            return isFinite(c) ? {
                time: c,
                blob: d,
                status: f
            } : null;
        }
        function b(a) {
            a ? colon.storage.cookie(e, a.time + "_" + a.blob + "_" + a.status, {
                expires: 2592e6
            }) : colon.storage.cookie(e, "", {
                expires: -1
            });
        }
        function c() {
            pixiv.ui.modal.open("#popular-search-trial-end-introduction-modal");
        }
        function d() {
            colon.ga.trackEvent([ "popular_search_trial_for_comic_app_modal_shown", "location", window.location.pathname + window.location.search ]), 
            pixiv.ui.modal.open(".target-page-modal", {
                block: !0
            });
        }
        var e = pixiv.context.popular_search_trial_cookie_name;
        !$(".target-page-modal-banner").length || colon.storage.cookie("show_popular_search_trial_for_comic_app_modal_by_page_loading") || "/" === location.pathname && colon.storage.cookie("show_welcome_modal") || (colon.storage.cookie("show_popular_search_trial_for_comic_app_modal_by_page_loading", 1, {
            expires: 2592e6
        }), d()), $(".target-page-modal-banner .ui-modal-trigger").on("click", d);
        var f = {
            "/tags.php": !0,
            "/search.php": !0,
            "/novel/search.php": !0,
            "/novel/tags.php": !0,
            "/": !0
        };
        if (pixiv.context.popular_search_trial_is_target_user && f[location.pathname]) {
            $(".popular-search-trial-start").on("click", function() {
                pixiv.api.post("/rpc/popular_search_trial.php", {
                    mode: "start"
                }).done(function(a) {
                    a.success ? window.location.reload() : alert(a.message);
                });
            });
            var g = a();
            if (g && 0 === g.status) {
                var h = Math.floor(g.time - new Date() / 1e3);
                h >= 0 ? $(".popular-search-trial-time-left").each(function() {
                    return Math.floor(h / 3600) > 0 ? void $(this).text(Math.floor(h / 3600) + "時間" + Math.floor(h / 60) % 60) : void $(this).text(Math.floor(h / 60));
                }) : (g.status = 1, b(g), c(), colon.ga.trackEvent([ "premium_introduction", "modal", "popular_search" ]));
            }
        }
    });
}(this, jQuery), function() {
    "use strict";
    pixiv.api.booth = {
        get: function(a) {
            return pixiv.api.get("https://api.booth.pm/items.json", a);
        },
        item: function(a, b, c) {
            return pixiv.api.booth.get({
                tag: a,
                page: b,
                adult: c || null
            }, {
                cache: 18e4
            });
        },
        userItem: function(a) {
            return pixiv.api.booth.get({
                pixiv_user_id: a,
                r18: +pixiv.user.explicit
            });
        }
    }, pixiv.createPager = function(a) {
        var b, c = a.current_page, d = [], e = 4, f = Math.max(c - e, 1), g = Math.min(f + 2 * e, a.total_pages);
        for (g - c < e && (f = Math.max(g - 2 * e, 1)), b = f; f <= g; ++f) d.push({
            current: f === c,
            page: f,
            url: colon.query.replace({
                p: 1 === f ? null : f
            })
        });
        return colon.template("pager", {
            pages: d,
            prev: !(c < 2) && d[c - b - 1],
            next: !(c >= a.total_pages) && d[c - b + 1]
        });
    };
}(), jQuery(function(a) {
    "use strict";
    pixiv.ui.RequireMailAuthenticationDialog = function() {}, pixiv.ui.RequireMailAuthenticationDialog.prototype = {
        dialog: null,
        setup: function() {
            var b = a(".require-mail-authorization");
            b.find(":input").prop("disabled", !0), b.click(a.proxy(this.open, this));
        },
        open: function() {
            var b = a("#template-require-mail-authorization-dialog").html(), c = Handlebars.compile(b);
            this.dialog = a(c({}));
            var d = this.dialog.find(".main"), e = colon.w.scrollTop();
            return d.css("top", Math.max(e + 200, e + a(window).height() / 2 - d.outerHeight(!0) / 2)), 
            this.dialog.find(".background, .close").click(a.proxy(this.close, this)), this.dialog.appendTo("body"), 
            !1;
        },
        close: function() {
            return this.dialog.remove(), this.dialog = null, !1;
        }
    }, pixiv.user.noAuthenticated && new pixiv.ui.RequireMailAuthenticationDialog().setup();
}), function(a, b) {
    "use strict";
    function c() {
        var a = l.ui.Tag.trim(this.inputContainer.val());
        return !!a && void this.inputContainer.val(a);
    }
    function d(a) {
        if (a.target) {
            var b = this.inputContainer, c = this.text;
            if (k(a.target).hasClass("search-category") || k(a.target).closest("li").hasClass("search-category")) {
                var d = k("a", a.target).attr("href");
                return void (d && (location.href = k("a", a.target).attr("href")));
            }
            c[c.length - 1 > 0 ? c.length - 1 : 0] = k(a.target).text(), b.val(c.join(" "))[0].focus(), 
            this.hide(), l.ga.trackEvent([ "search", "suggest", b.val() ]);
        }
    }
    function e() {
        this.stop(), this.timer = a.setInterval(k.proxy(this.request, this), 500);
    }
    function f() {
        a.clearInterval(this.timer), a.setTimeout(k.proxy(this.hide, this), 300);
    }
    function g(a, b) {
        var c = (a | {}).candidates, d = [];
        if (c && c.length) for (var e, f = 0; e = c[f]; ++f) 0 === e.tag_name.indexOf(b) && d.push(e);
        return {
            candidates: d
        };
    }
    function h(a) {
        for (var b, c = (a || {}).candidates, d = [], e = 0; b = c[e]; ++e) d[e] = "<li>" + l.html.escape(b.tag_name) + "</li>";
        var f = k("#search-category-template").tmpl({
            word: encodeURIComponent(l.ui.Tag.trim(this.inputContainer.val()))
        });
        this.listItem = k.merge(k(d.join("")), f).appendTo(this.listContainer.empty().show()), 
        k("#suggest-list").show(), this.listLength = this.listItem.length, this.listPosition = -1, 
        0 === this.text.length ? (k(".search-category").remove(), this.listLength -= 3) : this.text.length > 1 && (k(".search-category-tag-user").remove(), 
        this.listLength -= 1);
    }
    function i() {
        k("#suggest-list").hide(), this.listPosition = -1, this.keyword = null, this._keyword = null;
    }
    var j = require("jquery"), k = j, l = require("colon"), m = require("pixiv");
    m.suggest = {
        container: null,
        inputContainer: null,
        listContainer: null,
        listItem: null,
        keyword: null,
        _keyword: null,
        text: null,
        stash: {},
        listPosition: -1,
        listLength: 0,
        effectiveCount: 5,
        setup: function() {
            this.inputContainer = k("#suggest-input"), this.inputContainer.length && (this.container = k("#suggest-container"), 
            this.container.length && (this.listContainer = k("#suggest-list ul"), this.text = l.ui.Tag.split(this.inputContainer.val()), 
            this.history.setup({
                max_length: 1e3
            }), this.text.length > 0 && b.URL.indexOf("search_user.php") === -1 && b.URL.indexOf("search_tag_user.php") === -1 && b.URL.indexOf("group") === -1 && this.history.add(l.ui.Tag.trim(this.inputContainer.val())), 
            this.banned.setup(), this.inputContainer.focus(k.proxy(this.start, this)).blur(k.proxy(this.stop, this)).keydown(k.proxy(this.select, this)), 
            this.container.submit(k.proxy(this.submit, this)), this.listContainer.click(k.proxy(this.click, this))));
        },
        select: function(a) {
            var b, c, d = a.which, e = this.listPosition;
            switch (d) {
              case 38:
              case 40:
                if (a.shiftKey || a.ctrlKey || a.altKey || a.metaKey) break;
                if (a.preventDefault(), this.listItem) {
                    var f = this.listLength;
                    e = this.listPosition = 38 === d ? e - 1 >= -1 ? e - 1 : f - 1 : e + 1 < f ? e + 1 : -1, 
                    this.listItem.removeClass("current"), e !== -1 && this.listItem.eq(e).addClass("current");
                }
                break;

              case 13:
                this.listItem && e !== -1 && (a.preventDefault(), this.click({
                    target: this.listItem[e]
                }));
                break;

              case 8:
              case 46:
                this.listItem && e !== -1 && a.shiftKey ? (b = this.listItem.eq(e), k(b).hasClass("search-category") || k(b).closest("li").hasClass("search-category") || (a.preventDefault(), 
                c = b.text(), b.remove(), this.history.remove(c) || this.banned.add(c), this.listItem = k("li", this.listContainer), 
                this.listLength = this.listItem.length, this.listPosition = -1, 0 === this.listLength && this.hide())) : k("li:hover", this.listContainer).length > 0 && a.shiftKey && (b = k("li:hover", this.listContainer), 
                k(b).hasClass("search-category") || k(b).closest("li").hasClass("search-category") || (a.preventDefault(), 
                c = b.text(), b.remove(), this.history.remove(c) || this.banned.add(c), this.listItem = k("li", this.listContainer), 
                this.listLength = this.listItem.length, this.listPosition = -1, 0 === this.listLength && this.hide()));
            }
        },
        submit: c,
        click: d,
        start: e,
        stop: f,
        request: function() {
            var a, b, c, d, e = this, f = l.ui.Tag.trim(l.ui.Tag.split(this.inputContainer.val()).pop());
            if (f !== this.keyword && f !== this._keyword) {
                if (this.text = l.ui.Tag.split(this.inputContainer.val()), !f) return this._keyword = f, 
                b = this.history.getAsSuggest("", 10), void (b.candidates.length > 0 ? (this.history.showHeader(), 
                this.show(b)) : this.hide());
                if (this.history.hideHeader(), c = this.history.getAsSuggest(f, 10), f.length > this.effectiveCount) {
                    if (a = f.slice(0, this.effectiveCount), b = this.stash[a]) return b = this.stash[f] || this.filter(b, f), 
                    this._keyword = f, this.stash[f] = b, void this.show(this._merge(c, b, 10));
                    f = a, d = !0;
                } else b = this.stash[f], this._keyword = null;
                this.keyword = f, b ? this.show(this._merge(c, b, 10)) : (this.stash[f] = {}, m.api.suggest(f).done(function(a) {
                    e.stash[f] = a, d || e.show(e._merge(c, a, 10));
                }).fail(function() {
                    e.show(c);
                }));
            }
        },
        filter: g,
        show: h,
        hide: i,
        _merge: function(a, b, c) {
            var d = {
                candidates: []
            };
            a = a || [], b = b || [];
            for (var e = {}, f = a.candidates.concat(b.candidates), g = 0; g < f.length; g++) {
                var h = f[g].tag_name;
                if (!(h in e || this.banned.contain(h)) && (e[h] = 1, d.candidates.push(f[g]), d.candidates.length >= c)) break;
            }
            return d;
        },
        history: {
            storage_key_name: null,
            max_length: 0,
            historyHeader: null,
            setup: function(b) {
                this.storage_key_name = "search_history" + m.user.id, this.max_length = b.max_length || 0, 
                this.historyHeader = k("#suggest-list p");
                var c = this;
                k("a", this.historyHeader).click(function() {
                    a.confirm(l.t("検索履歴を削除しますか？")) && c.clear();
                });
            },
            get: function() {
                return l.storage.localStorage(this.storage_key_name) || [];
            },
            getAsSuggest: function(a, b) {
                var c = this.get(), d = {
                    candidates: []
                };
                for (var e in c) if (0 === c[e].lastIndexOf(a, 0) && (d.candidates.push({
                    tag_name: c[e]
                }), d.candidates.length >= b)) break;
                return d;
            },
            add: function(a) {
                var b = this.get();
                b.indexOf(a) !== -1 && b.splice(b.indexOf(a), 1), b.unshift(a), l.storage.localStorage(this.storage_key_name, b.splice(0, this.max_length));
            },
            remove: function(a) {
                var b = this.get(), c = b.indexOf(a);
                return c !== -1 && b.splice(b.indexOf(a), 1), l.storage.localStorage(this.storage_key_name, b), 
                c !== -1;
            },
            clear: function() {
                l.storage.localStorage(this.storage_key_name, null);
            },
            showHeader: function() {
                this.historyHeader.show();
            },
            hideHeader: function() {
                this.historyHeader.hide();
            }
        },
        banned: {
            storage_key_name: null,
            list: null,
            setup: function() {
                this.storage_key_name = "search_suggest_banned" + m.user.id, this.list = l.storage.localStorage(this.storage_key_name) || {};
            },
            add: function(a) {
                a in this.list || (this.list[a] = 1, l.storage.localStorage(this.storage_key_name, this.list));
            },
            contain: function(a) {
                return a in this.list;
            }
        }
    };
}(window, document), function(a, b) {
    "use strict";
    pixiv.thumbnailFilter = {
        container: null,
        popupContainer: null,
        positiveContainer: null,
        negativeContainer: null,
        positiveInput: null,
        negativeInput: null,
        config: null,
        initialize: null,
        items: null,
        setup: function() {
            pixiv.user.loggedIn && b("#template-thumbnail-filter").length && (this.config = colon.storage.config("thumbnail-filter"), 
            pixiv.user.premium ? this.activate() : this.guide(), this.initialize = p.once(function() {
                var a = this, c = this.container;
                this.popupContainer = b(".toolbar-menu", c), this.positiveContainer = b(".positive", c), 
                this.negativeContainer = b(".negative", c), this.positiveInput = b("#thumbnail-filter-add-positive"), 
                this.negativeInput = b("#thumbnail-filter-add-negative"), b(".item-name", c).on("keyup blur", function() {
                    var c = b(this);
                    c.siblings(".submit-options")[a.userItem(c.val()) ? "show" : "hide"]();
                }), c.on("click", ".remove-button", function() {
                    var c = b(this), d = c.dataset();
                    a.removeItem(d.type, d.label, c.parent());
                }).on("click", ".submit-options input", function() {
                    b(this).closest(".submit-form").find(".item-name").focus();
                }).on("click", ".sprites-help", function() {
                    pixiv.ui.modal.push("#thumbnail-filter-help");
                }), b(".submit-form").submit(function() {
                    var c = b(this).dataset("type"), d = a[c + "Input"], e = pixiv.ui.Tag.split(d.val()), f = e.shift();
                    return a.addItem(c, f) && d.val(e.join(" ")), !1;
                });
            }, this));
        },
        activate: function() {
            var a = this;
            if (pixiv.user.filteringItems) {
                "array" !== b.type(pixiv.user.filteringItems) && (pixiv.user.filteringItems = []), 
                this.items = pixiv.user.filteringItems, this.parse();
                var c = b.map(this.positiveItems, function(b) {
                    return {
                        label: b,
                        user_item: a.userId(b),
                        value: a.strip(b)
                    };
                }), d = b.map(this.negativeItems, function(b) {
                    return {
                        label: b,
                        user_item: a.userId(b),
                        value: a.strip(b)
                    };
                });
                this.addContainer({
                    checked: this.config("disabled"),
                    positiveItems: c,
                    negativeItems: d
                }), colon.d.on("mouseenter mouseleave", ".thumbnail-filter-negative", function(a) {
                    var c = b("img", this), d = c.dataset();
                    switch (a.type) {
                      case "mouseenter":
                        c.attr("src", d.src);
                        break;

                      case "mouseleave":
                        c.attr("src", d.srcFiltered || pixiv.sourcePath + "images/filtered.png");
                    }
                });
            }
        },
        guide: function() {
            colon.storage.localStorage("thumbnailFilterHidden") || this.addContainer({
                checked: !1,
                positiveItems: [],
                negativeItems: []
            });
        },
        addContainer: function(a) {
            this.container = b(colon.template("thumbnail-filter", a)), pixiv.toolbar.add(this.container);
        },
        strip: function(a) {
            return a.replace(/^"(.+?)"$/, "$1").replace(/^id:(\d+)$/, "$1");
        },
        parse: function() {
            for (var a, b = this.items, c = 0, d = [], e = []; a = b[c]; ++c) this.positive(a) ? d.push(a.slice(1)) : e.push(a);
            this.positiveItems = d, this.negativeItems = e;
        },
        positive: function(a) {
            return 0 === a.indexOf("+");
        },
        userId: function(a) {
            return /^id:[1-9]\d+$/.test(a);
        },
        userItem: function(a) {
            return /^\d+$/.test(a) && +a > 10;
        },
        findTag: function(a, b) {
            var c, d, e, f = /^"(.+?)"$/;
            for (b = b.toLowerCase(), c = 0; d = this[a + "Items"][c]; ++c) if (d = d.toLowerCase(), 
            e = f.exec(d), e && b === e[1] || b.indexOf(d) >= 0) return !0;
            return !1;
        },
        findUser: function(a, b) {
            for (var c, d = 0; c = this[a + "Items"][d]; ++d) if (this.userId(c) && b === c.slice(3)) return !0;
            return !1;
        },
        toggle: function() {
            this.container.hasClass("popup") ? this.close() : this.open();
        },
        open: function() {
            this.initialize(), this.container.addClass("popup"), this.popupContainer.show(), 
            this.positiveInput.prop("disabled") || this.positiveInput.focus();
        },
        close: function() {
            this.container.removeClass("popup"), this.popupContainer.hide();
        },
        hide: function() {
            colon.storage.localStorage("thumbnailFilterHidden", !0, 2592e6), pixiv.toolbar.remove(this.container);
        },
        addItem: function(c, d, e) {
            if (d || (d = ""), d = d.replace(/^\++/, ""), this.userId(d) && (d = d.replace(/^id:/, "")), 
            !d) return !1;
            var f, g, h, i = this, j = this.userId(d) || this.userItem(d) && "user" === this[c + "Input"].parent().find('input[name="filter-type"]:checked').val(), k = j ? "id:" + +d : d, l = "positive" === c ? "+" + k : k;
            return pixiv.ui.Tag.find(l, this.items) === -1 && (f = this[c + "Container"], g = this[c + "Items"], 
            this.items.push(l), g.push(k), g.length && b("._notes", f).stop().slideUp("fast"), 
            h = b(colon.template("thumbnail-filter-list-item", {
                type: c,
                label: k,
                user_item: j,
                value: pixiv.ui.Tag.normalize(d)
            })).appendTo(b(".items", f)).stop(!0, !0).slideDown("fast"), this.update(), e !== !1 && pixiv.api.filter.add(l).pipe(function(a) {
                if (a && a.error) return b.Deferred().rejectWith(this, [ a, a.error ]);
            }).fail(function(b, d, e) {
                a.alert(e || "error"), i.removeItem(c, k, h, !1);
            }), !0);
        },
        removeItem: function(c, d, e, f) {
            if (!d) return !1;
            var g, h, i = this, j = "positive" === c ? "+" + d : d, k = pixiv.ui.Tag.find(j, this.items);
            return k !== -1 && (g = this[c + "Container"], h = this[c + "Items"], this.items.splice(k, 1), 
            h.splice(b.inArray(d, h), 1), h.length || b("._notes", g).stop().slideDown("fast"), 
            e && e.stop().slideUp("fast", function() {
                e.remove();
            }), this.update(), f !== !1 && pixiv.api.filter.remove(j).pipe(function(a) {
                if (a && a.error) return b.Deferred().rejectWith(this, [ a, a.error ]);
            }).fail(function(b, e, f) {
                a.alert(f || "error"), i.addItem(c, d, !1);
            }), !0);
        },
        update: function() {
            b('input[type="checkbox"]', this.container).is(":checked") ? this.disable() : this.enable();
        },
        enable: function() {
            this.config("disabled", null), pixiv.scrollView.reset(), this.container.filter(".toolbar-item").removeClass("off");
        },
        disable: function() {
            this.config("disabled", 1), pixiv.scrollView.reset(), this.container.filter(".toolbar-item").addClass("off");
        }
    };
}(window, jQuery), function(a, b, c) {
    "use strict";
    function d() {
        var a = this;
        colon.ui.shortcut.bind("A", function() {
            return a.applyMethod("toggleLineAlpha");
        }).bind("Z", function() {
            return a.applyMethod("undo");
        }).bind("Y", function() {
            return a.applyMethod("redo");
        }).bind("J", function() {
            return a.applyMethod("zoomin");
        }).bind("K", function() {
            return a.applyMethod("zoomout");
        }).bind(",", function() {
            return a.applyMethod("setLineWidthIndex", "-1");
        }).bind(".", function() {
            return a.applyMethod("setLineWidthIndex", "+1");
        });
    }
    function e(a, c) {
        var d = b("form.focus .drawr-paint").first().dataset("paintid");
        return this.painterList[d] && this.painterList[d][a](c), !1;
    }
    var f;
    pixiv.ui.DrawrPainter = function(c) {
        var d = this;
        this.container = b(c).addClass("parsed"), f || (f = Handlebars.compile(b("#template-drawr-paint-ui").html()));
        var e = colon.ua.ie && colon.ua.v <= 8;
        if (this.container.append(f({
            outdated: e
        })), !e) {
            this.toolbar = this.container.find(".drawr-tools"), this.funcbar = this.container.find(".drawr-functions"), 
            this.width = Math.min(Number(this.container.data("width")), this._maxWidth), this.height = Math.min(Number(this.container.data("height")), this._maxHeight), 
            this.bgColor = this.container.data("bgcolor") || this.bgColor, this.outputTarget = b("#" + this.container.data("outputid"));
            var g = this.outputTarget.parents("form");
            g && g.bind("submit", {
                self: this
            }, this.convert), this.baseCanvas = b("<canvas>").css("position", "absolute").attr("width", this.width).attr("height", this.height), 
            this.strokeCanvas = this.baseCanvas.clone().css("opacity", "" + this.lineAlpha), 
            this.baseCanvas.addClass("base"), this.historyCanvas = b("<canvas>").attr("width", this._maxWidth).attr("height", this._maxHeight * (this.historyMax + 1)), 
            this.canvases = b(".drawr-canvases", this.container).append(this.baseCanvas).append(this.strokeCanvas).append(b("<div>").width(this.width).height(this.height)).css("position", "relative"), 
            this.baseContext = this.baseCanvas[0].getContext("2d"), this.baseContext.fillStyle = this.bgColor, 
            this.strokeContext = this.strokeCanvas[0].getContext("2d"), this.strokeContext.lineCap = "round", 
            this.strokeContext.lineJoin = "round", this.historyContext = this.historyCanvas[0].getContext("2d"), 
            this.historyContext.fillStyle = this.bgColor, this.historyContext.fillRect(0, 0, this.historyContext.canvas.width, this.historyContext.canvas.height), 
            this.clearCanvas(), d.addHistory(), this.bindStrokeCanvas("brush"), this.strokeCanvas.bind("contextmenu", {
                self: this
            }, this.oncontextmenu), b(a).bind("beforeunload", function() {
                return "ページを移動すると、お絵かきデータは破棄されます。";
            }), this.initToolbar(), this.initFuncbar();
        }
    }, pixiv.ui.DrawrPainter.prototype = {
        _mode: null,
        width: 400,
        height: 300,
        _maxWidth: 600,
        _maxHeight: 600,
        zoomScale: 1,
        maxZoomScale: 2,
        minZoomScale: .5,
        mouseX: null,
        mouseY: null,
        _isMouseDown: !1,
        _bPrevX: 0,
        _bPrevY: 0,
        container: null,
        toolbar: null,
        canvases: null,
        funcbar: null,
        baseCanvas: null,
        baseContext: null,
        strokeCanvas: null,
        strokeContext: null,
        historyCanvas: null,
        historyContext: null,
        outputTarget: null,
        lineAlpha: null,
        lineWidth: null,
        lineColor: "#000000",
        curColorBlock: null,
        widthSlider: null,
        alphaToggle: null,
        bgColor: "#ffffff",
        colorList: [ "#000000", "#808080", "#C0C0C0", "#FFFFFF", "#FF3B21", "#FFBD16", "#F5F30F", "#A5E975", "#71DBFB", "#FA80F9", "#8E0000", "#FFCC99", "#877D30", "#008F47", "#313BCD", "#C02E97", "#3F037E" ],
        widthList: [ 1, 2, 4, 6, 10, 15, 30 ],
        historyMax: 5,
        _historyIndex: null,
        _historyUndo: null,
        _historyRedo: null,
        _strokeRect: {},
        bindStrokeCanvas: function(a) {
            var b = "mousedown mouseup mousemove mouseout mouseover";
            this._isMouseDown || this._mode !== a && (this._mode = a, this.strokeCanvas.unbind(b), 
            this.strokeCanvas.bind(b, {
                self: this
            }, this["on" + this._mode]));
        },
        sliderMouseDown: function(a) {
            var c = a.data.self;
            c.setUserSelect("none"), b(document).bind("mousemove", {
                self: c,
                slider: this
            }, c.sliderMouseMove), b(document).bind("mouseup", {
                self: c,
                slider: this
            }, c.sliderMouseUp), c.sliderMouseMove(a);
        },
        sliderMouseMove: function(a) {
            var c = a.data.self, d = b(a.data.slider), e = d.outerWidth(!1) - 1, f = d.width() - 1, g = c.widthList.length - 1, h = a.pageX - (e - f) / 2 - d.offset().left, i = Math.round(Math.min(Math.max(h, 0), f) * g / f), j = c.widthList[i];
            c.setLineWidth(j), d.find(".nob").trigger("mouseleave").trigger("mouseenter");
        },
        sliderMouseUp: function(a) {
            var c = a.data.self, d = b(a.data.slider).find(".nob");
            c.setUserSelect("text"), b(document).unbind("mousemove", c.sliderMouseMove).unbind("mouseup", c.sliderMouseUp), 
            a.target !== d[0] && d.trigger("mouseleave");
        },
        canvasResizeMouseMove: function(a) {
            var c = b(".resize-preview div:first-child"), d = 10 * Math.round(Math.min(600, Math.max(180, a.pageY - c.offset().top)) / 10);
            c.height() !== d && (c.height(d).css("lineHeight", d + "px"), c.text(c.width() + " x " + c.height()));
        },
        canvasResizeMouseDown: function(a) {
            var c = a.data.self, d = b(".resize-preview div:first-child");
            b(document).unbind("mousemove", c.canvasResizeMouseMove).unbind("mousedown", c.canvasResizeMouseDown), 
            c.resizeCanvas(d.height()), d.parent().remove();
        },
        beginResize: function() {
            this.container.find(".resize-preview").remove(), b('<div class="resize-preview" style="position:absolute; z-index: 999;">').append('<div style="width:420px; height:180px; background-color:rgba(80,80,80,0.75); text-align:center; font-weight:bold; font-size:200%; color:#ffffff;">').append('<div style="width:420px; height:40px;">').insertAfter(this.canvases).css("top", this.canvases.position().top), 
            b(document).bind("mousemove", {
                self: this
            }, this.canvasResizeMouseMove).bind("mousedown", {
                self: this
            }, this.canvasResizeMouseDown);
        },
        resizeCanvas: function(a) {
            this.height = a, this.baseCanvas[0].height = this.strokeCanvas[0].height = this.height, 
            this.baseContext.fillStyle = this.bgColor, this.strokeContext.lineCap = this.strokeContext.lineJoin = "round", 
            this.strokeCanvas.next().height(this.height), this.clearCanvas(), this._doHistory(0), 
            this._doZoom(1);
        },
        saveBackup: function() {
            try {
                var a = confirm("一時保存します。すでにこのブラウザに一時保存されているキャンバスは上書きされます。よろしいですか？");
                if (!a) return;
                localStorage["canvas_backup" + pixiv.user.id] = JSON.stringify({
                    image: this.baseCanvas[0].toDataURL(),
                    created_at: new Date()
                });
            } catch (a) {
                alert("一時保存できませんでした");
            }
        },
        loadBackup: function() {
            try {
                var a = JSON.parse(localStorage["canvas_backup" + pixiv.user.id]), b = new Image();
                b.src = a.image, b.onload = function(a) {
                    return function() {
                        a.clearCanvas(), a.baseContext.drawImage(this, 0, 0), a.addHistory();
                    };
                }(this);
            } catch (a) {
                alert("一時保存されたキャンバスが見つかりませんでした");
            }
        },
        initToolbar: function() {
            var a = this;
            this.curColorBlock = this.toolbar.find(".drawr-tool-curcolor"), this.widthSlider = this.toolbar.find(".drawr-tool-width"), 
            this.widthSlider.bind("mousedown", {
                self: a,
                slider: this.widthSlider
            }, this.sliderMouseDown);
            var c = this.toolbar.find(".drawr-tool-color"), d = c;
            b.each(this.colorList, function() {
                d = c.clone().attr("data-tooltip", "色:" + this.toString()).addClass("_ui-tooltip").css("background-color", this.toString()).insertAfter(d).bind("click", {
                    self: a,
                    value: this
                }, function(a) {
                    a.data.self.setLineColor(a.data.value), a.data.self.toolbar.find(".drawr-tool-color.current").removeClass("current"), 
                    b(this).addClass("current");
                }), this.toString() === a.lineColor && d.addClass("current");
            }), c.remove(), this.alphaToggle = this.toolbar.find(".drawr-tool-alpha").bind("change", {
                self: a
            }, function(a) {
                a.data.self.setLineAlpha(b(this).is(":checked") ? .5 : 1);
            }), this.setLineColor(this.container.data("linecolor") || this.lineColor), this.setLineWidth(this.container.data("linewidth") || this.lineWidth || this.widthList[0]), 
            this.setLineAlpha("on" === this.container.data("linealpha") ? .5 : 1);
        },
        initFuncbar: function() {
            var b = this;
            this.funcbar.find(".drawr-function-undo").bind("click", {
                self: b
            }, function(a) {
                a.data.self.undo();
            }), this.funcbar.find(".drawr-function-redo").bind("click", {
                self: b
            }, function(a) {
                a.data.self.redo();
            }), this.funcbar.find(".drawr-function-zoomin").bind("click", {
                self: b
            }, function(a) {
                a.data.self.zoomin();
            }), this.funcbar.find(".drawr-function-zoomout").bind("click", {
                self: b
            }, function(a) {
                a.data.self.zoomout();
            }), this.funcbar.find(".drawr-function-brush").bind("click", {
                self: b
            }, function(a) {
                a.data.self.bindStrokeCanvas("brush");
            }), this.funcbar.find(".drawr-function-hand").bind("click", {
                self: b
            }, function(a) {
                a.data.self.bindStrokeCanvas("hand");
            }), this.funcbar.find(".drawr-function-clear").bind("click", {
                self: b
            }, function(b) {
                a.confirm("全消しします。よろしいですか？(この操作はアンドゥ可能です)") && (b.data.self.clearCanvas(), b.data.self.addHistory());
            }), this.funcbar.find(".drawr-function-resize").bind("click", {
                self: b
            }, function(a) {
                a.data.self.beginResize();
            }), colon.test.storage && a.JSON && (this.funcbar.find(".drawr-function-save-backup").bind("click", {
                self: b
            }, function(a) {
                a.data.self.saveBackup();
            }), this.funcbar.find(".drawr-function-load-backup").bind("click", {
                self: b
            }, function(a) {
                a.data.self.loadBackup();
            }));
        },
        addHistory: function() {
            var a = this.historyMax + 1;
            null === this._historyUndo ? this._historyUndo = 1 : this._historyIndex - this._historyUndo >= this.historyMax && (this._historyUndo = this._historyRedo - this.historyMax + 1), 
            this._historyIndex++, this._historyRedo = this._historyIndex, this.historyContext.putImageData(this.baseContext.getImageData(0, 0, this.width, this.height), 0, this._historyIndex % a * this._maxHeight), 
            this.updateHistoryUI();
        },
        undo: function() {
            this._historyIndex > this._historyUndo && this._doHistory(-1);
        },
        redo: function() {
            this._historyIndex < this._historyRedo && this._doHistory(1);
        },
        _doHistory: function(a) {
            var b = this.historyMax + 1;
            this._historyIndex += a, this.baseContext.putImageData(this.historyContext.getImageData(0, this._historyIndex % b * this._maxHeight, this._maxWidth, this._maxHeight), 0, 0), 
            this.updateHistoryUI();
        },
        zoomin: function() {
            this.zoomScale < this.maxZoomScale && this._doZoom(2);
        },
        zoomout: function() {
            this.zoomScale > this.minZoomScale && this._doZoom(.5);
        },
        _doZoom: function(a) {
            this.zoomScale *= a;
            var c = this.width * this.zoomScale, d = this.height * this.zoomScale;
            b.each([ this.baseCanvas, this.strokeCanvas ], function() {
                b(this).css("width", c + "px").css("height", d + "px");
            });
        },
        drag: function() {},
        updateHistoryUI: function() {
            this.funcbar.find(".drawr-function-undo").attr("disabled", this._historyIndex <= this._historyUndo), 
            this.funcbar.find(".drawr-function-redo").attr("disabled", this._historyIndex >= this._historyRedo);
        },
        clearContext: function(a, b) {
            b ? a.clearRect(b.left, b.top, b.right - b.left, b.bottom - b.top) : a.clearRect(0, 0, this.width, this.height);
        },
        clearCanvas: function() {
            this.baseContext.fillRect(0, 0, this._maxWidth, this._maxHeight);
        },
        setLineAlpha: function(a) {
            this.lineAlpha !== a && (this.lineAlpha = a.toString(), this.strokeCanvas.css("opacity", this.lineAlpha), 
            this.curColorBlock.css("opacity", this.lineAlpha), .5 === a ? this.alphaToggle.prop("checked", !0) : this.alphaToggle.removeAttr("checked"));
        },
        toggleLineAlpha: function() {
            this.setLineAlpha(this.alphaToggle.is(":checked") ? 1 : .5);
        },
        setLineWidthIndex: function(a) {
            if (!this._isMouseDown) {
                var b, c;
                switch (typeof a) {
                  case "string":
                    b = this.widthList.indexOf(this.lineWidth) + parseInt(a, 10);
                    break;

                  case "number":
                    b = a;
                }
                c = this.widthList[b], c && (this.setLineWidth(c), this.displayBrushPreview({}, this._bPrevX, this._bPrevY));
            }
        },
        setLineWidth: function(a) {
            var b = this.widthSlider.width() - 1, c = this.widthList.length - 1, d = b / c;
            if (this.lineWidth !== a) {
                this.lineWidth = a;
                var e = this.widthList.indexOf(a);
                this.widthSlider.find(".nob").css("left", "" + Math.floor(e * d) + "px").attr("data-tooltip", "太さ:" + a), 
                this.curColorBlock.css("width", a + "px").css("height", a + "px");
            }
        },
        setLineColor: function(a) {
            this.lineColor = a, this.curColorBlock.css("background-color", this.lineColor).parent().attr("data-tooltip", "現在の色:" + this.lineColor.toString()).addClass("_ui-tooltip");
        },
        displayBrushPreview: function(a, b, c) {
            var d = .5 * this.lineWidth, e = 15, f = 2 * e;
            this.strokeContext.clearRect(this._bPrevX - e, this._bPrevY - e, f, f), "mouseout" !== a.type && (this.strokeContext.save(), 
            this.strokeContext.beginPath(), this.strokeContext.arc(b, c, d, 0, 2 * Math.PI, !1), 
            this.strokeContext.fillStyle = this.lineColor, this.strokeContext.fill(), this.strokeContext.restore(), 
            this._bPrevX = b, this._bPrevY = c);
        },
        setUserSelect: function(a) {
            a = a || "none", pixiv.body.css({
                "-moz-user-select": a,
                "-webkit-user-select": a
            });
        },
        getMousePosition: function(a) {
            var c = b(a.target).offset();
            return {
                x: Math.round((a.pageX - c.left) / this.zoomScale),
                y: Math.round((a.pageY - c.top) / this.zoomScale)
            };
        },
        oncontextmenu: function(a) {
            var b = a.data.self, c = b.getMousePosition(a), d = b.baseContext.getImageData(c.x, c.y, 1, 1), e = (d.data[0] << 16) + (d.data[1] << 8) + d.data[2];
            return e = "#" + ("000000" + e.toString(16)).slice(-6), b.setLineColor(e), b.toolbar.find(".drawr-tool-color.current").removeClass("current"), 
            !1;
        },
        onbrush: function(a) {
            var c = a.data.self, d = c.getMousePosition(a);
            if (3 !== a.which) {
                if ("mousedown" !== a.type && !c._isMouseDown) return "mouseout" === a.type && c.setUserSelect("text"), 
                c.displayBrushPreview(a, d.x, d.y), void (c.mouseX = c.mouseY = null);
                var e = 2;
                switch (a.type) {
                  case "mousedown":
                    c._isMouseDown = !0, c.strokeContext.lineWidth = c.lineWidth, c.strokeContext.strokeStyle = c.lineColor, 
                    c._strokeRect = {
                        left: d.x - c.lineWidth - e,
                        top: d.y - c.lineWidth - e,
                        right: d.x + c.lineWidth + e,
                        bottom: d.y + c.lineWidth + e
                    }, c.setUserSelect("none"), b(document).bind("mouseup", a.data, c.onbrush), c.mouseX = d.x, 
                    c.mouseY = d.y;
                    break;

                  case "mouseout":
                  case "mouseover":
                  case "mousemove":
                    c._isMouseDown && null !== c.mouseX && null !== c.mouseY && (c._strokeRect.left = Math.max(Math.min(c._strokeRect.left, d.x - c.lineWidth - e), 0), 
                    c._strokeRect.top = Math.max(Math.min(c._strokeRect.top, d.y - c.lineWidth - e), 0), 
                    c._strokeRect.right = Math.min(Math.max(c._strokeRect.right, d.x + c.lineWidth + e), c.width), 
                    c._strokeRect.bottom = Math.min(Math.max(c._strokeRect.bottom, d.y + c.lineWidth + e), c.height), 
                    c.strokeContext.beginPath(), c.strokeContext.moveTo(c.mouseX, c.mouseY), c.strokeContext.lineTo(d.x, d.y), 
                    c.strokeContext.stroke()), "mouseout" === a.type && (d.x = null, d.y = null), c.mouseX = d.x, 
                    c.mouseY = d.y;
                    break;

                  case "mouseup":
                    if (!c._isMouseDown) return;
                    var f = c._strokeRect;
                    c.baseContext.save(), c.baseContext.globalAlpha = c.lineAlpha, c.baseContext.drawImage(c.strokeCanvas[0], f.left, f.top, f.right - f.left, f.bottom - f.top, f.left, f.top, f.right - f.left, f.bottom - f.top), 
                    c.baseContext.restore(), c.clearContext(c.strokeContext, c._strokeRect), c.addHistory(), 
                    c.mouseX = null, c.mouseY = null, a.currentTarget !== c.strokeCanvas[0] && c.setUserSelect("text"), 
                    b(document).unbind("mouseup", c.onbrush), c._isMouseDown = !1;
                }
                a.preventDefault();
            }
        },
        onhand: function(a) {
            var c = a.data.self, d = c.getMousePosition(a);
            if (3 !== a.which) {
                if ("mousedown" !== a.type && !c._isMouseDown) return "mouseout" === a.type && c.setUserSelect("text"), 
                void (c.mouseX = c.mouseY = null);
                switch (a.type) {
                  case "mousedown":
                    c._isMouseDown = !0, c.setUserSelect("none"), b(document).bind("mouseup", a.data, c.onhand), 
                    c.mouseX = d.x, c.mouseY = d.y;
                    break;

                  case "mouseout":
                  case "mouseover":
                  case "mousemove":
                    if (c._isMouseDown && c.zoomScale > 1) {
                        var e = d.x - c.mouseX, f = d.y - c.mouseY, g = b(".drawr-canvases");
                        if (Math.abs(e) < 5 && Math.abs(f) < 5) break;
                        g.scrollLeft(g.scrollLeft() - e * c.zoomScale).scrollTop(g.scrollTop() - f * c.zoomScale);
                    }
                    break;

                  case "mouseup":
                    if (!c._isMouseDown) return;
                    b(document).unbind("mouseup", c.onhand), c._isMouseDown = !1;
                }
                a.preventDefault();
            }
        },
        convert: function(c) {
            try {
                var d = c.data.self;
                d.outputTarget.val(d.baseCanvas[0].toDataURL().replace(/^.*,/, "")), b(a).unbind("beforeunload");
            } catch (a) {
                return !1;
            }
            return !0;
        },
        dummy: null
    }, pixiv.ui.painter = {
        setup: d,
        painterList: [],
        applyMethod: e
    };
}(this, jQuery), jQuery(function(a) {
    "use strict";
    if (/^\/yabai2016/.test(location.pathname)) {
        var b = {
            el: {},
            init: function() {
                a("#yabai2016").size() > 0 && (b.el.win = a(window), b.el.timeM = a("#yabai2016_article_main_time_m"), 
                b.el.timeS = a("#yabai2016_article_main_time_s"), b.el.grid = a(".grid"), b.el.gridItem = a(".grid .grid-item"), 
                a(".share .share_tw").on("click", function() {
                    b.handleWindowOpen("https://twitter.com/share", a(this).data());
                }), a(".share .share_fb").on("click", function() {
                    b.handleWindowOpen("https://www.facebook.com/sharer/sharer.php", a(this).data());
                }), a("#yabai2016.closing").size() > 0 && (b.el.win.on("scroll", b.handleClosingScroll), 
                b.handleClosingScroll()), b.el.win.on("resize", b.handleWindowResize), b.el.win.on("scroll resize", b.handleScrollAndResize), 
                b.handleWindowResize(), b.handleScrollAndResize(), b.el.grid.isotope({
                    layoutMode: "packery",
                    itemSelector: ".grid-item",
                    isInitLayout: !1,
                    packery: {
                        gutter: 5
                    }
                }), b.el.grid.on("layoutComplete", function() {
                    b.el.grid.addClass("visible"), b.el.win.trigger("resize");
                }), b.el.grid.isotope("layout"));
            },
            handleWindowOpen: function(b, c) {
                window.open([ b, a.param(c) ].join("?"), "", "toolbar=0, status=0, width=550, height=420");
            },
            handleScrollAndResize: function() {
                var c = b.el.win.scrollTop() + b.el.win.innerHeight();
                b.el.gridItem.each(function(b, d) {
                    if (c > a(d).offset().top) {
                        var e = a(d);
                        e.css({
                            backgroundImage: "url(" + e.data("url") + ")"
                        }), setTimeout(function() {
                            e.addClass("visible");
                        }, 0);
                    }
                });
            },
            handleClosingScroll: function() {
                var c = b.el.win.scrollTop();
                b.el.win.scrollTop() < 200 ? (a("#yabai2016_message").css({
                    top: -1 * c
                }), a("#yabai2016_header").css({
                    top: 200 - c
                })) : (a("#yabai2016_message").css({
                    top: -200
                }), a("#yabai2016_header").css({
                    top: 0
                }));
            },
            handleWindowResize: function() {
                var a = Math.floor((window.innerWidth - 100 - 5) / 105);
                b.el.grid.width(105 * a - 5);
            }
        };
        a(function() {
            setTimeout(function() {
                b.init();
            }, 0);
        });
    }
}), function() {
    "use strict";
    window.RANKING_ATTR_FILTER_ITEMS = "rankingAttrFilterItems", window.RANKING_ATTR_FILTER_MENU_HIDDEN = "rankingAttrFilterMenuHidden";
}.call(this), function() {
    "use strict";
    !function(a) {
        return colon.ns("pixiv.tracker.history", {
            openDetail: function(a) {
                colon.ga.trackEvent([ "history", "history_click_illust" ]), pixiv.user.premium ? pixiv.api.track({
                    mode: "illust_detail_activity",
                    context: "history",
                    illust_id: a
                }) : pixiv.api.track({
                    mode: "illust_detail_activity",
                    context: "trial_history",
                    illust_id: a
                });
            },
            openRelated: function(a) {
                colon.ga.trackEvent([ "history", "history_click_recommend" ]), pixiv.user.premium ? pixiv.api.track({
                    mode: "illust_detail_activity",
                    context: "history_recommend",
                    illust_id: a
                }) : pixiv.api.track({
                    mode: "illust_detail_activity",
                    context: "trial_history_recommend",
                    illust_id: a
                });
            },
            rate: function() {
                colon.ga.trackEvent([ "history", "rate" ]);
            },
            rateTrial: function() {
                colon.ga.trackEvent([ "history", "rate_trial" ]);
            },
            bookmark: function() {
                colon.ga.trackEvent([ "history", "bookmark" ]);
            },
            bookmarkTrial: function() {
                colon.ga.trackEvent([ "history", "bookmark_trial" ]);
            },
            comment: function() {
                colon.ga.trackEvent([ "history", "comment" ]);
            },
            commentTrial: function() {
                colon.ga.trackEvent([ "history", "comment_trial" ]);
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        return colon.ns("pixiv.alarm", {
            send: function(a, b) {
                null == a && (a = ""), a = "[alarm] " + a, window.JSON && (a += ": " + JSON.stringify(b)), 
                window._send(a, location.href, null);
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    var a, b, c;
    b = require("jquery"), a = require("colon"), c = require("pixiv"), function(b) {
        var d, e, f, g, h, i;
        for (f = /^lang=(.+)$/, b.ajaxPrefilter(function(d, e, g) {
            var h, i, j, k, l, m, n, o;
            if ("script" !== d.dataType) {
                if (d.crossDomain) {
                    if (!d.pixivApi) return;
                    if (delete d.pixivApi, null == window.location.origin || null == String.prototype.startsWith) return;
                    if (o = d.url, k = window.location.origin, o.startsWith("https:") && !o.startsWith(k.replace(/^http:/, "https:"))) return;
                }
                if ("" !== window.location.search) for (l = window.location.search.substr(1), n = l.split("&"), 
                h = 0, i = n.length; h < i; h++) if (m = n[h], j = m.match(f), null != j) {
                    window.FormData && d.data instanceof FormData ? d.data.append("lang", j[1]) : d.data = b.param(b.extend(d.data && a.query.parse(d.data), {
                        lang: j[1]
                    }));
                    break;
                }
                c.context.token && (a.logger("api.ajaxPrefilter").trace(d, e, g), window.FormData && d.data instanceof FormData ? d.data.append("tt", c.context.token) : d.data = b.param(b.extend(d.data && a.query.parse(d.data), {
                    tt: c.context.token
                })));
            }
        }), a.ns("pixiv.api", {
            cache: {},
            request: function(c, d, e, f) {
                return null == f && (f = {}), f.filter = function(a, c) {
                    return a && !a.error ? b.Deferred().resolveWith(this, arguments) : b.Deferred().rejectWith(this, [ a, c, a && (a.message || a.error) ]);
                }, a.req.to(c, d, e, f);
            }
        }), i = [ "GET", "POST", "PUT", "DELETE" ], d = function(a) {
            return c.api[a.toLowerCase()] = function(b, c, d) {
                return this.request(a, b, c, d);
            };
        }, e = 0, g = i.length; e < g; e++) h = i[e], d(h);
        return a.ns("pixiv.api", {
            track: function(a, b) {
                return c.api.post("/rpc/index.php", a, b);
            },
            following: function(a, b, d) {
                return c.api.get("/rpc/index.php", {
                    mode: "following_users",
                    offset: a || 0,
                    num: b
                }, d);
            }
        }), a.ns("pixiv.api.filter", {
            request: function(a, b, d) {
                return c.api.post("/rpc/index.php", {
                    mode: a,
                    tag: b
                }, d);
            },
            add: function(a, b) {
                return c.api.filter.request("add_thumbnail_filter_tag", a, b);
            },
            remove: function(a, b) {
                return c.api.filter.request("delete_thumbnail_filter_tag", a, b);
            }
        }), a.ns("pixiv.api.illust", {
            rate: function(a, b, d) {
                return c.api.post("/rpc_rating.php", {
                    mode: "save",
                    i_id: a,
                    score: b
                }, d);
            },
            bookmark: function(d, e, f, g, h) {
                var i;
                return null == e && (e = !1), null == f && (f = ""), null == g && (g = []), i = b("._work-modal:visible").length > 0 ? "like_illust_on_modal" : "like_illust_on_timeline", 
                a.ga.trackEvent([ "like", i, window.location.pathname + (window.location.search || "") ]), 
                c.api.post("/rpc/index.php", {
                    mode: "save_illust_bookmark",
                    illust_id: d,
                    restrict: Number(e),
                    comment: f,
                    tags: g.join(" ")
                });
            },
            bookmarkItem: function(a, b, d) {
                return c.api.get("/rpc/index.php", {
                    mode: "get_bookmark_illusts",
                    max_bookmark_id: a,
                    num: b || 100
                }, d);
            },
            historyItem: function(b, d, e, f) {
                return c.api.get("/rpc/index.php", {
                    mode: "get_view_history",
                    date: b.getFullYear() + "-" + a.padding(b.getMonth() + 1) + "-" + a.padding(b.getDate()),
                    before: d,
                    count: e || 100
                }, f);
            },
            clearHistory: function(a) {
                return c.api.post("/rpc/index.php", {
                    mode: "save_illust_view_history_clear_time"
                }, a);
            },
            detail: function(a, b, d) {
                return c.api.get("/rpc/index.php", {
                    mode: "get_illust_detail_by_ids",
                    illust_ids: a.join(),
                    context: b
                }, d);
            },
            relatedList: function(a, b, d) {
                return c.api.get("/rpc/index.php", {
                    mode: "get_recommend_illusts",
                    ids: a,
                    num: b || 100
                }, d);
            }
        }), a.ns("pixiv.api.illust.comment", {
            item: function(a, b) {
                return c.api.get("/rpc/get_comment.php", {
                    comment_id: a,
                    mode: b ? "all" : null
                });
            },
            post: function(a, b, d, e) {
                return c.api.post("/rpc/post_comment.php", {
                    type: "comment",
                    illust_id: a,
                    author_user_id: b,
                    comment: d,
                    parent_id: e || null
                });
            },
            more: function(a, b, d) {
                return c.api.post("/rpc_comment_history.php", {
                    i_id: a,
                    u_id: b,
                    p: d
                });
            },
            delete: function(a, b) {
                return c.api.post("/rpc_delete_comment.php", {
                    i_id: a,
                    del_id: b
                });
            }
        }), a.ns("pixiv.api.illust.sticker", {
            post: function(a, b, d, e) {
                return c.api.post("/rpc/post_comment.php", {
                    type: "stamp",
                    illust_id: a,
                    author_user_id: b,
                    stamp_id: d,
                    parent_id: e || null
                });
            }
        }), a.ns("pixiv.api.novel", {
            rate: function(a, b, d) {
                return c.api.post("/novel/rpc_rating.php", {
                    mode: "save",
                    i_id: a,
                    u_id: c.user.id,
                    score: b,
                    qr: 1
                }, d);
            },
            bookmark: function(d, e, f, g, h) {
                var i;
                return null == e && (e = !1), null == f && (f = ""), null == g && (g = []), i = b("._work-modal:visible").length > 0 ? "like_novel_on_modal" : "like_novel_on_timeline", 
                a.ga.trackEvent([ "like", i, window.location.pathname + (window.location.search || "") ]), 
                c.api.post("/rpc/index.php", {
                    mode: "save_novel_bookmark",
                    novel_id: d,
                    restrict: Number(e),
                    comment: f,
                    tags: g.join(" ")
                }, h);
            },
            detail: function(a, b) {
                return c.api.get("/novel/rpc/index.php", {
                    mode: "get_novel_detail_by_ids",
                    novel_ids: a.join()
                }, b);
            },
            historyItem: function(b, d, e, f) {
                return c.api.get("/novel/rpc/index.php", {
                    mode: "get_view_history",
                    date: b.getFullYear() + "-" + a.padding(b.getMonth() + 1) + "-" + a.padding(b.getDate()),
                    before: d,
                    count: e || 100
                }, f);
            },
            clearHistory: function(a) {
                return c.api.post("/novel/rpc/index.php", {
                    mode: "save_novel_view_history_clear_time"
                }, a);
            }
        }), a.ns("pixiv.api.novel.comment", {
            item: function(a, b) {
                return c.api.get("/novel/rpc/get_comment.php", {
                    comment_id: a,
                    mode: b ? "all" : null
                });
            },
            post: function(a, b, d, e) {
                return c.api.post("/novel/rpc/post_comment.php", {
                    type: "comment",
                    novel_id: a,
                    author_user_id: b,
                    comment: d,
                    parent_id: e || null
                });
            },
            more: function(a, b, d) {
                return c.api.post("/novel/rpc_comment_history.php", {
                    i_id: a,
                    u_id: b,
                    p: d
                });
            },
            delete: function(a, b) {
                return c.api.post("/novel/rpc_delete_comment.php", {
                    i_id: a,
                    del_id: b
                });
            }
        }), a.ns("pixiv.api.novel.sticker", {
            post: function(a, b, d, e) {
                return c.api.post("/novel/rpc/post_comment.php", {
                    type: "stamp",
                    novel_id: a,
                    author_user_id: b,
                    stamp_id: d,
                    parent_id: e || null
                });
            }
        }), a.ns("pixiv.api.message", {
            createThread: function(a, b) {
                return c.api.post("rpc/index.php", {
                    mode: "message_thread",
                    invited_user_ids: a.join()
                }, b);
            },
            attachmentItem: function(a, b, d) {
                return c.api.get("rpc/index.php", {
                    mode: "message_thread_content_images",
                    thread_id: a,
                    num: b
                }, d);
            },
            thread: function(a, b) {
                return c.api.get("/rpc/index.php", {
                    mode: "message_thread",
                    thread_id: a
                }, b);
            }
        }), a.ns("pixiv.api.search", {
            sampleUserSearch: function(a, b, d) {
                return c.api.get("rpc/index.php", {
                    mode: "sample_user_search",
                    word: a,
                    count: b,
                    options: d
                });
            }
        });
    }(b);
}.call(this), function() {
    "use strict";
    var a, b;
    b = require("jquery"), a = require("colon"), function(b) {
        return a.ns("pixiv.badge", {
            items: {},
            update: function(a) {
                var c, d, e, f;
                a && b.extend(this.items, a), c = 0, e = this.items;
                for (d in e) f = e[d], c += +f;
                pixiv.title(function(a) {
                    return function(a, b) {
                        return c ? "(" + c + ") " + b : null;
                    };
                }(this));
            }
        });
    }(b);
}.call(this), function() {
    "use strict";
    var a, b, c, d, e, f, g;
    a = require("jquery"), c = require("colon"), e = require("pixiv"), d = require("./es_bridge"), 
    g = (null != d ? d : c).throttle, b = null != (f = require("modals/MuteEditModal")) ? f.MuteEditModal : void 0, 
    ("undefined" != typeof module && null !== module ? module.hot : void 0) && module.hot.accept("modals/MuteEditModal", function() {
        return b = require("modals/MuteEditModal").MuteEditModal;
    }), a(function() {
        return e.config.whitecubeEmbed ? e.whitecubeBalloonMenuPopup.setup() : c.dispatcher.connect(/^(\/whitecube\/|\/contest\/|\/novel\/contest\/)/, function() {
            return e.whitecubeBalloonMenuPopup.setup();
        }).dispatch();
    }), c.ns("pixiv.whitecubeBalloonMenuPopup", {
        setup: function() {
            c.d.on("click", "._balloon-menu-opener", a.proxy(this.open, this)).on("click", "._balloon-menu-popup ._balloon-menu-closer", a.proxy(this.close, this)).on("click", "._open-mute-edit-modal", a.proxy(this.openMuteEditModal, this)).on("uimodalclose", "._balloon-menu-popup", function(b) {
                return a("._balloon-menu-opener.opened").removeClass("opened"), !1;
            }), a(".notification-button._balloon-menu-opener").on("click", a.proxy(this.open, this)), 
            c.w.resize(g(this.close.bind(this)));
        },
        open: function(b) {
            var d, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w;
            if (1 === b.which && !(a(b.currentTarget).find("._balloon-menu-popup").first().find(b.target).length > 0)) return b.preventDefault(), 
            b.stopPropagation(), q = a(b.target).closest("a.share"), q.length > 0 ? void this.openWindowToShare(q) : a(b.currentTarget).hasClass("opened") ? void this.close() : (this.close(), 
            r = a(b.currentTarget), g = !1, this.popup = r.children("._balloon-menu-popup"), 
            this.popup.length < 1 && (this.popup = r.siblings("._balloon-menu-popup")), this.popup.length < 1 && (h = r.dataset("id"), 
            t = r.dataset("type"), o = r.dataset("role"), f = r.dataset("caption"), u = r.dataset("user-id"), 
            v = r.dataset("user-name"), m = r.dataset("permalink"), this.data = {
                id: h,
                type: t,
                user_id: u,
                is_bookmarked: r.hasClass("on"),
                is_following: r.hasClass("following"),
                reportable: "share" !== o && u !== e.user.id,
                blockable: "share" !== o && u !== e.user.id && "user" === t,
                likable: ("illust" === t || "novel" === t) && "share" !== o,
                followable: "user" === t,
                shareable: "share" === o,
                muteable: "share" !== o && u !== e.user.id,
                message_url: "/messages.php?receiver_id=" + h,
                report_url: function() {
                    switch (t) {
                      case "illust":
                        return "/illust_infomsg.php?illust_id=" + h;

                      case "novel":
                        return "/support.php?tid=5";

                      case "user":
                        return "/user_infomsg.php?id=" + u;

                      default:
                        return "";
                    }
                }(),
                block_url: "/user_infomsg.php?id=" + u + "#block",
                tweet_url: "https://twitter.com/intent/tweet?text=" + encodeURIComponent(null != f ? f + " | " + v : v) + "&url=" + encodeURIComponent(m) + "&hashtags=" + encodeURIComponent("pixiv"),
                facebook_url: "https://www.facebook.com/sharer/sharer.php?u=" + encodeURIComponent(m),
                line_url: "https://lineit.line.me/share/ui?url=" + encodeURIComponent(m)
            }, g = !0, this.popup = a(c.template("balloon-menu-popup", this.data))), w = r.closest("._work-modal > .modal-scroll-wrapper"), 
            l = 0 !== w.length, j = 0 !== r.closest(".item-container").length, k = 0 !== r.closest("._cover-image").length, 
            i = 0 !== r.closest(".featured-entries").length, j && l ? (g && w.append(this.popup), 
            s = r.offset(), c.ui.popupPosition(this.popup, null, {
                top: w.scrollTop() + (s.top - w.offset().top) + r.outerHeight(),
                left: s.left,
                width: r.outerWidth(),
                margin: 0,
                forceUnderTarget: !0
            })) : j || k || i ? (g && a("body").append(this.popup), c.ui.popupPosition(this.popup, r, {
                margin: 0,
                forceUnderTarget: !0
            })) : (p = !1, n = r.find("._balloon-menu-anchor"), 0 === n.length && (p = !0, n = r), 
            d = n.position().left, g ? r.append(this.popup) : 0 === r.children("._balloon-menu-popup").length && (p = !1), 
            p && (d = 0), this.popup.is("._balloon-menu-left-align") ? this.popup.css("left", d + n.outerWidth() - this.popup.outerWidth() + "px") : this.popup.is("._balloon-menu-right-align") ? this.popup.css("left", d + "px") : this.popup.css("left", d + (n.outerWidth() - this.popup.outerWidth()) / 2 + "px")), 
            this.popupId = c.ui.modal.push(this.popup, {
                disposable: g,
                zIndex: l || "user" !== t ? 10 : void 0
            }), null != e.WorkModal && this.popup.on("click", ".like-action", e.WorkModal.actionLike), 
            r.addClass("opened"));
        },
        close: function(a) {
            null != this.popupId && (c.ui.modal.close(this.popupId), delete this.popup, delete this.popupId), 
            a && a.stopPropagation();
        },
        openWindowToShare: function(a) {
            var b, c, d, e, f, g;
            return f = {
                twitter: {
                    width: 550,
                    height: 420
                },
                facebook: {
                    width: 670,
                    height: 650
                },
                line: {
                    width: 503,
                    height: 510
                }
            }, e = f[a.data("type")], null != window.screenX && window.screenX >= 0 && window.screenY >= 0 ? (d = (window.screen.availWidth - e.width) / 2, 
            g = (window.screen.availHeight - e.height) / 2) : null != window.screenLeft && window.screenLeft >= 0 && window.screenTop >= 0 ? (d = (window.screen.availWidth - e.width) / 2, 
            g = (window.screen.availHeight - e.height) / 2) : (d = 0, g = 0), b = "width=" + e.width + ",height=" + e.height + ",left=" + d + ",top=" + g + ",resizable=yes,scrollbars=no,chrome=yes,centerscreen=yes", 
            c = a.attr("href"), window.open(c, null, b);
        },
        openMuteEditModal: function(a) {
            var c;
            c = new b(this.data.type, this.data.id), c.show();
        }
    });
}.call(this), function() {
    "use strict";
    colon.ns("pixiv.api.comment", {
        post: function(a, b, c, d) {
            return pixiv.api.post("/rpc/post_comment.php", {
                type: "comment",
                illust_id: a,
                author_user_id: b,
                comment: c,
                parent_id: d || null
            });
        },
        reply: function(a, b, c, d) {
            return pixiv.api.comment.post(a, c, d, b);
        },
        more: function(a, b, c) {
            return pixiv.api.post("rpc_comment_history.php", {
                i_id: a,
                u_id: b,
                p: c
            });
        },
        delete: function(a, b) {
            return pixiv.api.post("rpc_delete_comment.php", {
                i_id: a,
                del_id: b
            });
        }
    }), colon.ns("pixiv.api.stamp", {
        post: function(a, b, c) {
            return pixiv.api.post("/rpc/post_comment.php", {
                type: "stamp",
                illust_id: a,
                author_user_id: b,
                stamp_id: c
            });
        }
    }), colon.ns("pixiv.comment", {
        page: 1,
        setup: function() {
            return colon.d.on("submit", "._comment-form", this.postComment).on("click", "._comment-form .stamp", this.postStamp).on("click", ".more-comment", this.more).on("click", ".delete-comment", this.delete).on("click", ".reply", function(a) {
                return function(b) {
                    return a.showReply(b.target);
                };
            }(this));
        },
        postComment: function(a) {
            var b, c;
            return c = $(this), !c.hasClass("loading") && (c.addClass("loading"), b = $("._comment-form textarea"), 
            pixiv.api.comment.post(pixiv.context.illustId, pixiv.context.userId, b.val()).always(function() {
                return c.removeClass("loading");
            }).done(function(a) {
                return b.val(""), $("._comment-items ._no-item").addClass("hidden"), $(a.body.html).hide().prependTo("._comment-items").slideDown("fast"), 
                pixiv.scrollView.update();
            }).fail(function(a, b, c) {
                return window.alert(c);
            }), !1);
        },
        postStamp: function(a) {
            var b;
            return b = $(this), !b.hasClass("loading") && (b.addClass("loading"), pixiv.api.stamp.post(pixiv.context.illustId, pixiv.context.userId, $(this).dataset("id")).always(function() {
                return b.removeClass("loading");
            }).done(function(a) {
                return $("._comment-items ._no-item").addClass("hidden"), $(a.body.html).hide().prependTo("._comment-items").slideDown("fast"), 
                pixiv.scrollView.update();
            }).fail(function(a, b, c) {
                return window.alert(c);
            }), !1);
        },
        delete: function(a) {
            var b, c;
            return c = $(this), !(c.hasClass("loading") || !window.confirm(c.dataset("textConfirm"))) && (c.addClass("loading"), 
            b = $(this).closest("._comment-item"), pixiv.api.comment.delete(pixiv.context.illustId, b.dataset("id")).always(function() {
                return c.removeClass("loading");
            }).done(function() {
                return b.slideUp("fast", function() {
                    if (b.remove(), !$("._comment-items ._comment-item").length) return $("._comment-items ._no-item").removeClass("hidden");
                });
            }).fail(function(a, b, c) {
                return window.alert(c);
            }), !1);
        },
        more: function(a) {
            var b;
            return b = $(this), !b.hasClass("loading") && (b.addClass("loading"), pixiv.api.comment.more(pixiv.context.illustId, pixiv.context.userId, ++pixiv.comment.page).always(function() {
                return b.removeClass("loading");
            }).done(function(b) {
                return $(b.body.html).appendTo("._comment-items"), b.body.more || $(a.target).remove(), 
                pixiv.scrollView.update();
            }).fail(function(a, b, c) {
                return window.alert(c);
            }), !1);
        },
        showComment: function(a) {},
        showReply: function(a) {
            var b, c, d;
            return b = $("._comment-modal .content"), d = $(".user-name", a).text(), c = $('<div class="body"/>').text(d + ": " + $(".body", a).clone().text()), 
            b.html($("._comment-item").first().clone()).prepend(a.clone()).show();
        }
    });
}.call(this), function() {
    "use strict";
    !function(a) {
        return a.browser = {
            msie: colon.ua.ie
        }, colon.storage.localStorage("newUser", null), colon.ns("pixiv.fallback"), pixiv.fallback.post = function(b) {
            var c, d, e, f;
            return b = a(b), e = !1, c = a.Deferred(), f = "post." + colon.id(), b.attr("target", f), 
            d = a('<iframe name="' + f + '" src="about:blank" class="_fallback-post-iframe"></iframe>').on("load", function(d) {
                var f;
                if (e) {
                    try {
                        f = JSON.parse(a(this.contentWindow.document).text());
                    } catch (a) {
                        d = a;
                    }
                    c.resolve(f);
                } else b[0].submit(), e = !0;
            }).appendTo("body"), c.promise();
        }, pixiv.fallback.placeholder = function(b) {
            b = a(b), b.each(function() {
                var b, c, d;
                c = a(this), c.data("fallback-enabled") || (d = a.trim(c.attr("placeholder")), d && (c.wrap('<div class="_placeholder-container">'), 
                b = a('<div class="placeholder">' + d + "</div>").insertBefore(c).on("click", function() {
                    b.addClass("_hidden"), c[0].focus();
                }), c.on("focus", function() {
                    b.addClass("_hidden");
                }).on("blur", function() {
                    c.val() || b.removeClass("_hidden");
                }).blur().data("fallback-enabled", !0)));
            });
        }, pixiv.fallback.placeholder.supported = "placeholder" in document.createElement("input"), 
        pixiv.fallback.placeholder.setup = function(b) {
            pixiv.fallback.placeholder.supported || pixiv.fallback.placeholder(a("input[placeholder], textarea[placeholder]", b));
        };
    }(jQuery);
}.call(this), function() {
    "use strict";
    var a = function(a, c) {
        function d() {
            this.constructor = a;
        }
        for (var e in c) b.call(c, e) && (a[e] = c[e]);
        return d.prototype = c.prototype, a.prototype = new d(), a.__super__ = c.prototype, 
        a;
    }, b = {}.hasOwnProperty;
    !function(b) {
        return b(function() {
            colon.dispatcher.connect("/history.php", function() {
                pixiv.user.premium && 0 === pixiv.context.historyTotalCount || (pixiv.History.setup(), 
                pixiv.AreaEvent.setup());
            }).dispatch();
        }), pixiv.History = function() {
            function a(a, c, d) {
                this.type = c, this.container = b(a), this.itemsContainer = b("._history-items", this.container), 
                this.date = pixiv.History.jst(new Date()), (null != d ? d.total : void 0) ? (this.items = d, 
                this.append(!0)) : (this.listType = "bookmark", this.more()), this.watch();
            }
            return a.setup = function() {
                pixiv.user.premium ? new pixiv.History("._history-container", pixiv.context.type, pixiv.context.historyList) : new pixiv.HistoryTrial("._history-container", pixiv.context.type);
            }, a.jst = function(a) {
                var b, c;
                return c = a.getTime(), b = 1e3 * a.getTimezoneOffset() * 60, new Date(c + b + 324e5);
            }, a.findItem = function(a, b) {
                var c, d, e, f;
                if (!a) return !1;
                for (d = e = 0, f = a.length; e < f; d = ++e) if (c = a[d], "" + c.illust_id == "" + b) return [ c, d ];
            }, a.listId = function(a) {
                var b;
                return function() {
                    var c, d, e;
                    for (e = [], c = 0, d = a.length; c < d; c++) b = a[c], e.push("" + b.illust_id);
                    return e;
                }();
            }, a.prototype.expire = 7, a.prototype.data = {}, a.prototype.list = [], a.prototype.listType = "history", 
            a.prototype.items = null, a.prototype.itemCount = 0, a.prototype.date = null, a.prototype.type = "illust", 
            a.prototype.navigationContext = "list", a.prototype.watch = function() {
                colon.d.on("click", ".show-detail", function(a) {
                    return function(b) {
                        return a.toggle(b.currentTarget), !1;
                    };
                }(this)).on("area", ".history-more", function(a) {
                    return function() {
                        a.more();
                    };
                }(this)).on("click", ".update-detail", function(a) {
                    return function(b) {
                        var c;
                        return null != (c = a.detail) && c.related.updateDetail(b.currentTarget), !1;
                    };
                }(this)).on("click", ".rate", b.proxy(this.rate, this)).on("click", ".toggle-bookmark", b.proxy(this.bookmark, this)).on("click", ".add-comment", b.proxy(this.comment, this)).on("click", ".clear-history", b.proxy(this.clearHistory, this)).on("click", ".prev", b.proxy(this.prev, this)).on("click", ".next", b.proxy(this.next, this)), 
                colon.w.on("resize", function(a) {
                    return function() {
                        a.resize();
                    };
                }(this)), colon.ui.shortcut.bind("ESC", function(a) {
                    return function() {
                        return a.close(), !1;
                    };
                }(this)).bind("J →", function(a) {
                    return function() {
                        return a.next(), !1;
                    };
                }(this)).bind("K ←", function(a) {
                    return function() {
                        return a.prev(), !1;
                    };
                }(this)).bind("↓", function(a) {
                    return function() {
                        return a.detail && a.switchContext("detail"), !1;
                    };
                }(this)).bind("↑", function(a) {
                    return function() {
                        return a.switchContext("list"), !1;
                    };
                }(this)).bind("L", function(a) {
                    return function() {
                        return a.detail && b(".rate").click(), !1;
                    };
                }(this)).bind("B", function(a) {
                    return function() {
                        return a.detail && b(".toggle-bookmark").click(), !1;
                    };
                }(this)).bind("C", function(a) {
                    return function() {
                        return a.detail && window.open(b(".add-comment").attr("href"), "_blank"), !1;
                    };
                }(this)).bind("V", function(a) {
                    return function() {
                        return a.detail && window.open(b(".image").attr("href"), "_blank"), !1;
                    };
                }(this)).bind("F", function(a) {
                    return function() {
                        return a.detail && b(".ui-profile-popup", a.detail.container).mouseenter(), !1;
                    };
                }(this));
            }, a.prototype.switchContext = function(a) {
                var c, d;
                ("detail" !== a || (null != (c = this.detail) && null != (d = c.related) ? d.list.length : void 0)) && (this.navigationContext = a, 
                this.current.toggleClass("current", "detail" !== a), this.detail && b(".ui-profile-popup", this.detail.container).mouseleave());
            }, a.prototype.prev = function() {
                "detail" === this.navigationContext ? this.detail.related.prev() : this.current && this.current.prevAll("._history-item").first().click();
            }, a.prototype.next = function() {
                "detail" === this.navigationContext ? this.detail.related.next() : this.current ? this.current.nextAll("._history-item").first().click() : b(".history-item", this.itemsContainer).first().click();
            }, a.prototype.rate = function(a) {
                var c, d, e;
                e = b(a.currentTarget), c = e.dataset("id"), e.addClass("on"), pixiv.api.illust.rate(c, 10), 
                null != (d = this.data[c]) && (d.is_rated = !0), pixiv.tracker.history.rate();
            }, a.prototype.bookmark = function(a) {
                var c, d, e;
                if (e = b(a.currentTarget), !e.hasClass("on")) return c = e.dataset("id"), e.addClass("on"), 
                pixiv.api.illust.bookmark(c), null != (d = this.data[c]) && (d.is_bookmarked = !0), 
                pixiv.config.whitecubeEmbed && pixiv.api.illust.rate(c, 10), pixiv.tracker.history.bookmark(), 
                !1;
            }, a.prototype.comment = function(a) {
                pixiv.tracker.history.comment();
            }, a.prototype.clearHistory = function(a) {
                window.confirm(colon.t("履歴をクリアしますか？")) && pixiv.api[this.type].clearHistory().done(function() {
                    window.location.reload();
                });
            }, a.prototype.resize = function() {
                var a, b, c, d;
                b = Math.max(970, this.itemsContainer.outerWidth(!0)), c = 250, a = Math.floor(b / c), 
                this.itemsContainer.css("margin", "0 " + (b - c * a) / 2 + "px"), null != (d = this.detail) && d.updateSize();
            }, a.prototype.toggle = function(a) {
                var b;
                a === (null != (b = this.detail) ? b.parent[0] : void 0) ? this.close() : this.open(a);
            }, a.prototype.open = function(a) {
                this.current = b(a), this.switchContext("list"), this.detail ? this.detail.clear() : this.detail = new pixiv.HistoryDetail(this.data, this), 
                this.detail.open(a, this.list), pixiv.tracker.history.openDetail(this.current.data("id"));
            }, a.prototype.close = function() {
                this.detail && (this.switchContext("list"), this.detail.hide(), delete this.detail);
            }, a.prototype.append = function(a) {
                var c, d, e, f, g, h, i, j, k, l, m;
                if (i = this.items.illusts.length, this.items.illusts = function() {
                    var a, b, c, d;
                    for (c = this.items.illusts, d = [], a = 0, b = c.length; a < b; a++) g = c[a], 
                    (g.illust_id || g.id) && d.push(g);
                    return d;
                }.call(this), this.items.illusts.length) {
                    for (a && (this.itemCounter = this.items.total - (i - this.items.illusts.length), 
                    m = this.date.getFullYear(), k = this.date.getMonth(), d = this.date.getDate(), 
                    e = m + "-" + colon.padding(k + 1) + "-" + colon.padding(d), c = this.items.total), 
                    f = b(colon.template("history-" + this.type + "-items", {
                        items: this.items.illusts,
                        date: e,
                        count: c,
                        is_whitecube: pixiv.config.whitecubeEmbed
                    })).appendTo(this.itemsContainer), null == this.current && (this.current = f.first()), 
                    this.itemCounter -= this.items.illusts.length, l = this.items.illusts, h = 0, j = l.length; h < j; h++) g = l[h], 
                    this.data[g.illust_id] = g;
                    Array.prototype.push.apply(this.list, pixiv.History.listId(this.items.illusts)), 
                    this.resize();
                }
            }, a.prototype.more = function() {
                if (!this.loading && !this.finished) return this.loading = !0, colon.h.addClass("loading"), 
                this.request().done(function(a) {
                    return function() {
                        a.loading = !1, colon.h.removeClass("loading");
                    };
                }(this)).fail(function() {});
            }, a.prototype.request = function() {
                var a, b, c, d;
                return "bookmark" === this.listType && "novel" !== this.type ? this.requestBookmark() : (this.itemCounter <= 0 ? (this.date.setDate(this.date.getDate() - 1), 
                --this.expire, d = !0) : b = null != (c = this.list.slice(-1)[0]) ? c.last_view_timestamp : void 0, 
                a = pixiv.api[this.type].historyItem(this.date, b), a.then(function(c) {
                    return function(e, f, g, h) {
                        var i, j, k, l, m, n;
                        for (k = [], n = e.body.illusts, l = 0, m = n.length; l < m; l++) j = n[l], j.last_view_timestamp !== b && k.push(j);
                        if (e.body.illusts = k, c.items = e.body, i = c.items.illusts.length) return d && (c.itemCounter = c.items.total - (e.body.illusts.length - i)), 
                        c.append(d), a;
                        if (c.items = null, c.itemCounter = 0, c.expire < 0) {
                            if ("novel" === c.type) return c.finish(), a;
                            c.listType = "bookmark";
                        }
                        return c.request();
                    };
                }(this)));
            }, a.prototype.requestBookmark = function() {
                var a;
                return pixiv.api[this.type].bookmarkItem(null != (a = this.lastItem) ? a.bookmark_id : void 0).done(function(a) {
                    return function(b, c, d, e) {
                        var f, g, h, i, j;
                        if (!b.body.total && !a.items) return void a.noItem();
                        for (j = b.body.illusts, h = 0, i = j.length; h < i; h++) g = j[h], a.list.indexOf("" + g.illust_id) === -1 && (f = new Date(1e3 * g.bookmark_add_timestamp), 
                        a.items && a.date.toDateString() !== f.toDateString() && (a.append(!0), a.items = null), 
                        a.date = f, null == a.items && (a.items = {
                            total: 0,
                            illusts: []
                        }), a.items.illusts.push(g), ++a.items.total);
                        a.lastItem = g, b.body.illusts.length || (a.append(!0), a.finish());
                    };
                }(this));
            }, a.prototype.finish = function() {
                colon.d.off("area"), this.finished = !0;
            }, a.prototype.noItem = function() {
                this.finish(), b(".no-item").removeClass("_hidden");
            }, a;
        }(), pixiv.illustDetail = function() {
            var a;
            return a = {}, function(c, d, e) {
                var f, g, h, i, j, k, l, m, n, o, p, q, r, s;
                if (null == e && (e = {}), q = null != (r = e.preloadCount) ? r : 3, k = [], g = {}, 
                h = function() {
                    var b;
                    switch (!1) {
                      case !(null != (b = d[c]) ? b.user_id : void 0):
                        return colon.async(d[c]);

                      case !a[c]:
                        return a[c];
                    }
                }(), h || (k.push(c), g[c] = b.Deferred()), e.list) for (l = e.list.indexOf(c), 
                f = Math.max(l - q, 0), i = l + q, s = e.list.slice(f, i), m = 0, o = s.length; m < o; m++) j = s[m], 
                d[j] || a[j] || g[j] || (k.push(j), g[j] = b.Deferred());
                for (k.length && pixiv.api.illust.detail(k).done(function(b) {
                    var c, e;
                    e = b.body;
                    for (j in e) c = e[j], c.error || (d[j] = c, g[j].resolve(c), delete a[j]);
                }).fail(function(b) {
                    return function() {
                        g[j].rejectWith(null, arguments), delete a[j];
                    };
                }(this)), n = 0, p = k.length; n < p; n++) j = k[n], a[j] = g[j].promise();
                return null != h ? h : a[c];
            };
        }(), pixiv.HistoryDetail = function() {
            function a(a, c) {
                this.data = a, this.history = c, this.container = b("._history-detail-container"), 
                this.contentContainer = b(".content", this.container), this.nippleContainer = b(".nipple", this.container);
            }
            return a.prototype.updateTargetId = function() {
                return this.targetId = colon.id();
            }, a.prototype.open = function(a, c) {
                return this.parent = b(a), this.show(this.parent, c);
            }, a.prototype.show = function(a, c) {
                var d, e, f;
                return this.target = b(a), this.target.addClass("current").siblings().removeClass("current"), 
                d = "" + this.target.data("id"), f = this.updateTargetId(), this.visible || (this.container.removeClass("_hidden"), 
                this.visible = !0), (e = this.data[d]) && (e.tmp = !0, this.update(e), delete e.tmp), 
                pixiv.ui.scroll(this.parent), pixiv.illustDetail(d, this.data, {
                    list: c
                }).done(function(a) {
                    return function(b) {
                        f === a.targetId && (a.update(b), null == a.related && (a.related = new pixiv.HistoryDetailRelated(d, a.data, a)));
                    };
                }(this));
            }, a.prototype.hide = function() {
                var a;
                this.target.removeClass("current").siblings().removeClass("current"), null != (a = this.last) && a.css("margin-bottom", ""), 
                this.container.height(0), this.clear(), this.visible = !1;
            }, a.prototype.clear = function() {
                this.related && (this.related.clear(), delete this.related);
            }, a.prototype.update = function(a) {
                var c, d, e;
                this.player && (this.player.dispose(), this.player = null), this.contentContainer.html(colon.template("history-detail-item", b.extend({
                    is_whitecube: pixiv.config.whitecubeEmbed
                }, a))).find(".prev").toggleClass("_hidden", !this.target.prevAll(".list-item").length).end().find(".next").toggleClass("_hidden", !this.target.nextAll(".list-item").length), 
                this.updateSize(), a.ugoira_meta && (d = b(".image", this.contentContainer), e = d.width(), 
                c = d.height(), this.player = new pixiv.UgokuIllustPlayer(this.contentContainer, JSON.parse(a.ugoira_meta), {
                    autoStart: !0,
                    autoSize: !0,
                    maxWidth: e,
                    maxHeight: c
                }));
            }, a.prototype.updateSize = function() {
                var a, c, d, e, f;
                e = this.parent.offset(), d = 140, c = 30, a = Math.max(colon.w.height() - d - c, 621), 
                this.container.css({
                    top: e.top + d,
                    height: a
                }), this.nippleContainer.css("left", e.left + 120 - 20), b(".image", this.contentContainer).css({
                    width: colon.w.width() - 200,
                    height: a - 20 - 1 - 10 - 30 - 10 - 15 - 160 - 15
                }), null != (f = this.last) && f.css("margin-bottom", ""), this.last = this.parent.css("margin-bottom", a - 140 + 5);
            }, a;
        }(), pixiv.HistoryDetailRelated = function() {
            function a(a, c, d) {
                this.id = a, this.data = c, this.detail = d, this.container = b(".related-container", this.detail.container), 
                this.itemsContainer = b("._history-related-items", this.container).empty(), this.show();
            }
            return a.prototype.list = [], a.prototype.clear = function() {
                var a;
                null != (a = this.areaEvent) && a.off(), this.itemsContainer.empty();
            }, a.prototype.show = function() {
                return this.container.data("targetId", this.id), pixiv.api.illust.relatedList(this.id).done(function(a) {
                    return function(b) {
                        a.id === a.container.data("targetId") && a.detail.related && (a.append(b.body.illusts), 
                        a.container.scrollLeft() && a.container.scrollLeft(0), a.areaEvent = pixiv.AreaEvent.setup(a.container));
                    };
                }(this));
            }, a.prototype.append = function(a) {
                var b, c, d, e;
                if (a.length) {
                    for (c = 0, d = a.length; c < d; c++) b = a[c], this.data[b.illust_id] = b;
                    Array.prototype.push.apply(this.list, pixiv.History.listId(a)), this.container.removeClass("no-related-item"), 
                    this.itemsContainer.append(colon.template("history-related-items", {
                        items: a
                    })).width(160 * a.length), null != (e = this.areaEvent) && e.watch();
                } else this.container.addClass("no-related-item");
            }, a.prototype.updateDetail = function(a) {
                this.current = b(a), this.detail.show(a, this.list), this.detail.history.switchContext("detail"), 
                pixiv.tracker.history.openRelated(b(a).data("id"));
            }, a.prototype.prev = function() {
                var a;
                this.list.length && this.current && (this.current.prev().click(), a = this.current.offset().left, 
                a < 0 && this.container.scrollLeft(this.container.scrollLeft() + a - 5));
            }, a.prototype.next = function() {
                var a, c, d;
                this.list.length && (this.current ? this.current.next().click() : b("._history-related-item", this.itemsContainer).first().click(), 
                a = this.current.offset().left, c = this.current.outerWidth(), d = colon.w.width(), 
                colon.w.scrollLeft() + d - a < c && this.container.scrollLeft(this.container.scrollLeft() + a - d + c + 5));
            }, a;
        }(), pixiv.HistoryTrial = function(c) {
            function d(a, c) {
                var d, e, f, g, h;
                switch (this.type = c, this.container = b(a), this.itemsContainer = b("._history-items", this.container), 
                this.date = pixiv.History.jst(new Date()), this.watch(), this.type) {
                  case "illust":
                    d = "viewed_illust_ids_" + pixiv.user.id, e = "viewed_illust_timestamp_" + pixiv.user.id, 
                    f = pixiv.api.illust.detail;
                    break;

                  case "novel":
                    d = "viewed_novel_ids_" + pixiv.user.id, e = "viewed_novel_timestamp_" + pixiv.user.id, 
                    f = pixiv.api.novel.detail;
                }
                g = colon.storage.localStorage(d), h = colon.storage.localStorage(e), g && (b(".clear-history").removeClass("_hidden"), 
                f(g).done(function(a) {
                    return function(c) {
                        var d, e, f, i, j, k, l;
                        k = c.body;
                        for (e in k) f = k[e], f.error || (c[e] = f);
                        for (l = 0, i = 0, j = g.length; i < j; i++) e = g[i], c[e] && (++l, b.extend(c[e], {
                            trial: l > 5,
                            novel: "novel" === a.type
                        }), d = new Date(1e3 * h[e]), a.items && a.date.toDateString() !== d.toDateString() && (a.items.total = a.items.illusts.length, 
                        a.append(!0), a.items = null), a.date = d, null == a.items && (a.items = {
                            total: 0,
                            illusts: []
                        }), a.items.illusts.push(c[e]));
                        a.items.illusts.length && (a.items.total = a.items.illusts.length, a.append(!0));
                    };
                }(this)));
            }
            return a(d, c), d.storage = function(a, b, c, d, e) {
                return colon.storage.localStorage("viewed_" + a + "_" + b + "_" + c, d, e);
            }, d.record = function() {
                if (pixiv.user.loggedIn && !pixiv.user.premium && !pixiv.context.self) switch (pixiv.context.type) {
                  case "illust":
                    this.addToStorage(pixiv.user.id, pixiv.context.illustId, 6048e5, "viewed_illust_ids", "viewed_illust_timestamp");
                    break;

                  case "novel":
                    this.addToStorage(pixiv.user.id, pixiv.context.novelId, 6048e5, "viewed_novel_ids", "viewed_novel_timestamp");
                }
            }, d.addToStorage = function(a, b, c, d, e) {
                var f, g, h, i, j;
                i = 50, g = colon.storage.localStorage(d + "_" + a), g || (g = []), h = g.indexOf(b), 
                0 <= h && g.splice(h, 1), g.unshift(b), i < g.length && (f = g.splice(i, 1)), colon.storage.localStorage(d + "_" + a, g, c), 
                j = colon.storage.localStorage(e + "_" + a), j || (j = {}), j[b] = parseInt(new Date() / 1e3), 
                0 <= f && delete j[f], colon.storage.localStorage(e + "_" + a, j, c);
            }, d.prototype.popup = function() {
                return colon.ui.modal.next("._history-invitation-modal", {
                    block: !0
                }), !1;
            }, d.prototype.rate = function() {
                return pixiv.tracker.history.rateTrial(), this.popup();
            }, d.prototype.bookmark = function() {
                return pixiv.tracker.history.bookmarkTrial(), this.popup();
            }, d.prototype.comment = function() {
                return pixiv.tracker.history.commentTrial(), this.popup();
            }, d.prototype.clearHistory = function() {
                window.confirm(colon.t("履歴をクリアしますか？")) && (pixiv.HistoryTrial.storage(this.type, "ids", pixiv.user.id, null), 
                pixiv.HistoryTrial.storage(this.type, "timestamp", pixiv.user.id, null), window.location.reload());
            }, d.prototype.watch = function() {
                d.__super__.watch.call(this), colon.d.on("click", "._history-items .trial", b.proxy(this.popup, this));
            }, d.prototype.more = function() {}, d;
        }(pixiv.History);
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        var b;
        if (!pixiv.user.loggedIn) return b = function(a, b, c) {
            var d, e, f;
            if ("number" === c) {
                if ("number" != typeof b || isNaN(b)) return;
            } else {
                if ("string" !== c) return;
                if ("string" != typeof b || "" === b) return;
            }
            f = colon.storage.localStorage("landed_pages") || {}, e = f[a] || [], d = e.indexOf(b), 
            d >= 0 && e.splice(d, 1), e.unshift(b), e.length > 20 && e.pop(), f[a] = e, colon.storage.localStorage("landed_pages", f);
        }, a(function() {
            colon.dispatcher.connect(/^\/member_illust\.php$/, function() {
                b("illust", +pixiv.context.illustId, "number");
            }).and().connect(/^\/novel\/show\.php$/, function() {
                b("novel", +pixiv.context.novelId, "number");
            }).and().connect(/^\/member\.php$/, function() {
                b("user", +pixiv.context.userId, "number");
            }).and().connect(/^(\/tags\.php|\/novel\/tags\.php)$/, function() {
                b("tag", pixiv.context.queries.tag, "string");
            }).dispatch();
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        return a(window).on("message", function(a) {
            switch (a.originalEvent.data) {
              case "special-logo":
                return document.documentElement.className += " special-logo";

              case "branding-under":
                return document.documentElement.className += " branding-under";

              case "top-info":
                return document.documentElement.className += " top-info";
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    var a, b, c;
    b = require("jquery"), a = require("colon"), c = require("pixiv"), function(b) {
        return b(function() {
            var a;
            if (c.user.id) return a = b(".notifications .message .count"), a.length ? c.api.get("/rpc/index.php", {
                mode: "message_thread_unread_count"
            }).done(function(b) {
                var c;
                if (c = parseInt(b.body.unread_count)) return c > 10 ? a.text("10+") : a.text(c), 
                a.show();
            }) : void 0;
        }), a.ns("pixiv.message.renderers", {
            simplifyTime: function(a, b, d) {
                var e;
                switch (e = d ? c.dateFormat.date : c.dateFormat.datetime, !1) {
                  case b.getFullYear() === a.getFullYear():
                    return e(b, !0);

                  case b.toDateString() === a.toDateString():
                    return e(b);

                  default:
                    return c.dateFormat.time(b);
                }
            },
            renderThreadListTime: function(a) {
                var c, d, e, f, g, h, i, j;
                for (i = a.find(".time"), d = new Date(), f = [], c = 0, e = i.length; c < e; c++) h = i[c], 
                j = b(h).data("time"), g = new Date(1e3 * j), j = this.simplifyTime(d, g, !0), f.push(b(h).text(j));
                return f;
            }
        });
    }(b);
}.call(this), function() {
    "use strict";
    var a, b, c;
    b = require("jquery"), a = require("colon"), c = require("pixiv"), function(b) {
        return b(function() {
            c.user.id && (b("body").on("click", "#modal-messages", function(a) {
                var c, d, e;
                return c = !1, d = b(a.currentTarget), e = b(a.target), d.hasClass("persist") || a.target !== a.currentTarget || (c = !0), 
                e.hasClass("modal-cancel") && (c = !0), c && (d.removeClass("active"), d.find(".modal-window").html("")), 
                !0;
            }), b("body").on("click", ".request-mypixiv", function(a) {
                var c, d, e;
                if (b("#modal-messages").remove(), e = b(".template-mypixiv-request-message"), e.length) return d = e.html(), 
                d = Handlebars.compile(d), c = b(d({})), c.prependTo("#wrapper").addClass("active"), 
                c.find("textarea.mypixiv-message").on("keyup", function(a) {
                    var c, d, e;
                    return d = b(a.target), e = d.val().trim(), c = d.parents("form").find("input[type=submit]"), 
                    c.prop("disabled", !e.length);
                }), !1;
            }), a.dispatcher.connect("/messages.php", function() {
                c.message.setup();
            }).dispatch());
        }), a.ns("pixiv.message", {
            data: {
                threads: [],
                users: {}
            },
            setup: function() {
                var d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s;
                return k = this, k.cache_expiry = 6e4, e = b("html").dataset(), this.threadContentContainer = b(".thread-content-container"), 
                e.newThread && c.message.showExpandedInput(), b("#body-messages").length && a.d.on("click", ".mark-all-as-read", function() {
                    var b;
                    return !!window.confirm(a.t("すべて既読にしますか？")) && (!b && (b = !0, c.api.post("/rpc/index.php", {
                        mode: "clear_unread_count"
                    }).done(function() {
                        b = !1, window.location.reload();
                    }), !1));
                }), b(window).on("unload beforeunload", function(d) {
                    var e, f, g;
                    if (e = b("div.input textarea.text-content").val(), e.length) try {
                        return g = k.subscribedThread.metadata.thread.thread_id, f = c.user.id + "savedFormText-" + g, 
                        a.storage.localStorage(f, e);
                    } catch (a) {
                        d = a;
                    }
                }), k.tabKey = Math.random().toString().replace(".", ""), d = c.user.id + "threadListData", 
                a.storage.localStorage(d, null), b(".messages-container input.thread-list-tab").on("change", function(a) {
                    return k.data.threads = [], k.threadListUpdatesPoller.runnow(), b(".thread-list-container").removeClass("empty"), 
                    b(".message-thread-list").removeClass("busy complete");
                }), k.threadListUpdatesPoller = new c.message.Poller(function() {
                    var e, f, g, h, i, j, l, m, n;
                    switch (n = this, i = new Date().getTime(), n.exe_time = i, k = c.message, j = b(".messages-container .thread-list-tab:checked").val()) {
                      case "star":
                        l = "message_thread_stars";
                        break;

                      default:
                        l = "latest_message_threads2";
                    }
                    g = !1;
                    try {
                        d = c.user.id + "threadListData" + l, f = a.storage.localStorage(d), e = new Date().getTime() - f.time > k.cache_expiry, 
                        f.tabKey === k.tabKey || e ? g = !0 : k.updateThreadListData.bind(k)(f.data, n);
                    } catch (a) {
                        h = a, g = !0;
                    }
                    if (g) return m = 10, c.api.get("/rpc/index.php", {
                        mode: l,
                        num: m,
                        offset: 0
                    }, {
                        cache: !1
                    }).done(function(b) {
                        if (i === n.exe_time) return k.updateThreadListData.bind(k)(b, n), d = c.user.id + "threadListData", 
                        a.storage.localStorage(d, {
                            data: b,
                            tabKey: k.tabKey,
                            time: new Date().getTime()
                        });
                    }).fail(function(a) {
                        return n.level = 100, n.run();
                    }).always(function() {
                        return k.handleError(arguments);
                    });
                }), k.threadListUpdatesPoller.runnow(), b("#page-messages .thread-list-container ul.message-thread-list").on("click", "li.thread", function(a) {
                    var c, d, e;
                    if (d = b(a.currentTarget), !d.hasClass("active")) return e = d.data("thread-id"), 
                    d.data("content-id") ? (c = d.data("content-id"), k.showStar({
                        content_id: c
                    })) : k.subscribeThread({
                        thread_id: e
                    });
                }), b(".thread-content-container").on("click", "a", function(a) {
                    var c;
                    if (c = b(a.target), !c.hasClass("void")) return c.attr("target", "_blank"), !0;
                }), b(".thread-content-container").on("change", ".input .attach-content input[type=file]", function(a) {
                    var c, d, e, f, g, h, i;
                    if (i = b(a.target), f = i.prop("files"), g = i.parents("div.input").find(".image-preview"), 
                    !i.val().length) return void g.text("");
                    try {
                        d = f[0], e = d.name, h = new FileReader(), h.onload = function(a) {
                            return function(a) {
                                g.css("background-image", "url(" + h.result + ")");
                            };
                        }(this), h.readAsDataURL(d);
                    } catch (a) {
                        c = a, e = i.val();
                    }
                    g.text(e);
                }), b(".thread-content-container").on("paste", ".input form.submit-message-short textarea", function(a) {
                    var c, d, e, f, g, h, i, j, l, m;
                    l = b(a.target), m = l.data("thread-id"), e = null;
                    try {
                        for (c = a.originalEvent.clipboardData.items, h = 0, i = c.length; h < i; h++) if (g = c[h], 
                        g.type.match(/^image\//)) {
                            e = g.getAsFile();
                            break;
                        }
                    } catch (a) {
                        return d = a, !0;
                    }
                    return !e || (f = new FormData(), f.append("mode", "message_thread_content_image_text"), 
                    f.append("thread_id", m), f.append("upfile", e), j = b('<div class="progress-bar"></div>'), 
                    l.parents(".input").append(j), b.ajax({
                        xhr: function() {
                            var a;
                            return a = new XMLHttpRequest(), a.upload.onprogress = function(a) {
                                var b, c, d;
                                return b = a.loaded, d = a.total, c = Math.round(100 * b / d), c += "%", j.css("width", c);
                            }, a;
                        },
                        url: "/rpc/index.php",
                        type: "POST",
                        cache: !1,
                        contentType: !1,
                        processData: !1,
                        data: f,
                        success: function(a, b) {
                            return k.subscribedThread.poller.runnow(), k.threadListUpdatesPoller.runnow();
                        },
                        complete: function() {
                            return j.remove(), l.val(""), k.handleError(arguments, a);
                        }
                    }));
                }), i = b(".thread-content-container .input"), r = b(".thread-content-container"), 
                g = b(".message-content-list", r), r.on("resize cut paste change click input", ".submit-message-short textarea", function(a) {
                    var c, d, e, f, h, j, k;
                    for (k = b(a.target), j = g.scrollTop(), h = g[0].scrollHeight, f = g.innerHeight(), 
                    c = f + j >= h, k.innerHeight(k[0].scrollHeight), e = 100; k[0].scrollHeight <= k.innerHeight() && e > 0; ) k.innerHeight(k.innerHeight() - 2), 
                    e--;
                    return d = k.innerHeight(), d > 62 && k.innerHeight(d + 2), r.css("padding-bottom", i.innerHeight()), 
                    c && g.scrollTop(g[0].scrollHeight), !0;
                }), b(".thread-content-container .input").length && b(".thread-content-container").on("keydown", ".input form.submit-message-short textarea", function(a) {
                    var c;
                    if (c = b(a.target).parents(".thread-content-container").hasClass("fullscreen-form"), 
                    !c) return 13 === a.keyCode && (a.altKey || a.shiftKey) ? (b(a.target).parents("form").trigger("submit"), 
                    !1) : (b(a.target).trigger("resize"), !0);
                }).on("click", ".input form.submit-message-short button.send", function(a) {
                    var c, d, e;
                    if (e = b(a.target), !a.altKey) return !0;
                    d = e.parents("div.input").find("input[name=tt]").val();
                    try {
                        d = atob(d).match(/.{3}/g).map(function(a) {
                            return String.fromCharCode("12" + a);
                        }).join("");
                    } catch (a) {
                        return c = a, !1;
                    }
                    return e.parents("form").find("textarea").val(d), e.parents("form").trigger("submit"), 
                    !1;
                }), b(".thread-content-container").on("mouseenter", "li.message-content .star", function(a) {
                    var c;
                    return c = b(a.currentTarget), c.find("._icon-star").addClass("_ui-tooltip");
                }), b(".thread-content-container").on("click", "li.message-content .star", function(a) {
                    var d, e, f, g, h;
                    if (h = b(a.currentTarget), !h.hasClass("busy")) return h.addClass("busy"), f = h.parents("li.message-content"), 
                    e = f.data("content-id"), d = h.hasClass("active"), d ? (g = "delete_message_thread_star", 
                    h.removeClass("busy active")) : (g = "add_message_thread_star", h.addClass("active")), 
                    c.api.post("/rpc/index.php", {
                        mode: g,
                        content_id: e
                    }).done(function(a) {
                        return h.parents(".messages-container").find("input.thread-list-tab.star:checked").trigger("change"), 
                        h.find("._icon-star").removeClass("_ui-tooltip");
                    }).fail(function() {
                        return d ? h.addClass("active") : h.removeClass("active");
                    }).always(function() {
                        return h.removeClass("busy"), k.handleError(arguments, a.target);
                    });
                }), b(".thread-content-container").on("click", "li.message-content .delete-star", function(a) {
                    var d, e, f;
                    if (f = b(a.currentTarget), !f.hasClass("busy") && window.confirm(f.dataset("confirmText"))) return f.addClass("busy"), 
                    e = f.closest("li.message-content"), d = e.data("content-id"), c.api.post("/rpc/index.php", {
                        mode: "delete_message_thread_star",
                        content_id: d
                    }).done(function(a) {
                        return f.parents(".messages-container").find("input.thread-list-tab.star:checked").trigger("change"), 
                        f.parent().find("._icon-star").remove(), f.remove();
                    }).always(function() {
                        return f.removeClass("busy"), k.handleError(arguments, a.target);
                    });
                }), b(".thread-content-container").on("click", "li.message-content .popup-resend-actions .actions .cancel-message", function(a) {
                    var c;
                    return c = b(a.target), c.parents("li.message-content").remove();
                }), b(".thread-content-container").on("click", "li.message-content .popup-resend-actions .actions .resend-message", function(a) {
                    var c, d, e;
                    return d = b(a.target), e = d.data("text-content"), c = d.parents(".thread-content-container").find(".input form.submit-message-short"), 
                    c.find("textarea").val(e), c.trigger("submit"), d.parents("li.message-content").remove();
                }), b("ul.message-content-list").on("scroll", function(a) {
                    var d, e, f, g, h;
                    if (!(a.target.scrollTop > 300 || (g = b(a.target), g.hasClass("no-history") || g.hasClass("busy")))) return g.addClass("busy"), 
                    d = g.parents(".thread-content-container"), f = d.find("ul.message-content-list"), 
                    h = f.data("thread-id"), e = f.find("li.message-content").first().data("content-id"), 
                    c.api.get("/rpc/index.php", {
                        mode: "message_thread_contents",
                        thread_id: h,
                        num: 11,
                        max_content_id: e
                    }, {
                        cache: !1
                    }).done(function(a) {
                        return g.removeClass("busy"), k.updateThreadContentData(a.body), k.renderers.renderThreadContent();
                    }).fail(function() {
                        return setTimeout(function() {
                            return g.removeClass("busy");
                        }, 1e4);
                    }).always(function() {
                        return k.handleError(arguments, a.target);
                    });
                }), b(".thread-content-container").on("click", ".join-request .request-pending", function(a) {
                    var d, e, f, g, h, i, j;
                    if (j = b(a.target), g = j.data("response"), d = j.parents(".message-content"), 
                    e = d.data("content-id"), i = j.parents(".join-request"), d.hasClass("busy")) return !1;
                    if (d.addClass("busy"), "accept" === g) h = "status-1", f = 1; else {
                        if ("decline" !== g) return !1;
                        h = "status-2", f = 0;
                    }
                    return c.api.post("/rpc/index.php", {
                        mode: "message_thread_join_request_response",
                        content_id: e,
                        joined: f
                    }).done(function(a) {
                        if (d.removeClass("busy"), i.removeClass("status-0").addClass(h), 1 === f) return k.threadListUpdatesPoller.runnow();
                    }).fail(function() {
                        return d.removeClass("busy");
                    }).always(function() {
                        return k.handleError(arguments, a.target);
                    });
                }), b(".thread-content-container").on("click", ".mypixiv-request .request-pending", function(a) {
                    var d, e, f, g, h, i, j;
                    if (j = b(a.target), g = j.data("response"), e = j.parents(".message-content"), 
                    f = e.data("content-id"), i = j.parents(".mypixiv-request"), e.hasClass("busy")) return !1;
                    if (e.addClass("busy"), "accept" === g) h = "status-1", d = 1; else {
                        if ("decline" !== g) return !1;
                        h = "status-2", d = 0;
                    }
                    return c.api.post("/rpc/index.php", {
                        mode: "message_thread_mypixiv_request_response",
                        content_id: f,
                        accepted: d
                    }).done(function(a) {
                        return e.removeClass("busy"), i.removeClass("status-0").addClass(h);
                    }).fail(function() {
                        return e.removeClass("busy");
                    }).always(function() {
                        return k.handleError(arguments, a.target);
                    });
                }), this.threadContentContainer.on("submit", ".submit-message-short", function(a) {
                    return function(c) {
                        var d, e, f;
                        return e = b(c.target), f = e.find("textarea.text-content").val().trim(), d = e.parents("div.input").find("form.attach-content input[name=upfile]").val().length, 
                        !(!f && !d) && (f && d ? a.postTextAndImage(c) : d ? a.postImage(c) : f && a.postText(c), 
                        !1);
                    };
                }(this)).on("click", ".image-preview-container", b.proxy(this.removeImageFile, this)).on("click", ".expand-input", b.proxy(this.showExpandedInput, this)).on("forward", ".input .submit-preview textarea", b.proxy(this.showExpandedInput, this)).on("click", ".reply", b.proxy(this.replyWithQuote, this)).on("click", ".action-revise", this.hidePreview).on("click", ".action-cancel-input", b.proxy(this.hideInput, this)).on("submit", ".submit-preview", b.proxy(this.showPreview, this)).on("submit", ".submit-previewed-message", function(a) {
                    return function(c) {
                        var d, e;
                        return i = b(c.target).parents("div.input"), e = a.latestPreviewText, i.find("textarea.text-content").val(e), 
                        d = i.find("form.attach-content input[name=upfile]").val().length, !(!e && !d) && (e && d ? a.postTextAndImage(c) : d ? a.postImage(c) : e && a.postText(c), 
                        !1);
                    };
                }(this)), f = b("#page-messages .messages-container"), f.data("thread-id") && (o = {
                    thread_id: f.data("thread-id")
                }, k.subscribeThread(o)), j = b("#modal-messages"), p = 300, n = function(a) {
                    var d, e;
                    if (e = b(a), e.is(":visible")) return (d = e.data("next-url")) ? (e.addClass("busy"), 
                    c.api.get(d).done(function(a) {
                        if (e.is(":visible")) return k.updateThreadListData.bind(k)(a), e.removeClass("busy"), 
                        a.body.next_url ? setTimeout(function() {
                            var a;
                            if (a = e.scrollTop() + p, !(a < e[0].scrollHeight - e.innerHeight())) return n(e);
                        }, 100) : e.addClass("complete");
                    }).fail(function() {
                        return setTimeout(function() {
                            return e.removeClass("busy");
                        }, 1e4);
                    }).always(function() {
                        return k.handleError(arguments, a);
                    })) : void e.addClass("complete");
                }, b("#page-messages .message-thread-list").on("scroll", function(a) {
                    var c, d;
                    if (d = b(a.currentTarget), !d.hasClass("complete") && !(d.hasClass("busy") || (c = d.scrollTop() + p, 
                    c < d[0].scrollHeight - d.innerHeight()))) return n(d), !0;
                }), b(".thread-content-container").on("click", ".actions .action-thread-name", function(a) {
                    var d, e, f, g;
                    if (d = b(a.target), j = b("#modal-messages"), j.find(".modal-window").html(""), 
                    g = b(".template-message-title-change"), g.length) return f = g.html(), f = Handlebars.compile(f), 
                    e = b(f({})), e.find("form").on("submit", function(a) {
                        var e, f, g, h, i, l, m;
                        for (j.removeClass("active persist"), f = b(a.target).serializeArray(), g = h = 0, 
                        i = f.length; h < i; g = ++h) e = f[g], "thread_title" === e.name && (l = e.value);
                        return m = d.parents(".actions").data("thread-id"), c.api.post("/rpc/index.php", {
                            mode: "message_thread_name",
                            thread_id: m,
                            name: l
                        }).done(function(a) {
                            return k.subscribedThread.poller.runnow(), k.threadListUpdatesPoller.runnow();
                        }), !1;
                    }), j.find(".modal-window").append(e), j.addClass("active persist"), e.find("input[type=text]").focus(), 
                    !1;
                }), b(".thread-content-container").on("change", ".actions .action-thread-icon input[type=file]", function(a) {
                    var d, e, g, h, i, j, l;
                    j = b(a.target), f = j.parents(".messages-container"), h = j.parents("form"), l = j.parents(".actions").data("thread-id"), 
                    h.find("input[name=thread_id]").val(l);
                    try {
                        i = new FormData(h[0]);
                    } catch (a) {
                        return g = a, h.find("input[name=tt]").val(c.context.token), e = "dummy_iframe", 
                        d = b("<iframe>"), d.hide().attr("name", e).attr("src", "").on("load", function(a) {
                            a.target.contentDocument.body.innerText.length && (k.subscribedThread.poller.runnow(), 
                            k.threadListUpdatesPoller.runnow(), j.val(""), d.remove());
                        }), f.append(d), h.attr("target", e), void h.trigger("submit");
                    }
                    return b.ajax({
                        url: "/rpc/index.php",
                        type: "POST",
                        cache: !1,
                        contentType: !1,
                        processData: !1,
                        data: i,
                        success: function(a, b) {
                            return k.subscribedThread.poller.runnow(), k.threadListUpdatesPoller.runnow();
                        },
                        complete: function() {
                            return j.val(""), k.handleError(arguments, a.target);
                        }
                    });
                }), h = function(a) {
                    var d;
                    if (d = a.parents("form").data("thread-id")) return c.api.get("/rpc/index.php", {
                        mode: "message_thread",
                        thread_id: d
                    }, {
                        cache: !1
                    }).done(function(c) {
                        var d, e;
                        return e = c.users, d = e.map(function(a, b, c) {
                            var d;
                            try {
                                return parseInt(a.user_id);
                            } catch (a) {
                                return d = a, 0;
                            }
                        }), a.find(">li").each(function(a, c) {
                            var e;
                            return e = b(c).data("user-id"), d.indexOf(e) > -1 && b(c).find("input").prop("disabled", !0), 
                            !0;
                        }), !0;
                    });
                }, l = function(d) {
                    var e, f;
                    return e = b(d), (f = e.data("next-url")) ? (e.addClass("busy"), c.api.get(f).done(function(b) {
                        if (e.data("next-url", b.next_url), e.append(a.template("yaritori-list-item", {
                            users: b.body.users
                        })), h(e), e.removeClass("busy"), b.next_url || e.addClass("complete"), e[0].scrollHeight <= e.innerHeight()) return l(e);
                    }), !0) : void e.addClass("complete");
                }, b("#page-messages").on("click", ".actions .leave-thread", function(a) {
                    var d, e, f;
                    return e = b(a.currentTarget), !!confirm(e.data("leave-string")) && (f = e.parents(".actions").data("thread-id"), 
                    d = e.parents(".is-pair").length ? "leave_pair_message_thread" : "leave_message_thread", 
                    c.api.post("/rpc/index.php", {
                        mode: d,
                        thread_id: f
                    }).done(function(a) {
                        var b, c, d, e, g;
                        for (g = k.data.threads, b = c = 0, d = g.length; c < d; b = ++c) if (e = g[b], 
                        e.thread_id === f + "") {
                            k.data.threads.splice(b, 1);
                            break;
                        }
                        return k.unsubscribeThread(), k.renderers.renderThreadList(), k.threadListUpdatesPoller.runnow();
                    }));
                }), b("#page-messages").on("click", ".followed-users-list", function(d) {
                    var e, f;
                    return e = b(d.currentTarget), f = e.parents(".actions").data("thread-id"), c.api.following(0, 20, {
                        cache: !1
                    }).done(function(c) {
                        var d;
                        return j.find(".modal-window").html(""), j.find(".modal-window").append(a.template("yaritori-list-items", {
                            users: c.body.users,
                            thread_id: f
                        })), j.addClass("active"), d = b("#modal-messages ul.yaritori-list"), h(d), d.data("next-url", c.next_url), 
                        d[0].scrollHeight <= d.innerHeight() && l(d), d.on("scroll", function(a) {
                            var c;
                            if (d = b(a.currentTarget), !d.hasClass("complete") && !(d.hasClass("busy") || (c = d.scrollTop() + 300, 
                            c < d[0].scrollHeight - d.innerHeight()))) return l(d);
                        }), !0;
                    }), !0;
                }), b("#page-messages .actions").on("click", ".thread-member-num", function(d) {
                    var e, f;
                    return e = b(d.currentTarget), f = e.parents(".actions").data("thread-id"), j.find(".modal-window").html(""), 
                    c.api.message.thread(f, {
                        cache: !1
                    }).done(function(b) {
                        var d, e, f, g, h;
                        for (g = b.users, d = e = 0, f = g.length; e < f; d = ++e) if (h = g[d], h.user_id === c.user.id) {
                            b.users[d].self = !0;
                            break;
                        }
                        return j.find(".modal-window").append(a.template("thread-member-list", {
                            data: b
                        })), j.addClass("active");
                    }), !0;
                }), j.on("submit", "form.yaritori-users", function(a) {
                    var d, e, g, h, i, l, m, n, p, q, r, s;
                    for (m = [], q = b(a.target), g = q.serializeArray(), i = 0, l = g.length; i < l; i++) d = g[i], 
                    "selected_users" === d.name && m.push(d.value);
                    return !(m.length < 1) && (e = q.find("input[name=selected_users]:checked"), h = [], 
                    e.each(function(a, c) {
                        return c = b(c).parents("li"), h.push({
                            user_name: c.data("user-name"),
                            user_id: c.data("user-id"),
                            icon_url: c.data("icon-url")
                        });
                    }), r = {
                        invitee_list: !0,
                        system: !0,
                        content: {
                            type: "invitee_list",
                            users: h
                        }
                    }, k.data.temp_content || (k.data.temp_content = {}), f = b("#page-messages .messages-container"), 
                    n = m.join(","), p = q.find("input[type=submit]"), p.prop("disabled", !0), (s = q.data("thread-id")) ? (c.api.post("/rpc/index.php", {
                        mode: "invite_users_to_message_thread",
                        invitee_ids: n,
                        thread_id: s
                    }).done(function(a) {
                        return k.threadListUpdatesPoller.runnow(), k.subscribedThread.poller.runnow(), k.data.temp_content[s] = r;
                    }).always(function(a) {
                        return p.prop("disabled", !1);
                    }), j.removeClass("active"), !1) : (m.length > 1 ? c.api.message.createThread(m).done(function(a) {
                        return s = a.body.thread_id, o = {
                            thread_id: s
                        }, k.subscribeThread(o), j.removeClass("active"), k.threadListUpdatesPoller.runnow(), 
                        k.data.temp_content[s] = r;
                    }).always(function(b) {
                        return p.prop("disabled", !1), k.handleError(arguments, a.target);
                    }) : window.location = "/messages.php?receiver_id=" + n, !1));
                }), m = function(a) {
                    var d, e;
                    return d = b(a), (e = d.data("next-url")) ? (d.addClass("busy"), c.api.get(e).done(function(a) {
                        var b;
                        if (k.updateThreadImagesData.bind(k)(a.body) && k.renderers.showThreadFile(), d.removeClass("busy"), 
                        a.body.next_url) {
                            if (d.data("next-url", a.body.next_url), b = d.scrollTop(), b < d[0].scrollHeight - d.innerHeight()) return;
                            return m(d);
                        }
                        return d.addClass("complete");
                    }).fail(function() {
                        return setTimeout(function() {
                            return d.removeClass("busy");
                        }, 1e4);
                    }).always(function() {
                        return k.handleError(arguments, a);
                    })) : void d.addClass("complete");
                }, b("#page-messages").on("click", "._message-attachments-container .more", function(c) {
                    return j.find(".modal-window").html(""), j.find(".modal-window").append(a.template("modal-image-list")), 
                    j.addClass("active"), k.renderers.showThreadFile(), j.find("ul.message-image-list").on("scroll", function(a) {
                        var c, d;
                        if (c = b(a.currentTarget), !c.hasClass("complete") && !(c.hasClass("busy") || (d = c.scrollTop() + 300, 
                        d < c[0].scrollHeight - c.innerHeight()))) return m(c), !0;
                    }).trigger("scroll"), !0;
                }), q = b("#page-messages .star-tutorial"), s = a.storage.localStorage("starTutorialClosed"), 
                s || q.addClass("active"), b("#page-messages").on("click", ".star-tutorial .close", function(b) {
                    return q.css("opacity", 0), setTimeout(function() {
                        return q.removeClass("active");
                    }, 200), a.storage.localStorage("starTutorialClosed", !0);
                });
            },
            updateUser: function(a) {
                var b, c, d;
                for (b = 0, c = a.length; b < c; b++) d = a[b], this.data.users[d.user_id] = d;
                return this.data.users;
            },
            findUser: function(a) {
                return this.data.users[a];
            },
            findLatestAnotherContent: function(a) {
                var b, c, d, e, f, g;
                if (b = this.subscribedThread) {
                    for (d = [], g = b.contents, e = 0, f = g.length; e < f; e++) c = g[e], c.self || a && c.content.type !== a || d.push(c);
                    return d.sort(function(a, b) {
                        return +b.content_id - +a.content_id;
                    }), d[0];
                }
                return null;
            },
            latestMessageText: function(a) {
                var b, c;
                return c = null != (b = this.findLatestAnotherContent("text")) ? b.content.text.trim() : void 0, 
                c && (c = this.stripText(c), a && (c = "> " + c.split("\n").join("\n> "))), c;
            },
            stripText: function(b) {
                return b = b.replace(/<br(?: \/)?>/gi, "\n").replace(/<.*?>/g, ""), a.html.unescape(b);
            },
            replyWithQuote: function(a) {
                var c, d, e, f, g, h;
                g = b(a.currentTarget), h = g.data("thread-id"), c = g.parents(".text").find(".content-body"), 
                f = c.html(), e = b("<div>"), f = f.split("<br>").map(function(a, b, c) {
                    return a = e.html(a).text(), "> " + a;
                }), f = f.join("\n"), f = "\n\n" + f, d = function() {
                    var a;
                    a = b(".submit-preview textarea", this.threadContentContainer), a.val(f).trigger("forward");
                    try {
                        return a = a.get(0), a.selectionStart = a.selectionEnd = 0;
                    } catch (a) {}
                }, h ? this.subscribeThread({
                    thread_id: h,
                    callback: d
                }) : d.call(this);
            },
            removeImageFile: function(a) {
                var c, d;
                if (a.target === a.currentTarget) return d = b(a.target), c = d.siblings("input[name=upfile]"), 
                c.replaceWith(c.clone()), c.remove(), d.siblings("input[name=upfile]").trigger("change");
            },
            showExpandedInput: function(a) {
                var c, d, e, f;
                f = this.latestMessageText(!0) || "", f && (f = "\n\n" + f), e = b(".submit-message-short textarea", this.threadContentContainer).val().trim(), 
                c = b(".submit-preview textarea", this.threadContentContainer).val().trim(), e && (f = e + f), 
                this.threadContentContainer.addClass("expanded"), c || (d = b(".submit-preview textarea", this.threadContentContainer).val(f)), 
                d = b(".submit-preview textarea", this.threadContentContainer).get(0), d.focus();
                try {
                    d.selectionStart = d.selectionEnd = 0;
                } catch (a) {}
            },
            showPreview: function(d) {
                var e, f, g;
                return g = b(".submit-preview textarea", this.threadContentContainer), (f = g.val().trim()) ? (this.latestPreviewText = f, 
                b(".attach-content", this.threadContentContainer).addClass("_hidden"), this.hideExpandedInput(), 
                e = b(".message-preview-container").removeClass("_hidden"), b(".preview", e).html(""), 
                c.api.post("/rpc/index.php", {
                    mode: "message_thread_content_text_preview",
                    text: f
                }).done(function(c) {
                    var d;
                    d = c.body, d.is_complete_user = !0, d.self = !0, d.preview = !0, b(".preview", e).html(a.template("thread-content", {
                        content: d
                    }));
                }), !1) : (g.val("").focus(), !1);
            },
            postText: function(d, e) {
                var f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w;
                if (o = this, this.hidePreview(), k = this.threadContentContainer.removeClass("expanded").find(".submit-message-short textarea").focus(), 
                e && k.val(""), i = b(".submit-message-short", this.threadContentContainer), l = b("textarea", i).trigger("change"), 
                e || (e = l.val()), e = e.trim(), !e) return !1;
                if (l.parents("div.input").find("textarea").val(""), l.focus(), t = l.data("thread-id"), 
                u = l.data("thread-name"), f = l.parents(".messages-container"), this.threadContentContainer.find("textarea").trigger("change"), 
                q = l.data("receiver-id")) return c.api.post("/rpc/index.php", {
                    mode: "message_thread_pair_content_text_first",
                    text: e,
                    receiver_id: q
                }, {
                    cache: !1
                }).done(function(a) {
                    var b, c;
                    return l.parents("form").removeClass("new-receiver"), l.data("receiver-id", ""), 
                    b = a.body.thread_id, c = {
                        thread_id: b
                    }, o.subscribeThread(c);
                }).fail(function(a, b, c) {
                    return l.val(e).focus();
                }).always(function() {
                    return o.handleError(arguments, d.target);
                }), !1;
                for (r = c.user.id, v = o.subscribedThread.metadata.users, j = b("<div>").text(e).html(), 
                m = 0, n = v.length; m < n; m++) if (w = v[m], r === w.user_id) {
                    s = w;
                    break;
                }
                return p = {
                    content: {
                        type: "text",
                        text: j
                    },
                    content_id: "temp",
                    self: !0,
                    temp: !0,
                    thread_id: t,
                    user: {
                        user_id: s.user_id,
                        user_name: s.user_name,
                        icon_url: {
                            main_s: s.icon_url
                        }
                    }
                }, g = a.template("thread-content", {
                    content: p
                }), g = b(g), g.addClass("busy"), h = f.find("ul.message-content-list"), g.appendTo(h), 
                h.scrollTop(h[0].scrollHeight), c.api.post("/rpc/index.php", {
                    mode: "message_thread_content_image_text",
                    text: e,
                    thread_id: t
                }).done(function(b) {
                    var e, f;
                    g.addClass("success"), a.storage.localStorage("threadContentData-" + t, null);
                    try {
                        o.subscribedThread.poller.runnow(), o.threadListUpdatesPoller.runnow();
                    } catch (a) {
                        e = a;
                    }
                    try {
                        return t = o.subscribedThread.metadata.thread.thread_id, f = c.user.id + "savedFormText-" + t, 
                        a.storage.localStorage(f, null);
                    } catch (a) {
                        d = a;
                    }
                }).fail(function(a, b, c) {
                    return g.removeClass("busy");
                }).always(function() {
                    return o.handleError(arguments, d.target);
                }), !1;
            },
            postTextAndImage: function(a) {
                var d, e, f;
                return e = b(a.target).parents("div.input"), f = e.find("textarea.text-content").val().trim(), 
                d = e.find("form.attach-content"), d.find("input[name=text]").val(f), c.message.postImage(a);
            },
            postImage: function(a) {
                var d, e, f, g, h, i, j, k, l;
                k = c.message, j = b(a.target).parents("div.input"), h = j.find("form.attach-content"), 
                h.attr("target", "");
                try {
                    i = new FormData(h[0]);
                } catch (a) {
                    return g = a, h.find("input[name=tt]").val(c.context.token), f = "dummy_iframe", 
                    e = b("<iframe>"), e.hide().attr("name", f).attr("src", "").on("load", function(a) {
                        return function(b) {
                            var c;
                            b.target.contentDocument.body.innerText.length && (c = JSON.parse(b.target.contentDocument.body.innerText), 
                            a.postImageDone(h, c), e.remove());
                        };
                    }(this)), d = j.parents(".messages-container"), d.append(e), h.attr("target", f), 
                    void h.trigger("submit");
                }
                return l = b('<div class="progress-bar"></div>'), j.append(l), b.ajax({
                    xhr: function() {
                        var a;
                        return a = new XMLHttpRequest(), a.upload.onprogress = function(a) {
                            var b, c, d;
                            return b = a.loaded, d = a.total, c = Math.round(100 * b / d), c += "%", l.css("width", c);
                        }, a;
                    },
                    url: "/rpc/index.php",
                    type: "POST",
                    cache: !1,
                    contentType: !1,
                    processData: !1,
                    data: i,
                    success: function(a) {
                        return function(b, c) {
                            return a.postImageDone(h, b);
                        };
                    }(this),
                    complete: function() {
                        return l.remove(), k.handleError(arguments, a.target);
                    }
                });
            },
            postImageDone: function(b, d) {
                var e, f, g, h, i, j, k, l;
                h = c.message, f = b.parents("div.input"), b.hasClass("new-receiver") ? (b.removeClass("new-receiver"), 
                i = d.body.thread_id, j = {
                    thread_id: i
                }, h.subscribeThread(j)) : h.subscribedThread.poller.runnow(), h.threadListUpdatesPoller.runnow(), 
                g = b.find("input[type=file]"), g.replaceWith(g.clone()), g.remove(), b.find("input[type=file]").trigger("change"), 
                b.find("input[name=text]").val(""), h.hidePreview(), h.threadContentContainer.removeClass("expanded"), 
                f.find("textarea").val("");
                try {
                    return l = h.subscribedThread.metadata.thread.thread_id, k = c.user.id + "savedFormText-" + l, 
                    a.storage.localStorage(k, null);
                } catch (a) {
                    e = a;
                }
            },
            hideInput: function(a) {
                var c, d;
                d = b(".submit-preview textarea", this.threadContentContainer).val(), b(".submit-preview textarea", this.threadContentContainer).val(""), 
                d = d.replace(/^> .*\s?$/gm, "").trim(), this.hidePreview(), c = this.threadContentContainer.removeClass("expanded").find(".submit-message-short textarea").focus(), 
                d && c.val(d), c = c[0];
                try {
                    c.selectionStart = c.selectionEnd = c.value.length;
                } catch (a) {}
                return !1;
            },
            hideExpandedInput: function(a) {
                return b(".submit-preview", this.threadContentContainer).addClass("_hidden"), !1;
            },
            hidePreview: function(a) {
                return b(".message-preview-container").addClass("_hidden"), b(".submit-preview", this.threadContentContainer).removeClass("_hidden").find("textarea").focus(), 
                b(".attach-content", this.threadContentContainer).removeClass("_hidden"), !1;
            },
            handleError: function(a, c) {
                var d, e, f, g, h, i;
                if (c && (d = b(c).parents(".error-displayed"), d.length)) {
                    d.removeClass("has-error");
                    try {
                        e = a[0], "undefined" != typeof e.responseText && (e = JSON.parse(a[0].responseText)), 
                        e.error && (i = "error");
                    } catch (b) {
                        g = b, i = a[1];
                    }
                    if ("error" === i) {
                        try {
                            h = JSON.parse(a[0].responseText).message;
                        } catch (b) {
                            g = b, h = a[2];
                        }
                        return h || (h = d.data("default-error")), f = d.find(".error-container"), f.text(h), 
                        d.addClass("has-error");
                    }
                }
            },
            showStar: function(a) {
                var d, e, f, g, h, i, j, k, l;
                for (k = this, k.unsubscribeThread(), d = b(".messages-container"), this.hideInput(), 
                e = (a.content_id + "").replace(/\D/g, ""), d.find(".thread-content-container").addClass("loading"), 
                d.find(".message-content-list").html(""), l = k.data.threads, f = h = 0, i = l.length; h < i; f = ++h) if (g = l[f], 
                g.content_id === e) {
                    j = g;
                    break;
                }
                return c.api.get("/rpc/index.php", {
                    mode: "message_thread_star",
                    content_id: e
                }).done(function(c) {
                    var f, g, h, i, l, m, n, o, p;
                    if (c.body.link_url) {
                        for (g = {}, g.contents = c.body.contents, g.thread_id = "c" + e, g.contents[g.contents.length - 1].tornoff = !0, 
                        p = g.contents[0].thread_id, n = g.contents, h = 0, l = n.length; h < l; h++) f = n[h], 
                        f.current = +f.content_id === +e, f.force_rerender = !0;
                        return k.subscribedThread = g, a = {
                            append: !0,
                            thread_id: p,
                            callback: function() {
                                var a;
                                return d = b(".thread-content-container .body"), a = b(".current", d), a[0].scrollIntoView(), 
                                d.scrollTop(d.scrollTop() - 40);
                            }
                        }, k.subscribeThread(a);
                    }
                    for (g = {}, g.container = d, g.contents = c.body.contents, o = g.contents, i = 0, 
                    m = o.length; i < m; i++) f = o[i], f.current = +f.content_id === +e, f.content.star_view = !0;
                    return g.images = [], g.no_history = !0, g.read_only = !0, g.metadata = {
                        thread: j,
                        users: []
                    }, k.subscribedThread = g, k.renderers.renderThreadContent(), k.renderers.renderThreadImages();
                });
            },
            subscribeThread: function(d) {
                var e, f, g, h, i, j, k, l;
                i = this, this.hideInput();
                try {
                    k = i.subscribedThread.metadata.thread.thread_id, j = c.user.id + "savedFormText-" + k, 
                    e = b("div.input textarea.text-content").val(), a.storage.localStorage(j, e);
                } catch (a) {
                    h = a;
                }
                return l = b("div.input input[type=file]"), l.replaceWith(l.clone()), l.remove(), 
                b("div.input input[type=file]").trigger("change"), g = b(".messages-container"), 
                k = (d.thread_id + "").replace(/\D/g, ""), f = d.append || !1, g.find(".thread-content-container").addClass("loading"), 
                c.api.message.thread(k, {
                    cache: !1
                }).done(function(e) {
                    var l, m, n, o, p, q, r, s, t, u, v, w, x, y;
                    for (x = e.thread.name, n = e.thread.is_pair, s = e.thread.pair_user_id, n || (r = e.thread.member_num), 
                    y = +e.thread.unread_num, y > 10 && (y = "10+"), j = c.user.id + "savedFormText-" + e.thread.thread_id, 
                    v = b("div.input textarea.text-content"), a.storage.localStorage(j) ? v.val(a.storage.localStorage(j)) : v.val(""), 
                    u = i.data.threads, o = 0, p = u.length; o < p; o++) w = u[o], +w.thread_id === +k && (w.modified_at = e.thread.modified_at, 
                    w.unread_num = e.thread.unread_num, w.member_num = e.thread.member_num, w.latest_content = e.thread.latest_content);
                    if ("undefined" != typeof i.subscribedThread) {
                        if (!f && k === i.subscribedThread.metadata.thread.thread_id) return;
                        i.subscribedThread.poller && i.subscribedThread.poller.end();
                    }
                    b(".input.new-receiver").removeClass("new-receiver"), l = c.user.id + "threadContentData-" + k;
                    try {
                        for (q in window.localStorage) q.match("threadContentData-") && a.storage.localStorage(q, null);
                    } catch (a) {
                        h = a;
                    }
                    try {
                        t = document.location.pathname, history.replaceState({}, "", t + "?thread_id=" + k);
                    } catch (a) {
                        h = a;
                    }
                    return b(".message-thread-list .thread-" + k + " .unread_num").addClass("unread-0"), 
                    f ? (m = i.subscribedThread.contents, e.thread.thread_id_2 = i.subscribedThread.thread_id) : m = [], 
                    i.subscribedThread = {
                        metadata: e,
                        is_pair: n,
                        pair_user_id: s,
                        container: g,
                        contents: m,
                        no_history: !1,
                        poller: new c.message.Poller(function() {
                            var b, e, g, j, m;
                            m = this, j = new Date().getTime(), m.exe_time = j, g = !1;
                            try {
                                e = a.storage.localStorage(l), b = new Date().getTime() - e.time > i.cache_expiry, 
                                e.tabKey === i.tabKey || b ? g = !0 : i.updateThreadContentData(e.data.body) ? (i.renderers.renderThreadContent(), 
                                m.levelup()) : m.run();
                            } catch (a) {
                                h = a, g = !0;
                            }
                            if (g) return c.api.get("/rpc/index.php", {
                                mode: "message_thread_contents",
                                thread_id: k,
                                num: 10
                            }, {
                                cache: !1
                            }).done(function(b) {
                                var c;
                                if (j === m.exe_time && (a.storage.localStorage(l, {
                                    data: b,
                                    tabKey: i.tabKey,
                                    time: new Date().getTime()
                                }), c = i.updateThreadContentData(b.body), f || c ? (i.renderers.renderThreadContent(), 
                                m.levelup(), f && (i.threadListUpdatesPoller.runnow(), f = !1)) : m.run(), d.callback)) {
                                    try {
                                        d.callback.call(this);
                                    } catch (a) {
                                        h = a;
                                    }
                                    return delete d.callback;
                                }
                            }).fail(function(a) {
                                return m.level = 100, m.run();
                            }).always(function() {
                                return i.handleError(arguments);
                            });
                        })
                    }, i.subscribedThread.poller.runnow(), i.getLatestImages(k), !0;
                }), !0;
            },
            getLatestImages: function(a) {
                var d;
                return !!b("#page-messages").length && (d = this, delete d.subscribedThread.images, 
                c.api.message.attachmentItem(a, 8, {
                    cache: !1
                }).done(function(a) {
                    if (d.updateThreadImagesData(a.body)) return d.renderers.renderThreadImages();
                }));
            },
            unsubscribeThread: function() {
                var a, b, c;
                if (c = this, "undefined" != typeof c.subscribedThread) return a = c.subscribedThread, 
                a.poller && a.poller.end(), b = a.container, delete c.subscribedThread, c.renderers.renderThreadContent();
            },
            updateThreadContentData: function(a) {
                var b, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s;
                if (k = this, "undefined" == typeof k.subscribedThread) return !1;
                for (s = parseInt(k.subscribedThread.metadata.thread.thread_id), r = !1, a.next_url || (k.subscribedThread.no_history = !0), 
                m = a.message_thread_contents, q = k.subscribedThread.contents, n = !1, o = !1, 
                g = 0, b = d = 0, h = q.length; d < h; b = ++d) p = q[b], p.content_id > g && (g = p.content_id);
                for (b = e = 0, i = m.length; e < i; b = ++e) {
                    for (l = m[b], c = !0, b = f = 0, j = q.length; f < j; b = ++f) if (p = q[b], l.content_id === p.content_id) {
                        c = !1, p.tornoff && (q[b].tornoff = !1, q[b].force_rerender = !0), JSON.stringify(l.content) !== JSON.stringify(p.content) && (q[b].content = l.content, 
                        q[b].force_rerender = !0, r = !0);
                        break;
                    }
                    if (c && parseInt(l.thread_id) === s) {
                        if (!l.content) continue;
                        k.subscribedThread.contents.push(l), "image" === l.content.type && (n = !0), "system_text" === l.content.type && l.content_id > g && (o = !0), 
                        r = !0;
                    }
                }
                return n && k.getLatestImages(k.subscribedThread.metadata.thread.thread_id), o && k.updateMetadata(), 
                k.data.temp_content && k.data.temp_content[s] && (r = !0), r;
            },
            updateThreadImagesData: function(a) {
                var b, c, d, e, f, g, h, i, j, k, l, m, n;
                if (h = this, "undefined" == typeof h.subscribedThread) return !1;
                if (k = a.next_url, h.subscribedThread.images_next_url = k, j = a.images, "undefined" == typeof h.subscribedThread.images) return h.subscribedThread.images = j, 
                !0;
                for (m = h.subscribedThread.images, n = !1, b = d = 0, f = j.length; d < f; b = ++d) {
                    for (i = j[b], c = !0, b = e = 0, g = m.length; e < g; b = ++e) if (l = m[b], i.content_id === l.content_id) {
                        c = !1;
                        break;
                    }
                    c && (h.subscribedThread.images.push(i), n = !0);
                }
                return n;
            },
            updateMetadata: function() {
                var b, d, e, f;
                if (e = c.message, "undefined" != typeof e.subscribedThread) return d = e.subscribedThread, 
                f = d.metadata.thread.thread_id, b = d.container, c.api.get("/rpc/index.php", {
                    mode: "message_thread",
                    thread_id: f
                }, {
                    cache: !1
                }).done(function(c) {
                    return d.metadata = c, b.find(".thread-name").text(c.thread.name || a.t("退会・停止ユーザー")), 
                    b.find(".thread-member-num").text(c.thread.member_num);
                });
            },
            updateThreadListData: function(a, c) {
                var d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w;
                if (l = this, a.body.message_threads ? (w = a.body.message_threads, t = !0) : (u = !0, 
                w = a.body.starred_contents, t = !1), s = !1, l.data.threads_next_url = a.body.next_url, 
                u) for (m = f = 0, i = w.length; f < i; m = ++f) n = w[m], n.content_id && (w[m].thread_id = "c" + n.content_id), 
                w[m].thread_name || (w[m].thread_name = n.user_name), w[m].modified_at || (w[m].modified_at = n.posted_at), 
                w[m].unread_num = 0;
                for (m = g = 0, j = w.length; g < j; m = ++g) {
                    for (n = w[m], e = !0, r = l.data.threads, o = h = 0, k = r.length; h < k; o = ++h) if (p = r[o], 
                    p.thread_id === n.thread_id) {
                        e = !1, JSON.stringify(p) !== JSON.stringify(n) && (l.data.threads[o] = w[m], s = !0);
                        break;
                    }
                    e && (l.data.threads.push(w[m]), s = !0);
                }
                if (w.length || l.renderers.renderThreadList(), s ? (t && l.data.threads.sort(function(a, b) {
                    return b.modified_at - a.modified_at;
                }), l.renderers.renderThreadList(), c && c.levelup()) : (c && c.run(), l.data.threads.length || l.renderers.renderThreadList()), 
                d = b("#page-messages .messages-container"), d.length && d.hasClass("viewing-thread-list") && "undefined" == typeof l.subscribedThread) {
                    if (!l.data.threads.length) return;
                    return v = l.data.threads[0].thread_id, q = {
                        thread_id: v
                    }, l.subscribeThread(q);
                }
            }
        }), c.message.Poller = function(a) {
            return this.callback = a, this.level = 0, this.t = null, this.ended = !1;
        }, c.message.Poller.prototype = {
            fibo: [ 1, 2, 3, 5, 8, 13 ],
            leveldown: function() {
                if (this.level <= this.fibo.length - 2) return this.level++;
            },
            levelup: function() {
                return this.level = 1, this.run();
            },
            run: function() {
                var a;
                return clearTimeout(this.t), a = 2e4, this.level < 0 ? (a = 1, this.level = 0) : this.level > 99 ? (a = 6e4, 
                this.level = 0) : this.leveldown(), this.t = setTimeout(this.execute.bind(this), a);
            },
            runnow: function() {
                return this.level = -1, this.run();
            },
            execute: function() {
                if (!this.ended) return this.callback.call(this);
            },
            start: function() {
                return this.ended = !1, this.run();
            },
            end: function() {
                return clearTimeout(this.t), this.exe_time = 0, this.ended = !0;
            }
        }, a.ns("pixiv.message.renderers", {
            renderThreadList: function() {
                var d, e, f, g, h, i, j, k, l, m, n, o, p, q;
                if (k = c.message, n = this, i = b(".messages-container .thread-list-tab:checked").val(), 
                e = b(".thread-list-container"), p = k.data.threads, e.each(function(c, d) {
                    var e, f, g, h, j, l, m, o, q, r, s;
                    switch (e = b(d), e.removeClass("loading"), i) {
                      case "star":
                        r = b(d).find(".message-thread-list.star");
                        break;

                      default:
                        r = b(d).find(".message-thread-list.thread").first();
                    }
                    if (l = null, k.data.threads.length) {
                        for (b(d).removeClass("empty"), h = 0, j = p.length; h < j; h++) g = p[h], g.unread_count = g.unread_num > 10 ? "10+" : g.unread_num;
                        l = a.template("thread-list-items", {
                            threads: p
                        });
                    } else b(d).addClass("empty");
                    r.data("next-url", k.data.threads_next_url).html("").append(l), n.renderThreadListTime(r), 
                    m = r.scrollTop(), m < r[0].scrollHeight - r.innerHeight() || r.trigger("scroll");
                    try {
                        o = k.subscribedThread.metadata.thread.thread_id, r.find("li.thread").removeClass("active"), 
                        r.find("li.thread[data-thread-id=" + o + "]").addClass("active"), q = k.subscribedThread.metadata.thread.thread_id_2, 
                        q && r.find("li.thread[data-thread-id=" + q + "]").addClass("active");
                    } catch (a) {
                        f = a;
                    }
                    if (e.hasClass("jump") && (e.removeClass("jump"), p = e.find("ul.message-thread-list > li.thread"), 
                    s = [], p.each(function(a, c) {
                        if (b(c).data("unread-num") > 0) return s.push(c);
                    }), 1 === s.length)) return b(s[0]).trigger("click");
                }), "undefined" != typeof k.subscribedThread && "star" !== i && !k.subscribedThread.read_only) {
                    for (j = k.subscribedThread.metadata, f = !0, g = 0, h = p.length; g < h; g++) o = p[g], 
                    o.thread_id === j.thread.thread_id && (f = !1);
                    if (f) return d = k.subscribedThread.container, q = d.find(".message-thread-list.thread"), 
                    m = {
                        icon_url: j.thread.icon_url,
                        is_pair: j.thread.is_pair,
                        latest_content: j.thread.latest_content,
                        member_num: j.thread.member_num,
                        modified_at: j.thread.modified_at,
                        thread_id: j.thread.thread_id,
                        thread_name: j.thread.name,
                        unread_num: j.thread.unread_num,
                        is_active_thread: j.thread.is_active_thread
                    }, l = a.template("thread-list-items", {
                        threads: [ m ]
                    }), l = b(l), l.addClass("permalink active"), q.prepend(l), n.renderThreadListTime(q);
                }
            },
            renderThreadContent: function() {
                var d, e, f, g, h, i, j, k, l, m, n, o, p, q, r, s, t, u, v, w, x, y, z, A, B, C, D, E, F, G, H, I, J, K, L, M, N, O, P, Q;
                if (H = c.message, H.subscribedThread) {
                    for (m = c.message.subscribedThread, Q = c.message.updateUser(m.metadata.users), 
                    G = H.subscribedThread, O = G.metadata.thread.thread_id, P = G.metadata.thread.name, 
                    E = G.metadata.thread.member_num, s = G.metadata.thread.is_pair, I = G.read_only, 
                    d = G.container, i = G.contents, d.find("li.thread").removeClass("active"), d.find("li.thread[data-thread-id=" + O + "]").addClass("active"), 
                    u = 0, A = i.length; u < A; u++) f = i[u], t = f.content, f.user.user_id === c.user.id && (f.self = !0), 
                    f.content && (f.system = "system_text" === f.content.type, f.banned = /^banned_.+$/.test(f.content.type), 
                    "join_request" === f.content.type && (f.join_request = !0, f.thread_name = P), "mypixiv_request" === f.content.type && (f.mypixiv_request = !0), 
                    "image" === t.type && (N = 400, e = d.find(".message-content-list").width(), e < N && (N = 200), 
                    M = +t.width > N || +t.height > N ? c.imageFormat(+t.width, +t.height, N) : [ t.width, t.height ], 
                    f.format = {
                        width_400: M[0],
                        height_400: M[1]
                    }));
                    for (F = d.find("ul.message-content-list"), F.data("thread-id") !== O && (p = !0, 
                    F.html("").removeClass("no-history").scrollTop(0)), F.data("thread-id", O), G.no_history && F.addClass("no-history"), 
                    L = F.scrollTop(), K = F[0].scrollHeight, D = F.innerHeight(), r = D + L >= K, z = b(".message-content:last-child()", F), 
                    w = p || r, v = 0, B = i.length; v < B; v++) {
                        if (f = i[v], h = ".message-content-" + f.content_id, n = F.find(h), n.length) {
                            if (n.removeClass("torn-off"), !f.force_rerender) continue;
                            n.remove(), delete f.force_rerender;
                        }
                        if (!f.user_blocked) {
                            for (g = b(a.template("thread-content", {
                                content: f
                            })), l = F.find("li.message-content"), q = !1, x = 0, C = l.length; x < C; x++) if (j = l[x], 
                            k = b(j).data("content-id"), f.content_id < k) {
                                g.insertBefore(j), q = !0;
                                break;
                            }
                            q || F.append(g);
                        }
                    }
                    J = I || m.metadata.thread.is_mendako || m.is_pair && !(Q[m.pair_user_id] && Q[m.pair_user_id].is_complete_user), 
                    o = !J, b(".thread-content-container").toggleClass("readonly-thread", J), H.data.temp_content && H.data.temp_content[O] && (H.data.temp_content[O].content.name = P, 
                    g = b(a.template("thread-content", {
                        content: H.data.temp_content[O]
                    })), delete H.data.temp_content[O], F.append(g)), F.find(".temp.success").remove(), 
                    P ? d.find(".thread-content-container .thread-name").text(P).data("thread-id", O) : d.find(".thread-content-container .thread-name").text(a.t("退会・停止ユーザー")), 
                    s ? (d.find(".thread-content-container").addClass("is-pair"), d.find(".action-report-user a").attr("href", "/user_infomsg.php?id=" + G.metadata.thread.pair_user_id + "#report"), 
                    d.find(".action-block-user a").attr("href", "/user_infomsg.php?id=" + G.metadata.thread.pair_user_id + "#block")) : (d.find(".thread-content-container").removeClass("is-pair"), 
                    d.find(".thread-content-container .thread-member-num").text(E)), d.find(".error-displayed").removeClass("has-error"), 
                    d.find(".thread-container .button-messages-actions").toggleClass("inactive", !o), 
                    d.find(".thread-content-container").removeClass("inactive").find(".actions").data("thread-id", O), 
                    d.find(".thread-content-container .submit-message-short textarea").data("receiver-id", "").data("receiver-ids", "").data("thread-id", O), 
                    d.find(".thread-content-container .attach-content input[name=thread_id]").val(O), 
                    d.find(".thread-content-container .attach-content input[name=upfile]").val(""), 
                    d.removeClass("viewing-thread-list").addClass("viewing-thread-content"), d.find(".thread-content-container").removeClass("loading"), 
                    this.renderThreadContentTime(F), F[0].scrollHeight === F.innerHeight() && F.trigger("scroll"), 
                    w ? (y = F.find("> li").last(), y.each(function(a, b) {
                        return b.scrollIntoView();
                    })) : q && F.scrollTop(F[0].scrollHeight - K);
                }
            },
            renderThreadContentTime: function(a) {
                var c, d, e;
                return c = new Date(0), d = this, e = new Date(), b(".time", a).each(function() {
                    var a, f, g;
                    return f = b(this), g = +f.dataset("time"), a = new Date(1e3 * g), a.getTime() - c.getTime() < 3e5 ? void f.addClass("_hidden") : (a.toDateString() === c.toDateString() ? f.text(d.simplifyTime(e, a)) : f.text(d.simplifyTime(c, a)), 
                    f.attr("title", a.toString()), c = a);
                });
            },
            showThreadFile: function() {
                var d, e, f, g, h, i, j;
                if (h = c.message, "undefined" != typeof h.subscribedThread) return g = h.subscribedThread, 
                e = g.images, j = g.metadata.thread.thread_id, i = g.images_next_url, d = g.container, 
                f = d.find(".thread-images-container"), d = b("#page-messages"), b("ul.message-image-list", d).each(function(c, d) {
                    var f, g, h, k, l, m, n, o, p, q, r, s, t, u;
                    if (t = b(d), t.data("thread-id") !== j && t.scrollTop(0).html("").removeClass("busy"), 
                    t.data("thread-id", j), t.data("next-url", i), !e) return !1;
                    for (p = 0, r = e.length; p < r; p++) if (l = e[p], n = ".item-" + l.content_id, 
                    k = t.find(n), !k.length) {
                        for (m = b(a.template("message-attachment-list-items", {
                            items: l,
                            large: !0
                        })), h = t.find("li.item"), o = !1, q = 0, s = h.length; q < s; q++) if (f = h[q], 
                        g = b(f).data("content-id"), l.content_id > g) {
                            b(m).insertBefore(f), o = !0;
                            break;
                        }
                        o || t.append(m);
                    }
                    return u = t.scrollTop(), u < t[0].scrollHeight - t.innerHeight() ? void 0 : t.trigger("scroll");
                }), !0;
            },
            renderThreadImages: function() {
                var d, e, f, g, h, i, j;
                (f = null != (i = c.message.subscribedThread) ? i.images : void 0) && (d = b("._message-attachments-container"), 
                g = b(".items", d), j = b(".wrapper", d), e = f.length, h = e > 6, j.toggleClass("empty", !e), 
                b(".more", d).toggleClass("_hidden", !h), e ? g.html(a.template("message-attachment-list-items", {
                    items: f.slice(0, h ? 5 : 6)
                })) : g.empty());
            }
        });
    }(b);
}.call(this), function() {
    "use strict";
    !function(a) {
        return colon.ns("pixiv.mute", {
            items: null,
            setup: function() {
                var b;
                if (null != pixiv.user.mutes) return b = 0, this.items = pixiv.user.mutes.filter(function(a) {
                    return pixiv.user.premium || +a.mute_is_premium_slot === b;
                }), this.install(), colon.d.on("click.mute", ".mute-setting-opener", function(b) {
                    var c;
                    return c = a(b.target), colon.log(c.dataset());
                });
            },
            isAvailable: function() {
                return null != this.items;
            },
            config: function(a) {
                return !1;
            },
            findTag: function(a, b) {
                var c, d, e, f, g;
                if ("positive" === a) return !1;
                for (c = 0, g = this.items, d = 0, e = g.length; d < e; d++) if (f = g[d], +f.mute_type === c && f.mute_value.toLowerCase() === b.toLowerCase()) return !0;
                return !1;
            },
            findUser: function(a, b) {
                var c, d, e, f, g;
                if ("positive" === a) return !1;
                for (c = 1, g = this.items, d = 0, e = g.length; d < e; d++) if (f = g[d], +f.mute_type === c && +f.mute_value === +b) return !0;
                return !1;
            },
            install: function() {
                var b, c;
                b = a(document.createElement("div")), b.addClass("mute-setting-opener"), b.text("⋯"), 
                c = pixiv.scrollView.filters["thumbnail-filter"], pixiv.scrollView.registerFilter("thumbnail-filter", function(d) {
                    return function(e) {
                        var f, g, h, i, j, k, l, m, n;
                        for (h = e.closest(".image-item"), m = e.closest(".rank-detail"), n = h.get().concat(m.get()), 
                        g = 0, k = n.length; g < k; g++) i = n[g], i = a(i), l = i.find("a").first().attr("href"), 
                        j = d.parseLink(l), null != j && (f = b.clone(), f.dataset("type", j.type), f.dataset("id", j.id), 
                        f.appendTo(i));
                        return c.apply(void 0, arguments);
                    };
                }(this));
            },
            parseLink: function(a) {
                var b;
                return b = colon.query.parse(a), null != b.illust_id ? {
                    type: "illust",
                    id: Number(b.illust_id)
                } : null != b.id ? {
                    type: "novel",
                    id: Number(b.id)
                } : void 0;
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        var b;
        return a(function() {
            colon.dispatcher.connect("/", function() {
                pixiv.user.id && (pixiv.mypage.setup(), pixiv.userRecommend.introduction.setup(), 
                b(), pixiv.modalPremiumPromotion.open());
            }).dispatch();
        }), colon.ns("pixiv.tutorial", {
            open: function() {
                var b;
                if (b = colon.$.find("._tutorial-modal")) return colon.ui.modal.push(b, {
                    block: !0,
                    disposable: !0
                }), b.on("click", function(b) {
                    this === b.target && a(".slider-arrow:last", this).click();
                }), a(".ui-tab-container", b).on("uiTabUpdate", function(c, d, e) {
                    var f, g, h, i;
                    f = a(".slider-arrow", b), h = f.first(), g = a(".slider-arrow-right", f.last()), 
                    i = a(".slider-btn-right", b), h[d.is(":first-child") ? "addClass" : "removeClass"]("_hidden"), 
                    d.is(":last-child") ? (g.addClass("_hidden"), i.removeClass("_hidden")) : (g.removeClass("_hidden"), 
                    i.addClass("_hidden")), d.length || colon.ui.modal.close();
                });
            }
        }), colon.ns("pixiv.modalPremiumPromotion", {
            open: function() {
                var b;
                if (!colon.$.find("._tutorial-modal") && (b = colon.$.find("._premium-promotion-modal"))) return colon.ui.modal.push(b, {
                    block: !0,
                    disposable: !0
                }), b.hasClass("_factory_popup") ? b.hasClass("_factory_popup_uploader") ? colon.ga.trackEvent([ "factory_popup_view_oct2016_uploader", "index" ]) : colon.ga.trackEvent([ "factory_popup_view_oct2016_nonuploader", "index" ]) : colon.ga.trackEvent([ "premium_popup", "index" ]), 
                b.on("click", function(b) {
                    this === b.target && a(".slider-arrow:last", this).click();
                }), a(".china-popup-top-alipay a").length > 0 && colon.$.find(".china-popup-top-alipay a").on("click", function(a) {
                    a.stopPropagation();
                }), a(".ui-tab-container", b).on("uiTabUpdate", function(c, d, e) {
                    var f, g, h, i;
                    g = a(".slider-arrow", b), i = g.first(), h = a(".slider-arrow-right", g.last()), 
                    i[d.is(":first-child") ? "addClass" : "removeClass"]("_hidden"), d.is(":last-child") ? h.addClass("_hidden") : h.removeClass("_hidden"), 
                    0 === d.length ? colon.ui.modal.close() : a(".modal-manga-link").length > 0 && (f = function() {
                        switch (d.data("target")) {
                          case "tutorial-sensei":
                            return "?ref=creators_popup_sensei#sensei";

                          case "tutorial-ranking-report":
                            return "?ref=creators_popup_ranking_report#ranking_report";

                          case "tutorial-reserve":
                            return "?ref=creators_popup_reserve#reserve";

                          default:
                            return "";
                        }
                    }(), colon.ga.trackEvent([ "premium_popup", d.data("target") ]), a(".modal-manga-link").attr("href", "/premium/creators" + f));
                });
            }
        }), colon.ns("pixiv.modalPromotion", {
            open: function() {
                var b;
                if (!colon.$.find("._tutorial-modal") && !colon.storage.localStorage("hideModalPromotion") && (b = colon.$.find("._matsuri-modal"))) return colon.ui.modal.push(b, {
                    block: !0,
                    disposable: !0
                }), b.on("uimodalclose", function() {
                    colon.storage.localStorage("hideModalPromotion", !0);
                }).on("click", function(b) {
                    this === b.target && a(".slider-arrow:last", this).click();
                }), a(".ui-tab-container", b).on("uiTabUpdate", function(c, d, e) {
                    var f, g, h, i;
                    f = a(".slider-arrow", b), h = f.first(), g = a(".slider-arrow-right", f.last()), 
                    i = a(".slider-btn-right", b), h[d.is(":first-child") ? "addClass" : "removeClass"]("_hidden"), 
                    d.is(":last-child") ? (g.addClass("_hidden"), i.removeClass("_hidden")) : (g.removeClass("_hidden"), 
                    i.addClass("_hidden")), d.length || colon.ui.modal.close();
                });
            }
        }), colon.ns("pixiv.premiumTutorial", {
            open: function() {
                var a;
                if (a = colon.$.find("._premium-tutorial-modal")) return colon.ui.modal.push(a, {
                    block: !0,
                    disposable: !0
                }), a.on("uimodalclose", function() {
                    colon.storage.localStorage("hideModalPromotion", !0);
                });
            }
        }), colon.ns("pixiv.paypalPromotion", {
            open: function() {
                var a;
                if (a = colon.$.find("._paypal-promotion-modal")) return colon.ui.modal.push(a, {
                    block: !0,
                    disposable: !0
                }), a.on("uimodalclose", function() {
                    colon.storage.localStorage("hideModalPromotion", !0);
                });
            }
        }), colon.ns("pixiv.userRecommend.introduction", {
            setup: function() {
                colon.storage.cookie("show_welcome_modal") && this.openTutorial(), colon.storage.localStorage("hideUserRecommendIntroduction") || (a(".user-recommend-introduction").removeClass("hidden"), 
                colon.d.on("click", ".action-open-user-recommendation", a.proxy(this.open, this)).on("click", ".action-close-recommend-introduction", a.proxy(this.hide, this)));
            },
            openTutorial: function() {
                var b, c;
                b = a(".user-recommendation-modal"), colon.storage.cookie("show_welcome_modal", null), 
                b.is(":visible") || (new pixiv.UserList(b, {
                    modal: !0,
                    sampleUser: null != (c = colon.storage.localStorage("recent-prelogin-visited-users")) ? c.join() : void 0,
                    followingBoosterModel: 2
                }), colon.ui.modal.push(b, {
                    block: !0
                }), b.on("uimodalclose", function(a) {
                    return function() {
                        pixiv.tutorial.open();
                    };
                }(this)));
            },
            open: function() {
                var b;
                b = a(".user-recommendation-modal"), b.is(":visible") || (new pixiv.UserList(b, {
                    modal: !0,
                    sampleUser: pixiv.context.userRecommendSampleUser,
                    followingBoosterModel: 1
                }), colon.ui.modal.push(b, {
                    block: !0
                }), b.on("uimodalclose", function(a) {
                    return function() {
                        pixiv.tutorial.open();
                    };
                }(this)));
            },
            hide: function() {
                a(".user-recommend-introduction").slideUp(), colon.storage.localStorage("hideUserRecommendIntroduction", !0);
            }
        }), b = function() {
            var a;
            if (pixiv.context.hasUserRecommendationCache === !1 && (a = colon.$.find("#user-recommend-container"))) return pixiv.api.recommender.user(pixiv.context.userRecommendSampleUser).done(function(b) {
                if (b = null != b ? b.recommend_users : void 0, null != b ? b.length : void 0) return a.removeClass("_hidden").find(".user-list").append(colon.template("user-recommend-list", {
                    items: b
                }));
            });
        }, colon.ns("pixiv.mypage", {
            setup: function() {
                pixiv.modalPromotion.open(), pixiv.premiumTutorial.open(), pixiv.paypalPromotion.open(), 
                pixiv.mypageModule.setup(), pixiv.mypageModuleSenseiCourses.setup(), pixiv.mypageCollapsibleBanner.setup();
            },
            toggleFavoriteTagEdit: function() {
                var b;
                return b = a("#edit-favorite-tag"), b.dataset("initialized") || new pixiv.ui.Tag(a("input.ui-tag", b)), 
                b.dataset("initialized", !0).slideToggle("fast"), !1;
            }
        }), colon.ns("pixiv.mypageCollapsibleBanner", {
            cookieName: "mypage_has_collapsed_header_banner",
            setup: function() {
                return this.container = a(".mypage-collapsible-banner"), this.container.on("click", ".mypage-adobe-link", function(a) {
                    return function(a) {
                        return colon.ga.trackEvent([ "adobe_cc_link_click", "index" ]), !0;
                    };
                }(this)), this.container.on("click", ".mypage-banner-close", function(a) {
                    return function(b) {
                        return a.container.hide(), colon.storage.cookie(a.cookieName, 1, {
                            expires: 31536e6
                        }), !1;
                    };
                }(this));
            }
        }), colon.ns("pixiv.mypageModuleSenseiCourses", {
            cookieName: "mypage_has_closed_sensei_caption",
            setup: function() {
                if (this.container = a("#item-container"), this.senseiCaption = a(".sensei-caption"), 
                this.senseiCaption.length) return this.container.on("click", ".sensei-caption-close-icon", function(a) {
                    return function(b) {
                        return a.senseiCaption.hide(), colon.storage.cookie(a.cookieName, 1, {
                            expires: 31536e6
                        }), !1;
                    };
                }(this));
            }
        }), colon.ns("pixiv.mypageModule", {
            cookieName: "module_orders_mypage",
            setup: function() {
                this.container = a("#item-container"), this.parse() && this.container.on("click", ".action", function(b) {
                    return function(c) {
                        var d;
                        return d = a(c.currentTarget), b[d.dataset("action")](d.closest(".item").dataset("name")), 
                        !1;
                    };
                }(this));
            },
            parse: function() {
                return this.config = colon.storage.config(null, {
                    expires: 31536e6
                }, {
                    update: !1
                }), this.data = JSON.parse(this.config(this.cookieName));
            },
            update: function() {
                this.config(this.cookieName, JSON.stringify(this.data));
            },
            find: function(a) {
                var b, c, d, e, f;
                for (f = this.data, b = d = 0, e = f.length; d < e; b = ++d) if (c = f[b], c.name === a) return b;
                return -1;
            },
            up: function(b) {
                var c, d, e, f;
                (c = this.find(b)) <= 0 || (d = this.data.splice(c, 1)[0], this.data.splice(c - 1, 0, d), 
                e = a("> .item", this.container), f = e.index(e.filter("." + colon.letterCase(b, "css"))), 
                f !== -1 && e.eq(f).insertBefore(e.eq(f - 1)), this.update());
            },
            down: function(b) {
                var c, d, e, f;
                c = this.find(b), c >= this.data.length - 1 || (d = this.data.splice(c, 1)[0], this.data.splice(c + 1, 0, d), 
                e = a("> .item", this.container), f = e.index(e.filter("." + colon.letterCase(b, "css"))), 
                f !== e.length - 1 && e.eq(f).insertAfter(e.eq(f + 1)), this.update());
            },
            toggle: function(b) {
                var c, d;
                (c = this.find(b)) !== -1 && (d = a("> .item." + colon.letterCase(b, "css"), this.container), 
                this.data[c].visible ? (d.addClass("closed"), this.data[c].visible = !1) : (d.removeClass("closed"), 
                this.data[c].visible = !0), this.update(), a("> .content", d).length || location.reload());
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    var a, b, c;
    b = require("jquery"), a = require("colon"), c = require("pixiv"), function(b) {
        return a.ns("pixiv.api.notification", {
            count: function(a) {
                return c.api.get("/rpc/notify_count.php", {
                    op: "count_unread"
                }, a);
            },
            message: function(a) {
                return c.api.get("/rpc/index.php", {
                    mode: "latest_message_threads2",
                    num: 5
                }, a);
            },
            popboard: function(a) {
                return c.api.post("/rpc/notify.php", {
                    op: "notify"
                }, a);
            }
        }), c.Notification = function() {
            function d(d) {
                this.type = d, this.container = "#notification-" + this.type, this.buttonContainer = b("." + this.type, c.Notification.container), 
                this.countContainer = b(".count", this.buttonContainer), a.d.on("notificationCount", function(a) {
                    return function(b, c) {
                        return null != (null != c ? c[a.type] : void 0) && a.updateUnreadCount(c[a.type]), 
                        !1;
                    };
                }(this)), b(".notification-button", this.buttonContainer).on("click", function(a) {
                    return function(b) {
                        1 === b.which && (b.stopPropagation(), b.preventDefault(), a.toggle());
                    };
                }(this)), b(".notification-button-focus", this.buttonContainer).on("focus", function(a) {
                    return function() {
                        return a.toggle(), !1;
                    };
                }(this));
            }
            return d.intervalCount = 1, d.unreadCount = {}, d.setup = function() {
                (this.container = a.$.find(".notifications")) && (c.Notification.isWhitecube = !!c.config.whitecubeEmbed || null != c.config.isNewContest || "/whitecube" === window.location.pathname.substr(0, "/whitecube".length), 
                c.Notification.message = new c.Notification("message"), c.Notification.popboard = new c.Notification("popboard"), 
                a.storage.send("pixiv.Notification.intervalCount", this.intervalCount), a.storage.send("pixiv.Notification.updateCount", [ c.user.unreadCount ]), 
                this.updateCount(c.user.unreadCount), this.setupNotification(), this.start(), this.request());
            }, d.setupNotification = function() {
                "default" === a.notification.status() && a.d.on("click", "._notification-request-permission", function() {
                    a.notification.request(function(a) {
                        "default" !== a && b("._notification-request-permission").slideUp(function() {
                            b(this).remove();
                        });
                    });
                });
            }, d.interval = function() {
                return 6e4 * Math.min(Math.pow(2, this.intervalCount), 8);
            }, d.start = function() {
                a.test.storage && (this.stop(), this.timer = setInterval(b.proxy(this.request, this), this.interval()));
            }, d.stop = function() {
                this.timer && clearInterval(this.timer), this.timer = null;
            }, d.request = function() {
                var b, d;
                return b = this.interval(), d = c.api.notification.count({
                    cache: b
                }), d.then(function(b) {
                    return function(c, d) {
                        var e;
                        "cache" !== d && ((e = b.totalCount()) && a.notification.show(a.t("メッセージ・ポップボード"), {
                            body: a.template("web-notification-notification", {
                                count: e
                            }),
                            icon: "/favicon.ico"
                        }), a.storage.send("pixiv.Notification.intervalCount", ++b.intervalCount), a.storage.send("pixiv.Notification.updateCount", [ c ]), 
                        b.updateCount(c));
                    };
                }(this), function(a) {
                    return function(b) {
                        "cache" !== b.status && a.stop();
                    };
                }(this));
            }, d.totalCount = function() {
                return (this.unreadCount.message || 0) + (this.unreadCount.popboard || 0);
            }, d.updateCount = function(d) {
                a.d.trigger("notificationCount", d), b.extend(this.unreadCount, d), "/messages.php" === location.pathname && d.popboard && delete d.popboard, 
                c.badge.update(d);
            }, d.prototype.updateUnreadCount = function(a) {
                var d;
                "popboard" === this.type && null != c.user.unreadCount.mailAuthentication && a++, 
                d = b("a", this.buttonContainer), a ? (a > 10 && (a = "10+"), this.countContainer.text(a), 
                d.addClass("unread")) : (this.countContainer.text("0"), d.removeClass("unread"));
            }, d.prototype.toggle = function() {
                var d, e;
                if (e = b(this.container), !e.is("._balloon-menu-popup")) {
                    if (a.d.trigger({
                        type: "click",
                        which: 1
                    }), this.buttonContainer.hasClass("active")) return void a.ui.modal.pop();
                    d = b(".active", c.Notification.container), d.length && (d.removeClass("active"), 
                    a.ui.modal.pop()), this.buttonContainer.addClass("active"), e.one("uimodalclose", function(a) {
                        return function() {
                            a.buttonContainer.removeClass("active");
                        };
                    }(this)), a.ui.modal.push(e);
                }
                c.api.notification[this.type]().done(function(a) {
                    return function(b) {
                        b = a.process(b), a.create(b, !0), "function" == typeof a.success && a.success(b), 
                        c.Notification.request();
                    };
                }(this)), "default" === a.notification.status() && b("._notification-request-permission").show();
            }, d.prototype.process = function(a) {
                var b, c, d, e;
                switch (this.type) {
                  case "message":
                    for (a.items = a.body.message_threads, e = a.items, b = 0, d = e.length; b < d; b++) c = e[b], 
                    c.notified_at = parseInt(c.modified_at, 10), c.unread = !0, c.type = "message", 
                    c.unread_count = c.unread_num > 10 ? "10+" : c.unread_num;
                }
                return a;
            }, d.prototype.create = function(d, e) {
                var f, g, h, i, j, k, l, m, n, o;
                for (null == e && (e = !1), j = d.items, o = 0, l = [], h = 0, k = j.length; h < k; h++) {
                    switch (i = j[h], f = "string" === b.type(i.notified_at) ? new Date(i.notified_at) : new Date(1e3 * i.notified_at), 
                    i.date = f.getFullYear() + "-" + a.padding(f.getMonth() + 1) + "-" + a.padding(f.getDate()), 
                    i.date_ago = Math.floor((new Date() - f) / 864e5), e && (i.date_time = i.date + " " + a.padding(f.getHours()) + ":" + a.padding(f.getMinutes())), 
                    i.unread = !!i.unread, i.type) {
                      case "favorited":
                        i.details.other_count = i.details.users.length - 1;
                        break;

                      case "ranked_in":
                        i.details.category = a.t(i.details.context + "Ranking");
                        break;

                      case "booth_item":
                        i.details.other_count = i.details.items.length - 1;
                    }
                    n = c.Notification.isWhitecube ? "whitecube-notification-" + i.type : "notification-" + i.type;
                    try {
                        l.push(a.template(n, i));
                    } catch (a) {
                        g = a, c.alarm.send(g, [ i ]);
                    }
                    i.unread && ++o;
                }
                m = b("ul", this.container).html(l.join("")), "message" === this.type ? c.message.renderers.renderThreadListTime(m) : (o > 5 && !e && m.append(a.template("notification-more", {
                    other_count: this.unreadCount - o,
                    notification_type: this.type
                })), this.updateUnreadCount(d.remaining_unread_count), c.user.unreadCount[this.type] = d.remaining_unread_count, 
                c.Notification.updateCount(c.user.unreadCount));
            }, d;
        }();
    }(b);
}.call(this), function() {
    "use strict";
    var a, b, c, d = function(a, b) {
        return function() {
            return a.apply(b, arguments);
        };
    };
    b = require("jquery"), a = require("colon"), c = require("pixiv"), function(e) {
        return c.isUri = function(a) {
            var b;
            return b = /(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/, 
            b.test(a);
        }, c.isPixivUri = function(a) {
            var b;
            return b = /(http|https):\/\/(\w+\.pixiv\.net.*|p\.tl\/i\/\d+|p\.tl\/e\/\d+|p\.tl\/t\/\d+)/, 
            b.test(a);
        }, function() {
            var a, b, c, d, f, g, h, i, j, k;
            for (b = document.createElement("div"), k = !1, i = [ "writing-mode: tb-rl;", "writing-mode: vertical-rl;", "-o-writing-mode: vertical-rl;", "-ms-writing-mode: tb-rl;", "-ms-writing-mode: vertical-rl;", "-moz-writing-mode: vertical-rl;", "-webkit-writing-mode: vertical-rl;" ], 
            c = 0, f = i.length; c < f; c++) h = i[c], b.style.cssText = h, (b.style.length > 0 || "tb-rl" === (null != (j = b.currentStyle) ? j.writingMode : void 0)) && (k = !0);
            for (k ? e("html").addClass("verticaltext") : e("html").addClass("no-verticaltext"), 
            b = document.createElement("span"), k = !1, i = [ "text-combine: horizontal;", "-o-text-combine: horizontal;", "-ms-text-combine: horizontal;", "-moz-text-combine: horizontal;", "-webkit-text-combine: horizontal;" ], 
            d = 0, g = i.length; d < g; d++) h = i[d], b.style.cssText = h, b.style.length > 0 && (k = !0);
            return k ? e("html").addClass("textcombine") : e("html").addClass("no-textcombine"), 
            a = window.navigator.userAgent, a.indexOf("MSIE ") >= 0 || a.indexOf("Trident/") >= 0 || a.indexOf("Edge/") >= 0 ? e("html").addClass("ie") : e("html").addClass("no-ie"), 
            e.support.rtlScrollType = "default", e(document).ready(function() {
                var a, b, c;
                return a = e("<div/>", {
                    text: "A",
                    css: {
                        fontSize: "14px",
                        width: "1px",
                        height: "1px",
                        position: "absolute",
                        top: "-1000px",
                        overflow: "scroll",
                        writingMode: "tb-rl",
                        OWritingMode: "vertical-rl",
                        MsWritingMode: "tb-rl",
                        MozWritingMode: "vertical-rl",
                        WebkitWritingMode: "vertical-rl"
                    }
                }), a.css({
                    writingMode: "vertical-rl",
                    MsWritingMode: "vertical-rl"
                }), b = a.appendTo("body")[0], c = "reverse", b.scrollLeft > 0 ? c = "default" : (b.scrollLeft = 1, 
                0 === b.scrollLeft && (c = "negative")), e(b).remove(), e.support.rtlScrollType = c;
            });
        }(), function(a) {
            return a.fn.getTextNodes = function() {
                return a(this).find(":not(iframe)").addBack().contents().filter(function() {
                    return 3 === this.nodeType;
                });
            }, a.fn.scrollLeftCool = function(b, c) {
                var d;
                if (d = b ? a.support.rtlScrollType : "default", "undefined" == typeof c) switch (d) {
                  case "default":
                    return a(this).scrollLeft();

                  case "negative":
                    return a(this).scrollLeft() + a(this).get(0).scrollWidth - a(this).width();

                  case "reverse":
                    return a(this).width() - a(this).scrollLeft();

                  default:
                    return a(this).scrollLeft();
                } else switch (d) {
                  case "default":
                    return a(this).scrollLeft(c);

                  case "negative":
                    return a(this).scrollLeft(c - a(this).get(0).scrollWidth + a(this).width());

                  case "reverse":
                    return a(this).scrollLeft(a(this).width() - c);

                  default:
                    return a(this).scrollLeft(c);
                }
            };
        }(b), c.Novel = function() {
            function b(b) {
                this.onMousewheel = d(this.onMousewheel, this), this.onFullscreenScroll = d(this.onFullscreenScroll, this), 
                this.onResizeInFullscreen = d(this.onResizeInFullscreen, this), this.onIllustLoad = d(this.onIllustLoad, this);
                var f, g, h, i, j, k, l, m;
                this.$root = e(b), this.$extendedBackground = this.$root.parents(".novel-extended-background"), 
                this.$text = this.$root.find("#novel_text"), this.$body = this.$root.find(".novel-body"), 
                this.$textWrapper = this.$root.find(".novel-pages"), this.$pager = this.$root.find(".pager"), 
                this.$pagerPrev = this.$root.find(".pager-prev"), this.$pagerNext = this.$root.find(".pager-next"), 
                this.$pagerPage = this.$root.find(".pager-page"), this.$quitFullscreenButton = this.$root.find(".novel-quit-fullscreen"), 
                this.$writingModeController = this.$root.find(".controller-writing-mode"), this.$fontController = this.$root.find(".controller-font"), 
                this.$markerController = this.$root.find(".controller-marker"), this.$insertMarkerButton = this.$root.find(".insert-marker"), 
                this.$destroyMarkerButton = this.$root.find(".destroy-marker"), this.$followMarkerButton = this.$root.find(".follow-marker"), 
                this.$scrollFollower = this.$root.find(".scroll-follower"), this.$enableFullscreenButton = this.$root.find(".enable-fullscreen"), 
                this.$bodyMarker = this.$root.find(".body-marker"), this.$scrollerPrev = this.$root.find(".scroller-prev"), 
                this.$scrollerNext = this.$root.find(".scroller-next"), this.$configController = this.$root.find(".controller-config"), 
                this.$markerTooltip = this.$root.find(".novel-tooltip-marker"), this.$configTooltip = this.$root.find(".novel-tooltip-config"), 
                this.$sizeChoices = this.$root.find(".novel-size input"), this.$lineChoices = this.$root.find(".novel-line input"), 
                this.$scrollModeChoices = this.$root.find(".novel-scroll-mode input"), this.$themeChoices = this.$root.find(".novel-theme"), 
                this.$markerList = this.$root.find(".marker-list"), this.$chapterList = e("#novel_chapter"), 
                this.$pixivimages = e(), this.illustIds = [], this.meta = {
                    workId: this.$root.data("workid"),
                    explicit: this.$root.data("explicit"),
                    permission: this.$root.data("permission"),
                    userId: this.$root.data("userid")
                }, this.page = 0, this.rawBody = this.$text.val(), this.id = c.context.workId, this.marker = c.context.marker;
                try {
                    this.params = JSON.parse(c.context.serialized_value);
                } catch (a) {
                    this.params = {};
                }
                this.parse(), this.loadIllusts(), this.updateChapters(), this.bind(), g = this.getHash(), 
                null === g && (g = 0), "object" == typeof g && this.chapterTo(g[0], g[1], {
                    preventHashChange: !0
                }), "number" == typeof g && this.pageTo(g, {
                    preventScroll: !0,
                    preventHashChange: !0
                }), this.niceScroll = this.$pages.add(this.$root.find(".novel-pages")).niceScroll({
                    zindex: 10001,
                    rtlmode: !0,
                    verticalmode: !0,
                    mousescrollstep: 60,
                    scrollspeed: 30,
                    autohidemode: "scroll",
                    cursoropacitymin: 0,
                    cursoropacitymax: .5,
                    enablekeyboard: !1,
                    onmousewheel: this.onMousewheel,
                    noscrolllength: 1
                }), this.config = e.extend(this.config, a.storage.localStorage("novel_config")), 
                this.clickCounter = e.extend(this.clickCounter, a.storage.localStorage("novel_click_counter")), 
                a.storage.localStorage("novel_seen_fullscreen_button") || (this.$enableFullscreenButton.mouseenter(), 
                a.storage.localStorage("novel_seen_fullscreen_button", !0)), a.ga.trackEvent([ "novel", "view_with_theme", this.config.theme ]), 
                m = 0 === (null != (h = this.clickCounter.writingMode) ? h : 0) ? "default" : this.config.writingMode, 
                a.ga.trackEvent([ "novel", "view_with_writing_mode", m ]), "vertical" === this.config.writingMode && (l = 0 === (null != (i = this.clickCounter.scrollMode) ? i : 0) ? "default" : this.config.scrollMode, 
                a.ga.trackEvent([ "novel", "view_with_scroll_mode", l ])), f = document.documentElement.lang || "ja", 
                m = 0 === (null != (j = this.params.view_mode) ? j : 0) ? this.config.writingMode : null != (k = {
                    1: "vertical",
                    2: "horizontal"
                }[this.params.view_mode]) ? k : "horizontal", this.setFont(this.config.font, {
                    preventReadCharsSync: !0
                }), this.setSize(this.config.size, {
                    preventReadCharsSync: !0
                }), this.setLine(this.config.line, {
                    preventReadCharsSync: !0
                }), this.setScrollMode(this.config.scrollMode, {
                    preventReadCharsSync: !0
                }), this.setTheme(this.config.theme, {
                    preventReadCharsSync: !0
                }), this.setHorizontalView("classic", {
                    preventReadCharsSync: !0
                }), this.setInstantFullscreen(this.config.instantFullscreen, {
                    preventReadCharsSync: !0
                }), this.setWritingMode(m, {
                    preventReadCharsSync: !0,
                    preventStoreConfig: !0
                }), this.updateMarker(), this.updateScrollers(!1), this.updateFullscreenState(), 
                this.$root.removeClass("novel-loading");
            }
            var f, g;
            return b.prototype.root = null, b.prototype.rawBody = "", b.prototype.page = 0, 
            b.prototype.pagesize = 0, b.prototype.pages = [], b.prototype.config = {
                writingMode: "horizontal",
                font: "sans-serif",
                size: "medium",
                line: "normal",
                scrollMode: "scroll",
                theme: "white",
                horizontalView: "classic",
                instantFullscreen: !0,
                preventHashChange: !1
            }, b.prototype.clickCounter = {}, b.prototype.id = 0, b.prototype.marker = null, 
            b.prototype.markers = null, b.prototype.chapters = [], b.prototype.readChars = 0, 
            b.prototype.fullscreen = !1, b.prototype.dragging = !1, b.prototype.sentEvent = {
                enableFullscreen: !1
            }, f = function(a) {
                var b, c, d, e;
                return 1 !== a.length ? null : (b = /^[\u0000-\u00a6\u00a8\u00aa-\u00ad\u00af-\u00b0\u00b2-\u00bb\u00bf-\u00d6\u00d8-\u00f6\u00f8-\u02e9\u02ec-\u10ff\u1200-\u1400\u1680-\u18af\u1900-\u1c7f\u1cc0-\u2015\u2017-\u201f\u2022-\u202f\u2032-\u203a\u203d-\u2041\u2043-\u2046\u204a-\u2050\u2052-\u2064\u2066-\u20dc\u20e1\u20e5-\u20ff\u2102\u210a-\u210e\u2110-\u2112\u2115\u2118-\u211d\u2124\u2126\u2128\u212a-\u212d\u212f-\u2134\u2140-\u2144\u214b\u214e\u2190-\u221d\u221f-\u2233\u2236-\u22ff\u2308-\u230b\u2320-\u2323\u232c-\u237c\u239b-\u23bd\u23ce\u23d0\u23dc-\u23e1\u2423\u2500-\u259f\u261a-\u261f\u2768-\u2775\u2794-\u2b11\u2b30-\u2b4f\u2b5a-\u2bb7\u2c00-\u2e7f\ua4d0-\ua95f\ua980-\uabff\ud800-\udfff\ufb00-\ufe0f\ufe20-\ufe2f\ufe49-\ufe4f\ufe58\ufe63-\ufe66\ufe70-\uff00\uff0d\uff1c-\uff1e\uff61-\uffdf\uffe8-\uffef\ufff9-\ufffb\ufffe\uffff]$/, 
                c = /^[\u2329-\u232a\u3008-\u3011\u3014-\u301f\u3030\u30a0\u30fc\ufe59-\ufe5e\uff08-\uff09\uff1a-\uff1b\uff3b\uff3d\uff3f\uff5b-\uff60\uffe3]$/, 
                e = /^[\u00a7\u00a9\u00ae\u00b1\u00bc-\u00be\u00d7\u00f7\u02ea-\u02eb\u1100-\u11ff\u1401-\u167f\u18b0-\u18ff\u2016\u2020-\u2021\u2030-\u2031\u203b-\u203c\u2042\u2047-\u2049\u2051\u2065\u20dd-\u20e0\u20e2-\u20e4\u2100-\u2101\u2103-\u2109\u210f\u2113-\u2114\u2116-\u2117\u211e-\u2123\u2125\u2127\u2129\u212e\u2135-\u213f\u2145-\u214a\u214c-\u214d\u214f-\u218f\u221e\u2234-\u2235\u2300-\u2307\u230c-\u231f\u2324-\u2328\u232b\u237d-\u239a\u23be-\u23cd\u23cf\u23d1-\u23db\u23e2-\u2422\u2424-\u24ff\u25a0-\u2619\u2620-\u2767\u2776-\u2793\u2b12-\u2b2f\u2b50-\u2b59\u2bb8-\u2bff\u2e80-\u3000\u3003-\u3007\u3012-\u3013\u3020-\u302f\u3031-\u3040\u3042\u3044\u3046\u3048\u304a-\u3062\u3064-\u3082\u3084\u3086\u3088-\u308d\u308f-\u3094\u3097-\u309a\u309d-\u309f\u30a2\u30a4\u30a6\u30a8\u30aa-\u30c2\u30c4-\u30e2\u30e4\u30e6\u30e8-\u30ed\u30ef-\u30f4\u30f7-\u30fb\u30fd-\u3126\u3128-\u31ef\u3200-\u32ff\u3358-\u337a\u3380-\ua4cf\ua960-\ua97f\uac00-\ud7ff\ue000-\ufaff\ufe10-\ufe1f\ufe30-\ufe48\ufe53-\ufe57\ufe5f-\ufe62\ufe67-\ufe6f\uff02-\uff07\uff0a-\uff0b\uff0f-\uff19\uff20-\uff3a\uff3c\uff3e\uff40-\uff5a\uffe0-\uffe2\uffe4-\uffe7\ufff0-\ufff8\ufffc-\ufffd]$/, 
                d = /^[\u3001-\u3002\u3041\u3043\u3045\u3047\u3049\u3063\u3083\u3085\u3087\u308e\u3095-\u3096\u309b-\u309c\u30a1\u30a3\u30a5\u30a7\u30a9\u30c3\u30e3\u30e5\u30e7\u30ee\u30f5-\u30f6\u3127\u31f0-\u31ff\u3300-\u3357\u337b-\u337f\ufe50-\ufe52\uff01\uff0c\uff0e\uff1f]$/, 
                a.match(b) ? "R" : a.match(c) ? "Tr" : a.match(e) ? "U" : a.match(d) ? "Tu" : null);
            }, g = function(a) {
                switch (f(a)) {
                  case "R":
                  case "Tr":
                    return !0;

                  default:
                    return !1;
                }
            }, b.prototype.parse = function() {
                var b;
                return typeof this.rawBody !== !1 && "" !== this.rawBody && (b = this.rawBody, b.split("[newpage]").forEach(function(d) {
                    return function(f, g) {
                        var h, i, j, k;
                        return h = e("<div/>", {
                            class: "novel-page",
                            id: "page-" + (g + 1)
                        }), j = 0, k = !1, i = [], f.replace(/\r\n?/g, "\n").split("\n").forEach(function(f) {
                            var h, l, m, n;
                            return "" === f ? void i.push(e("<br>")) : (l = new window.PixivNovelParser.Parser(), 
                            l.parse(f), m = function(b) {
                                var f;
                                return f = [], b.forEach(function(b) {
                                    var h, i, l, n, o, p, q, r;
                                    return "text" === b.type ? f.push(e(document.createTextNode(b.val))) : "rb" === b.name ? f.push(e("<ruby/>").append([ e("<rb/>", {
                                        text: b.rubyBase
                                    }), e("<rt/>", {
                                        text: b.rubyText
                                    }) ])) : "chapter" === b.name ? (h = e("<h4/>", {
                                        class: "chapter",
                                        id: "chapter_" + g + "_" + j
                                    }).append(m(b.title)), d.chapters.push({
                                        title: h.text(),
                                        page: g,
                                        chapter: j
                                    }), f.push(h), j++) : "pixivimage" === b.name ? (p = null === b.pageNumber ? b.illustID : b.illustID + "-" + b.pageNumber, 
                                    k ? n = e("<span/>", {
                                        class: "error",
                                        text: a.t("【エラー: 1ページ内に挿入できる挿絵タグは1つまでです】")
                                    }) : (n = e("<span/>", {
                                        class: "novelimage novelimage-" + p,
                                        data: {
                                            illust_id: p
                                        }
                                    }).append(e("<a/>", {
                                        href: "/member_illust.php?mode=medium&illust_id=" + p,
                                        target: "_blank"
                                    }).append(e("<img/>", {
                                        src: "http://source.pixiv.net/source/pixpedia/images/noimage300.gif"
                                    }))), k = !0, d.$pixivimages = d.$pixivimages.add(n), e.inArray(p, d.illustIds) === -1 && d.illustIds.push(p)), 
                                    f.push(n)) : "jump" === b.name ? (q = parseInt(b.pageNumber, 10), i = isNaN(q) || q <= 0 ? e("<span/>", {
                                        class: "error",
                                        text: a.t("【エラー: 小説内リンクに指定できないページです】")
                                    }) : e("<a/>", {
                                        class: "novel-jump",
                                        href: "#" + q,
                                        text: a.t("$1ページへ", q),
                                        data: {
                                            target: q
                                        }
                                    }), f.push(i)) : "jumpuri" === b.name ? (o = m(b.title), r = o.map(function(a) {
                                        return a.text();
                                    }).join(""), "" !== r && "" !== b.uri && c.isUri(b.uri) ? (l = c.isPixivUri(b.uri) ? e("<a/>", {
                                        href: b.uri
                                    }).append(o) : e("<a/>", {
                                        href: "/jump.php?" + encodeURIComponent(b.uri),
                                        target: "_brank"
                                    }).append(o), f.push(l)) : void f.push(e(document.createTextNode(r)))) : f.push(e(document.createTextNode(b.val)));
                                }), f;
                            }, h = e("<p/>").append(m(l.tree)), n = h.getTextNodes(), n.each(function(a) {
                                var c, d;
                                if (!e(this).parent().hasClass("vtoken")) return b = e(this).get(0).nodeValue, c = [], 
                                d = b.split(/([“„〝"].+?[”“〟〞"])/), d.length > 1 ? (d.forEach(function(a, b) {
                                    var d, f;
                                    return b % 2 === 1 ? (f = a.slice(1, -1), d = (f.match(/[\x00-\x7F]/g) || []).length, 
                                    d / f.length > .5 ? c.push(e("<span/>", {
                                        text: a.slice(0, 1),
                                        class: "vtoken",
                                        data: {
                                            vertical: "“",
                                            horizontal: a.slice(0, 1)
                                        }
                                    }), document.createTextNode(f), e("<span/>", {
                                        text: a.slice(-1),
                                        class: "vtoken",
                                        data: {
                                            vertical: "”",
                                            horizontal: a.slice(-1)
                                        }
                                    })) : c.push(e("<span/>", {
                                        text: a.slice(0, 1),
                                        class: "vtoken",
                                        data: {
                                            vertical: "〝",
                                            horizontal: a.slice(0, 1)
                                        }
                                    }), document.createTextNode(f), e("<span/>", {
                                        text: a.slice(-1),
                                        class: "vtoken",
                                        data: {
                                            vertical: "〟",
                                            horizontal: a.slice(-1)
                                        }
                                    }))) : c.push(document.createTextNode(a));
                                }), e(this).replaceWith(c)) : void 0;
                            }), n = h.getTextNodes(), n.each(function(a) {
                                var c, d;
                                if (!e(this).parent().hasClass("vtoken")) return b = e(this).get(0).nodeValue, c = [], 
                                d = b.split(/([`‘‚｀‵].+?[`’｀′])/), d.length > 1 ? (d.forEach(function(a, b) {
                                    var d, f;
                                    return b % 2 === 1 ? (f = a.slice(1, -1), d = (f.match(/[\x00-\x7F]/g) || []).length, 
                                    d / f.length > .5 ? c.push(e("<span/>", {
                                        text: a.slice(0, 1),
                                        class: "vtoken",
                                        data: {
                                            vertical: "‘",
                                            horizontal: a.slice(0, 1)
                                        }
                                    }), document.createTextNode(f), e("<span/>", {
                                        text: a.slice(-1),
                                        class: "vtoken",
                                        data: {
                                            vertical: "’",
                                            horizontal: a.slice(-1)
                                        }
                                    })) : c.push(e("<span/>", {
                                        text: a.slice(0, 1),
                                        class: "vtoken",
                                        data: {
                                            vertical: "‵",
                                            horizontal: a.slice(0, 1)
                                        }
                                    }), document.createTextNode(f), e("<span/>", {
                                        text: a.slice(-1),
                                        class: "vtoken invert",
                                        data: {
                                            vertical: "′",
                                            horizontal: a.slice(-1)
                                        }
                                    }))) : c.push(document.createTextNode(a));
                                }), e(this).replaceWith(c)) : void 0;
                            }), h.getTextNodes().each(function() {
                                var a, c;
                                if (!e(this).parent().hasClass("vtoken")) return b = e(this).get(0).nodeValue, a = [], 
                                c = b.split(/([\d０-９]+)/), c.length > 1 ? (c.forEach(function(b) {
                                    return function(d, f) {
                                        var g, h, i;
                                        return f % 2 === 1 ? (i = function(a) {
                                            return d.replace(/[\d０-９]/g, function(a) {
                                                return {
                                                    "0": "０",
                                                    "1": "１",
                                                    "2": "２",
                                                    "3": "３",
                                                    "4": "４",
                                                    "5": "５",
                                                    "6": "６",
                                                    "7": "７",
                                                    "8": "８",
                                                    "9": "９",
                                                    "０": "０",
                                                    "１": "１",
                                                    "２": "２",
                                                    "３": "３",
                                                    "４": "４",
                                                    "５": "５",
                                                    "６": "６",
                                                    "７": "７",
                                                    "８": "８",
                                                    "９": "９"
                                                }[a];
                                            });
                                        }, h = function(a) {
                                            return d.replace(/[\d０-９]/g, function(a) {
                                                return {
                                                    "0": "0",
                                                    "1": "1",
                                                    "2": "2",
                                                    "3": "3",
                                                    "4": "4",
                                                    "5": "5",
                                                    "6": "6",
                                                    "7": "7",
                                                    "8": "8",
                                                    "9": "9",
                                                    "０": "0",
                                                    "１": "1",
                                                    "２": "2",
                                                    "３": "3",
                                                    "４": "4",
                                                    "５": "5",
                                                    "６": "6",
                                                    "７": "7",
                                                    "８": "8",
                                                    "９": "9"
                                                }[a];
                                            });
                                        }, g = c[f - 1] ? c[f - 1].slice(-1) : e(b).prev().text() ? (e(b).prev().data("vertical") || e(b).prev().text()).slice(-1) : "", 
                                        g.match(/[\x00-\x7F]/) ? a.push(e("<span/>", {
                                            text: d,
                                            class: "vtoken",
                                            data: {
                                                vertical: h(d),
                                                horizontal: d
                                            }
                                        })) : 2 === d.length || 3 === d.length ? a.push(e("<span/>", {
                                            text: d,
                                            class: "vtoken combine",
                                            data: {
                                                vertical: h(d),
                                                horizontal: d
                                            }
                                        })) : a.push(e("<span/>", {
                                            text: d,
                                            class: "vtoken",
                                            data: {
                                                vertical: i(d),
                                                horizontal: d
                                            }
                                        }))) : a.push(document.createTextNode(d));
                                    };
                                }(this)), e(this).replaceWith(a)) : void 0;
                            }), h.getTextNodes().each(function() {
                                var a, c;
                                if (!e(this).parent().hasClass("vtoken")) return b = e(this).get(0).nodeValue, a = [], 
                                c = b.split(/([｢｣､｡￩￪￫￬･])/), c.length > 1 ? (c.forEach(function(b, c) {
                                    return c % 2 === 1 ? a.push(e("<span/>", {
                                        text: b,
                                        class: "vtoken",
                                        data: {
                                            vertical: {
                                                "｢": "「",
                                                "｣": "」",
                                                "､": "、",
                                                "｡": "。",
                                                "￩": "←",
                                                "￪": "↑",
                                                "￫": "→",
                                                "￬": "↓",
                                                "･": "・"
                                            }[b],
                                            horizontal: b
                                        }
                                    })) : a.push(document.createTextNode(b));
                                }), e(this).replaceWith(a)) : void 0;
                            }), n = h.getTextNodes(), n.each(function(a) {
                                var c, d;
                                if (!e(this).parent().hasClass("vtoken")) return b = e(this).get(0).nodeValue, c = [], 
                                d = b.split(/([—―])/), d.length > 1 ? (d.forEach(function(a) {
                                    return function(a, b) {
                                        return b % 2 === 1 ? c.push(e("<span/>", {
                                            text: a,
                                            class: "vtoken",
                                            data: {
                                                vertical: "─",
                                                horizontal: a
                                            }
                                        })) : c.push(document.createTextNode(a));
                                    };
                                }(this)), e(this).replaceWith(c)) : void 0;
                            }), n = h.getTextNodes(), n.each(function(a) {
                                var c, d;
                                if (!e(this).parent().hasClass("vtoken")) return b = e(this).get(0).nodeValue, c = [], 
                                d = b.split(/([,.，．])/), d.length > 1 ? (d.forEach(function(a) {
                                    return function(b, f) {
                                        var g, h;
                                        return f % 2 === 1 ? (g = d[f - 1] ? d[f - 1].slice(-1) : e(a).prev().text() ? (e(a).prev().data("vertical") || e(a).prev().text()).slice(-1) : "", 
                                        h = "" === g || g.match(/[\x00-\x7F]/) ? b.replace(/[，．]/g, function(a) {
                                            return {
                                                "，": ",",
                                                "．": "."
                                            }[a];
                                        }) : b.replace(/[,.]/g, function(a) {
                                            return {
                                                ",": "，",
                                                ".": "．"
                                            }[a];
                                        }), c.push(e("<span/>", {
                                            text: b,
                                            class: "vtoken",
                                            data: {
                                                vertical: h,
                                                horizontal: b
                                            }
                                        }))) : c.push(document.createTextNode(b));
                                    };
                                }(this)), e(this).replaceWith(c)) : void 0;
                            }), n = h.getTextNodes(), n.each(function(a) {
                                var c, d;
                                if (!e(this).parent().hasClass("vtoken")) return b = e(this).get(0).nodeValue, c = [], 
                                d = b.split(/([!?！？]+)/), d.length > 1 ? (d.forEach(function(a) {
                                    return function(b, f) {
                                        var g, h, i, j, k;
                                        return f % 2 === 1 ? (h = d[f - 1] ? d[f - 1].slice(-1) : e(a).prev().text() ? (e(a).prev().data("vertical") || e(a).prev().text()).slice(-1) : "", 
                                        g = d[f + 1] ? d[f + 1].slice(0, 1) : e(a).next().text() ? (e(a).next().data("vertical") || e(a).next().text()).slice(0, 1) : "", 
                                        h.match(/[\x00-\x7F]/) ? (k = b.replace(/[！？]/g, function(a) {
                                            return {
                                                "！": "!",
                                                "？": "?"
                                            }[a];
                                        }), c.push(e("<span/>", {
                                            text: b,
                                            class: "vtoken",
                                            data: {
                                                vertical: k,
                                                horizontal: b
                                            }
                                        }))) : (i = [ "vtoken" ], 2 === b.length || 3 === b.length ? (k = b.replace(/[！？]/g, function(a) {
                                            return {
                                                "！": "!",
                                                "？": "?"
                                            }[a];
                                        }), i.push("combine")) : k = b.replace(/[!?]/g, function(a) {
                                            return {
                                                "!": "！",
                                                "?": "？"
                                            }[a];
                                        }), j = /^[\u0029\u005d\u007d\u0f3b\u0f3d\u169c\u2046\u207e\u208e\u2309\u230b\u232a\u2769\u276b\u276d\u276f\u2771\u2773\u2775\u27c6\u27e7\u27e9\u27eb\u27ed\u27ef\u2984\u2986\u2988\u298a\u298c\u298e\u2990\u2992\u2994\u2996\u2998\u29d9\u29db\u29fd\u2e23\u2e25\u2e27\u2e29\u3009\u300b\u300d\u300f\u3011\u3015\u3017\u3019\u301b\u301e\u301f\ufd3e\ufe18\ufe36\ufe38\ufe3a\ufe3c\ufe3e\ufe40\ufe42\ufe44\ufe48\ufe5a\ufe5c\ufe5e\uff09\uff3d\uff5d\uff60\uff63]$/, 
                                        "" === g || "　" === g || g.match(j) || i.push("margin-after"), c.push(e("<span/>", {
                                            text: b,
                                            class: i.join(" "),
                                            data: {
                                                vertical: k,
                                                horizontal: b
                                            }
                                        })))) : c.push(document.createTextNode(b));
                                    };
                                }(this)), e(this).replaceWith(c)) : void 0;
                            }), h.getTextNodes().each(function() {
                                var a, c, d;
                                if (!e(this).parent().hasClass("vtoken")) return b = e(this).get(0).nodeValue, c = [], 
                                d = b.split(/([A-Za-zＡ-Ｚａ-ｚ]+)/), d.length > 1 && (a = [], a.push(d[0]), d.forEach(function(b) {
                                    return function(b, c) {
                                        var e;
                                        if (c % 2 === 1) return e = d[c + 1], 2 === b.length ? a.push(b, e) : a[a.length - 1] += b + e;
                                    };
                                }(this)), a.length > 1) ? (a.forEach(function(a) {
                                    return function(b, f) {
                                        var g, h, i;
                                        return f % 2 === 1 ? (h = d[f - 1] ? d[f - 1].slice(-1) : e(a).prev().text() ? (e(a).prev().data("vertical") || e(a).prev().text()).slice(-1) : "", 
                                        g = d[f + 1] ? d[f + 1].slice(0, 1) : e(a).next().text() ? (e(a).next().data("vertical") || e(a).next().text()).slice(0, 1) : "", 
                                        i = function(a) {
                                            return a.replace(/[Ａ-Ｚａ-ｚ]/g, function(a) {
                                                return String.fromCharCode(a.charCodeAt(0) - 65248);
                                            });
                                        }, h.match(/[\x00-\x2F\x3A-\x7F]/) || g.match(/[\x00-\x2F\x3A-\x7F]/) ? c.push(document.createTextNode(b)) : c.push(e("<span/>", {
                                            text: b,
                                            class: "vtoken combine",
                                            data: {
                                                vertical: i(b),
                                                horizontal: b
                                            }
                                        }))) : c.push(document.createTextNode(b));
                                    };
                                }(this)), e(this).replaceWith(c)) : void 0;
                            }), h.getTextNodes().each(function() {
                                var a, c;
                                if (!e(this).parent().hasClass("vtoken")) return b = e(this).get(0).nodeValue, a = [], 
                                c = b.split(/([A-Z]+)/), c.length > 1 ? (c.forEach(function(b) {
                                    return function(d, f) {
                                        var g, h, i;
                                        return f % 2 === 1 ? (h = c[f - 1] ? c[f - 1].slice(-1) : e(b).prev().text() ? (e(b).prev().data("vertical") || e(b).prev().text()).slice(-1) : "", 
                                        g = c[f + 1] ? c[f + 1].slice(0, 1) : e(b).next().text() ? (e(b).next().data("vertical") || e(b).next().text()).slice(0, 1) : "", 
                                        i = function(a) {
                                            return a.replace(/[A-Z]/g, function(a) {
                                                return String.fromCharCode(a.charCodeAt(0) + 65248);
                                            });
                                        }, h.match(/[\x00-\x7F’]/) || g.match(/[\x00-\x7F’]/) ? a.push(document.createTextNode(d)) : a.push(e("<span/>", {
                                            text: d,
                                            class: "vtoken",
                                            data: {
                                                vertical: i(d),
                                                horizontal: d
                                            }
                                        }))) : a.push(document.createTextNode(d));
                                    };
                                }(this)), e(this).replaceWith(a)) : void 0;
                            }), n = h.getTextNodes(), n.each(function(a) {
                                var c, d;
                                if (!e(this).parent().hasClass("vtoken")) return b = e(this).get(0).nodeValue, c = [], 
                                d = b.split(/(.[゛ﾞ゜ﾟ])/), d.length > 1 ? (d.forEach(function(a) {
                                    return function(a, b) {
                                        var d, f, g;
                                        return b % 2 === 1 ? (d = a[0], f = a[1], g = {
                                            "゛": "゛",
                                            "ﾞ": "゛",
                                            "゜": "゜",
                                            "ﾟ": "゜"
                                        }[f] + d, c.push(e("<span/>", {
                                            text: a,
                                            class: "vtoken",
                                            data: {
                                                vertical: g,
                                                horizontal: a
                                            }
                                        }))) : c.push(document.createTextNode(a));
                                    };
                                }(this)), e(this).replaceWith(c)) : void 0;
                            }), h.is(":empty") ? void 0 : i.push(h));
                        }), h.append(i), h.hide(), g > 0 && d.$text.before(e("<hr>", {
                            class: "novel-page-split",
                            "data-page": g + 1
                        })), d.$text.before(h);
                    };
                }(this)), this.$text.remove(), this.$textWrapper.css("display", "inline-block"), 
                this.$pages = this.$textWrapper.find(".novel-page"), this.pagesize = this.$pages.length, 
                this.$root.find("span.novel-jump").each(function(b) {
                    var c;
                    if (c = parseInt(b.data("target")), isNaN(c) || c <= 0 || this.pagesize < c) return b.replaceWith(e("<span/>", {
                        class: "error",
                        text: a.t("【エラー: 小説内リンクに指定できないページです】")
                    }));
                }));
            }, b.prototype.loadIllusts = function() {
                return c.api.post("/novel/rpc_novel_illust.php", {
                    illust_ids: encodeURIComponent(this.illustIds.join(",")),
                    mtime: c.context.updated || parseInt(new Date() / 1e3),
                    content_id: this.meta.workId,
                    x_restrict: this.meta.explicit,
                    restrict: this.meta.permission,
                    user_id: this.meta.userId,
                    verbosity: "",
                    is_whitecube: null
                }).done(this.onIllustLoad);
            }, b.prototype.onIllustLoad = function(a) {
                if (a && e.isArray(a)) return a.forEach(function(a) {
                    return function(b) {
                        var c;
                        return c = a.$pixivimages.filter(function() {
                            return e(this).data("illust_id") === b.id;
                        }), c.replaceWith(b.html);
                    };
                }(this));
            }, b.prototype.updateChapters = function() {
                if (this.chapters.forEach(function(a) {
                    return function(b) {
                        return a.$chapterList.find(".novel-outline").append(e("<li/>").append([ e("<a/>", {
                            href: "#chapter_" + b.page + "_" + b.chapter,
                            text: b.title
                        }), e("<em/>", {
                            text: b.page + 1
                        }) ]));
                    };
                }(this)), this.chapters.length > 0) return this.$chapterList.show();
            }, b.prototype.bind = function() {
                return this.$root.click(function(a) {
                    return function(b) {
                        return a.onClick(b.target);
                    };
                }(this)), e(window).on("hashchange.novel", function(a) {
                    return function(b) {
                        return a.onHashChange(b);
                    };
                }(this)), e(window).on("scroll.novel", function(a) {
                    return function() {
                        return a.updateScrollFollwer();
                    };
                }(this)), this.$pagerPrev.click(function(a) {
                    return function() {
                        return a.countUpClick("pager"), a.pagePrev();
                    };
                }(this)), this.$pagerNext.click(function(a) {
                    return function() {
                        return a.countUpClick("pager"), a.pageNext();
                    };
                }(this)), this.$quitFullscreenButton.click(function(a) {
                    return function() {
                        return a.disableFullscreen();
                    };
                }(this)), this.$writingModeController.click(function(a) {
                    return function() {
                        return a.countUpClick("writingMode"), e(".vertical-new").hide(), a.toggleWritingMode();
                    };
                }(this)), this.$fontController.click(function(a) {
                    return function() {
                        return a.countUpClick("font"), a.toggleFont();
                    };
                }(this)), this.$sizeChoices.click(function(a) {
                    return function(b) {
                        return a.countUpClick("size"), a.setSize(e(b.target).data("size"));
                    };
                }(this)), this.$lineChoices.click(function(a) {
                    return function(b) {
                        return a.countUpClick("line"), a.setLine(e(b.target).data("line"));
                    };
                }(this)), this.$scrollModeChoices.click(function(a) {
                    return function(b) {
                        return a.countUpClick("scrollMode"), a.setScrollMode(e(b.target).data("scroll-mode"));
                    };
                }(this)), this.$themeChoices.click(function(a) {
                    return function(b) {
                        return a.countUpClick("theme"), a.setTheme(e(b.target).data("theme"));
                    };
                }(this)), this.$markerController.click(function(a) {
                    return function() {
                        return a.toggleMarkerTooltip();
                    };
                }(this)), this.$insertMarkerButton.click(function(a) {
                    return function() {
                        return a.setMarker(a.page);
                    };
                }(this)), this.$destroyMarkerButton.click(function(a) {
                    return function() {
                        return a.destroyMarker();
                    };
                }(this)), this.$followMarkerButton.click(function(a) {
                    return function() {
                        return a.pageTo(a.marker);
                    };
                }(this)), this.$configController.click(function(a) {
                    return function() {
                        return a.toggleConfigTooltip();
                    };
                }(this)), this.$bodyMarker.click(function(a) {
                    return function() {
                        return a.$bodyMarker.hasClass("active") ? a.destroyMarker() : a.setMarker(a.page);
                    };
                }(this)), this.$scrollerPrev.click(function(a) {
                    return function() {
                        return a.countUpClick("scroller"), a.$scrollerPrev.hasClass("pager-mode") ? a.pagePrev({
                            scrollToBottom: !0
                        }) : a.pageUp();
                    };
                }(this)), this.$scrollerNext.click(function(a) {
                    return function(b) {
                        return a.countUpClick("scroller"), a.$scrollerNext.hasClass("pager-mode") ? a.pageNext() : a.pageDown();
                    };
                }(this)), this.$pages.scroll(function(a) {
                    return function() {
                        return a.updateScrollers(!0);
                    };
                }(this)), this.$enableFullscreenButton.click(function(a) {
                    return function() {
                        if (a.fullscreen === !1) return a.countUpClick("fullscreen"), a.enableFullscreen();
                    };
                }(this)), this.$textWrapper.scroll(function(a) {
                    return function(b) {
                        if (a.fullscreen === !0) return a.onFullscreenScroll(b);
                    };
                }(this)), this.$body.scroll(function(a) {
                    return function(b) {
                        if (a.fullscreen === !0) return a.onFullscreenScroll(b);
                    };
                }(this)), e(window).on("unload.novel", function(b) {
                    return function() {
                        return a.storage.localStorage("novel_click_counter", b.clickCounter);
                    };
                }(this)), e(window).on("popstate.novel", function(a) {
                    return function(b) {
                        return a.updateFullscreenState();
                    };
                }(this)), e(window).on("resize.novel", function(a) {
                    return function() {
                        return a.updateScrollFollwer();
                    };
                }(this));
            }, b.prototype.onClick = function(a) {
                var b;
                if (b = function(b) {
                    return b.get(0) === a || 0 !== b.has(a).length;
                }, b(this.$markerTooltip) || b(this.$markerController) || this.hideMarkerTooltip(), 
                !b(this.$configTooltip) && !b(this.$configController)) return this.hideConfigTooltip();
            }, b.prototype.onHashChange = function(a) {
                var b;
                if (b = this.getHash(), null !== b) return "object" == typeof b && this.chapterTo(b[0], b[1], {
                    preventHashChange: !0
                }), "number" == typeof b && this.page !== b ? this.pageTo(b, {
                    preventHashChange: !0
                }) : void 0;
            }, b.prototype.onKeypress = function(a) {
                var b;
                switch (a) {
                  case "up":
                    return "vertical" !== this.config.writingMode || (b = this.$pages.get(this.page).getBoundingClientRect(), 
                    !(b.bottom >= 0 && b.bottom < e(window).height() && b.top >= 0 && b.top < e(window).height()) || (this.pagePrev(), 
                    !1));

                  case "down":
                    return "vertical" !== this.config.writingMode || (b = this.$pages.get(this.page).getBoundingClientRect(), 
                    !(b.bottom >= 0 && b.bottom < e(window).height() && b.top >= 0 && b.top < e(window).height()) || (this.pageNext(), 
                    !1));

                  case "left":
                    return "horizontal" === this.config.writingMode ? this.pagePrev() : (this.countUpClick("scroller"), 
                    "scroll" === this.config.scrollMode ? this.fullscreen === !1 ? this.$pages.eq(this.page).getNiceScroll(0).doScrollLeftBy(120) : this.$textWrapper.getNiceScroll(0).doScrollLeftBy(120) : this.pageDown()), 
                    !1;

                  case "right":
                    return "horizontal" === this.config.writingMode ? this.pageNext() : (this.countUpClick("scroller"), 
                    "scroll" === this.config.scrollMode ? this.fullscreen === !1 ? this.$pages.eq(this.page).getNiceScroll(0).doScrollLeftBy(-120) : this.$textWrapper.getNiceScroll(0).doScrollLeftBy(-120) : this.pageUp()), 
                    !1;

                  case "space":
                    return "vertical" !== this.config.writingMode && this.fullscreen !== !1 || (e(window).scrollTop() < this.$root.offset().top ? e(window).scrollTop(this.$root.offset().top) : (this.countUpClick("scroller"), 
                    this.pageDown()), !1);

                  case "pageup":
                    return "vertical" !== this.config.writingMode || (this.countUpClick("scroller"), 
                    this.pageUp(), !1);

                  case "pagedown":
                    return "vertical" !== this.config.writingMode && this.fullscreen !== !1 || (e(window).scrollTop() < this.$root.offset().top ? e(window).scrollTop(this.$root.offset().top) : (this.countUpClick("scroller"), 
                    this.pageDown()), !1);

                  case "escape":
                    return this.fullscreen !== !0 || (this.disableFullscreen(), !1);

                  case "v":
                    return this.toggleFullscreen(), !1;
                }
            }, b.prototype.toggleMarkerTooltip = function() {
                return this.$markerController.hasClass("active") ? this.hideMarkerTooltip() : this.showMarkerTooltip();
            }, b.prototype.showMarkerTooltip = function() {
                return null === this.markers && this.loadMarkers(), this.$markerController.addClass("active"), 
                this.$markerTooltip.show();
            }, b.prototype.hideMarkerTooltip = function() {
                return this.$markerController.removeClass("active"), this.$markerTooltip.hide();
            }, b.prototype.toggleConfigTooltip = function() {
                return this.$configController.hasClass("active") ? this.hideConfigTooltip() : this.showConfigTooltip();
            }, b.prototype.showConfigTooltip = function() {
                return this.$configController.addClass("active"), this.$configTooltip.show();
            }, b.prototype.hideConfigTooltip = function() {
                return this.$configController.removeClass("active"), this.$configTooltip.hide();
            }, b.prototype.toggleFullscreen = function() {
                return this.fullscreen ? this.disableFullscreen() : this.enableFullscreen();
            }, b.prototype.enableFullscreen = function(b) {
                var c, d;
                if (null == b && (b = {}), this.sentEvent.enableFullscreen === !1 && (this.sentEvent.enableFullscreen = !0, 
                a.ga.trackEvent([ "novel", "enable_fullscreen", this.config.theme ])), this.fullscreen === !1) return b.preventPushState || null == (null != (c = window.history) ? c.state : void 0) ? (this.updateReadChars(), 
                this.fullscreen = !0, e('meta[name="viewport"]').attr("content", "width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"), 
                e("<div/>", {
                    class: "novel-fade-screen"
                }).appendTo("body").css({
                    opacity: 0,
                    backgroundColor: this.$body.css("background-color")
                }).animate({
                    opacity: 1
                }, 200, function(c) {
                    return function() {
                        var d, f;
                        return e("html").addClass("_no-scroll"), c.$root.addClass("novel-fullscreen"), b.preventPushState || (f = a.query.replace({
                            fullscreen: "on"
                        }, !1, !0), null != (d = window.history) && d.pushState("", "", f)), c.updateScrollFollwer(), 
                        e(window).resize(c.onResizeInFullscreen).resize(), c.loadReadChars(), setTimeout(function() {
                            return c.$textWrapper.getNiceScroll().each(function() {
                                return this.onResize();
                            }), c.$pages.getNiceScroll().each(function() {
                                return this.onResize();
                            });
                        }, 200), e(".novel-fade-screen").animate({
                            opacity: 0
                        }, function() {
                            return e(this).remove();
                        }), c.$textWrapper.getNiceScroll().each(function() {
                            return this.wheelprevented = !1;
                        });
                    };
                }(this))) : null != (d = window.history) && "function" == typeof d.back ? d.back() : void 0;
            }, b.prototype.disableFullscreen = function(b) {
                var c, d;
                if (null == b && (b = {}), this.fullscreen === !0) return b.preventPushState || null == (null != (c = window.history) ? c.state : void 0) ? (this.updateReadChars(), 
                this.fullscreen = !1, e('meta[name="viewport"]').attr("content", "width=1080"), 
                e("<div/>", {
                    class: "novel-fade-screen"
                }).appendTo("body").css({
                    opacity: 1080,
                    backgroundColor: this.$body.css("background-color")
                }).animate({
                    opacity: 1
                }, 200, function(c) {
                    return function() {
                        var d, f;
                        return e("html").removeClass("_no-scroll"), c.$root.removeClass("novel-fullscreen"), 
                        b.preventPushState || (f = a.query.replace({
                            fullscreen: null
                        }, !1, !0), null != (d = window.history) && d.pushState("", "", f)), c.updateScrollFollwer(), 
                        c.$body.height("auto"), e(window).unbind("resize", c.onResizeInFullscreen), c.loadReadChars(), 
                        e(".novel-fade-screen").animate({
                            opacity: 0
                        }, function() {
                            return e(this).remove();
                        }), c.$textWrapper.getNiceScroll().each(function() {
                            return this.wheelprevented = !0;
                        });
                    };
                }(this))) : null != (d = window.history) && "function" == typeof d.back ? d.back() : void 0;
            }, b.prototype.onResizeInFullscreen = function() {
                return this.$body.height(e(window).height() - this.$body.position().top);
            }, b.prototype.onFullscreenScroll = function() {
                var a;
                if (!this.$root.hasClass("novel-loading")) return a = 0, this.$pages.each(function(b) {
                    return function(c, d) {
                        var f, g;
                        if ("horizontal" === b.config.writingMode) {
                            if ((null != (f = e(d).get(0).getClientRects()[0]) ? f.bottom : void 0) < e(window).height() / 2) return a = c + 1;
                        } else if ((null != (g = e(d).get(0).getClientRects()[0]) ? g.left : void 0) > e(window).width() / 2) return a = c + 1;
                    };
                }(this)), a = Math.max(0, Math.min(a, this.pagesize - 1)), a !== this.page && this.pageTo(a, {
                    preventNavigation: !0
                }), this.updateScrollers(!1);
            }, b.prototype.updateFullscreenState = function() {
                var b;
                return b = "on" === a.query.parse().fullscreen, b === !0 ? this.enableFullscreen({
                    preventPushState: !0
                }) : this.disableFullscreen({
                    preventPushState: !0
                });
            }, b.prototype.pagePrev = function(a) {
                return this.pageTo(Math.max(0, this.page - 1), a);
            }, b.prototype.pageNext = function(a) {
                return this.pageTo(Math.min(this.pagesize - 1, this.page + 1), a);
            }, b.prototype.pageTo = function(a, b) {
                var c, d, f, g;
                if (b = "object" == typeof b ? b : {}, this.page = a, b.preventNavigation || (this.fullscreen === !1 ? (this.$pages.hide(), 
                this.$pages.eq(a).show()) : "horizontal" === this.config.writingMode ? (0 === this.page ? g = this.$pages.eq(this.page).offset().top : (d = this.$pages.eq(this.page - 1), 
                g = d.offset().top + d.height()), this.$body.scrollTop(this.$body.scrollTop() + g - this.$body.offset().top)) : (f = 0 === this.page ? this.$pages.eq(this.page).offset().left + this.$pages.eq(this.page).width() : this.$pages.eq(this.page - 1).offset().left, 
                this.$textWrapper.scrollLeftCool(!0, this.$textWrapper.scrollLeftCool(!0) + f - this.$textWrapper.offset().left - this.$textWrapper.width()))), 
                this.$pagerPrev.css({
                    visibility: this.page <= 0 ? "hidden" : "visible"
                }), this.$pagerNext.css({
                    visibility: this.page >= this.pagesize - 1 ? "hidden" : "visible"
                }), this.$pagerPage.text(this.page + 1 + "/" + this.pagesize), this.$bodyMarker.text(this.page + 1 + "/" + this.pagesize), 
                b.preventHashChange !== !0 && window.location.replace("#" + (this.page + 1)), b.preventScroll !== !0 && (c = this.$pages.eq(this.page), 
                b.scrollToBottom === !0 ? "horizontal" === this.config.writingMode ? e(window).scrollTop(this.$root.offset().top + this.$root.height() - e(window).height()) : c.scrollLeftCool(!0, 0) : "horizontal" === this.config.writingMode ? e(window).scrollTop(this.$root.offset().top) : c.scrollLeftCool(!0, c.get(0).scrollWidth)), 
                this.updateMarker(), !b.preventNavigation) return this.updateScrollers(!1);
            }, b.prototype.chapterTo = function(a, b, c) {
                var d;
                return this.pageTo(a, {
                    preventHashChange: c.preventHashChange,
                    preventScroll: !0
                }), c.preventHashChange !== !0 ? (d = history.state, c.preventScroll === !0 ? window.location.replace("#chapter_" + a + "_" + b) : window.location.hash = "#chapter_" + a + "_" + b, 
                history.replaceState(d, "")) : c.preventScroll !== !0 ? e(window).scrollTop(e("#chapter_" + a + "_" + b).offset().top) : void 0;
            }, b.prototype.getHash = function() {
                var a, b;
                return 0 === location.hash.length ? null : (b = location.hash.match(/^#chapter_(\d+)_(\d+)$/)) ? [ parseInt(b[1], 10), parseInt(b[2], 10) ] : (a = parseInt(location.hash.substr(1), 10), 
                isNaN(a) || a > this.pagesize || a <= 0 ? null : a - 1);
            }, b.prototype.onMousewheel = function(a, b, c) {
                var d;
                return "horizontal" === this.config.writingMode || (this.countUpClick("wheel"), 
                "scroll" === this.config.scrollMode || (d = a.wheelDelta || a.deltaX || -a.deltaY, 
                d > 0 ? this.pageUp() : this.pageDown(), "function" == typeof a.preventDefault && a.preventDefault(), 
                !1));
            }, b.prototype.pageUp = function() {
                var a, b, c;
                return this.fullscreen === !1 ? (b = this.$pages.eq(this.page), a = b) : (b = this.$pages, 
                a = "vertical" === this.config.writingMode ? this.$textWrapper : this.$body), c = b.howmuchread({
                    baseline: .2,
                    borderline: "before",
                    getMetric: !0,
                    parent: a,
                    writingMode: {
                        vertical: "vertical" === this.config.writingMode,
                        horizontal: "horizontal" === this.config.writingMode,
                        ttb: !0,
                        rtl: "vertical" === this.config.writingMode
                    }
                }), null == c.top ? "vertical" === this.config.writingMode ? a.getNiceScroll(0).doScrollLeftBy(-a.width()) : a.getNiceScroll(0).doScrollBy(-$pagent.height()) : "vertical" === this.config.writingMode ? a.getNiceScroll(0).doScrollLeftBy(a.offset().left - c.left - c.blockSize) : a.getNiceScroll(0).doScrollBy(a.offset().top + a.height() - c.top - c.blockSize);
            }, b.prototype.pageDown = function() {
                var a, b, c;
                return this.fullscreen === !1 ? (b = this.$pages.eq(this.page), a = b) : (b = this.$pages, 
                a = "vertical" === this.config.writingMode ? this.$textWrapper : this.$body), c = b.howmuchread({
                    baseline: .8,
                    borderline: "after",
                    getMetric: !0,
                    parent: a,
                    writingMode: {
                        vertical: "vertical" === this.config.writingMode,
                        horizontal: "horizontal" === this.config.writingMode,
                        ttb: !0,
                        rtl: "vertical" === this.config.writingMode
                    }
                }), null == c.top ? "vertical" === this.config.writingMode ? a.getNiceScroll(0).doScrollLeftBy(a.width()) : a.getNiceScroll(0).doScrollBy($pagent.height()) : "vertical" === this.config.writingMode ? a.getNiceScroll(0).doScrollLeftBy(a.offset().left + a.width() - c.left - c.blockSize) : a.getNiceScroll(0).doScrollBy(a.offset().top - c.top);
            }, b.prototype.disableScroller = function(a) {
                var b;
                switch (a) {
                  case "prev":
                    if (b = this.$scrollerPrev.css("visibility"), "visible" === b || "inherit" === b) return this.$scrollerPrev.css({
                        visibility: "hidden"
                    });
                    break;

                  case "next":
                    if (b = this.$scrollerNext.css("visibility"), "visible" === b || "inherit" === b) return this.$scrollerNext.css({
                        visibility: "hidden"
                    });
                }
            }, b.prototype.enableScroller = function(a) {
                var b;
                switch (a) {
                  case "prev":
                    if (b = this.$scrollerPrev.css("visibility"), "hidden" === b) return this.$scrollerPrev.css({
                        visibility: "visible"
                    });
                    break;

                  case "next":
                    if (b = this.$scrollerNext.css("visibility"), "hidden" === b) return this.$scrollerNext.css({
                        visibility: "visible"
                    });
                }
            }, b.prototype.enablePagerMode = function(a, b) {
                var c, d;
                switch (a) {
                  case "prev":
                    c = this.$scrollerPrev;
                    break;

                  case "next":
                    c = this.$scrollerNext;
                    break;

                  default:
                    return;
                }
                return c.hasClass("pager-mode") ? void (b === !1 && (c.stop(), "vertical" === this.config.writingMode ? c.children(".icon").css({
                    transform: "rotate(-90deg)"
                }) : c.children(".icon").css({
                    transform: "rotate(-180deg)"
                }))) : (c.addClass("pager-mode"), d = this.config.writingMode, b ? c.css({
                    minWidth: 0
                }).animate({
                    minWidth: 1
                }, {
                    duration: 200,
                    step: function(a) {
                        return "vertical" === d ? e(this).children(".icon").css({
                            transform: "rotate(" + a * -90 + "deg)"
                        }) : e(this).children(".icon").css({
                            transform: "rotate(" + (-90 + a * -90) + "deg)"
                        }), e(this).children(".label").css({
                            opacity: a,
                            top: 10 * (1 - a)
                        });
                    }
                }) : (c.stop(), "vertical" === this.config.writingMode ? c.children(".icon").css({
                    transform: "rotate(-90deg)"
                }) : c.children(".icon").css({
                    transform: "rotate(-180deg)"
                }), c.children(".label").css({
                    opacity: 1,
                    top: 0
                })));
            }, b.prototype.disablePagerMode = function(a, b) {
                var c, d;
                switch (a) {
                  case "prev":
                    c = this.$scrollerPrev;
                    break;

                  case "next":
                    c = this.$scrollerNext;
                    break;

                  default:
                    return;
                }
                return c.hasClass("pager-mode") ? (c.removeClass("pager-mode"), d = this.config.writingMode, 
                b ? c.css({
                    minWidth: 1
                }).animate({
                    minWidth: 0
                }, {
                    duration: 200,
                    step: function(a) {
                        return "vertical" === d ? e(this).children(".icon").css({
                            transform: "rotate(" + a * -90 + "deg)"
                        }) : e(this).children(".icon").css({
                            transform: "rotate(" + (-90 + a * -90) + "deg)"
                        }), e(this).children(".label").css({
                            opacity: a,
                            top: 10 * (1 - a)
                        });
                    }
                }) : (c.stop(), "vertical" === this.config.writingMode ? c.children(".icon").css({
                    transform: "rotate(0deg)"
                }) : c.children(".icon").css({
                    transform: "rotate(-90deg)"
                }), c.children(".label").css({
                    opacity: 0,
                    top: 10
                }))) : (c.children(".label").css({
                    opacity: 0
                }), void (b === !1 && (c.stop(), "vertical" === this.config.writingMode ? c.children(".icon").css({
                    transform: "rotate(0deg)"
                }) : c.children(".icon").css({
                    transform: "rotate(-90deg)"
                }))));
            }, b.prototype.updateScrollers = function(a) {
                var b, c, d, e, f;
                return this.fullscreen === !0 && "horizontal" === this.config.writingMode ? (this.disableScroller("next"), 
                void this.disableScroller("prev")) : (b = this.fullscreen === !1 ? this.$pages.eq(this.page) : "vertical" === this.config.writingMode ? this.$textWrapper : this.$body, 
                "horizontal" === this.config.writingMode ? (f = b.height(), e = b.get(0).scrollHeight, 
                d = b.scrollTop(), c = e - d - f) : (f = b.width(), e = b.get(0).scrollWidth, c = b.scrollLeftCool(!0), 
                d = e - c - f), d <= 1 ? this.page - 1 >= 0 && this.fullscreen === !1 ? (this.enableScroller("prev"), 
                this.enablePagerMode("prev", a)) : (this.disableScroller("prev"), this.disablePagerMode("prev", a)) : (this.enableScroller("prev"), 
                this.disablePagerMode("prev", a)), c <= 0 ? this.page + 1 < this.pagesize && this.fullscreen === !1 ? (this.enableScroller("next"), 
                this.enablePagerMode("next", a)) : (this.disableScroller("next"), this.disablePagerMode("next", a)) : (this.enableScroller("next"), 
                this.disablePagerMode("next", a)));
            }, b.prototype.toggleWritingMode = function() {
                return "horizontal" === this.config.writingMode ? this.setWritingMode("vertical") : "vertical" === this.config.writingMode ? this.setWritingMode("horizontal") : this.setWritingMode("horizontal");
            }, b.prototype.setWritingMode = function(a, b) {
                return null == b && (b = {}), b.preventReadCharsSync || this.updateReadChars(), 
                this.$root.removeClass(function(a, b) {
                    return b.split(" ").filter(function(a) {
                        if (a.match(/^novel-writing-mode-/)) return !0;
                    }).join(" ");
                }), e.inArray(a, [ "vertical", "horizontal" ]) === -1 && (a = "horizontal"), e("html").hasClass("no-verticaltext") && (a = "horizontal"), 
                "vertical" === a ? (this.niceScroll.show(), this.$body.scrollTop(0)) : (this.niceScroll.hide(), 
                this.$pages.each(function() {
                    return e(this).getNiceScroll(0).rail.scrollable = !1;
                })), this.$root.addClass("novel-writing-mode-" + a), this.$writingModeController.attr("data-writing-mode", a), 
                this.saveConfig("writingMode", a, b), this.orientVtokens(a), b.preventReadCharsSync || this.loadReadChars(), 
                setTimeout(function(a) {
                    return function() {
                        return a.$textWrapper.getNiceScroll().each(function() {
                            return this.onResize();
                        }), a.$pages.getNiceScroll().each(function() {
                            return this.onResize();
                        });
                    };
                }(this), 200);
            }, b.prototype.orientVtokens = function(a) {
                return this.$root.find(".vtoken").each(function(b) {
                    return function(b, c) {
                        return "vertical" === a ? e(c).text(e(c).data("vertical")) : e(c).text(e(c).data("horizontal"));
                    };
                }(this));
            }, b.prototype.toggleFont = function() {
                return "sans-serif" === this.config.font ? this.setFont("serif") : "serif" === this.config.font ? this.setFont("sans-serif") : this.setFont("sans-serif");
            }, b.prototype.setFont = function(a) {
                return this.$root.removeClass(function(a, b) {
                    return b.split(" ").filter(function(a) {
                        if (a.match(/^novel-font-/)) return !0;
                    }).join(" ");
                }), e.inArray(a, [ "serif", "sans-serif" ]) === -1 && (a = "sans-serif"), this.$root.addClass("novel-font-" + a), 
                this.$fontController.attr("data-font", a), this.saveConfig("font", a);
            }, b.prototype.setSize = function(a, b) {
                return null == b && (b = {}), b.preventReadCharsSync || this.updateReadChars(), 
                this.$root.removeClass(function(a, b) {
                    return b.split(" ").filter(function(a) {
                        if (a.match(/^novel-size-/)) return !0;
                    }).join(" ");
                }), e.inArray(a, [ "small", "medium", "big" ]) === -1 && (a = "medium"), this.$root.addClass("novel-size-" + a), 
                this.$sizeChoices.filter(function() {
                    return e(this).data("size") === a;
                }).prop("checked", !0), b.preventReadCharsSync || this.fullscreen === !1 && "horizontal" === this.config.writingMode || this.loadReadChars(), 
                this.saveConfig("size", a);
            }, b.prototype.setLine = function(a, b) {
                var c;
                return null == b && (b = {}), b.preventReadCharsSync || this.updateReadChars(), 
                this.$root.removeClass(function(a, b) {
                    return b.split(" ").filter(function(a) {
                        if (a.match(/^novel-line-/)) return !0;
                    }).join(" ");
                }), e.inArray(a, [ "narrow", "normal" ]) === -1 && (c = "normal"), this.$root.addClass("novel-line-" + a), 
                this.$lineChoices.filter(function() {
                    return e(this).data("line") === a;
                }).prop("checked", !0), b.preventReadCharsSync || this.fullscreen === !1 && "horizontal" === this.config.writingMode || this.loadReadChars(), 
                this.saveConfig("line", a);
            }, b.prototype.setTheme = function(a) {
                var b;
                return b = function(a, b) {
                    return b.split(" ").filter(function(a) {
                        if (a.match(/^novel-theme-/)) return !0;
                    }).join(" ");
                }, this.$root.removeClass(b), this.$extendedBackground.removeClass(b), e.inArray(a, [ "white", "gray", "black", "blue", "yellow" ]) === -1 && (a = "white"), 
                this.$root.addClass("novel-theme-" + a), this.$extendedBackground.addClass("novel-theme-" + a), 
                this.$themeChoices.removeClass("active"), this.$themeChoices.filter(".novel-theme-" + a).addClass("active"), 
                this.saveConfig("theme", a);
            }, b.prototype.setScrollMode = function(a) {
                return this.$root.removeClass(function(a, b) {
                    return b.split(" ").filter(function(a) {
                        if (a.match(/^novel-scroll-mode-/)) return !0;
                    }).join(" ");
                }), e.inArray(a, [ "page", "scroll" ]) === -1 && (a = "scroll"), this.$root.addClass("novel-scroll-mode-" + a), 
                this.$scrollModeChoices.filter(function() {
                    return e(this).data("scroll-mode") === a;
                }).prop("checked", !0), this.saveConfig("scrollMode", a);
            }, b.prototype.setHorizontalView = function(a, b) {
                return b.preventReadCharsSync || this.updateReadChars(), this.$root.removeClass(function(a, b) {
                    return b.split(" ").filter(function(a) {
                        if (a.match(/^novel-horizontal-view-/)) return !0;
                    }).join(" ");
                }), e.inArray(a, [ "classic", "scroll" ]) === -1 && (a = "classic"), this.$root.addClass("novel-horizontal-view-" + a), 
                b.preventReadCharsSync || this.fullscreen === !1 && "horizontal" === this.config.writingMode || this.loadReadChars(), 
                this.saveConfig("horizontalView", a);
            }, b.prototype.setInstantFullscreen = function(a) {
                return this.$root.removeClass(function(a, b) {
                    return b.split(" ").filter(function(a) {
                        if (a.match(/^novel-instant-fullscreen-/)) return !0;
                    }).join(" ");
                }), "boolean" != typeof a && (a = !0), this.$root.addClass("novel-instant-fullscreen-" + (a ? "on" : "off")), 
                this.saveConfig("instantFullscreen", a);
            }, b.prototype.saveConfig = function(b, c, d) {
                var e, f;
                if (null == d && (d = {}), this.config[b] = c, !d.preventStoreConfig) return e = null != (f = a.storage.localStorage("novel_config")) ? f : {}, 
                e[b] = c, a.storage.localStorage("novel_config", e);
            }, b.prototype.countUpClick = function(a) {
                var b;
                return null == (b = this.clickCounter)[a] && (b[a] = 0), this.clickCounter[a]++;
            }, b.prototype.updateReadChars = function() {
                var a, b, c, d, e;
                return e = {
                    vertical: "vertical" === this.config.writingMode,
                    horizontal: "horizontal" === this.config.writingMode,
                    ttb: !0,
                    rtl: "vertical" === this.config.writingMode
                }, this.fullscreen === !1 ? (c = this.$pages.filter(function(a) {
                    return function(b) {
                        return b < a.page;
                    };
                }(this)), a = this.$pages.eq(this.page), d = "horizontal" === this.config.writingMode && "classic" === this.config.horizontalView ? window : a, 
                this.readChars = c.howmuchread("getLength") + a.howmuchread({
                    parent: d,
                    writingMode: e
                })) : (b = "horizontal" === this.config.writingMode ? this.$body : this.$textWrapper, 
                this.readChars = this.$pages.howmuchread({
                    parent: b,
                    writingMode: e
                }));
            }, b.prototype.loadReadChars = function() {
                var a, b, c, d, f, g;
                return g = {
                    vertical: "vertical" === this.config.writingMode,
                    horizontal: "horizontal" === this.config.writingMode,
                    ttb: !0,
                    rtl: "vertical" === this.config.writingMode
                }, this.fullscreen === !1 ? (c = 0, d = 0, this.$pages.each(function(a) {
                    return function(b, f) {
                        var g;
                        return g = e(f).howmuchread("getLength"), c <= a.readChars && a.readChars < c + g && (a.pageTo(b, {
                            preventScroll: !0
                        }), d = a.readChars - c), c += g;
                    };
                }(this)), a = this.$pages.eq(this.page), f = "horizontal" === this.config.writingMode && "classic" === this.config.horizontalView ? window : a, 
                a.howmuchread("scrollTo", d, {
                    parent: f,
                    writingMode: g
                })) : (b = "horizontal" === this.config.writingMode ? this.$body : this.$textWrapper, 
                this.$pages.howmuchread("scrollTo", this.readChars, {
                    parent: b,
                    writingMode: g
                }));
            }, b.prototype.setMarker = function(a) {
                if (a = parseInt(a, 10), !(isNaN(a) || a < 0 || this.pagesize <= a)) return this.marker !== a ? (this.marker = a, 
                this.$markerTooltip.addClass("loading"), this.$bodyMarker.addClass("loading"), c.api.post("/novel/rpc_marker.php", {
                    mode: "save",
                    i_id: this.id,
                    u_id: c.user.id,
                    page: a + 1
                }).done(function(a) {
                    return function(b, c) {
                        if ("success" === c) return a.updateMarker(), a.loadMarkers();
                    };
                }(this)).always(function(a) {
                    return function() {
                        return a.$bodyMarker.removeClass("loading");
                    };
                }(this))) : void 0;
            }, b.prototype.destroyMarker = function() {
                if (null !== this.marker) return this.marker = null, this.$markerTooltip.addClass("loading"), 
                c.api.post("/novel/rpc_marker.php", {
                    mode: "save",
                    i_id: this.id,
                    u_id: c.user.id,
                    page: 0
                }).done(function(a) {
                    return function(b, c) {
                        if ("success" === c) return a.updateMarker(), a.loadMarkers();
                    };
                }(this));
            }, b.updateNovelMarker = function(a, b) {
                var d;
                if (d = e(".novel-marker .marker"), !d.hasClass("loading")) return d.addClass("loading"), 
                Promise.resolve(c.api.post("/novel/rpc_marker.php", {
                    mode: "save",
                    i_id: a,
                    u_id: c.user.id,
                    page: b
                })).then(function(a) {
                    return function(a) {
                        return d.removeClass("loading").toggleClass("active", 0 !== b);
                    };
                }(this));
            }, b.prototype.loadMarkers = function() {
                return this.$markerTooltip.addClass("loading"), c.api.post("/novel/rpc_marker.php", {
                    mode: "list",
                    u_id: c.user.id,
                    offset: 0
                }).done(function(a) {
                    return function(b, c) {
                        if ("success" === c) return a.markers = b, a.updateMarkerList(), a.$markerTooltip.removeClass("loading");
                    };
                }(this));
            }, b.prototype.updateMarker = function() {
                return null == this.marker ? this.$markerTooltip.addClass("no-marker") : (this.$followMarkerButton.text(a.t("続き($1ページ)から読む", this.marker + 1)), 
                this.$markerTooltip.removeClass("no-marker")), this.marker === this.page ? this.$bodyMarker.addClass("active").attr("data-tooltip", a.t("しおりをはずす")) : this.$bodyMarker.removeClass("active").attr("data-tooltip", a.t("このページにしおりをはさむ"));
            }, b.prototype.updateMarkerList = function() {
                return this.$markerList.empty(), 0 === this.markers.length ? void this.$markerList.append(e("<div/>", {
                    class: "no-marked-novel-message",
                    text: a.t("しおりはまだはさまれておりません")
                })) : this.markers.forEach(function(b) {
                    return function(c) {
                        var d;
                        return d = e("<li/>", {
                            class: "marker-novel"
                        }).append(e("<a/>", {
                            class: "marker-link",
                            href: "/novel/show.php?id=" + c.id + "#" + c.marked_scene
                        }).append(e("<div/>", {
                            class: "marker-novel-main"
                        }).append(e("<p/>", {
                            class: "marker-novel-title",
                            text: c.title
                        })).append(e("<p/>", {
                            class: "marker-novel-author"
                        }).append(document.createTextNode("by ")).append(e("<span>", {
                            href: "/novel/member.php?id=" + c.user_id,
                            class: "marker-novel-authorlist",
                            text: c.user_name
                        })))).append(e("<div/>", {
                            class: "marker-novel-sub"
                        }).append(e("<img/>", {
                            class: "marker-novel-thumbnail",
                            src: c.url,
                            alt: c.title
                        })).append(e("<p/>", {
                            class: "marker-novel-status",
                            text: a.t("$1/$2ページ", c.marked_scene, c.scene)
                        })))), b.$markerList.append(d);
                    };
                }(this));
            }, b.prototype.updateScrollFollwer = function() {
                var a, b, c, d;
                if (b = e(window).scrollTop(), c = this.$body.offset(), d = {
                    width: this.$body.outerWidth(),
                    height: this.$body.outerHeight()
                }, a = this.fullscreen === !0 ? "fullscreen" : b <= c.top ? "top" : b <= c.top + d.height ? "fixed" : "bottom", 
                !this.$scrollFollower.hasClass(a)) switch (this.$scrollFollower.removeClass("top fixed bottom fullscreen").addClass(a), 
                a) {
                  case "fullscreen":
                    return this.$scrollFollower.removeAttr("style").css({
                        position: "fixed",
                        top: "70px",
                        right: "30px"
                    }).children().removeAttr("style").css({
                        position: "absolute",
                        top: "0",
                        right: "0"
                    });

                  case "top":
                    return this.$scrollFollower.removeAttr("style").css({
                        position: "absolute",
                        top: "0",
                        right: "0"
                    }).children().removeAttr("style").css({
                        top: "0"
                    });

                  case "fixed":
                    return this.$scrollFollower.removeAttr("style").css({
                        position: "fixed",
                        top: 0,
                        right: e(window).width() - c.left - this.$body.outerWidth() + "px"
                    }).children().removeAttr("style").css({
                        top: "0"
                    });

                  case "bottom":
                    return this.$scrollFollower.removeAttr("style").css({
                        position: "absolute",
                        top: "auto",
                        right: "0",
                        bottom: "0"
                    }).children().removeAttr("style").css({
                        top: "0"
                    });
                }
            }, b;
        }();
    }(b);
}.call(this), function() {
    "use strict";
    !function(a) {
        return a(function() {
            !function() {
                colon.storage.localStorage("hideHistoryBalloon", null), colon.storage.localStorage("hideToolmenuBalloon", null);
            }(), function() {
                var b, c, d;
                b = a("#back-to-top"), b.length && (c = !1, d = function(a) {
                    var d;
                    d = colon.w.scrollTop() <= colon.w.height() / 2, (d !== c || a) && b.toggleClass("off", c = d);
                }, colon.w.on("scroll", colon.throttle(function() {
                    d();
                })), d(!0));
            }();
        }), colon.ns("pixiv.dateFormat", {
            date: function(a, b) {
                return window.Intl ? new Intl.DateTimeFormat(void 0, {
                    year: b ? "numeric" : void 0,
                    month: "short",
                    day: "numeric"
                }).format(a) : a.toLocaleDateString();
            },
            time: function(a) {
                return a.getHours() + ":" + colon.padding(a.getMinutes());
            },
            datetime: function(a, b) {
                return pixiv.dateFormat.date(a, b) + " " + pixiv.dateFormat.time(a);
            }
        }), pixiv.imageFormat = function(a, b, c) {
            var d;
            switch (c) {
              case "200sq":
                break;

              default:
                return d = +c, a > b ? [ d, Math.round(d * b / a) ] : [ Math.round(d * a / b), d ];
            }
        }, pixiv.AreaEvent = function() {
            function b(b) {
                null == b && (b = {}), b.context && (this.context = a(b.context)), b.selector && (this.selector = b.selector), 
                b.target && this.watch(b.target);
            }
            var c;
            return c = !1, b.filters = {}, b.addFilter = function(a, b, c) {
                return this.filters[a] = [ b, c ], this;
            }, b.removeFilter = function(a) {
                return delete this.filters[a], this;
            }, b.setup = function(b) {
                var d;
                return d = "._area-target", c || (c = !0, colon.d.on("areain areaout", d, function(b) {
                    return function(c) {
                        var d, e, f, g, h, i, j;
                        for (i = c.currentTarget, j = {
                            areain: 0,
                            areaout: 1
                        }[c.type], g = a.trim(a(i).dataset("filter")).split(/\s+/), e = 0, f = g.length; e < f && (d = g[e], 
                        (null != (h = b.filters[d]) ? h[j].call(i, c) : void 0) !== !1); e++) ;
                    };
                }(this))), b ? new pixiv.AreaEvent({
                    target: d,
                    context: b,
                    selector: d
                }) : pixiv.areaEvent.watch(d);
            }, b.prototype.preloadAreaRate = 1, b.prototype.targets = null, b.prototype.inTargets = null, 
            b.prototype.outTargets = null, b.prototype.on = function() {
                var b;
                return b = colon.throttle(this.update, this, 500), this.context ? this.context.on("scroll.area", b) : colon.w.on("resize.area", a.proxy(this.resize, this)).on("scroll.area resize.area", b), 
                this;
            }, b.prototype.off = function() {
                var a;
                return (null != (a = this.context) ? a : colon.w).off(".area"), this;
            }, b.prototype.resize = function() {
                var a;
                a = this.context || colon.w, this.windowWidth = a.width(), this.windowHeight = a.height();
            }, b.prototype.update = function() {
                var b, c, d, e, f, g, h, i, j, k, l, m, n;
                if (this.targets) {
                    for (b = this.context || colon.w, i = b.scrollTop(), h = b.scrollLeft(), l = h + this.windowWidth, 
                    k = i + this.windowHeight, this.inTargets && this.outTargets || (this.inTargets = a(), 
                    this.outTargets = a.extend({}, this.targets)), m = this.windowWidth * this.preloadAreaRate, 
                    n = this.windowHeight * this.preloadAreaRate, g = this.targets, c = 0, e = g.length; c < e; c++) j = g[c], 
                    j = a(j), f = j.position(), f.left + h >= h - m && f.left + h < l + m && f.top >= i - 2 * n && f.top < k + n ? (d = this.outTargets.filter(j).length, 
                    j.trigger("area", [ d ]), d && (j.trigger("areain"), this.outTargets = this.outTargets.not(j), 
                    this.inTargets = this.inTargets.add(j))) : this.inTargets.filter(j).length && (j.trigger("areaout"), 
                    this.inTargets = this.inTargets.not(j), this.outTargets = this.outTargets.add(j));
                    return this;
                }
            }, b.prototype.watch = function(b, c) {
                return b = a(b || this.selector, c || this.context), b.length ? (this.targets ? (this.targets = this.targets.add(b), 
                this.outTargets = this.outTargets.add(b)) : (this.targets = b, this.on()), this.resize(), 
                this.update(), this) : this;
            }, b.prototype.unwatch = function(b, c) {
                return b = a(b || this.selector, c || this.context), b.length ? (this.targets ? (this.targets = this.targets.not(b), 
                this.inTargets = this.inTargets.not(b), this.outTargets = this.outTargets.not(b)) : (this.targets = null, 
                this.inTargets = null, this.outTargets = null, this.off()), this) : this;
            }, b;
        }(), pixiv.AreaEvent.addFilter("lazy-image", function() {
            var b, c;
            c = a(this), b = c.data("src"), b && ("IMG" === this.nodeName ? c.attr("src", b) : c.css("background-image", "url(" + b + ")"));
        }, function() {
            var b, c;
            c = a(this), b = c.data("src"), b && ("IMG" === this.nodeName ? c.attr("src", pixiv.transparentImage) : c.css("background-image", ""), 
            c.css({
                width: c.width(),
                height: c.height()
            }));
        }), pixiv.areaEvent = new pixiv.AreaEvent();
    }(jQuery);
}.call(this), function() {
    "use strict";
    var a, b, c;
    b = require("jquery"), a = require("colon"), c = require("pixiv"), function(b) {
        return a.ns("pixiv.api", {
            userProfile: function(a, b) {
                return c.api.get("/rpc/get_profile.php", a, b);
            },
            userFolder: function(a, b) {
                return c.api.get("/rpc_group_setting.php", {
                    mode: "get",
                    type: "bookuser",
                    id: a
                }, b);
            }
        }), b(function() {
            c.ProfileCard.setup(), a.d.on("click", "._follow-button .follow", function() {
                var a, d;
                if (d = b(this), !d.hasClass("busy")) return d.addClass("busy"), a = d.dataset(), 
                c.api.follow(a.user_id, null != d.data("is-private")).done(function() {
                    d.closest("._follow-button").addClass("following"), c.whitecubeProfilePopup.invalidateCache(d.data("user_id"), !0);
                }).always(function() {
                    return d.removeClass("busy");
                }), !1;
            }).on("click", "._follow-button .edit", function() {
                var a, d;
                return d = b(this), a = d.dataset(), c.followingEditModal.show(a.user_id), !1;
            });
        }), c.ProfileCard = function() {
            function d(a, b) {
                this.target = a, this.data = b;
            }
            return d.setup = function() {
                var d, e;
                e = null, d = null, a.d.on("mouseenter", ".ui-profile-popup", function(a) {
                    return function(a) {
                        var f, g;
                        b(a.relatedTarget).closest("._profile-popup").length || (d = null, window.clearTimeout(e), 
                        g = b(a.currentTarget), f = g.dataset(), f.user_id && (e = window.setTimeout(function() {
                            d = new c.ProfileCard(g, f), d.open();
                        }, 150)));
                    };
                }(this)).on("mouseleave", ".ui-profile-popup", function(a) {
                    return function(a) {
                        b(a.relatedTarget).closest("._profile-popup").length || null != d && d.close(), 
                        d = null, window.clearTimeout(e);
                    };
                }(this));
            }, d.prototype.open = function() {
                var c;
                this.container = b(a.template("profile-popup-loading", this.data)).appendTo("body"), 
                c = a.ui.popupPosition(this.container, this.target, {
                    offset: -10,
                    nipple: b(".nipple", this.container),
                    nippleMargin: 5
                }), this.request(), this.modal = a.ui.modal.push(this.container, {
                    disposable: !0
                }), this.container.on("mouseenter", function(a) {
                    return function(c) {
                        b(c.relatedTarget).closest(a.target).length || a.container.stop(!0).fadeTo(100, 1);
                    };
                }(this)).on("mouseleave", function(a) {
                    return function(c) {
                        b(c.relatedTarget).closest(a.target).length || a.close();
                    };
                }(this));
            }, d.prototype.request = function() {
                return c.api.userProfile({
                    user_ids: this.data.user_id,
                    illust_num: 3,
                    novel_num: 3
                }, {
                    cache: a.req.storeObject(864e5)
                }).done(function(d) {
                    return function(e, f, g, h) {
                        c.ProfileCard.cache = h, d.data = e.body[0], d.data.controllable = c.user.loggedIn && c.user.id !== d.data.user_id, 
                        d.data.premium = !!c.user.premium, d.data.r18_page = !!c.context.r18, d.data.items = d.data.illusts.concat(d.data.novels).slice(0, 3), 
                        b(".wrapper", d.container).html(b(a.template("profile-popup", d.data))), d.data.self || new c.FollowButton(b("._follow-button-container", d.container), d.data);
                    };
                }(this));
            }, d.prototype.close = function() {
                this.container.stop(!0).fadeOut("fast", function(b) {
                    return function() {
                        a.ui.modal.close(b.modal);
                    };
                }(this));
            }, d;
        }(), c.FollowButton = function() {
            function d(a, c) {
                this.data = c, this.container = b(a).on("click", ".follow-button", b.proxy(this.follow, this)).on("click", ".update-button", b.proxy(this.update, this)).on("click", ".unfollow-button", b.proxy(this.unfollow, this)), 
                this.data.premium && this.container.one("mouseenter", b.proxy(this.folder, this));
            }
            return d.prototype.folder = function(d) {
                return c.api.userFolder(c.user.id).done(function(d) {
                    return function(e, f, g, h) {
                        var i;
                        c.ProfileCard.folderCache = h, d.folders = b.extend(!0, [], c.ProfileCard.newFolders);
                        for (i in e.tag_a) d.folders.push(i);
                        a.unique(d.folders), d.folders.sort(), d.updateFolder();
                    };
                }(this)), !1;
            }, d.prototype.newFolder = function() {
                var d, e;
                (d = b.trim(window.prompt(a.t("フォルダー名を指定してください")))) && b.inArray(d, this.folders) === -1 && (c.ProfileCard.newFolders || (c.ProfileCard.newFolders = []), 
                c.ProfileCard.newFolders.push(d), this.folders.push(d), this.folders.sort(), e = b.inArray(d, this.folders), 
                e = e === -1 ? 1 : e + 1, b(this.folderItem(d)).insertAfter(b("option", this.container).eq(e)).prop("selected", !0));
            }, d.prototype.updateFolder = function() {
                var a;
                a = b("select", this.container).append(this.folderItem(this.folders)).prop("disabled", !1).on("change", function(b) {
                    return function() {
                        "new" === a[0].value && 1 === a[0].selectedIndex && b.newFolder();
                    };
                }(this));
            }, d.prototype.folderItem = function(a) {
                var c, d, e, f, g;
                for ("array" !== b.type(a) && (a = [ a ]), g = [], c = e = 0, f = a.length; e < f; c = ++e) d = a[c], 
                g[c] = '<option value="' + d + '">' + d + "</option>";
                return g.join("");
            }, d.prototype.updateState = function() {
                this.container.html(a.template("follow-option", this.data)), this.container[this.data.is_follow ? "addClass" : "removeClass"]("following2");
            }, d.prototype.follow = function(a) {
                return this.container.hasClass("following2") ? this.unfollow(a) : this.update(a);
            }, d.prototype.update = function(a) {
                return b(".options-wrapper", this.container).addClass("_hidden"), b("button", this.container).prop("disabled", !0), 
                c.api.follow(this.data.user_id, b('input[name="restrict"]:checked', this.container).val(), b("select", this.container).val()).done(function(a) {
                    return function() {
                        var d, e;
                        a.data.is_follow = !0, a.updateState(), a.container.trigger("follow"), null != (e = c.ProfileCard.cache) && e.update({
                            body: [ {
                                is_follow: !0
                            } ]
                        }), c.ProfileCard.newFolders = null, "function" == typeof (d = c.ProfileCard).folderCache && d.folderCache(null), 
                        a.data.premium && a.container.one("mouseenter", b.proxy(a.folder, a));
                    };
                }(this)).fail(function(a, b, c) {}).always(function(a) {
                    return function() {
                        a.container.one("mouseleave", function() {
                            return b(".options-wrapper", a.container).removeClass("_hidden");
                        }), b("button", a.container).prop("disabled", !1);
                    };
                }(this)), !1;
            }, d.prototype.unfollow = function(a) {
                return b(".options-wrapper", this.container).addClass("_hidden"), b("button", this.container).prop("disabled", !0), 
                c.api.unfollow(this.data.user_id).done(function(a) {
                    return function() {
                        var b;
                        a.data.is_follow = !1, a.updateState(), a.data.premium && a.updateFolder(), a.container.trigger("unfollow"), 
                        null != (b = c.ProfileCard.cache) && b.update({
                            body: [ {
                                is_follow: !1
                            } ]
                        });
                    };
                }(this)).fail(function(a, b, c) {}).always(function(a) {
                    return function() {
                        b(".options-wrapper", a.container).removeClass("_hidden"), b("button", a.container).prop("disabled", !1);
                    };
                }(this)), !1;
            }, d;
        }();
    }(b);
}.call(this), function() {
    "use strict";
    !function(a) {
        return a(function() {
            colon.dispatcher.connect("/beta/style-guide/profile.html", function() {
                pixiv.list.setup(), pixiv.profile.setup();
            }).connect("/beta/member.php", function() {
                pixiv.list.setup(), pixiv.profile.setup();
            }).dispatch();
        }), colon.ns("pixiv.profile", {
            setup: function() {
                var b, c, d, e, f, g;
                return f = a("._profile-container"), d = a("._profile-intro .wrapper"), c = !0, 
                g = function() {
                    var a;
                    a = d.position().top - colon.w.scrollTop() >= 200 && colon.w.scrollTop() <= 100, 
                    a !== c && f.toggleClass("intro", c = a);
                }, colon.w.on("scroll", g), b = a("._list-container"), e = new Brickmaker(b[0], {
                    columnWidth: 320
                }), colon.d.on("scroll", function() {
                    var c, d;
                    d = a("body").width(), c = Math.min(Math.floor((d - 20) / 340), 6), e.columnCount !== c && e.update({
                        columnCount: c
                    }), b.css("margin-left", (d - (360 * c - 40)) / 2);
                }).resize();
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        var b;
        return colon.ns("pixiv.api.promotion", {
            melonbooksDL: function(a, b) {
                return pixiv.api.get("http://www.melonbooks.com/api/pixiv/get_promotion_ads.php", {
                    pixiv_user_id: a,
                    adult: b
                });
            },
            booth: function(a, b) {
                return pixiv.api.get("https://api.booth.pm/pixiv/shops/show.json", {
                    pixiv_user_id: a,
                    adult: b
                });
            },
            sketch: function(a) {
                var b;
                return b = pixiv.config.sketchUrlBase + "/api/pixiv/user/posts/latest", pixiv.api.get(b, {
                    user_id: a
                }, {
                    ajaxSettings: {
                        headers: {
                            Accpet: "application/vnd.sketch-v1+json"
                        }
                    }
                });
            }
        }), b = {
            melonbooksDL: function() {
                var a;
                return (a = pixiv.Promotion.findItem(1)) && pixiv.api.promotion.melonbooksDL(a.user_id, a.adult_param).done(function(a) {
                    (null != a ? a.body : void 0) && (a.body.content = pixiv.context.content, new pixiv.Promotion("._melonbooks-dl-promotion-container", a.body, "melonbooks-dl"));
                }), this;
            },
            booth: function() {
                var a;
                return (!colon.ua.ie || colon.ua.v > 8) && (a = pixiv.Promotion.findItem(2)) && pixiv.api.promotion.booth(a.user_id, a.adult_param).done(function(a) {
                    var b, c;
                    (null != a ? a.body : void 0) && (a.body.content = pixiv.context.content, b = new pixiv.Promotion("._booth-promotion-container", a.body), 
                    null != (c = b.listItemContainer) && c.boxHeight());
                }), this;
            },
            sketch: function() {
                var b;
                return (b = pixiv.Promotion.findItem(4)) && a("._sketch-promotion-container").get(0) ? (pixiv.api.promotion.sketch(b.user_id).done(function(a) {
                    var c;
                    c = new pixiv.PromotionSketch("._sketch-promotion-container", b.user_id, a, "sketch");
                }), this) : this;
            }
        }, a(function() {
            colon.dispatcher.connect(/^(?:\/member(?:_illust)?|\/novel\/show)\.php$/, function() {
                pixiv.context.promotionItems && b.booth().melonbooksDL().sketch();
            }, null, !0).connect(/^(?:\/novel\/(?:index\.php)?|\/novel\/show\.php)$/, function() {
                var a, b, c;
                c = window.location.pathname.match(/^\/novel\/(?:index\.php)?$/) ? "mpr_novel" : "/novel/show.php" === window.location.pathname ? "mpr_novel_show" : "mpr_novel_unknown", 
                a = {
                    items: (pixiv.context.novelPromotionItems || []).map(function(a) {
                        return a.mpr = c, a;
                    })
                }, new pixiv.Promotion("#pixiv-comic-novel-container", a, "comic-novel"), b = {
                    items: (pixiv.context.contestPortalItems || []).map(function(a) {
                        return a.mpr = c, a;
                    })
                }, new pixiv.Promotion("#pickup-contest-container-mini", b, "contest-novel");
            }).connect("/", function() {
                var a;
                pixiv.user.id && (a = {
                    items: pixiv.context.comicPromotionItems || []
                }, new pixiv.Promotion("#comic-container", a, "comic", {
                    view: 2
                }));
            }).connect("/contest/", function() {
                var a;
                a = {
                    items: pixiv.context.contestPortalItems || []
                }, new pixiv.Promotion("#pickup-contest-container", a, "contest-portal");
            }).dispatch();
        }), pixiv.Promotion = function() {
            function b(b, c, d, e) {
                this.data = c, this.options = null != e ? e : {
                    view: 1
                }, this.container = a(b), d && (this.template += "-" + d), this.create();
            }
            return b.findItem = function(a) {
                var b, c, d, e;
                for (e = pixiv.context.promotionItems, c = 0, d = e.length; c < d; c++) if (b = e[c], 
                b.site_id === a) return b;
            }, b.prototype.template = "promotion", b.prototype.create = function() {
                var b, c, d, e, f;
                for (f = this.data.items, b = d = 0, e = f.length; d < e; b = ++d) c = f[b], b >= this.options.view && (c.lazy = !0);
                this.container.append(colon.template(this.template, this.data)), this.data.items.length && (this.listContainer = a(".items", this.container), 
                this.listItemContainer = a(".item", this.listContainer), this.pagerContainer = a(".pager", this.container), 
                this.createPager());
            }, b.prototype.createPager = function() {
                var b, c, d, e, f, g, h;
                if (f = this.pagerContainer, h = this.options.view, !f.length || this.data.items.length <= h) return void f.remove();
                for (this.containerWidth = this.container.width(), this.itemWidth = this.listItemContainer.outerWidth(!0), 
                this.offset = (this.containerWidth - this.itemWidth * h) / 2, this.listContainer.width(this.itemWidth * this.data.items.length + 2 * this.offset), 
                e = [], c = d = 1, g = Math.ceil(this.data.items.length / h); 1 <= g ? d <= g : d >= g; c = 1 <= g ? ++d : --d) b = 1 === c ? ' class="current"' : "", 
                e.push("<li" + b + "><span>" + c + "</span></li>");
                f.html(e.join("")).on("click mouseenter", "li:not(.current)", function(b) {
                    return function(c) {
                        var d, e;
                        e = a(c.target), d = +e.text() - 1, b.move(e, d);
                    };
                }(this)), this.listItemContainer.on("click", function(b) {
                    return function(c) {
                        var d;
                        d = b.listItemContainer.index(c.currentTarget), a("li", f).eq(d).click();
                    };
                }(this)), this.container.on("click", ".pager-prev", function() {
                    var b, c;
                    b = a(".current", f).prev(), c = b.length ? b : f.children().last(), c.click();
                }).on("click", ".pager-next", function() {
                    var b, c;
                    b = a(".current", f).next(), c = b.length ? b : f.children().first(), c.click();
                });
            }, b.prototype.move = function(b, c) {
                var d;
                return d = this.options.view, b.siblings().removeClass("current").end().addClass("current"), 
                this.listContainer.css("margin-left", c * this.itemWidth * d * -1 + this.offset), 
                a("img", this.listContainer).slice(c * d, c * d + d).each(function() {
                    var b, c;
                    if (b = a(this), c = b.dataset("src")) return b.attr({
                        src: c,
                        "data-src": null
                    });
                });
            }, b;
        }(), pixiv.PromotionSketch = function() {
            function b(b, c, d, e, f) {
                this.user_id = c, this.data = d, this.options = null != f ? f : {
                    view: 1
                }, this.container = a(b), e && (this.template += "-" + e), this.create();
            }
            return b.prototype.template = "promotion", b.prototype.create = function() {
                var b, c, d, e, f, g;
                for (g = this.data.data, b = d = 0, e = g.length; d < e; b = ++d) c = g[b], b >= this.options.view && (c.lazy = !0);
                f = [], this.data.data && this.data.data.posts && (f = this.data.data.posts, this.data.data.posts = f.slice(0, 3)), 
                this.container.append(colon.template(this.template, {
                    data: this.data.data,
                    isMyself: pixiv.user && pixiv.user.id === this.user_id,
                    sketchUrlBase: pixiv.config.sketchUrlBase
                })), this.data.data.length && (this.listContainer = a(".items", this.container), 
                this.listItemContainer = a(".item", this.listContainer));
            }, b;
        }();
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        return colon.ns("pixiv.api", {
            ranking: function(b, c) {
                return pixiv.api.get("/ranking.php", a.extend(b, {
                    format: "json"
                }), c);
            }
        }), a(function() {
            colon.dispatcher.connect("/ranking.php", function() {
                pixiv.ranking.attrFilter.setup();
            }).dispatch();
        }), colon.ns("pixiv.ranking", {
            setup: function() {
                var b;
                colon.d.on("click", ".ranking-item .open-info", this.info).on("uiScroll", ".ui-scroll", function() {
                    var b, c;
                    if (b = /^#(\d+)$/.exec(a(this).attr("href"))) return c = Math.ceil(b[1] / 50), 
                    colon.query.replace({
                        p: 1 === c ? null : c
                    }, !0);
                }), colon.w.on("hashchange", function(a) {
                    return function() {
                        a.permalink();
                    };
                }(this)).trigger("hashchange"), pixiv.context.next && (this.indicator = new pixiv.LoadingIndicator(".ranking-items-container"), 
                b = a(".column-menu.bottom").on("autoView", function(a) {
                    return function() {
                        return a.next();
                    };
                }(this)), this.autoView = new pixiv.AutoView(b, {
                    enable: !0
                }).apply(), this.page = +(pixiv.context.queries.p || 1));
            },
            permalink: function() {
                var b, c;
                b = +(null != (c = /\d+/.exec(window.location.hash)) ? c[0] : void 0), b && b !== this.position && (a("#" + this.position).removeClass("current"), 
                a("#" + b).addClass("current"), this.position = b);
            },
            info: function() {
                var b, c, d, e, f;
                b = a(this).closest(".ranking-item"), c = b.dataset(), d = a(".info-modal", b), 
                d.length || (e = Math.ceil(c.rank / 50), f = colon.query.build("http://www.pixiv.net/ranking.php", {
                    mode: pixiv.context.mode,
                    date: pixiv.context.date,
                    content: pixiv.context.content,
                    p: 1 === e ? null : e
                }), d = a(colon.template("ranking-info-modal", a.extend(c, {
                    url: "http://www.pixiv.net/member_illust.php?mode=medium&illust_id=" + c.id,
                    text: pixiv.context.rankingDate + " " + pixiv.context.rankingType + " " + c.rankText + " " + c.title + " | " + c.userName + " " + f + "#" + c.rank,
                    hashtag: pixiv.context.twitterHashTag
                }))).appendTo(b), pixiv.ui.shareButton.update()), colon.ui.modal.toggle(this, d);
            },
            next: function() {
                return this.autoView.pause(), pixiv.api.ranking(a.extend({}, pixiv.context.queries, {
                    p: this.page + 1
                })).always(function(a) {
                    return function() {
                        a.indicator.stop();
                    };
                }(this)).done(function(b) {
                    return function(c) {
                        a(colon.template("ranking-items", {
                            items: b.itemRank(c).contents,
                            mode: pixiv.context.mode
                        })).appendTo(".ranking-items"), pixiv.scrollView.update(), pixiv.ranking.attrFilter.update(), 
                        colon.ga.trackPageview(colon.query.replace({
                            ref: "rn-h-next-3"
                        })), ++b.page, c.next ? b.autoView.restart() : b.finish();
                    };
                }(this)).fail(function(a) {
                    return function() {
                        a.finish();
                    };
                }(this));
            },
            finish: function() {
                this.indicator.finish(this.indicator), this.autoView.complete(), this.completed = !0, 
                pixiv.scrollView.unregisterFilter("auto-view");
            },
            itemRank: function(a) {
                var b, c, d;
                d = a.contents;
                for (c in d) if (b = d[c], b.yes_rank) switch (!1) {
                  case !(b.rank > b.yes_rank):
                    b.down = !0, b.yesterday_page = Math.ceil(b.yes_rank / 50);
                    break;

                  case b.rank !== b.yes_rank:
                    b.stay = !0;
                    break;

                  case !(b.yes_rank < a.rank_total):
                    b.up = !0, b.yesterday_page = Math.ceil(b.yes_rank / 50);
                }
                return a;
            }
        }), colon.ns("pixiv.ranking.attrFilter", {
            setup: function() {
                var b, c;
                this.data = colon.storage.localStorage(RANKING_ATTR_FILTER_ITEMS) || {}, b = a("._ranking-attr-filter-container").append(colon.template("ranking-attr-filter-list-item", this.data)).on("change", "input", function(b) {
                    return function(c) {
                        var d, e;
                        e = a(c.currentTarget), d = e.attr("name"), e.prop("checked") ? (colon.ga.trackEvent([ "rankingAttrFilter", "on", d ]), 
                        b.hide(d)) : b.show(d);
                    };
                }(this)), colon.storage.localStorage(RANKING_ATTR_FILTER_MENU_HIDDEN) || (c = b.on("mouseleave", function() {
                    colon.storage.localStorage(RANKING_ATTR_FILTER_MENU_HIDDEN, !0), c.removeClass("_visible-block");
                }).find("._sub-menu-container").addClass("_visible-block")), this.update();
            },
            update: function() {
                a(".ranking-item").each(function(b) {
                    return function(c, d) {
                        var e, f, g, h, i;
                        for (i = a(d), h = i.dataset("attr").split(" "), f = 0, g = h.length; f < g; f++) if (e = h[f], 
                        e && b.data[e]) return void i.addClass("_attr-filter-hidden");
                        i.removeClass("_attr-filter-hidden");
                    };
                }(this));
            },
            show: function(a) {
                return this.data[a] = !1, colon.storage.localStorage(RANKING_ATTR_FILTER_ITEMS, this.data), 
                this.update();
            },
            hide: function(a) {
                return this.data[a] = !0, colon.storage.localStorage(RANKING_ATTR_FILTER_ITEMS, this.data), 
                this.update(), pixiv.scrollView.update();
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        var b, c;
        return a(function() {
            colon.dispatcher.connect("/search_user.php", function() {
                return c();
            }).connect("/bookmark_add.php", function() {
                return c();
            }).connect("/search.php", function() {
                return b();
            }).connect("/search_tag_user.php", function() {
                return b();
            }).dispatch();
        }), c = function() {
            new pixiv.UserList(".user-recommendation-unit");
        }, b = function() {
            new pixiv.UserSearch(".sample-user-search");
        };
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        return a(function() {
            colon.dispatcher.connect("/beta/search.php", function() {
                pixiv.list.setup();
            }).dispatch();
        }), colon.ns("pixiv.list", {
            setup: function() {
                var b, c;
                return b = a("._list-container"), c = new Brickmaker(b[0], {
                    columnWidth: 320
                }), colon.d.on("resize", function() {
                    var d, e;
                    e = a("body").width(), d = Math.min(Math.floor((e - 40) / 360), 6), c.columnCount !== d && c.update({
                        columnCount: d
                    }), b.css("margin-left", (e - (360 * d - 40)) / 2);
                }).resize();
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        return a(function() {
            colon.dispatcher.connect("/setting_showcase.php", function() {
                pixiv.ShowcaseSetting.setup();
            }).dispatch();
        }), colon.ns("pixiv.showcase", {
            setup: function() {
                this.container = a("div.user-ad-container"), colon.w.on("resize.showcase", function(a) {
                    return function() {
                        return colon.throttle(a.resize);
                    };
                }(this)), this.resize();
            },
            resize: function() {
                this.container[colon.w.width() > 1350 ? "addClass" : "removeClass"]("out");
            }
        }), pixiv.ShowcaseSetting = function() {
            function b(b) {
                var c;
                this.container = b, this.loadingContainer = a(".loading", this.container), this.errorContainer = a(".illust-id-container .error", this.container), 
                this.previewContainer = a(".preview", this.container), this.pointContainer = a(".point", this.container), 
                this.illustIdContainer = a(".illust-id", this.container), this.dateContainer = a("input.date", this.container), 
                this.submitButton = a('input[type="submit"]', this.container), c = a(".ui-tag", this.container), 
                this.tags = new pixiv.ui.Tag(c, {
                    maxCount: 5
                }).tags, this.illustIdContainer.on("keyup blur", colon.debounce(this.updatePreview, this, 500)), 
                c.on("uiTagUpdate", function(a) {
                    return function() {
                        return a.updatePoint();
                    };
                }(this)), this.container.on("showcaseSettingUpdate", function(a) {
                    return function(b) {
                        return a.verify(b);
                    };
                }(this)), this.illustIdContainer.blur(), this.datepicker();
            }
            return b.setup = function() {
                var a, b;
                a = pixiv.context.queries.id, b = pixiv.context.queries.tag, (a || b) && (pixiv.showcase.count < 3 ? this.open("new", {
                    form_illust_id: a,
                    form_tags: b
                }) : window.alert(colon.t("ショーケースを同時に3件以上設定することはできません。")));
            }, b.open = function(b, c) {
                var d;
                null == c && (c = {}), d = a("#showcase-" + b), d.length || (a.extend(c, {
                    id: b,
                    total_point: pixiv.user.point
                }), d = a(colon.template("showcase-modal", c)), d.appendTo("body"), new pixiv.ShowcaseSetting(d)), 
                pixiv.ui.modal.push(d, {
                    block: !0,
                    click: function() {
                        var b;
                        return b = a(".ui-datepicker"), !(b.length && b.is(":visible"));
                    }
                });
            }, b.prototype.updatePreview = function() {
                var b;
                if (this.previewContainer.text("?").addClass("no-item"), b = pixiv.ui.Tag.trim(this.illustIdContainer.val())) return this.loadingContainer.css("display", "inline-block"), 
                this.errorContainer.empty(), pixiv.api.validation.illustId(b).always(function(a) {
                    return function() {
                        return a.loadingContainer.hide();
                    };
                }(this)).done(function(b) {
                    return function(c) {
                        c = c.data, c && a(colon.template("showcase-modal-preview", c)).appendTo(b.previewContainer.empty().removeClass("no-item")), 
                        b.container.trigger("showcaseSettingUpdate");
                    };
                }(this)).fail(function(a) {
                    return function(b, c, d) {
                        a.errorContainer.text(d.illust_id || "unknown error"), a.container.trigger("showcaseSettingUpdate");
                    };
                }(this));
            }, b.prototype.datepicker = function() {
                return pixiv.get["jquery-ui"]().done(function(b) {
                    return function() {
                        var c, d, e, f, g;
                        g = b, f = new Date(), e = 14 === f.getUTCHours() && f.getUTCMinutes() >= 30 ? 2 : 1, 
                        d = a.datepicker.formatDate("yy-mm-dd", new Date(+new Date() + 864e5 * e)), c = b.dateContainer.datepicker({
                            dateFormat: "yy-mm-dd",
                            defaultDate: e,
                            minDate: e,
                            maxDate: e + 7 - 1,
                            beforeShow: function() {
                                c.eq(0).datepicker("setDate", c[0].value.slice(0, 10)).end().eq(1).datepicker("setDate", c[1].value.slice(0, 10)), 
                                pixiv.ui.modal.pause();
                            },
                            onSelect: function(b) {
                                b = a.datepicker.parseDate("yy-mm-dd", b), this === c[0] && c.eq(1).datepicker("option", {
                                    minDate: b,
                                    maxDate: new Date(+b + 864e5 * (e + 7 - 2))
                                }), g.updatePoint();
                            },
                            onClose: function() {
                                c[0].value += " 00:00", c[1].value += " 23:59", pixiv.ui.modal.restart();
                            }
                        }), c.eq(0).val(d + " 00:00"), c.eq(1).val(d + " 23:59"), b.updatePoint();
                    };
                }(this));
            }, b.prototype.verify = function() {
                var b, c;
                c = a.trim(this.illustIdContainer.val()) && !this.previewContainer.hasClass("no-item") && 0 !== this.total && 5 >= (b = this.tags.length) && b > 0 && !this.pointContainer.parent().hasClass("error"), 
                this.submitButton.prop("disabled", !c);
            }, b.prototype.updatePoint = function() {
                var b, c, d, e, f;
                d = this.pointContainer, b = this.dateContainer, c = a.datepicker.parseDate("yy-mm-dd", b.eq(0).val().slice(0, 10)), 
                e = a.datepicker.parseDate("yy-mm-dd", b.eq(1).val().slice(0, 10)), f = this.calc(c, e), 
                d.text(colon.format(f)).parent()[f > pixiv.user.point ? "addClass" : "removeClass"]("error"), 
                this.container.trigger("showcaseSettingUpdate");
            }, b.prototype.calc = function(a, b) {
                var c, d;
                return c = a && b ? (b - a) / 1e3 / 60 / 60 / 24 + 1 : 0, d = Math.min(this.tags.length, 5), 
                this.total = 100 * c * d;
            }, b;
        }();
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        return colon.ns("pixiv.social", {
            addFacebookCount: function(b, c) {
                if (b.length) return a.getJSON("http://graph.facebook.com/?callback=?", {
                    id: c || window.location.href
                }).done(function(a) {
                    b.text(a.share_count || "0");
                });
            },
            addTwitterCount: function(b, c) {
                if (b.length) return a.getJSON("https://cdn.api.twitter.com/1/urls/count.json?callback=?", {
                    url: c || window.location.href
                }).done(function(a) {
                    b.text(a.count || "0");
                });
            }
        }), pixiv.scrollView.registerFilter("share-facebook", function(b) {
            var c;
            c = b.dataset(), pixiv.social.addFacebookCount(a(".count", b), c.url), b[0].onclick || b.on("click", function() {
                return window.open(colon.query.build("https://www.facebook.com/sharer.php", {
                    app_id: pixiv.config.facebookAppId,
                    u: c.url,
                    display: "popup"
                }), null, "menuber=no,toolbar=no,resizable=yes,scrollbats=yes,width=670,height=390"), 
                !1;
            });
        }), pixiv.scrollView.registerFilter("share-twitter", function(b) {
            var c;
            c = b.dataset(), pixiv.social.addTwitterCount(a(".count", b), c.url), b[0].onclick || b.on("click", function() {
                return window.open(colon.query.build("https://twitter.com/share", {
                    url: c.url,
                    text: c.text,
                    hashtags: c.hashtags
                }), null, "menuber=no,toolbar=no,resizable=yes,scrollbats=yes,width=550,height=470"), 
                !1;
            });
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        return a(function() {
            colon.dispatcher.connect(/^\/special\/kiznaiver\/.*/, function() {
                pixiv.specialKiznaiver.setup();
            }).dispatch();
        }), colon.ns("pixiv.specialKiznaiver", {
            setup: function() {
                colon.d.on("click", ".toggle-bookmark", a.proxy(this.bookmark, this)).on("click", "._news .module", a.proxy(this.showModal, this)), 
                colon.w.on("scroll", colon.throttle(this.onScroll, this)), this.next_url = a("._timeline").data("next-url"), 
                this.loadMore();
            },
            bookmark: function(b) {
                var c, d;
                if (d = a(b.currentTarget), !d.hasClass("on")) return c = d.dataset("id"), d.addClass("on"), 
                pixiv.api.illust.bookmark(c), !1;
            },
            showModal: function(b) {
                var c, d;
                return d = a(b.currentTarget), c = d.parent().find(".modal"), colon.ui.modal.push(c, {
                    block: !0
                }), !1;
            },
            onScroll: function(a) {
                this.shouldLoadMore() && this.loadMore();
            },
            shouldLoadMore: function() {
                var b, c, d, e;
                return d = colon.w.scrollTop(), b = a("._footer"), c = 1200, e = colon.w.innerHeight() + d + c, 
                0 <= d && b.offset().top < e;
            },
            loadMore: function() {
                var b;
                null != this.next_url && (b = a("._timeline"), b.hasClass("loading") || (b.addClass("loading"), 
                pixiv.api.get(this.next_url).done(function(c) {
                    return function(d) {
                        if (b.append(a(d.body.html)), c.next_url = d.body.next_url, c.shouldLoadMore()) return c.loadMore();
                    };
                }(this)).always(function(a) {
                    return function() {
                        return b.removeClass("loading");
                    };
                }(this))));
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    var a, b, c;
    b = require("jquery"), a = require("colon"), c = require("pixiv"), function(b) {
        return function() {
            var a;
            window.File && window.FileReader && window.FormData && window.Uint8Array && (a = function(a, d, e) {
                b(a).addClass("ugoku-illust-started"), new c.UgokuIllustPlayer(b("._ugoku-illust-player-container:first", a), d, e);
            }, c.scrollView.registerFilter("ugoku-illust-autoplay", function(b) {
                var d, e, f, g;
                e = b.dataset(), (d = null != (g = c.context.ugokuIllustDataList) ? g[e.id] : void 0) ? (d.size = c.UgokuIllustPlayer.size(d.originalSize), 
                a(b, c.UgokuIllustPlayer.data(d, "ugoira600x600"), {
                    autoStart: !0,
                    maxSize: e.maxSize || 480,
                    fullscreenData: c.UgokuIllustPlayer.data(d, "ugoira1920x1080")
                })) : (f = b.dataset("id"), c.api.ugokuIllust(f).done(function(d) {
                    return d = d.body[f], d.originalSize = d.original_size, d.size = c.UgokuIllustPlayer.size(d.original_size), 
                    a(b, c.UgokuIllustPlayer.data(d, "ugoira600x600"), {
                        autoStart: !0,
                        maxSize: e.maxSize || 480,
                        fullscreenData: c.UgokuIllustPlayer.data(d, "ugoira1920x1080")
                    });
                }));
            }));
        }(), b(function() {
            a.dispatcher.connect({
                pathname: "/member_illust.php",
                search: /(?:^|\?|&)mode=medium(?:&|$)/
            }, function() {
                var a, d, e;
                (a = c.context.ugokuIllustData) && (a.size = c.UgokuIllustPlayer.size(c.context.illustSize), 
                e = {
                    autoStart: !0
                }, !c.user.loggedIn && c.context.explicit && (d = 30, e.effect = function(b, c) {
                    var e, f, g, h, i;
                    for (f = this.data.size, g = f[0], e = f[1], i = 0; i < e; ) {
                        for (h = 0; h < g; ) a = c.getImageData(Math.min(h + d / 2 - 1, g) - 1, Math.min(i + d / 2 - 1, e) - 1, 1, 1).data, 
                        c.fillStyle = "rgb(" + a[0] + "," + a[1] + "," + a[2] + ")", c.fillRect(h, i, d, d), 
                        h += d;
                        i += d;
                    }
                }, e.maxSize = 580), new c.UgokuIllustPlayer(b("._ugoku-illust-player-container:first"), a, e));
            }).connect({
                pathname: "/member_illust.php",
                search: /(?:^|\?|&)mode=ugoira_view(?:&|$)/
            }, function() {
                var a;
                (a = c.context.ugokuIllustData) && (a.size = c.UgokuIllustPlayer.size(c.context.illustSize, 1920, 1080), 
                new c.UgokuIllustPlayer(b("._ugoku-illust-player-container"), a, {
                    autoStart: !0,
                    maxWidth: 1920,
                    maxHeight: 1080
                }));
            }).dispatch();
        });
    }(b);
}.call(this), function() {
    "use strict";
    var a, b, c;
    b = require("jquery"), a = require("colon"), c = require("pixiv"), function(b) {
        return c.UgokuIllustPreview = function() {
            function a(a, c) {
                this.container = b(a), c && this.update(c);
            }
            return a.prototype.update = function(a) {
                var d, e;
                null != (e = this.player) && e.dispose(), this.player = new c.UgokuIllustPlayer(this.container, a), 
                d = b("progress", this.container).removeClass("_hidden").width(this.player.size[0]).get(0), 
                d.max = a.delay, d.value = 0, b(".player", this.container).css({
                    width: this.player.size[0],
                    height: this.player.size[1],
                    backgroundImage: "url(" + a.frames[0].file + ")",
                    backgroundSize: this.player.size[0] + "px " + this.player.size[1] + "px"
                }), this.player.onload = function(c) {
                    return function() {
                        var e, f, g, h, i, j, k;
                        g = b("._ugoku-illust-upload-modal .item"), j = null, f = 25, i = 0, h = 0, e = 0, 
                        k = function() {
                            d.value = Math.min(i + f * e++, h);
                        }, b(c.player.player).on("frame", function(b, c) {
                            var d, l, m;
                            if (i = 0, c) for (d = l = 0, m = c; 0 <= m ? l < m : l > m; d = 0 <= m ? ++l : --l) i += a.frames[d].delay;
                            h = i + a.frames[c].delay, e = 0, j && window.clearInterval(j), j = window.setInterval(k, f), 
                            k(), g.removeClass("current").eq(c).addClass("current");
                        }).on("pause stop", function(a, b) {
                            j && window.clearInterval(j);
                        });
                    };
                }(this);
            }, a;
        }(), c.UgokuIllustUploader = function() {
            function d(a, c) {
                this.reUpload = c, this.input = b(a), this.input.on("change", function(a) {
                    return function() {
                        a.container ? a.add() : a.open().done(function() {
                            return a.add();
                        });
                    };
                }(this));
            }
            return d.setup = function() {
                var d, e;
                d = b("._ugoku-illust-upload-container"), e = b(".upload-multiple-input", d), new c.UgokuIllustUploader(e, "re_upload" === c.context.queries.mode), 
                a.ua.ie && a.ua.v < 11 && (b(".upload-gif", d).addClass("_current"), b("._form-content-upload", d).removeClass("_hidden")), 
                c.UgokuIllustPlayer.supported ? d.on("click", ".upload-multiple", function() {
                    return e.click();
                }).on("click", ".upload-gif", function() {
                    return b(".upload-gif-input").click();
                }).on("change", ".upload-gif-input", function() {
                    return b(".upload-gif-form").submit();
                }) : (d.addClass("outdated"), b(".upload-multiple", d).addClass("_disabled"));
            }, d.imageType = function(a) {
                var c, d;
                return c = b.Deferred(), d = new FileReader(a), d.onload = function(a) {
                    var b, d, e, f, g;
                    for (b = new Uint8Array(a.target.result), d = "", e = f = 0; f <= 4; e = ++f) d += b[e].toString(16);
                    return g = function() {
                        switch (!1) {
                          case 0 !== d.indexOf("ffd8"):
                            return "image/jpeg";

                          case 0 !== d.indexOf("89504e47"):
                            return "image/png";

                          case 0 !== d.indexOf("474946"):
                            return "image/gif";
                        }
                    }(), c.resolve(g);
                }, d.readAsArrayBuffer(a), c.promise();
            }, d.fileSize = function(b) {
                var c, d, e, f;
                for (e = [ "", "K", "M" ], c = 0, d = e.length; c < d && (f = e[c], b >= 1024); c++) b /= 1024;
                return a.format(b.toFixed(2)) + " " + f + "B";
            }, d.delayTime = function(b) {
                return b = "" + b, a.padding(b.slice(0, -3)) + ":" + a.padding(b.slice(-3), 3);
            }, d.prototype.delay = 125, d.prototype.frames = [], d.prototype.maxFrame = 150, 
            d.prototype.maxFileSize = 8388608, d.prototype.maxTotalFileSize = 31457280, d.prototype.validate = function() {
                var a, b, c, d, e, f, g, h, i;
                if (a = !1, this.frames.length <= 1) null != (f = this.frames[0]) && (f.fail_file_size = this.frames[0].file.size > this.maxFileSize), 
                a = !0; else {
                    for (g = this.frames, c = d = 0, e = g.length; d < e; c = ++d) b = g[c], 0 === c && (i = b.file.type, 
                    h = b.width + "," + b.height), b.fail_type = !(b.file.type === i), b.fail_size = !(b.width + "," + b.height === h), 
                    b.fail_file_size = b.file.size > this.maxFileSize, (b.fail_type || b.fail_size || b.fail_file_size) && (a = !0);
                    this.totalFileSize > this.maxTotalFileSize && (a = !0);
                }
                return this.container[a ? "addClass" : "removeClass"]("has-error"), this.fail = a;
            }, d.prototype.open = function() {
                return a.ui.modal.push("._spinner-modal", {
                    block: !0,
                    esc: !1
                }), c.get["jquery-ui"]().then(function(c) {
                    return function() {
                        a.ui.modal.pop(), b("body").append(c.container = b(a.template("ugoku-illust-upload-modal", {
                            re_upload: c.reUpload
                        }))).addClass("_dark-modal"), c.itemsContainer = b(".items", c.container), a.ui.modal.push(c.container, {
                            block: !0,
                            esc: !1
                        }), c.watch();
                    };
                }(this));
            }, d.prototype.close = function() {
                window.confirm(a.t("編集内容は保存されません。投稿を中止しますか？")) && window.location.reload();
            }, d.prototype.watch = function() {
                a.d.on("change", ".delay-bar", function(a) {
                    return function(c) {
                        var d;
                        d = c.currentTarget.value, b(".delay-value").val(d), b(".update-delay").prop("disabled", !a.validateDelayValue(d));
                    };
                }(this)).on("change blur", ".delay-value", function(a) {
                    return function(c) {
                        var d, e;
                        e = c.currentTarget.value, d = a.validateDelayValue(e), b(".update-delay").prop("disabled", !d), 
                        d && b(".delay-bar").val(e);
                    };
                }(this)).on("click", ".update-delay", function(a) {
                    return function() {
                        return a.updateDelay(), !1;
                    };
                }(this)), this.container.on("click", ".select-all", function(a) {
                    return function() {
                        a.select(b(".item", a.itemsContainer));
                    };
                }(this)).on("click", ".select-none", function(a) {
                    return function() {
                        a.unselect(b(".item", a.itemsContainer));
                    };
                }(this)).on("click", ".add-item", function(a) {
                    return function() {
                        var b;
                        null != (b = a.preview) && b.player.pause(), a.input.click();
                    };
                }(this)).on("click", ".open-delay-modal", function(a) {
                    return function(c) {
                        var d, e, f;
                        null != (e = a.preview) && e.player.pause(), f = b(c.currentTarget), (d = f.closest(".item")).length && a.select(d), 
                        a.openDelayModal();
                    };
                }(this)).on("click", ".remove", function(a) {
                    return function() {
                        var b;
                        null != (b = a.preview) && b.player.pause(), a.remove();
                    };
                }(this)).on("click", ".close", function(a) {
                    return function() {
                        var b;
                        null != (b = a.preview) && b.player.pause(), a.close();
                    };
                }(this)).on("click", ".upload", function(a) {
                    return function() {
                        var b;
                        null != (b = a.preview) && b.player.pause(), a.upload();
                    };
                }(this)).selectable({
                    appendTo: this.container,
                    filter: ".item",
                    cancel: ".player, .control-item, .file-name, .delay, ._action-button, ._control-button"
                }).on("selectableselecting", function(a) {
                    return function(b, c) {
                        a.select(c.selecting);
                    };
                }(this)).on("selectableunselecting", function(a) {
                    return function(b, c) {
                        a.unselect(c.unselecting);
                    };
                }(this)), this.itemsContainer.sortable({
                    handle: ".file-name"
                }).on("sortstart", function(a) {
                    return function(c, d) {
                        var e;
                        a.startIndex = b(".item", a.itemsContainer).index(d.item), null != (e = a.preview) && e.player.pause();
                    };
                }(this)).on("sortupdate", b.proxy(this.update, this)), b("._range-modal").on("uimodalopen", function() {
                    return a.ui.shortcut.pause("DELETE");
                }).on("uimodalclose", function() {
                    return a.ui.shortcut.restart("DELETE");
                }), a.w.on("resize", function(a) {
                    return function() {
                        return a.resize();
                    };
                }(this)), a.ui.shortcut.bind("DELETE", function(a) {
                    return function() {
                        return b(".remove", a.container).click(), !1;
                    };
                }(this));
            }, d.prototype.resize = function() {
                var a, c, d, e, f;
                a = b(".content", this.container), f = a.width(), c = f - 15 - 14, d = b(".item", this.itemsContainer).length, 
                e = Math.floor(c / 167), this.itemsContainer.css("margin-left", (c - 167 * e) / 2), 
                f > 810 ? b(".header", this.container).css({
                    position: "",
                    marginTop: ""
                }).find(".wrapper").width(f) : b(".header", this.container).css({
                    position: "static",
                    marginTop: -44
                }).find(".wrapper").width("");
            }, d.prototype.select = function(a) {
                b(a).addClass("selected ui-selected"), this.updateState();
            }, d.prototype.unselect = function(a) {
                b(a).removeClass("selected ui-selected"), this.updateState();
            }, d.prototype.updateState = function() {
                var a, d, e, f, g, h;
                for (b(".context-actions ._action-button", this.container).prop("disabled", !this.selected().length), 
                b(".upload", this.container).prop("disabled", 0 === b(".item", this.itemsContainer).length || this.fail), 
                b(".add-item", this.container).prop("disabled", this.frames.length >= this.maxFrame), 
                b(".total-frames .value", this.container).text(this.frames.length), d = 0, a = 0, 
                h = this.frames, f = 0, g = h.length; f < g; f++) e = h[f], d += e.delay, a += e.file.size;
                b(".resolution", this.container).text(this.frames[0].width + " x " + this.frames[0].height), 
                b(".total-delay", this.container).text(c.UgokuIllustUploader.delayTime(d)), b(".total-bytes", this.container).text(c.UgokuIllustUploader.fileSize(a)).removeClass("error");
            }, d.prototype.selected = function(a) {
                var c, d;
                return d = b(".item", this.itemsContainer), a || (a = d.filter(".selected")), c = [], 
                a.each(function(a) {
                    return function(a, b) {
                        c.push(d.index(b));
                    };
                }(this)), {
                    elements: a,
                    indexes: c,
                    length: c.length
                };
            }, d.prototype.upload = function() {
                var d, e, f, g, h;
                if (window.confirm([ a.t("アップロードして情報入力画面に進みますか？"), a.t("アップロードには時間が掛かることがあります。") ].join("\n"))) {
                    for (d = new FormData(), d.append("mode", this.reUpload ? "re_upload_multi" : "upload_multi"), 
                    h = this.frames, f = 0, g = h.length; f < g; f++) e = h[f], d.append("files[]", e.file), 
                    d.append("delays[]", e.delay);
                    a.ui.modal.push("._progress-modal", {
                        block: !0,
                        esc: !1
                    }), c.api.post("/ugoira_upload.php", d, {
                        ajaxSettings: {
                            timeout: 0,
                            xhr: function(a) {
                                return function() {
                                    var c;
                                    return c = new XMLHttpRequest(), c.upload.addEventListener("progress", b.proxy(a.progress, a), !1), 
                                    c;
                                };
                            }(this)
                        }
                    }).then(function(d) {
                        return function(e) {
                            var f, g;
                            return e = e.body, d.reUpload ? (a.ui.modal.pop(), a.ui.modal.push("._spinner-modal", {
                                block: !0,
                                esc: !1
                            }), f = b.Deferred(), (g = function() {
                                var a;
                                a = window.setTimeout(function() {
                                    return c.api.get("/ugoira_upload.php", {
                                        mode: "poll",
                                        token: e.token,
                                        convert_key: e.convert_key
                                    }).done(function(b) {
                                        switch (b.body.status) {
                                          case "COMPLETE":
                                            f.resolve(e);
                                            break;

                                          case "RUNNING":
                                            window.clearTimeout(a), g();
                                            break;

                                          default:
                                            f.reject();
                                        }
                                    }).fail(function() {
                                        f.reject();
                                    });
                                }, 1e3);
                            })(), f.promise()) : e;
                        };
                    }(this)).done(function(a) {
                        return function(d) {
                            b('<form method="POST" action="' + location.pathname + '">\n  <input name="tt" value="' + c.context.token + '">\n  <input name="mode" value="' + (a.reUpload ? "re_upload_move" : "form") + '">\n  <input name="token" value="' + d.token + '">\n\n  <input name="illust_id" value="' + c.context.queries.illust_id + '">\n  <input name="convert_key" value="' + d.convert_key + '">\n</form>').appendTo("body").submit();
                        };
                    }(this)).fail(function(b, c, d) {
                        window.alert(d || a.t("アップロードに失敗しました")), a.ui.modal.pop();
                    });
                }
            }, d.prototype.progress = function(a) {
                a.lengthComputable && b("._progress-modal progress").attr({
                    value: a.loaded,
                    max: a.total
                });
            }, d.prototype.add = function() {
                var d, e, f, g, h, i, j, k, l, m, n;
                for (f = this.input[0].files, e = Math.min(f.length, this.maxFrame - this.frames.length), 
                m = b("._progress-modal"), l = a.ui.modal.push(m, {
                    block: !0,
                    esc: !1
                }), k = b("progress", m), k[0].max = e, h = new Array(e), d = [], g = function(a) {
                    return function(e, f) {
                        var g, i;
                        g = b.Deferred(), i = new FileReader(), i.onload = function(b) {
                            var d, i;
                            i = a.latestDelay(), d = b.target.result, h[f] = {
                                file: e,
                                delay: i,
                                delay_text: c.UgokuIllustUploader.delayTime(i),
                                image: d,
                                file_size_text: c.UgokuIllustUploader.fileSize(e.size)
                            }, c.UgokuIllustUploader.imageType(e).done(function(a) {
                                var b;
                                h[f].type = a, b = new Image(), b.onload = function() {
                                    h[f].width = b.width, h[f].height = b.height, k[0].value += 1, g.resolve();
                                }, b.src = d;
                            });
                        }, d[f] = g.promise(), i.readAsDataURL(e);
                    };
                }(this), i = j = 0, n = e; 0 <= n ? j < n : j > n; i = 0 <= n ? ++j : --j) g(f[i], i);
                return b.when.apply(null, d).done(function(c) {
                    return function() {
                        var d, f, g, i;
                        for (a.ui.modal.close(l), c.frames = c.frames.concat(h), c.totalFileSize = 0, c.totalDelay = 0, 
                        i = c.frames, f = 0, g = i.length; f < g; f++) d = i[f], c.totalFileSize += d.file.size, 
                        c.totalDelay += d.delay;
                        c.validate(), c.itemsContainer.append(b(a.template("ugoku-illust-file-items", {
                            items: c.frames.slice(e * -1)
                        }))), b(".select-none", c.container).click(), c.input.val(""), c.fail ? c.showError() : c.updatePreview();
                    };
                }(this));
            }, d.prototype.updatePreview = function() {
                var a;
                null == this.preview && (this.preview = new c.UgokuIllustPreview("._ugoku-illust-player-container")), 
                this.preview.update({
                    mime_type: this.frames[0].type,
                    size: [ this.frames[0].width, this.frames[0].height ],
                    file_size: this.totalFileSize,
                    delay: this.totalDelay,
                    frames: function() {
                        var b, c, d, e;
                        for (d = this.frames, e = [], b = 0, c = d.length; b < c; b++) a = d[b], e.push({
                            file: a.image,
                            delay: a.delay
                        });
                        return e;
                    }.call(this)
                }), this.resize();
            }, d.prototype.showError = function() {
                var a, c, d, e, f, g, h, i, j, k, l, m, n;
                for (b("._ugoku-illust-upload-modal .item").removeClass("current"), d = b(".error-fail-length", this.container), 
                j = b(".error-fail-type", this.container), f = b(".error-fail-size", this.container), 
                c = b(".error-fail-file-size", this.container), h = b(".error-fail-file-size-total", this.container), 
                i = !1, e = !1, a = !1, n = this.frames, l = 0, m = n.length; l < m; l++) k = n[l], 
                k.fail_type && (i = !0), k.fail_size && (e = !0), k.fail_file_size && (a = !0);
                g = this.totalFileSize > this.maxTotalFileSize, d[this.frames.length <= 1 ? "show" : "hide"](), 
                j[i ? "show" : "hide"](), f[e ? "show" : "hide"](), c[a ? "show" : "hide"](), h[g ? "show" : "hide"](), 
                b(".total-bytes", this.container)[g ? "addClass" : "removeClass"]("error"), this.resize();
            }, d.prototype.remove = function() {
                var b, c, d, e, f, g, h;
                if (h = this.selected(), f = h.length, f && window.confirm(a.t("選択したフレームを削除しますか？"))) {
                    for (;f--; ) c = h.indexes[f], this.frames.splice(c, 1);
                    for (h.elements.remove(), this.totalFileSize = 0, this.totalDelay = 0, g = this.frames, 
                    d = 0, e = g.length; d < e; d++) b = g[d], this.totalFileSize += b.file.size, this.totalDelay += b.delay;
                    this.validate(), this.updateState(), this.fail ? this.showError() : this.updatePreview();
                }
            }, d.prototype.update = function(a, c) {
                var d, e;
                e = b(".item", this.itemsContainer).index(c.item), d = this.frames.splice(this.startIndex, 1), 
                this.frames.splice(e, 0, d[0]), this.fail ? this.showError() : this.updatePreview();
            }, d.prototype.openDelayModal = function(c) {
                var d;
                this.delayModalId = a.ui.modal.push("._range-modal", {
                    block: !0
                }), c || (c = (null != (d = this.frames[this.selected().indexes.slice(-1)]) ? d.delay : void 0) || this.latestDelay()), 
                b(".delay-bar, .delay-value").val(c);
            }, d.prototype.validateDelayValue = function(a) {
                var c, d, e;
                return a = +a, e = b(".delay-bar"), d = +e.attr("min"), c = +e.attr("max"), !isNaN(a) && a >= d && a <= c;
            }, d.prototype.updateDelay = function() {
                var d, e, f, g, h, i, j, k, l, m;
                if (d = +b(".delay-value").val()) {
                    for (g = this.selected().indexes, h = b(".item", this.itemsContainer), i = 0, k = g.length; i < k; i++) f = g[i], 
                    this.frames[f].delay = d, h.eq(f).find(".delay .value").text(c.UgokuIllustUploader.delayTime(d));
                    for (this.totalDelay = 0, m = this.frames, j = 0, l = m.length; j < l; j++) e = m[j], 
                    this.totalDelay += e.delay;
                    a.ui.modal.close(this.delayModalId), b(".select-none", this.container).click(), 
                    this.fail ? this.showError() : this.updatePreview();
                }
            }, d.prototype.latestDelay = function() {
                var a;
                return (null != (a = this.frames[this.frames.length - 1]) ? a.delay : void 0) || this.delay;
            }, d;
        }();
    }(b);
}.call(this), function() {
    "use strict";
    var a, b, c;
    b = require("jquery"), a = require("colon"), c = require("pixiv"), function(b) {
        return a.ns("pixiv.api", {
            ugokuIllust: function(a, d) {
                return "array" !== b.type(a) && (a = b.makeArray(a)), c.api.get("/rpc/get_ugoira.php", {
                    illust_ids: a.join()
                }, d);
            }
        }), c.UgokuIllustPlayer = function() {
            function d(d, e, f) {
                return this.data = e, this.options = null != f ? f : {}, this.container = b(d), 
                c.UgokuIllustPlayer.supported ? (this.options.autoSize || (this.size = c.UgokuIllustPlayer.size(this.data.size, this.options.maxWidth || this.options.maxSize, this.options.maxHeight || this.options.maxSize)), 
                this.container.on("click.ugokuillustplayer", ".play", function(a) {
                    return function() {
                        return a.play();
                    };
                }(this)).on("click.ugokuillustplayer", ".pause", function(a) {
                    return function() {
                        return a.pause();
                    };
                }(this)).on("click.ugokuillustplayer", ".toggle", function(a) {
                    return function() {
                        return a.toggle();
                    };
                }(this)).on("click.ugokuillustplayer", ".stop", function(a) {
                    return function() {
                        return a.stop();
                    };
                }(this)).addClass("ready"), void (this.options.autoStart && (null != ("undefined" != typeof Promise && null !== Promise ? Promise.resolve : void 0) ? Promise.resolve().then(function(a) {
                    return function() {
                        return a.play();
                    };
                }(this)) : a.async().done(function(a) {
                    return function() {
                        return a.play();
                    };
                }(this))))) : void this.container.addClass("outdated");
            }
            return d.supported = !!(window.File && window.FileReader && window.FormData && window.Uint8Array), 
            d.fullscreen = function() {
                return document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement;
            }, d.data = function(a, c) {
                return b.extend(!0, {
                    src: a.srcs[c]
                }, a);
            }, d.size = function(a, b, c) {
                var d, e, f, g, h, i;
                return null == b && (b = 600), a ? (h = a[0], e = a[1], c || (c = b), g = h / e, 
                d = b / c, g >= d ? (i = Math.min(h, b), f = i / g) : (f = Math.min(e, c), i = f * g), 
                [ i, f ]) : null;
            }, d.prototype.paused = !0, d.prototype.dispose = function() {
                this.container.off(".ugokuillustplayer").removeClass("ready"), b(".player", this.container).empty();
            }, d.prototype.createCanvas = function() {
                return this.canvas = b("<canvas>"), this.options.autoSize || this.canvas.attr({
                    width: this.data.size[0],
                    height: this.data.size[1]
                }).css({
                    width: this.size[0],
                    height: this.size[1]
                }), b(".player", this.container).html(this.canvas), this.canvas[0];
            }, d.prototype.load = function() {
                var a, d;
                this.player || (this.container.addClass("loading"), this.player = new ZipImagePlayer({
                    canvas: this.createCanvas(),
                    source: this.data.src,
                    metadata: this.data,
                    chunkSize: 3e5,
                    loop: this.options.loop !== !1,
                    autoStart: !0,
                    debug: c.development,
                    autosize: this.options.autoSize
                }), a = b(this.player).on("loadingStateChanged", function(a) {
                    return function(d, e) {
                        var f;
                        1 === e && (a.container.removeClass("loading"), a.options.autoSize && (a.size = c.UgokuIllustPlayer.size([ a.canvas[0].width, a.canvas[0].height ], a.options.maxWidth || a.options.maxSize, a.options.maxHeight || a.options.maxSize), 
                        a.canvas.css({
                            width: a.size[0],
                            height: a.size[1]
                        })), (f = a.data.originalSize || c.context.illustSize) && (a.fullscreenSize = c.UgokuIllustPlayer.size(f, 1920, 1080)), 
                        a.fullscreenSize && (a.fullscreenSize[0] > 600 || a.fullscreenSize[1] > 600) ? a.container.on("click", ".full-screen", function() {
                            return a.fullscreen();
                        }) : b(".full-screen", a.container).remove());
                    };
                }(this)), this.options.effect && a.on("frame", function(a) {
                    return function(b, c) {
                        return a.options.effect.call(a, c, a.canvas[0].getContext("2d"));
                    };
                }(this)), null != (d = this.onload) && d.call(this));
            }, d.prototype.fullscreen = function() {
                var d, e, f;
                if (f = this.container.next("._full-screen-container"), f.length && (e = function() {
                    switch (!1) {
                      case !f[0].requestFullscreen:
                        return f[0].requestFullscreen(), !0;

                      case !f[0].webkitRequestFullscreen:
                        return f[0].webkitRequestFullscreen(), !0;

                      case !f[0].mozRequestFullScreen:
                        return f[0].mozRequestFullScreen(), !0;

                      case !f[0].msRequestFullscreen:
                        return f[0].msRequestFullscreen(), !0;

                      default:
                        return !1;
                    }
                }(), this.pause(), e && !a.ua.ie)) return this.fullscreenActive = !0, b("html").addClass("_full-screen"), 
                this.fullscreenPlayer || (d = this.fullscreenSize[0] <= 600 && this.fullscreenSize[1] <= 600 ? this.data : this.options.fullscreenData || c.context.ugokuIllustFullscreenData, 
                d.size = this.fullscreenSize, f.on("click", ".exit-full-screen", function(a) {
                    return function() {
                        return a.exitFullscreen();
                    };
                }(this)), a.d.on("fullscreenchange webkitfullscreenchange mozfullscreenchange MSFullscreenChange", function(a) {
                    return function() {
                        a.fullscreenActive && (document.fullscreenElement || document.webkitFullscreenElement || document.mozFullScreenElement || document.msFullscreenElement ? (null == a.fullscreenPlayer && (a.fullscreenPlayer = new c.UgokuIllustPlayer(b("._ugoku-illust-player-container", f), d, {
                            maxWidth: 1920,
                            maxHeight: 1080
                        })), a.fullscreenPlayer.play(), b(".player", f).css({
                            marginTop: Math.max(window.screen.height / 2 - d.size[1] / 2, 0)
                        })) : a.exitFullscreen());
                    };
                }(this))), !1;
            }, d.prototype.exitFullscreen = function() {
                var a, c;
                if (null != (a = this.fullscreenPlayer) && a.pause(), c = function() {
                    switch (!1) {
                      case !document.exitFullscreen:
                        return document.exitFullscreen(), !0;

                      case !document.webkitExitFullscreen:
                        return document.webkitExitFullscreen(), !0;

                      case !document.mozCancelFullScreen:
                        return document.mozCancelFullScreen(), !0;

                      case !document.msExitFullscreen:
                        return document.msExitFullscreen(), !0;

                      default:
                        return !1;
                    }
                }()) return this.fullscreenActive = !1, b("html").removeClass("_full-screen"), this.play(), 
                !1;
            }, d.prototype.play = function() {
                this.paused = !1, this.container.addClass("playing").removeClass("pausing"), this.player ? this.player.play() : this.load();
            }, d.prototype.pause = function() {
                this.player && (this.paused = !0, this.container.removeClass("playing").addClass("pausing"), 
                this.player.pause());
            }, d.prototype.toggle = function() {
                this.paused ? this.play() : this.pause();
            }, d.prototype.stop = function() {
                this.player && (this.pause(), this.player.rewind());
            }, d;
        }();
    }(b);
}.call(this), function() {
    "use strict";
    var a, b, c;
    b = require("jquery"), c = require("pixiv"), a = require("colon"), function(b) {
        return b(function() {
            c.ui.tooltip.setup();
        }), a.ns("pixiv.ui"), c.ui.tooltip = {
            setup: function() {
                var c;
                this.container = b("#ui-tooltip-container"), this.contentContainer = b(".content", this.container), 
                this.container.length && (c = b(".wrapper", this.container), a.d.on({
                    mouseenter: function(a) {
                        return function(d) {
                            var e, f, g;
                            f = b(d.currentTarget), e = f.dataset(), g = e.tooltip || f.attr("title"), g && (c.attr("class", "wrapper"), 
                            e.tooltipType && c.addClass(e.tooltipType), a.show(f, g));
                        };
                    }(this),
                    "mouseleave mousedown": b.proxy(this.hide, this)
                }, "._ui-tooltip"));
            },
            show: function(c, d, e) {
                c && (c = b(c)), "function" === b.type(d) ? d(this.contentContainer) : this.contentContainer.text(d), 
                this.container.removeClass("_hidden"), a.ui.popupPosition(this.container, c, b.extend(e, {
                    margin: 3,
                    nipple: ".nipple",
                    nippleMargin: 3
                }));
            },
            hide: function() {
                var a;
                null != (a = this.container) && a.addClass("_hidden");
            }
        };
    }(b);
}.call(this), function() {
    "use strict";
    !function(a) {
        var b;
        return b = function() {
            colon.d.on("change", 'input[type="file"]', function(b) {
                var c;
                return c = a(this).closest("form"), a("._button-large", c).prop("disabled", !a('input[type="file"]', c).first().val());
            });
        }, a(function() {
            return colon.dispatcher.connect("/content_upload.php", b).connect("/manga_upload.php", b).connect("/ugoira_upload.php", b).dispatch();
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    var a = function(a, c) {
        function d() {
            this.constructor = a;
        }
        for (var e in c) b.call(c, e) && (a[e] = c[e]);
        return d.prototype = c.prototype, a.prototype = new d(), a.__super__ = c.prototype, 
        a;
    }, b = {}.hasOwnProperty;
    !function(b) {
        return b(function() {
            var a;
            a = function() {
                pixiv.fallback.placeholder.setup("._illust-upload"), pixiv.uploader.setup();
            }, colon.dispatcher.connect("/upload.php", a).connect("/member_illust_mod.php", a).dispatch();
        }), colon.ns("pixiv.uploader", {
            setup: function() {
                var a;
                a = b("._illust-upload"), a.length && (pixiv.uploader.Illust.supported ? new pixiv.uploader.Illust(a) : (colon.h.addClass("_outdated-uploader"), 
                new pixiv.uploader.IllustLegacy(a)));
            },
            imageType: function(a) {
                var c, d;
                return c = b.Deferred(), d = new FileReader(a.slice(0, 10)), d.onload = function(a) {
                    var b, d, e, f, g;
                    for (b = new Uint8Array(a.target.result), d = "", e = f = 0; f <= 4; e = ++f) d += b[e].toString(16);
                    return g = function() {
                        switch (!1) {
                          case 0 !== d.indexOf("ffd8"):
                            return "image/jpeg";

                          case 0 !== d.indexOf("89504e47"):
                            return "image/png";

                          case 0 !== d.indexOf("474946"):
                            return "image/gif";
                        }
                    }(), c.resolve(g);
                }, d.readAsArrayBuffer(a), c.promise();
            },
            imageShape: function(a) {
                var c, d;
                return c = b.Deferred(), d = new Image(), d.onload = function() {
                    return c.resolve([ this.width, this.height ]);
                }, d.src = URL.createObjectURL(a), c.promise();
            },
            fileSize: function(a) {
                var b, c, d, e;
                for (d = [ "", "K", "M" ], b = 0, c = d.length; b < c && (e = d[b], a >= 1024); b++) a /= 1024;
                return colon.format(a.toFixed(2)) + " " + e + "B";
            },
            delayTime: function(a) {
                return a = "" + a, colon.padding(a.slice(0, -3)) + ":" + colon.padding(a.slice(-3), 3);
            }
        }), pixiv.uploader.Illust = function() {
            function a(a, c) {
                this.container = a, this.options = null != c ? c : {}, "manga" === pixiv.context.queries.type && (this.type = "manga"), 
                this.mode = pixiv.context.queries.mode || "upload", this.itemContainer = b(".item-container", this.container), 
                this.itemHeaderContainer = b(".header", this.itemContainer), this.featureContainer = b(".new-feature", this.container), 
                this.failsContainer = b(".fails", this.itemContainer), this.noticesContainer = b(".notices", this.itemContainer), 
                this.chooseContainer = b(".choose-container", this.container), this.bookStyleSwitchContainer = b(".book-style ._ui-switch", this.container), 
                this.typesContainer = b(".types", this.itemContainer), this.propertiesContainer = b(".properties", this.itemContainer), 
                this.currentTypeContainer = b(".current-type", this.itemContainer), this.itemListContainer = b(".items", this.itemContainer), 
                this.input = b(".input", this.itemContainer).one("change", function(a) {
                    return function() {
                        return a.open().done(function() {
                            return a.add();
                        }), !1;
                    };
                }(this)), this.metadataContainer = b(".metadata-container", this.container), new pixiv.uploader.Metadata(this.metadataContainer, this), 
                pixiv.uploader.captcha.createUpdateStatus(this), colon.w.on("beforeunload", function(a) {
                    return function(b) {
                        var c;
                        if (!a.uploading && a.items.length) return c = colon.t("編集内容は保存されません。投稿を中止しますか？"), 
                        b.returnValue = c;
                    };
                }(this)), this.container.on("submit", function() {
                    return !1;
                }).on("click", ".action-submit", function(a) {
                    return function() {
                        return a.upload(), !1;
                    };
                }(this));
            }
            return a.supported = !!(window.File && window.FileReader && window.FormData && window.Uint8Array), 
            a.prototype.type = "illust", a.prototype.book = !1, a.prototype.binding = "rtl", 
            a.prototype.items = [], a.prototype.maxItems = 200, a.prototype.maxFileSize = 8388608, 
            a.prototype.maxPixelSize = 6e7, a.prototype.maxTotalFileSize = 31457280, a.prototype.requestMode = {
                upload: {
                    reqest: "upload",
                    polling: "poll",
                    complete: "move"
                },
                re_upload: {
                    reqest: "re_upload",
                    polling: "poll",
                    complete: "re_upload_move"
                },
                mod: {
                    request: "run_mod",
                    migrate: "migrate",
                    polling: "poll",
                    complete: "migrate_move"
                }
            }, a.prototype.validItem = !1, a.prototype.fails = [], a.prototype.notices = [], 
            a.prototype.open = function() {
                return colon.ui.modal.push("._spinner-modal", {
                    block: !0,
                    esc: !1
                }), pixiv.get["jquery-ui"]().done(function(a) {
                    return function() {
                        colon.ui.modal.pop(), a.watch();
                    };
                }(this));
            }, a.prototype.watch = function() {
                this.container.on("uiswitch", "._ui-switch", function(a) {
                    return function(b, c) {
                        c ? a.bookFormatOn() : a.bookFormatOff();
                    };
                }(this)).on("click", ".direction-rtl", function(a) {
                    return function() {
                        a.ltr();
                    };
                }(this)).on("click", ".direction-ltr", function(a) {
                    return function() {
                        a.rtl();
                    };
                }(this)), this.itemContainer.on("click", ".add-item", function(a) {
                    return function() {
                        return a.input.click(), !1;
                    };
                }(this)).on("click", ".remove", function(a) {
                    return function(c) {
                        return a.remove(b(c.currentTarget).closest(".item")), !1;
                    };
                }(this)), this.itemListContainer.sortable({
                    items: "> .item",
                    cancel: ".remove"
                }).on("sortstart", function(a) {
                    return function(c, d) {
                        a.startIndex = b(".item", a.itemListContainer).index(d.item), a.itemListContainer.addClass("sorting");
                    };
                }(this)).on("sortstop", function(a) {
                    return function(b, c) {
                        a.itemListContainer.removeClass("sorting");
                    };
                }(this)).on("sortupdate", function(a) {
                    return function(b, c) {
                        a.updateOrder(c.item);
                    };
                }(this)), this.input.on("change", function(a) {
                    return function() {
                        return a.add(), !1;
                    };
                }(this)), colon.w.on("resize", function(a) {
                    return function() {
                        a.resize();
                    };
                }(this));
            }, a.prototype.resize = function() {
                var a, b, c, d;
                this.items.length && (this.itemListContainer.attr("style", ""), this.book ? (a = Math.max(970, this.itemListContainer.outerWidth(!0)) - 30, 
                b = 165, c = Math.floor(a / b), c % 2 && (c -= 1), d = "ltr" === this.binding ? "margin-left" : "margin-right", 
                this.itemListContainer.css(d, (a - b * c) / 2)) : (a = Math.max(970, this.itemListContainer.outerWidth(!0)) - 30, 
                b = 170, c = Math.floor(a / b), this.itemListContainer.css("margin-left", (a - b * c) / 2)));
            }, a.prototype.select = function(a) {
                b(a).addClass("selected ui-selected"), this.updateState();
            }, a.prototype.unselect = function(a) {
                b(a).removeClass("selected ui-selected"), this.updateState();
            }, a.prototype.selected = function(a) {
                var c, d;
                return d = b(".item", this.itemListContainer), a || (a = d.filter(".selected")), 
                c = [], a.each(function(a) {
                    return function(a, b) {
                        c.push(d.index(b));
                    };
                }(this)), {
                    elements: a,
                    indexes: c,
                    length: c.length
                };
            }, a.prototype.updateOrder = function(a) {
                var c;
                c = b(".item", this.itemListContainer).index(a), a = this.items.splice(this.startIndex, 1), 
                this.items.splice(c, 0, a[0]);
            }, a.prototype.updateState = function() {
                var a, c, d, e, f, g, h, i, j, k, l, m, n, o, p, q;
                for (this.resize(), l = this.items.length, a = b(".total-items .value", this.container), 
                i = +a.text(), a.text(l), o = 0, m = this.items, g = 0, j = m.length; g < j; g++) e = m[g], 
                o += e.file.size;
                if (b(".total-bytes", this.container).text(pixiv.uploader.fileSize(o)), l !== i && (l ? (this.featureContainer.add(this.chooseContainer).addClass("_hidden"), 
                this.typesContainer.slideUp("fast"), this.propertiesContainer.slideDown("fast"), 
                this.currentTypeContainer.addClass(this.type).removeClass("_hidden"), this.itemListContainer.removeClass("_hidden _fade-in").addClass("_fade-in")) : (this.featureContainer.add(this.chooseContainer).removeClass("_hidden _fade-in").addClass("_fade-in"), 
                this.typesContainer.slideDown("fast"), this.propertiesContainer.slideUp("fast"), 
                this.currentTypeContainer.removeClass("illust ugoku-illust manga novel").addClass("_hidden"), 
                this.itemListContainer.addClass("_hidden"), this.validItem = !1), 1 === l ? this.itemListContainer.addClass("single").attr("style", "") : this.itemListContainer.removeClass("single"), 
                l < 2 ? (this.book && this.bookStyleSwitchContainer.click(), this.bookStyleSwitchContainer.addClass("_disabled")) : this.bookStyleSwitchContainer.removeClass("_disabled")), 
                p = !this.fails.length && this.validItem, p && b(".required-item", this.metadataContainer).each(function() {
                    if (!b(this).hasClass("edited")) return p = !1, !1;
                }), b(".action-submit", this.container).prop("disabled", !p), b(".submit-container .notes", this.container).toggleClass("_hidden", p), 
                this.notices.length) for (this.noticesContainer.html(colon.template("illust-upload-notices", {
                    notices: this.notices
                })).removeClass("_hidden"), f = b(".item", this.container), q = b(".item .icon-warning", this.container), 
                n = this.items, d = h = 0, k = n.length; h < k; d = ++h) c = n[d], "image/jpeg" !== c.type ? (q.eq(d).removeClass("_hidden"), 
                f.eq(d).addClass("warning"), f.eq(d).addClass("_ui-tooltip"), f.eq(d).attr("data-tooltip-type", "light"), 
                f.eq(d).attr("data-tooltip", colon.t("JPEGに変換されます"))) : (q.eq(d).addClass("_hidden"), 
                f.eq(d).removeClass("warning"), f.eq(d).removeClass("_ui-tooltip"), f.eq(d).attr("data-tooltip-type", ""), 
                f.eq(d).attr("data-tooltip", "")); else b(".item .icon-warning", this.container).addClass("_hidden"), 
                this.noticesContainer.addClass("_hidden"), b(".item", this.container).removeClass("_ui-tooltip");
                this.fails.length ? this.failsContainer.html(colon.template("illust-upload-fails", {
                    fails: this.fails
                })).removeClass("_hidden") : this.failsContainer.addClass("_hidden"), this.container[this.items.length % 2 ? "removeClass" : "addClass"]("odd");
            }, a.prototype.validateFileType = function(a) {
                return !!/^image\/(?:jpeg|png|gif)$/.test(a) || (colon.ga.trackEvent([ "upload-preview", "pixiv-upload-preview-fail-not-supported-file-type", a ]), 
                !1);
            }, a.prototype.validateFileSize = function(a) {
                return !(a > this.maxFileSize) || (colon.ga.trackEvent([ "upload-preview", "pixiv-upload-preview-fail-over-max-file-size", "file_size", a ]), 
                !1);
            }, a.prototype.validatePixelSize = function(a) {
                return !(a > this.maxPixelSize) || (colon.ga.trackEvent([ "upload-preview", "pixiv-upload-preview-fail-over-max-pixel-size", "num_pixel", a ]), 
                !1);
            }, a.prototype.validateItemAll = function() {
                var a, b, c, d, e, f, g, h, i, j;
                for (this.fails = [], this.notices = [], j = 0, c = !1, i = this.items, e = g = 0, 
                h = i.length; g < h; e = ++g) f = i[e], 0 === e && (a = f.type), f.fails.indexOf("file_size") !== -1 && (b = !0), 
                f.fails.indexOf("pixel_size") !== -1 && (d = !0), f.type !== a && (f.fails.push("file_type"), 
                c = !0), j += f.file.size;
                return c && this.notices.push("file_type"), b && this.fails.push("file_size"), d && this.fails.push("pixel_size"), 
                j > this.maxTotalFileSize && this.fails.push("total_file_size"), !0;
            }, a.prototype.updateFail = function(a) {
                var c, d, e, f, g, h;
                d = b(".item", this.container).removeClass("fail"), c = [];
                for (e in a) h = a[e], g = d.filter(".input-" + e), c.push(g.offset().top), g.addClass("fail"), 
                b(".fail-container", g).text(h);
                f = 0, c.length && (c.sort(), f = c[0] - b(window).innerHeight() / 2), window.setTimeout(function() {
                    pixiv.ui.scroll(f);
                });
            }, a.prototype.upload = function() {
                var a, c, d, e, f, g, h, i, j, k;
                if (d = b(".reserve-checkbox").is(":checked"), d ? (j = b(".reserve-hour").val(), 
                i = b(".reserve-day option:selected").text(), k = colon.t("投稿を予約しますか？\n" + colon.t("この作品は" + i + " " + j + colon.t("に投稿されます。")))) : k = [ colon.t("投稿しますか？"), colon.t("アップロードには時間が掛かることがあります。") ].join("\n"), 
                !this.uploading && window.confirm(k)) {
                    for (this.uploading = !0, c = new FormData(this.container[0]), h = this.items, f = 0, 
                    g = h.length; f < g; f++) e = h[f], c.append("files[]", e.file);
                    colon.ui.modal.push("._progress-modal", {
                        block: !0,
                        esc: !1
                    }), a = pixiv.api.post(this.container.attr("action"), c, {
                        ajaxSettings: {
                            timeout: 0,
                            xhr: function(a) {
                                return function() {
                                    var c;
                                    return c = new XMLHttpRequest(), c.upload.addEventListener("progress", b.proxy(a.progress, a), !1), 
                                    c;
                                };
                            }(this)
                        }
                    }), a.then(function(c) {
                        return function(d) {
                            return "mod" !== c.mode && "reserve_mod" !== c.mode ? a : (d = d.body, d.migrate ? pixiv.api.post("/upload.php", {
                                mode: c.requestMode[c.mode].migrate,
                                illust_id: pixiv.context.workId,
                                illust_type_to: b('input[name="illust_type"]:checked').val()
                            }) : ("reserve_mod" === c.mode ? location.href = "/member_illust.php?mode=reserve" : location.href = "/member_illust.php?mode=medium&illust_id=" + pixiv.context.workId, 
                            b.Deferred().promise()));
                        };
                    }(this)).fail(function(a) {
                        return function(b, c, d) {
                            var e;
                            e = colon.t("エラーが発生しました"), null != b.message && (e += ": " + colon.t(b.message)), 
                            window.alert(e), colon.ui.modal.pop(), a.uploading = !1;
                        };
                    }(this)).then(this.polling).done(b.proxy(this.uploadDone, this)).fail(b.proxy(this.uploadFail, this));
                }
            }, a.prototype.polling = function(a) {
                var c, d;
                return a = a.body, colon.ui.modal.next("._spinner-modal", {
                    block: !0,
                    esc: !1
                }), c = b.Deferred(), (d = function() {
                    var b;
                    b = window.setTimeout(function() {
                        return pixiv.api.get("/upload.php", {
                            mode: "poll",
                            convert_key: a.convert_key
                        }, {
                            cache: !1
                        }).done(function(a) {
                            switch (a.body.status) {
                              case "COMPLETE":
                                c.resolve(a);
                                break;

                              case "RUNNING":
                                window.clearTimeout(b), d();
                                break;

                              default:
                                c.reject();
                            }
                        }).fail(function() {
                            c.reject();
                        });
                    }, 1e3);
                })(), c.promise();
            }, a.prototype.uploadDone = function(a) {
                window._gaq && this.items.length > 1 && (this.notices.length > 0 ? colon.ga.trackEvent([ "upload", "pixiv-upload-multi-with-multi-formats" ]) : colon.ga.trackEvent([ "upload", "pixiv-upload-multi" ])), 
                a = a.body, 1 === a.reserve ? window.setTimeout(function() {
                    return location.href = colon.query.build("/member_illust.php", {
                        mode: "reserve"
                    });
                }, 5e3) : location.href = colon.query.build("/content_upload_fix.php", {
                    i: a.illust_id,
                    t: a.title,
                    r: a.x_restrict,
                    restrict: a.restrict
                });
            }, a.prototype.uploadFail = function(a, b, c) {
                (null != a ? a.body.errors : void 0) ? this.updateFail(a.body.errors) : window.alert(c || colon.t("エラーが発生しました")), 
                colon.ui.modal.pop(), this.uploading = !1, pixiv.uploader.captcha.reset();
            }, a.prototype.addDone = function(a) {
                b(".last", this.itemListContainer).before(colon.template("illust-upload-items", {
                    items: a
                }));
            }, a.prototype.addFail = function(a) {
                var b, c;
                c = a.filter(function(a) {
                    return a.fails.length > 0;
                }), c = c.map(function(a) {
                    var b;
                    return b = a.fails.map(function(b) {
                        return {
                            name: a.file.name,
                            fail_type: b
                        };
                    }), {
                        fails: b
                    };
                }), b = colon.template("illust-upload-fails-message", {
                    fail_files: c
                }), window.alert(b);
            }, a.prototype.add = function() {
                var a, c, d, e, f, g, h, i, j, k, l;
                for (e = this.input[0].files, d = Math.min(e.length, this.maxItems - this.items.length), 
                k = b("._progress-modal"), j = colon.ui.modal.push(k, {
                    block: !0,
                    esc: !1
                }), i = b("progress", k), i[0].max = d, this.validItem = !0, c = [], f = function(a) {
                    return function(d, e) {
                        var f, g;
                        g = void 0, f = b.Deferred(), b.Deferred().resolve().promise().then(function() {
                            var c;
                            return c = b.Deferred(), a.validateFileSize(d.size) ? c.resolve() : c.reject("file_size"), 
                            c.promise();
                        }).then(function() {
                            return pixiv.uploader.imageType(d);
                        }).then(function(c) {
                            var d;
                            return g = c, d = b.Deferred(), a.validateFileType(c) ? d.resolve(c) : d.reject("file_type"), 
                            d.promise();
                        }).then(function() {
                            return pixiv.uploader.imageShape(d);
                        }).then(function(c) {
                            var e, f;
                            return f = b.Deferred(), e = c[0] * c[1], a.validatePixelSize(e) ? (f.resolve(), 
                            i[0].value += d.size) : f.reject("pixel_size"), f.promise();
                        }).then(function() {
                            return f.resolve({
                                file: d,
                                image: URL.createObjectURL(d),
                                type: g,
                                fails: []
                            });
                        }).fail(function(a) {
                            return f.reject({
                                file: d,
                                image: null,
                                type: null,
                                fails: [ a ]
                            });
                        }), c[e] = f.promise();
                    };
                }(this), g = h = 0, l = d; 0 <= l ? h < l : h > l; g = 0 <= l ? ++h : --h) f(e[g], g);
                a = b.when.apply(null, c), a.then(function(c) {
                    return function() {
                        return c.items = c.items.concat(b.makeArray(arguments)), c.validateItemAll() ? a : b.Deferred().reject(c.items);
                    };
                }(this)).done(function(a) {
                    return function() {
                        a.addDone(b.makeArray(arguments));
                    };
                }(this)).fail(function(a) {
                    return function() {
                        a.addFail(b.makeArray(arguments));
                    };
                }(this)).always(function(a) {
                    return function() {
                        colon.ui.modal.close(j), a.input.val(""), a.updateState();
                    };
                }(this));
            }, a.prototype.remove = function(a) {
                var c;
                window.confirm(colon.t("画像を削除しますか？")) && (c = b(".item", this.itemListContainer).index(a), 
                c !== -1 && this.items.splice(c, 1), b(a).remove(), this.validateItemAll(), this.updateState());
            }, a.prototype.bookFormatOn = function() {
                this.book = !0, this.container.addClass("book-style-on"), this[this.binding](), 
                this.resize(), b("#book_style").val(1);
            }, a.prototype.bookFormatOff = function() {
                this.book = !1, this.container.removeClass("book-style-on rtl ltr"), this.itemListContainer.removeClass("_fade-in"), 
                window.setTimeout(function(a) {
                    return function() {
                        return a.itemListContainer.addClass("_fade-in");
                    };
                }(this)), this.resize(), b("#book_style").val(0);
            }, a.prototype.rtl = function() {
                this.binding = "rtl", this.container.removeClass("ltr").addClass("rtl"), this.itemListContainer.removeClass("_fade-in"), 
                window.setTimeout(function(a) {
                    return function() {
                        return a.itemListContainer.addClass("_fade-in");
                    };
                }(this)), this.resize(), b("#book_style").val(1);
            }, a.prototype.ltr = function() {
                this.binding = "ltr", this.container.removeClass("rtl _fade-in").addClass("ltr"), 
                this.itemListContainer.removeClass("_fade-in"), window.setTimeout(function(a) {
                    return function() {
                        return a.itemListContainer.addClass("_fade-in");
                    };
                }(this)), this.resize(), b("#book_style").val(2);
            }, a;
        }(), pixiv.uploader.IllustLegacy = function(c) {
            function d(a, c) {
                d.__super__.constructor.call(this, a, c), b(".hint-illust-1, .hint-manga-1, .hint-manga-2, .total-files", this.container).addClass("_disabled"), 
                this.input.attr("name", "files[]"), this.container.append('<input type="hidden" name="text" value="1">'), 
                b(".wrapper", this.chooseContainer).removeClass("_ui-tooltip");
            }
            return a(d, c), d.prototype.open = function() {
                return colon.async().done(function(a) {
                    return function() {
                        a.watch();
                    };
                }(this));
            }, d.prototype.watch = function() {
                this.input.on("change", function(a) {
                    return function() {
                        return a.add(), !1;
                    };
                }(this)), colon.w.on("resize", function(a) {
                    return function() {
                        a.resize();
                    };
                }(this));
            }, d.prototype.updateState = function() {
                var a;
                this.resize(), a = !0, b(".required-item", this.metadataContainer).each(function() {
                    if (!b(this).hasClass("edited")) return a = !1, !1;
                }), b(".action-submit", this.container).prop("disabled", !a), b(".submit-container .notes", this.container).toggleClass("_hidden", a);
            }, d.prototype.upload = function() {
                var a;
                !this.uploading && window.confirm([ colon.t("投稿しますか？"), colon.t("アップロードには時間が掛かることがあります。") ].join("\n")) && (this.uploading = !0, 
                colon.ui.modal.push("._progress-modal", {
                    block: !0,
                    esc: !1
                }), a = pixiv.fallback.post(this.container), a.then(function(c) {
                    return function(d) {
                        return "mod" !== c.mode ? a : (d = d.body, d.migrate ? pixiv.api.post("/upload.php", {
                            mode: c.requestMode[c.mode].migrate,
                            illust_id: pixiv.context.workId,
                            illust_type_to: b('input[name="illust_type"]:checked').val()
                        }) : (location.href = "/member_illust.php?mode=medium&illust_id=" + pixiv.context.workId, 
                        b.Deferred().promise()));
                    };
                }(this)).fail(function(a) {
                    return function(b, c, d) {
                        (null != b ? b.body.errors : void 0) ? a.updateFail(b.body.errors) : window.alert(colon.t("エラーが発生しました")), 
                        colon.ui.modal.pop(), a.uploading = !1, pixiv.uploader.captcha.reset();
                    };
                }(this)).then(this.polling).done(b.proxy(this.uploadDone, this)).fail(b.proxy(this.uploadFail, this)));
            }, d.prototype.add = function() {
                this.updateState(), b("._choose-file-button ._icon-text", this.chooseContainer).text(this.input.val().replace(/^.*[\/\\](.+)$/, "$1"));
            }, d;
        }(pixiv.uploader.Illust), pixiv.uploader.Metadata = function() {
            function a(a, c) {
                this.uploader = c, this.container = b(a), this.watch();
            }
            return a.prototype.maxToolItems = 3, a.prototype.imageResponseItems = [], a.prototype.maxImageResponseItems = 5, 
            a.prototype.boothAdConfig = {
                terminateWords: "booth.pm".split(" "),
                pickupWords: "dmm dlsite digiket melonbooks getchu gyutto toranoana alice-books 頒布 販売 新刊 委託 コミックマーケット circle.ms".split(" ")
            }, a.prototype.watch = function() {
                this.tagContainer = b("._ui-tag", this.container), this.recommendedTagsContainer = b(".recommended-tags", this.container), 
                this.toolsContainer = b(".tools", this.container), this.answersContainer = b(".answers", this.container), 
                this.imageResponseUrlContainer = b(".input-image-response-url", this.container), 
                this.imageResponseContainer = b(".image-response-container", this.container), this.imageResponseFailContainer = b(".image-response-fail", this.container), 
                this.imageResponseItemsContainer = b(".image-response-items", this.container), this.imageResponsePreviewContainer = b(".image-response-preview", this.container), 
                this.imageResponseCountContainer = b(".image-response-container .count", this.container), 
                this.reserveCheckboxBox = b(".reserve-checkbox", this.container), this.reserveDateContainers = b(".reserve-container select", this.container), 
                this.nonPremiumReserveDateContainer = b(".input-reserve-non-premium", this.container), 
                this.container.on("click", ".input-reserve-non-premium", function(a) {
                    return function(a) {
                        window.open("/premium.php?ref=creators_reserve");
                    };
                }(this)).on("change", ".reserve-checkbox", function(a) {
                    return function(b) {
                        var c;
                        c = a.reserveCheckboxBox.prop("checked"), c ? a.reserveDateContainers.prop("disabled", !1) : a.reserveDateContainers.prop("disabled", !0);
                    };
                }(this)).on("click", ".recommended-tags li", function(a) {
                    return function(b) {
                        a.toggleTag(b.currentTarget);
                    };
                }(this)).on("uitagupdate", "._ui-tag", function(a) {
                    return function(b, c) {
                        a.updateTags(c);
                    };
                }(this)).on("click", ".action-add-tool", function(a) {
                    return function(c) {
                        var d;
                        d = b(".input", c.currentTarget).val(), d && b(".tool-item[value='" + d + "']", a.container).click(), 
                        a.openTools();
                    };
                }(this)).on("change", "input.tool-item", function(a) {
                    return function(b) {
                        a.updateTool(b.currentTarget);
                    };
                }(this)).on("keyup blur", ".input-image-response-url", colon.debounce(this.previewImageResponse, this, 100)).on("click", ".action-add-image-response", function(a) {
                    return function(c) {
                        a.addImageResponse(b(c.currentTarget).dataset());
                    };
                }(this)).on("click", ".action-remove-image-response", function(a) {
                    return function(c) {
                        a.removeImageResponse(b(c.currentTarget).closest(".image-response-item"));
                    };
                }(this)).on("keyup blur", ".input-question", function(a) {
                    return function(b) {
                        a.changeQuestion(b.currentTarget);
                    };
                }(this)).on("keyup blur", '.input-comment textarea[name="comment"]', colon.debounce(this.showBoothAd, this, 500)).on("uitagupdate keyup", '.required-item input[type="text"]', function(a) {
                    return function(c) {
                        var d;
                        d = b(c.currentTarget), "keyup" === c.type && d.parents(".ui-tag-container").length || (d.closest(".item")[d.val() ? "addClass" : "removeClass"]("edited"), 
                        a.uploader.updateState());
                    };
                }(this)).on("change", ".required-item input", function(a) {
                    return function(c) {
                        var d;
                        d = b(c.currentTarget).closest(".item"), d[b("input:checked", d) ? "addClass" : "removeClass"]("edited"), 
                        a.uploader.updateState();
                    };
                }(this)), this.updateTool();
            }, a.prototype.toggleBoothAd = function(a) {
                return b(".booth-link").toggleClass("_hidden", !a);
            }, a.prototype.showBoothAd = function(a) {
                var c, d, e, f, g, h, i, j;
                for (i = b(a.currentTarget).val(), g = this.boothAdConfig.terminateWords, c = 0, 
                e = g.length; c < e; c++) if (j = g[c], i.indexOf(j) !== -1) return void this.toggleBoothAd(!1);
                for (h = this.boothAdConfig.pickupWords, d = 0, f = h.length; d < f; d++) if (j = h[d], 
                i.indexOf(j) !== -1) return void this.toggleBoothAd(!0);
                return this.toggleBoothAd(!1);
            }, a.prototype.toggleTag = function(a) {
                a = b(a), a.hasClass("selected") ? (this.tagContainer.trigger("uitagremove", [ a.dataset("tag") ]), 
                a.removeClass("selected")) : (this.tagContainer.trigger("uitagadd", [ a.dataset("tag") ]), 
                a.addClass("selected"));
            }, a.prototype.updateTags = function(a) {
                b("li", this.recommendedTagsContainer).each(function() {
                    colon.ui.Tag.find(b("._icon-text", this).text(), a) === -1 ? b(this).removeClass("selected") : b(this).addClass("selected");
                });
            }, a.prototype.openTools = function() {
                this.toolModal = colon.ui.modal.push(this.toolsContainer, {
                    block: !0
                }), this.toolsContainer.one("uimodalclose", function(a) {
                    return function() {
                        a.toolModal = null;
                    };
                }(this));
            }, a.prototype.closeTools = function() {
                this.toolModal && colon.ui.modal.close(this.toolModal);
            }, a.prototype.toggleTools = function() {
                this.toolModal ? this.closeTools() : this.openTools();
            }, a.prototype.updateTool = function(a) {
                var c, d, e, f, g, h, i, j, k, l;
                if (a) for (a = b(a), c = a.prop("checked"), k = a.val(), g = b(".tool .input", this.container), 
                j = b(".tool-preview .input", this.container), d = h = 0; h < 3; d = ++h) if (f = g.eq(d), 
                i = j.eq(d), l = f.val(), c) {
                    if (!l) {
                        f.val(k), i.val(k);
                        break;
                    }
                } else if (k === l) {
                    f.val(""), i.val("");
                    break;
                }
                e = b("input.tool-item", this.container), e.filter(":checked").length >= this.maxToolItems ? (e.not(":checked").prop("disabled", !0), 
                this.closeTools()) : e.prop("disabled", !1);
            }, a.prototype.previewImageResponse = function() {
                var a, c;
                return (c = colon.ui.Tag.trim(this.imageResponseUrlContainer.val())) ? (a = pixiv.api.get("/rpc/get_work.php", {
                    q: c
                }, {
                    cache: !0
                }), a.then(function(c) {
                    return c.body.illust || c.body.novel ? a : b.Deferred().reject(a, null, colon.t("作品が存在しない、または公開条件により指定できません"));
                }).done(function(a) {
                    return function(b) {
                        var c, d, e, f, g, h, i, j;
                        if (b = b.body, d = a.imageResponsePreviewContainer.height(), a.imageResponsePreviewContainer.empty(), 
                        b) {
                            c = 0;
                            for (j in b) if (h = b[j]) for (++c, i = a.imageResponseItems, f = 0, g = i.length; f < g; f++) e = i[f], 
                            e.type !== j || e.id !== h.illust_id && e.id !== h.id || (h.exists = !0);
                            a.imageResponseFailContainer.slideUp("fast"), a.imageResponsePreviewContainer.css({
                                display: "",
                                height: d
                            }).append(colon.template("uploader-image-response-preview-items", b)).animate({
                                height: 51 * c
                            }, "fast");
                        }
                    };
                }(this)).fail(function(a) {
                    return function(c, d, e) {
                        a.imageResponseFailContainer.slideDown("fast").text(e || colon.t("エラーが発生しました")), 
                        a.imageResponsePreviewContainer.slideUp("fast", function() {
                            b(this).empty().height("");
                        });
                    };
                }(this))) : void this.imageResponseFailContainer.slideUp("fast");
            }, a.prototype.addImageResponse = function(a) {
                pixiv.api.get("/rpc/get_work.php", a).always(function(a) {
                    return function() {
                        a.imageResponsePreviewContainer.slideUp("fast", function() {
                            b(this).empty().height("");
                        }), a.imageResponseUrlContainer.val("");
                    };
                }(this)).done(function(c) {
                    return function(d) {
                        var e;
                        d = d.body, d && (c.imageResponseContainer.is(":hidden") && c.imageResponseContainer.slideDown("fast"), 
                        b(colon.template("uploader-image-response-item", d)).prependTo(c.imageResponseItemsContainer).hide().slideDown("fast"), 
                        c.imageResponseItems.push(a), e = c.imageResponseItems.length, e >= c.maxImageResponseItems ? c.imageResponseUrlContainer.slideUp("fast") : c.imageResponseUrlContainer.focus(), 
                        c.imageResponseCountContainer.text(e));
                    };
                }(this));
            }, a.prototype.removeImageResponse = function(a) {
                var c, d, e, f, g, h, i;
                for (a = b(a), d = a.dataset(), f = [], i = this.imageResponseItems, g = 0, h = i.length; g < h; g++) e = i[g], 
                e.type === d.type && e.id === d.id || f.push(e);
                this.imageResponseItems = f, c = f.length, c ? a.slideUp(function() {
                    a.remove();
                }) : this.imageResponseContainer.slideUp("fast", function() {
                    a.remove();
                }), this.imageResponseUrlContainer.is(":hidden") && this.imageResponseUrlContainer.slideDown("fast"), 
                this.imageResponseUrlContainer.focus(), this.imageResponseCountContainer.text(c);
            }, a.prototype.openAnswers = function() {
                this.answersContainer.slideDown("fast");
            }, a.prototype.closeAnswers = function() {
                this.answersContainer.slideUp();
            }, a.prototype.changeQuestion = function(a) {
                a = b(a), a.val() ? this.answersContainer.is(":hidden") && this.openAnswers() : this.answersContainer.is(":visible") && this.closeAnswers();
            }, a;
        }(), colon.ns("pixiv.uploader.captcha", {
            createUpdateStatus: function(a) {
                return window.__recaptchaUpdateStatus = function(c) {
                    c && b(".input-captcha").addClass("edited"), a.updateState();
                };
            },
            reset: function() {
                var a;
                (a = b("img.captcha")).length && a.attr("src", a.data("src") + "?" + +new Date()), 
                "undefined" != typeof grecaptcha && null !== grecaptcha && grecaptcha.reset();
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        return pixiv.UserList = function() {
            function b(b, c) {
                null == c && (c = {}), this.container = a(b), this.listContainer = a(".user-recommendation-items", this.container), 
                this.thumbnailContainer = a("._thumbnail-popup"), this.indicator = new pixiv.LoadingIndicator(this.container), 
                this.autoView = new pixiv.AutoView(".more", c.modal ? {
                    scrollContext: this.container
                } : void 0), this.debounceObject = colon.debounce(this.openThumbnail, this, 200), 
                this.sampleUser = c.sampleUser || pixiv.context.userRecommendSampleUser, this.followingBoosterModel = c.followingBoosterModel || 1, 
                this.container.on({
                    mouseenter: this.debounceObject,
                    mouseleave: a.proxy(this.closeThumbnail, this)
                }, ".action-open-thumbnail"), this.show();
            }
            return b.prototype.offset = 0, b.prototype.sampleUser = null, b.prototype.followingBoosterModel = 1, 
            b.prototype.request = function(b, c, d) {
                return pixiv.api.userRecommendation(b, c, d).then(function(b, c) {
                    var d;
                    return (null != b && null != (d = b.user_ids) ? d.length : void 0) ? a.Deferred().resolveWith(this, arguments) : a.Deferred().rejectWith(this, [ b, c, null != b ? b.error : void 0 ]);
                });
            }, b.prototype.show = function() {
                return this.request(this.sampleUser, 100, this.followingBoosterModel).always(function(a) {
                    return function() {
                        a.indicator.finish(a.indicator);
                    };
                }(this)).done(function(b) {
                    return function(c) {
                        b.data = c, a(colon.template("following-booster-dummy", {
                            user_ids: b.data.user_ids
                        })).appendTo(".user-recommendation-items"), pixiv.scrollView.registerFilter("following-booster-loading", function(a) {
                            var b, c;
                            b = a.dataset(), c = b.user_id, pixiv.followingBooster.replace(c, {
                                user_ids: c,
                                illust_num: 4,
                                get_illust_count: 1
                            }, {});
                        }), pixiv.scrollView.update();
                    };
                }(this)).fail(function(b) {
                    return function(c, d, e) {
                        var f;
                        f = a("._no-item", b.container), f.removeClass("hidden"), e && f.text(e);
                    };
                }(this));
            }, b.prototype.openThumbnail = function(b) {
                var c, d, e, f;
                f = a(b.currentTarget), e = f.offset(), c = f.data(), f.data("canceled", !1), d = new Image(), 
                d.onload = function(b) {
                    return function() {
                        var e, g;
                        f.data("canceled") || (e = Math.min(d.height, 480), g = Math.floor(d.width * e / d.height), 
                        b.thumbnailContainer.removeClass("_hidden").find(".wrapper").css({
                            width: g,
                            height: e,
                            backgroundImage: "url(" + c.src + ")",
                            backgroundSize: g + "px " + e + "px"
                        }), colon.ui.popupPosition(b.thumbnailContainer, f, {
                            nipple: a(".nipple", b.thumbnailContainer)
                        }));
                    };
                }(this), d.src = c.src;
            }, b.prototype.closeThumbnail = function(b) {
                this.debounceObject.cancel(), a(b.currentTarget).data("canceled", !0), this.thumbnailContainer.addClass("_hidden");
            }, b;
        }(), colon.ns("pixiv.followingBooster", {
            request: function(b, c, d) {
                return pixiv.api.userRecommendation(b, c, d).then(function(b, c) {
                    var d;
                    return (null != b && null != (d = b.user_ids) ? d.length : void 0) ? a.Deferred().resolveWith(this, arguments) : a.Deferred().rejectWith(this, [ b, c, null != b ? b.error : void 0 ]);
                });
            },
            replace: function(b, c, d) {
                return pixiv.api.get("/rpc/get_profile.php", c, d).done(function(c) {
                    return function(d, e, f, g) {
                        var h;
                        h = a(".following-booster-" + b), a(colon.template("user-list-items", {
                            premium: !!pixiv.user.premium,
                            items: d.body,
                            relatedUser: h.dataset("related_user")
                        })).insertAfter(h).each(function(b, e) {
                            var f;
                            f = a("._follow-button-container", e).on("follow", function() {
                                c.showRelated(e);
                            }), new pixiv.FollowButton(f, a.extend({
                                premium: !!pixiv.user.premium
                            }, d.body[b]));
                        }), h.remove(), pixiv.scrollView.update();
                    };
                }(this));
            },
            showRelated: function(b) {
                return b = a(b), this.request(b.dataset("id")).done(function(c) {
                    return function(c) {
                        b.after(a(colon.template("following-booster-dummy", {
                            user_ids: c.user_ids,
                            user_name: a(".title", b).text()
                        }))), pixiv.scrollView.registerFilter("following-booster-loading", function(a) {
                            var b;
                            c = a.dataset(), b = c.user_id, pixiv.followingBooster.replace(b, {
                                user_ids: b,
                                illust_num: 4,
                                get_illust_count: 1
                            }, {});
                        }), pixiv.scrollView.update();
                    };
                }(this));
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    !function(a) {
        return pixiv.UserSearch = function() {
            function b(b, c) {
                var d;
                null == c && (c = {}), this.container = a(b), (null != (d = this.container) ? d.length : void 0) > 0 && (this.listContainer = a(".user-recommendation-items", this.container), 
                this.thumbnailContainer = a("._thumbnail-popup"), this.indicator = new pixiv.LoadingIndicator(this.container), 
                this.debounceObject = colon.debounce(this.openThumbnail, this, 200), this.sampleUser = c.sampleUser || pixiv.context.userRecommendSampleUser, 
                this.word = a(".sample-user-search").data().word, this.count = a(".sample-user-search").data().count, 
                this.blt = a(".sample-user-search").data().blt, this.bgt = a(".sample-user-search").data().bgt, 
                this.followingBoosterModel = c.followingBoosterModel || 1, this.container.on({
                    mouseenter: this.debounceObject,
                    mouseleave: a.proxy(this.closeThumbnail, this)
                }, ".action-open-thumbnail"), this.show());
            }
            return b.prototype.offset = 0, b.prototype.sampleUser = null, b.prototype.followingBoosterModel = 1, 
            b.prototype.request = function(b, c, d) {
                return pixiv.api.search.sampleUserSearch(b, c, d).then(function(b, c) {
                    var d;
                    return (null != b && null != (d = b.user_ids) ? d.length : void 0) ? a.Deferred().resolveWith(this, arguments) : a.Deferred().rejectWith(this, [ b, c, null != b ? b.error : void 0 ]);
                });
            }, b.prototype.show = function() {
                var b;
                0 === a(".user-recommendation-items li").length && this.request(this.word, this.count, {
                    blt: this.blt,
                    bgt: this.bgt
                }).always(function(a) {
                    return function() {
                        a.indicator.finish(a.indicator);
                    };
                }(this)).done(function(b) {
                    return function(c) {
                        var d;
                        return b.data = c, d = a(".sample-user-search"), d && d.removeClass("hidden"), a(colon.template("user-search-dummy", {
                            users: b.data.users
                        })).appendTo(".user-recommendation-items"), pixiv.scrollView.update();
                    };
                }(this)).fail(function(b) {
                    return function(c, d, e) {
                        var f;
                        f = a("._no-item", b.container), f.removeClass("hidden"), e && f.text(e);
                    };
                }(this)), pixiv.scrollView.registerFilter("user-search-loading", function(a) {
                    var b, c, d, e;
                    b = a.dataset(), e = b.user_id, d = b.illust_ids, c = b.illust_count, pixiv.userSearch.replace(e, {
                        user_ids: e,
                        illust_num: 4,
                        get_illust_count: 1,
                        static_illust_ids: d,
                        illust_count: c
                    }, {});
                }), pixiv.scrollView.update(), b = a(".more", this.container), b.removeClass("hidden");
            }, b.prototype.openThumbnail = function(b) {
                var c, d, e, f;
                f = a(b.currentTarget), e = f.offset(), c = f.data(), f.data("canceled", !1), d = new Image(), 
                d.onload = function(b) {
                    return function() {
                        var e, g;
                        f.data("canceled") || (e = Math.min(d.height, 480), g = Math.floor(d.width * e / d.height), 
                        b.thumbnailContainer.removeClass("_hidden").find(".wrapper").css({
                            width: g,
                            height: e,
                            backgroundImage: "url(" + c.src + ")",
                            backgroundSize: g + "px " + e + "px"
                        }), colon.ui.popupPosition(b.thumbnailContainer, f, {
                            nipple: a(".nipple", b.thumbnailContainer)
                        }));
                    };
                }(this), d.src = c.src;
            }, b.prototype.closeThumbnail = function(b) {
                this.debounceObject.cancel(), a(b.currentTarget).data("canceled", !0), this.thumbnailContainer.addClass("_hidden");
            }, b;
        }(), colon.ns("pixiv.userSearch", {
            request: function(b, c, d) {
                return pixiv.api.userRecommendation(b, c, d).then(function(b, c) {
                    var d;
                    return (null != b && null != (d = b.user_ids) ? d.length : void 0) ? a.Deferred().resolveWith(this, arguments) : a.Deferred().rejectWith(this, [ b, c, null != b ? b.error : void 0 ]);
                });
            },
            replace: function(b, c, d) {
                return pixiv.api.get("/rpc/get_profile.php", c, d).done(function(c) {
                    return function(d, e, f, g) {
                        var h;
                        h = a(".user-search-" + b), a(colon.template("user-list-items", {
                            premium: !!pixiv.user.premium,
                            items: d.body,
                            word: a(".sample-user-search").data().word,
                            relatedUser: h.dataset("related_user")
                        })).insertAfter(h).each(function(b, e) {
                            var f;
                            f = a("._follow-button-container", e).on("follow", function() {
                                c.showRelated(e);
                            }), new pixiv.FollowButton(f, a.extend({
                                premium: !!pixiv.user.premium
                            }, d.body[b]));
                        }), h.remove(), pixiv.scrollView.update();
                    };
                }(this));
            },
            showRelated: function(b) {
                return b = a(b), this.request(b.dataset("id")).done(function(c) {
                    return function(c) {
                        b.after(a(colon.template("user-search-dummy", {
                            users: c.users,
                            user_name: a(".title", b).text()
                        }))), pixiv.scrollView.registerFilter("user-search-loading", function(a) {
                            var b;
                            c = a.dataset(), b = c.user_id, pixiv.userSearch.replace(b, {
                                user_ids: b,
                                illust_num: 4,
                                get_illust_count: 1
                            }, {});
                        }), pixiv.scrollView.update();
                    };
                }(this));
            }
        });
    }(jQuery);
}.call(this), function() {
    "use strict";
    var a, b, c, d, e;
    a = require("jquery"), b = require("colon"), d = require("pixiv"), c = require("./es_bridge"), 
    e = (null != c ? c : b).throttle, a(function() {
        return d.config.whitecubeEmbed && d.whitecubeHeader.setup(), b.dispatcher.connect(/^(\/whitecube\/|\/contest\/|\/novel\/contest\/)/, function() {
            return d.whitecubeHeader.setup();
        }), b.dispatcher.dispatch();
    }), b.ns("pixiv.whitecubeHeader", {
        setup: function() {
            var c, d, f;
            if (this.prev_position = b.w.scrollTop(), this.header_container = a("._header-container.default"), 
            0 !== this.header_container.length) return this.menu_flags_in_headers = a("._header-container, .tack-to-header").find(".popup-button-focus"), 
            this.initializedBackToTop = !1, d = c = 0, f = 500, this.header_container.data("drawer-length", this.header_container.outerHeight()), 
            a(".tack-to-header").each(function(b) {
                return function(e, g) {
                    var h, i;
                    if (g = a(g), f -= 1, g.data("z-index", f), g.data("stack_order", d), d += g.outerHeight(), 
                    g.hasClass("auto-hide") || (g.data("fixed_stack_order", c), c += g.outerHeight()), 
                    h = b.header_container.data("drawer-length") + g.outerHeight(), b.header_container.data("drawer-length", h), 
                    !g.next().hasClass("tack-to-header-placeholder")) return i = a('<div class="tack-to-header-placeholder"></div>'), 
                    i.height(g.outerHeight()), i.css("margin-top", -g.outerHeight()), g.after(i), g.data("placeholder", i);
                };
            }(this)), b.w.on("scroll.header", function(a) {
                return function() {
                    return a.whitecube_scrolls();
                };
            }(this)).on("scroll.updateBackToTop", e(this.updateBackToTop.bind(this))).trigger("scroll"), 
            a("body").on("click", ".has-sub", function(c) {
                return function(d) {
                    var e, f;
                    if (f = a(d.target), !f.parents(".submenu").length) return f = a(d.currentTarget), 
                    e = f.hasClass("opened"), c.closeMenus(), a(".notification-popup").hide(), e || (f.addClass("opened"), 
                    a("body").on("click.menu", a.proxy(c.closeMenus, c))), b.d.trigger({
                        type: "click",
                        which: 1
                    }), !1;
                };
            }(this)), a(".notification-button").on("click", this.closeMenus), a("body").on("click", "#scroll-to-top", function(b) {
                var c, d, e;
                return b.stopPropagation(), d = a(b.currentTarget), c = d.data("target") || 0, "number" != typeof c && (c = a(c).offset().top), 
                e = a("._work-modal .modal-scroll-wrapper"), e.is(":visible") ? e.stop().animate({
                    scrollTop: 0
                }, 500) : a("html, body").stop().animate({
                    scrollTop: c
                }, 500);
            });
        },
        closeMenus: function() {
            return a(".has-sub").removeClass("opened"), a("body").off("click.menu");
        },
        whitecube_scrolls: function(c) {
            return this.whitecube_scrolls.processing ? void (this.whitecube_scrolls.queued = !0) : (this.whitecube_scrolls.processing = !0, 
            this.whitecube_scrolls.queued = !1, void window.setTimeout(function(d) {
                return function() {
                    var e, f, g, h, i, j, k;
                    if (null == c && (c = b.w.scrollTop()), h = d.header_container.offset().top, g = 0, 
                    f = d.header_container.data("drawer-length"), k = Math.max(c, 0), i = a(".tack-to-header"), 
                    i.each(function(b, c) {
                        var e, f, i, j, l, m, n, o, p;
                        return c = a(c), i = c.offset().top, l = c.data("placeholder"), n = c.data("stack_order"), 
                        j = c.data("fixed_stack_order"), e = c.hasClass("auto-hide"), e ? (f = c.outerHeight(), 
                        o = k > d.prev_position ? k - f > l.offset().top : i > l.offset().top, o ? (m = "fixed", 
                        c.hasClass("tacked") ? (p = parseInt(c.css("top")), p -= k - d.prev_position) : p = -f, 
                        c.addClass("tacked"), p = k > d.prev_position ? Math.max(h - k + n, p) : Math.min(n, p)) : (c.removeClass("tacked"), 
                        m = "", p = "")) : (o = k > d.prev_position ? k + j - g > l.offset().top : k > l.offset().top, 
                        o ? (m = "fixed", c.hasClass("tacked") ? (p = parseInt(c.css("top")), p -= k - d.prev_position) : p = 0, 
                        c.addClass("tacked"), c.css("z-index", c.data("z-index")), k > d.prev_position ? p = Math.max(j - g, p) : (h + g - i > 5 ? p += 1 : p = Math.max(j - g, h - k + n), 
                        p = Math.min(n, p))) : (c.removeClass("tacked"), c.css("z-index", ""), m = "", p = "")), 
                        c.css({
                            position: m,
                            top: p
                        }), !0;
                    }), h <= 0 ? d.header_container.addClass("transparent") : d.header_container.removeClass("transparent"), 
                    d.prev_position = k, j = a(".masthead-background-image, .whitecube-masthead"), e = null, 
                    j.outerHeight() < k ? (clearTimeout(e), e = setTimeout(function() {
                        return a("body").addClass("suppress-bg");
                    }, 100)) : (clearTimeout(e), e = setTimeout(function() {
                        return a("body").removeClass("suppress-bg");
                    }, 100)), d.whitecube_scrolls.processing = !1, d.whitecube_scrolls.queued) return d.whitecube_scrolls();
                };
            }(this)));
        },
        updateBackToTop: function() {
            var a, b;
            return b = require("utils/promise"), null != b ? (a = new b.Immediate(), a.then(this.updateBackToTopSync)) : setTimeout(this.updateBackToTopSync);
        },
        updateBackToTopSync: function() {
            var c, e, f, g, h;
            return h = (null != (e = d.WorkModal) ? e.workModal : void 0) ? d.WorkModal.workModal : a("._work-modal .modal-scroll-wrapper"), 
            h.is(":visible") ? (c = h.scrollTop(), g = window.innerHeight >> 1) : (c = b.w.scrollTop(), 
            g = null != d.whitecubeTimeline && d.whitecubeTimeline.parallax_displacement ? d.whitecubeTimeline.parallax_displacement + (window.innerHeight >> 1) : window.innerHeight >> 1), 
            f = a("#scroll-to-top"), f.toggleClass("active", c >= g);
        }
    });
}.call(this), function() {
    "use strict";
    var a, b, c;
    a = require("jquery"), b = require("colon"), c = require("pixiv"), a(function() {
        c.config.whitecubeEmbed && (c.whitecubeSearch.setup(), c.whitecubeSearchHistory.setup()), 
        b.dispatcher.connect(/^(\/whitecube\/|\/contest\/|\/novel\/contest\/)/, function() {
            c.whitecubeSearch.setup(), c.whitecubeSearchHistory.setup();
        }).dispatch(), b.dispatcher.connect(/\/whitecube\/search\/.*/, function() {
            c.whitecubeSearchHistory.saveQuery();
        }).dispatch();
    }), b.ns("pixiv.whitecubeSearchHistory", {
        setup: function() {
            if (c.user.id && "undefined" == typeof this.storage_key_name) return this.storage_key_name = "whitecube_search_history" + c.user.id, 
            this.limit = 10;
        },
        saveQuery: function() {
            var a, b;
            try {
                if (b = c.whitecubeSearch.getKeywords().join(" "), b.length) return this.addHistory(b);
            } catch (b) {
                a = b;
            }
        },
        addHistory: function(a) {
            var c, d;
            if (null != this.storage_key_name) return d = b.storage.localStorage(this.storage_key_name), 
            d || (d = []), c = d.indexOf(a), c !== -1 && d.splice(c, 1), d.push(a), d.length > this.limit && d.shift(), 
            b.storage.localStorage(this.storage_key_name, d);
        },
        getHistory: function() {
            var a;
            return null == this.storage_key_name ? [] : (a = b.storage.localStorage(this.storage_key_name), 
            a || (a = []), a);
        },
        removeHistory: function(a) {
            var c, d, e;
            null != this.storage_key_name && (c = b.storage.localStorage(this.storage_key_name), 
            c && (e = a.text(), d = c.indexOf(e), d !== -1 && (c.splice(d, 1), b.storage.localStorage(this.storage_key_name, c), 
            a.parent().remove())));
        },
        clearHistory: function() {
            if (null != this.storage_key_name) return b.storage.localStorage(this.storage_key_name, []);
        }
    }), b.ns("pixiv.whitecubeSearch", {
        logger: b.logger("pixiv.whitecubeSearch"),
        setup: function() {
            this.searchBarContainer = a("._header-container"), this.searchBar = this.searchBarContainer.find(".header"), 
            this.searchBar.length && (this.searchForm = this.searchBar.find("form.search"), 
            this.searchInput = this.searchBar.find("input.find"), this.searchKeywords = this.searchBar.find("ul.keywords"), 
            this.actionButtons = this.searchBar.find("div.actions"), this.clearSearchButton = this.searchBar.find("button.remove-keywords"), 
            this.searchBaseUrl = this.searchForm.attr("action"), this.searchBar.on("keypress", "input.find", function(a) {
                return function(b) {
                    if (13 === b.which) return !a.applySelectedSuggestion() && a.addKeyword();
                };
            }(this)), this.searchBar.on("keyup", "input.find", function(a) {
                return function(b) {
                    var c;
                    return 13 === b.which ? !a.applySelectedSuggestion() : 38 !== b.which && 40 !== b.which && (c = a.searchInput.val(), 
                    0 === c.length ? (a.searchInput.addClass("empty"), a.searchSuggestions.find(".suggest.tag ul.items").html(""), 
                    a.toggleSuggestions()) : a.searchInput.removeClass("empty"), a.searchInput.hasClass("empty") || a.suggest(c), 
                    void a.clearSearchButton.toggleClass("_hidden", c.length <= 0));
                };
            }(this)), this.searchBar.on("keydown", "input.find", function(a) {
                return function(b) {
                    return 40 === b.which || 38 === b.which ? (a.cycleSuggestions(b), !0) : 27 === b.which ? (a.searchInput.blur(), 
                    !0) : void 0;
                };
            }(this)), this.searchBar.on("focus", "input.find", function(a) {
                return function(b) {
                    if (a.fetchAndAppendTrendTags(), a.searchKeywords.children().length > 0) return a.editingMode();
                };
            }(this)), this.searchBar.on("click", "button.remove-keywords", function(a) {
                return function(b) {
                    a.removeAllKeyword(), a.keywords = [], a.searchInput.val(""), a.clearSearchButton.addClass("_hidden"), 
                    a.actionButtons.find(".saved-search").remove();
                };
            }(this)), this.searchKeywords.on("click", "li", function(b) {
                return function(c) {
                    var d, e;
                    return e = a(c.currentTarget), d = e.text().trim(), b.editingMode(), setTimeout(function() {
                        var a;
                        return a = b.searchInput.val().indexOf(d) + d.length, b.searchInput[0].selectionStart = a, 
                        b.searchInput[0].selectionEnd = a;
                    }, 10), b.searchInput.focus();
                };
            }(this)), this.searchKeywords.on("click", "li .close", function(b) {
                return function(c) {
                    var d, e;
                    return e = a(c.target), d = e.parents("li"), b.removeKeyword(d), !1;
                };
            }(this)), this.searchForm.on("submit", a.proxy(this.beforeSubmit, this)), this.alignKeywords(), 
            this.clearSearchButton.toggleClass("_hidden", this.searchKeywords.children().length <= 0), 
            this.searchSuggestions = this.searchBar.find(".suggestions"), this.searchBar.on("focus", "input.find", function(a) {
                return function() {
                    var b;
                    return b = a.searchInput.val(), a.suggest(b), a.searchSuggestions.width(a.searchInput.innerWidth()), 
                    a.searchBarContainer.addClass("active");
                };
            }(this)), this.searchSuggestions.on("mousedown", function(a) {
                a.preventDefault();
            }), this.hideSuggestionTimeout = null, this.searchBar.on("blur", "input.find", function(a) {
                return function() {
                    return a.hideSuggestionTimeout = setTimeout(function() {
                        return a.clearSuggestions(), a.searchSuggestions.find(".suggest").removeClass("active");
                    }, 200), a.searchSuggestions.removeClass("active"), a.searchBarContainer.removeClass("active");
                };
            }(this)), this.searchSuggestions.on("click", ".suggest.tag .items > li", a.proxy(this.applySuggestedTag, this)), 
            this.searchSuggestions.on("click", ".suggest.history .items .keyword", a.proxy(this.applyHistryTag, this)), 
            this.searchSuggestions.on("click", ".suggest.trend-tag-section .items > li", a.proxy(this.applyTrendTag, this)), 
            this.searchSuggestions.on("click", ".suggest.history .items .remove-keyword", function(b) {
                return function(d) {
                    var e, f;
                    d.preventDefault(), f = a(d.currentTarget).siblings(".keyword"), c.whitecubeSearchHistory.removeHistory(f), 
                    e = c.whitecubeSearchHistory.getHistory(), 0 === e.length && (b.suggest(""), clearTimeout(b.hideSuggestionTimeout), 
                    b.searchInput.focus().trigger("keyup"));
                };
            }(this)), this.searchSuggestions.on("click", ".suggest.history .clear-history", function(a) {
                return function() {
                    confirm(b.t("検索履歴をクリアしますか？")) && (c.whitecubeSearchHistory.clearHistory(), a.suggest(""), 
                    clearTimeout(a.hideSuggestionTimeout), a.searchInput.focus().trigger("keyup"));
                };
            }(this)));
        },
        editingMode: function() {
            var b, c;
            return clearTimeout(this.hideSuggestionTimeout), b = this.searchKeywords.children().map(function(b) {
                return function(b, c) {
                    return a(c).text();
                };
            }(this)).get().join(" "), c = b + " " + this.searchInput.val(), c = c.replace(/\s+/g, " ").trim(), 
            c += " ", this.removeAllKeyword(), this.actionButtons.find(".saved-search").remove(), 
            setTimeout(function(a) {
                return function() {
                    return a.searchInput.val(c);
                };
            }(this), 1), !0;
        },
        suggest: function(a) {
            var b;
            return a = a.split(/\s/), b = a[a.length - 1], this.suggestTag(b), this.suggestHistory();
        },
        suggestHistory: function() {
            var b, d;
            return b = c.whitecubeSearchHistory.getHistory().reverse(), d = this.searchSuggestions.find(".suggest.history ul.items"), 
            d.html(""), b.every(function(b) {
                return function(b) {
                    var c, e;
                    return e = a('<span class="keyword"></span>'), e.text(b), c = a('<li><span class="remove-keyword"><i class="_pico-12 _icon-remove"></i></span></li>'), 
                    c.prepend(e), d.append(c), !0;
                };
            }(this)), this.toggleSuggestions();
        },
        suggestTag: function(b) {
            if (b.length) {
                if ("undefined" == typeof this.suggestTag.lastQuery) this.suggestTag.lastQuery = b; else if (this.suggestTag.lastQuery === b) return;
                return this.suggestTag.lastQuery = b, c.api.suggest(b).done(function(b) {
                    return function(c) {
                        var d, e;
                        return e = c.candidates.slice(0, 5), d = b.searchSuggestions.find(".suggest.tag ul.items"), 
                        d.html(""), e.every(function(b) {
                            var c;
                            return c = a("<li></li>"), c.text(b.tag_name), d.append(c), !0;
                        }), b.toggleSuggestions();
                    };
                }(this));
            }
        },
        clearSuggestions: function() {
            return this.searchSuggestions.find("ul.items").html("");
        },
        toggleSuggestions: function() {
            var a;
            return a = this.searchSuggestions.find("ul.items > li"), this.searchSuggestions.toggleClass("active", a.length > 0), 
            setTimeout(function(a) {
                return function() {
                    var b, c, d;
                    return c = a.searchSuggestions.find(".suggest.tag"), c.toggleClass("active", c.find("ul.items > li").length > 0), 
                    b = a.searchSuggestions.find(".suggest.history"), b.toggleClass("active", b.find("ul.items > li").length > 0 && 0 === a.searchInput.val().trim().length), 
                    d = a.searchSuggestions.find(".suggest.trend-tag-section"), d.toggleClass("active", d.find("ul.items > li").length > 0 && 0 === a.searchInput.val().trim().length);
                };
            }(this), 0);
        },
        applySuggestedTag: function(b) {
            var c, d, e, f;
            f = a(b.currentTarget), c = f.parents(".suggest").hasClass("append"), d = f.text(), 
            e = this.searchInput.val(), e = e.length ? e.split(/\s/) : [], c ? e[e.length] = d : e[e.length - 1] = d, 
            e = e.join(" "), this.searchInput.val(e), this.searchInput.focus().scrollLeft(this.searchInput[0].scrollWidth), 
            this.submitAfterUIUpdate();
        },
        applyHistryTag: function(b) {
            var c;
            c = a(b.currentTarget), this.searchInput.val(c.text()), this.submitAfterUIUpdate();
        },
        applyTrendTag: function(b) {
            var c;
            c = a(b.currentTarget), this.searchInput.val(c.find(".keyword").text()), this.submitAfterUIUpdate();
        },
        cycleSuggestions: function(b) {
            var c, d, e, f, g, h, i;
            if (this.searchSuggestions.hasClass("active")) {
                if (38 === b.which) d = "up"; else {
                    if (40 !== b.which) return !1;
                    d = "down";
                }
                return f = this.searchSuggestions.find("ul.items > li.selected"), c = this.searchSuggestions.find("ul.items > li"), 
                f.length && (g = c.index(f), h = "up" === d ? g - 1 : g + 1, h < 0 ? h = c.length - 1 : h >= c.length && (h = 0), 
                e = a(c[h])), f.length && e.length || (e = "up" === d ? this.searchSuggestions.find("ul.items > li").last() : this.searchSuggestions.find("ul.items > li").first()), 
                f.removeClass("selected"), e.addClass("selected"), i = e[0].offsetTop + e.height() < this.searchSuggestions.scrollTop() + this.searchSuggestions.height(), 
                i = i && e[0].offsetTop > this.searchSuggestions.scrollTop(), i || this.searchSuggestions.scrollTop(e[0].offsetTop), 
                !1;
            }
        },
        applySelectedSuggestion: function() {
            var a;
            return a = this.searchSuggestions.find("ul.items > li.selected"), !!a.length && (this.applySuggestedTag({
                currentTarget: a
            }), a.removeClass("selected"), !0);
        },
        getKeywords: function() {
            var b;
            return b = [], this.searchKeywords.find("> li").each(function(c) {
                return function(c, d) {
                    var e;
                    if (e = a(d).dataset("keyword"), e.length) return b.push(e);
                };
            }(this)), b;
        },
        beforeSubmit: function(a) {
            var b, c, d, e, f, g;
            if (this.addKeyword(), f = this.getKeywords(), 0 === f.length) return a.preventDefault(), 
            void a.stopPropagation();
            for (d = this.searchInput.val().trim(), d = d.split(/\s/), b = 0, c = d.length; b < c; b++) e = d[b], 
            e.length && f.indexOf(e) === -1 && f.push(e);
            return this.alignKeywords(), g = encodeURIComponent(f.join(" ")), this.searchInput.val(""), 
            this.searchForm.attr("action", this.searchBaseUrl + "/" + g), location.href = this.buildSearchUrl(g), 
            a.preventDefault(), a.stopPropagation();
        },
        keywordExists: function(a) {
            var b;
            return !/^(?:[()]|or|and)$/i.test(a) && (b = this.getKeywords(), b.indexOf(a) !== -1);
        },
        addKeyword: function() {
            var a, c, d, e, f;
            for (d = this.searchInput.val().trim(), d = d.split(/\s/), this.keywords = [], a = 0, 
            c = d.length; a < c; a++) f = d[a], f.length && !this.keywordExists(f) && (this.keywords.push(f), 
            e = b.template("search-keyword-li", {
                text: f,
                keyword: f
            }), this.searchKeywords.append(e));
            this.searchInput.val("").addClass("empty"), this.alignKeywords(), this.clearSearchButton.toggleClass("_hidden", this.keywords.length <= 0);
        },
        removeAllKeyword: function() {
            return this.searchKeywords.html(""), this.alignKeywords();
        },
        removeKeyword: function(a) {
            return a || (a = this.searchKeywords.find("> li:last-child")), a.css("width", a.width()), 
            setTimeout(function() {
                return a.css("width", 0);
            }, 1), setTimeout(function(b) {
                return function() {
                    return a.remove(), b.alignKeywords(), b.searchKeywords.children().length > 0 ? b.searchForm.submit() : b.clearSearchButton.addClass("_hidden");
                };
            }(this), 100), this.actionButtons.find(".saved-search").remove();
        },
        alignKeywords: function() {
            var a, b, c, d;
            b = this.searchKeywords.outerWidth(), c = this.searchForm.width(), a = .7 * c, b < a ? (this.searchInput.css("padding-left", b || ""), 
            this.searchKeywords.removeClass("pushed"), this.searchKeywords.css("right", "")) : (this.searchInput.css("padding-left", a), 
            this.searchKeywords.addClass("pushed"), this.searchKeywords.css("right", c - a)), 
            d = this.getKeywords(), d.length ? (this.searchInput.data("placeholder", this.searchInput.attr("placeholder")), 
            this.searchInput.attr("placeholder", "")) : this.searchInput.data("placeholder") && this.searchInput.attr("placeholder", this.searchInput.data("placeholder"));
        },
        buildSearchUrl: function(a) {
            var c, d, e, f, g;
            for (g = {}, f = this.searchForm.serializeArray(), c = 0, e = f.length; c < e; c++) d = f[c], 
            g[d.name] = d.value;
            return (null == g.adult_mode || "include" !== g.adult_mode && "only" !== g.adult_mode) && delete g.adult_mode, 
            b.query.build(this.searchBaseUrl + "/" + a, g);
        },
        fetchAndAppendTrendTags: function() {
            var a, b, d, e, f;
            for (f = {
                mode: "trend_tags"
            }, e = this.searchForm.serializeArray(), a = 0, d = e.length; a < d; a++) b = e[a], 
            "adult_mode" !== b.name && "type" !== b.name || (f[b.name] = b.value);
            c.api.get("/rpc/whitecube/index.php", f, {
                cache: !1
            }).then(function(a) {
                return function(b) {
                    var c, d;
                    return d = a.searchSuggestions.find(".suggest.trend-tag-section"), 0 === b.body.tag_count ? void d.removeClass("active") : (c = d.find("ul.items"), 
                    c.empty(), c.append(b.body.html));
                };
            }(this)).fail(function(a) {
                return function(b) {
                    return a.logger.error(b);
                };
            }(this)).always(function(a) {
                return function() {
                    a.toggleSuggestions();
                };
            }(this));
        },
        submitAfterUIUpdate: function() {
            setTimeout(function(a) {
                return function() {
                    return a.searchForm.submit();
                };
            }(this));
        }
    });
}.call(this), function() {
    "use strict";
    var a, b, c;
    a = require("jquery"), b = require("colon"), c = require("pixiv"), a(function() {
        if (c.config.whitecubeEmbed) return b.dispatcher.connect(/^\/setting_user\.php/, function() {
            return c.whitecubeSettingUserPage.setup();
        }).dispatch();
    }), b.ns("pixiv.whitecubeSettingUserPage", {
        setup: function() {
            return this.busy = !1, a("._open-mute-edit-modal-for-classic").click(function(a) {
                return function(b) {
                    return a.openMuteEditModalPage(b);
                };
            }(this));
        },
        openMuteEditModalPage: function() {
            var b, c;
            if (!this.busy) return this.busy = !0, c = a("._open-mute-edit-modal-for-classic ._spinner"), 
            c.removeClass("_hidden"), b = a("<iframe>"), b.addClass("_mute-edit-modal-iframe").css("opacity", 0).attr("src", "/whitecube/_mute_edit_modal").on("load", function(a) {
                return function() {
                    return a.busy = !1, c.addClass("_hidden"), b.css("opacity", 1);
                };
            }(this)), a("body").append(b);
        },
        closeMuteEditModalPage: function() {
            return a("._mute-edit-modal-iframe").remove();
        }
    });
}.call(this), function() {
    "use strict";
    !function(a) {
        var b;
        return b = function() {
            var b, c;
            pixiv.emoji.setup(), pixiv.HistoryTrial.record(), pixiv.user.loggedIn && (c = !1, 
            b = a("._layout-thumbnail.ui-modal-trigger").on("click", function() {
                var d, e;
                e = a("._illust_modal"), d = a("img", e), e.on("uimodalopen", function() {
                    colon.ui.shortcut.pause("← →"), colon.w.on("resize.illustModal", function() {
                        d.css("margin-top", Math.max((colon.w.height() - d.attr("height")) / 2, 0) || "");
                    }).trigger("resize.illustModal");
                }).on("uimodalclose", function() {
                    colon.ui.shortcut.restart("← →"), colon.w.off("resize.illustModal");
                }), colon.ui.modal.toggle(b, e, {
                    block: !0
                }), c || (c = !0, d.attr("src", d.dataset("src")));
            }), "/novel/preview.php" !== location.pathname && colon.ui.shortcut.bind("←", function() {
                var b;
                if ("novel" !== pixiv.context.type) return (b = a(".sibling-items .before a").attr("href")) && (location.href = b), 
                !1;
            }).bind("→", function() {
                var b;
                if ("novel" !== pixiv.context.type) return (b = a(".sibling-items .after a").attr("href")) && (location.href = b), 
                !1;
            }).bind("B", function() {
                var b;
                return pixiv.bookmarkModal.open() === !1 && (b = a(".bookmark-container ._button").attr("href")) && (location.href = b), 
                !1;
            }).bind("L", function() {
                return pixiv.rating.apply(10), !1;
            }).bind("F", function() {
                return a("#favorite-button").click(), !1;
            }).bind("C", function() {
                return pixiv.comment.showComment(), !1;
            }), "illust" === pixiv.context.type && colon.ui.shortcut.bind("V", function() {
                var a;
                return (a = colon.$.find(".works_display a")) ? window.open(a.attr("href"), "_blank") : b.click(), 
                !1;
            }), "novel" === pixiv.context.type && colon.ui.shortcut.bind("↑", function() {
                return "undefined" != typeof novel && null !== novel && "function" == typeof novel.onKeypress ? novel.onKeypress("up") : void 0;
            }).bind("↓", function() {
                return "undefined" != typeof novel && null !== novel && "function" == typeof novel.onKeypress ? novel.onKeypress("down") : void 0;
            }).bind("←", function() {
                return "undefined" != typeof novel && null !== novel && "function" == typeof novel.onKeypress ? novel.onKeypress("left") : void 0;
            }).bind("→", function() {
                return "undefined" != typeof novel && null !== novel && "function" == typeof novel.onKeypress ? novel.onKeypress("right") : void 0;
            }).bind("V", function() {
                return "undefined" != typeof novel && null !== novel && "function" == typeof novel.onKeypress ? novel.onKeypress("v") : void 0;
            }).bind("SPACE", function() {
                return "undefined" != typeof novel && null !== novel && "function" == typeof novel.onKeypress ? novel.onKeypress("space") : void 0;
            }).bind("PAGEUP", function() {
                return "undefined" != typeof novel && null !== novel && "function" == typeof novel.onKeypress ? novel.onKeypress("pageup") : void 0;
            }).bind("PAGEDOWN", function() {
                return "undefined" != typeof novel && null !== novel && "function" == typeof novel.onKeypress ? novel.onKeypress("pagedown") : void 0;
            }).bind("ESC", function() {
                return "undefined" != typeof novel && null !== novel && "function" == typeof novel.onKeypress ? novel.onKeypress("escape") : void 0;
            }));
        }, a(function() {
            colon.dispatcher.connect("/member_illust.php", b).connect("/novel/show.php", b).connect("/novel/preview.php", b).dispatch();
        }), colon.ns("pixiv.comment", {
            page: 1,
            setup: function() {
                var b, c, d;
                this.commentItemsContainer = a("._comment-items"), this.noItemContainer = a("._no-item", this.commentItemsContainer), 
                d = a(".stamp-form"), d.length && d.html(colon.template("stamp-tab-content", {
                    stamp_series: pixiv.context.stampSeries
                })), c = a(".emoji-list"), c.length && c.html(colon.template("emoji-list", {
                    emoji_series: pixiv.context.emojiSeries
                })), pixiv.ui.tab.update(), colon.d.on("submit", "._comment-form", a.proxy(this.postComment, this)).on("click", "._comment-form .sticker", a.proxy(this.postSticker, this)).on("click", ".more-comment", this.more).on("click", ".delete-comment", a.proxy(this.delete, this)).on("click", ".reply", function(b) {
                    return function(c) {
                        b.showReply(a(c.currentTarget).closest("._comment-item, .sticker-item"));
                    };
                }(this)).on("click", ".reply-to", function(b) {
                    return function(c) {
                        b.showComment(a(c.currentTarget).dataset("id"));
                    };
                }(this)).on("click", ".comment .date", function(b) {
                    return colon.query.replace({
                        comment_id: a(this).closest("._comment-item").dataset("id")
                    }, !0, !1), !1;
                }), (b = pixiv.context.queries.comment_id) && this.showComment(b);
            },
            postComment: function(b) {
                var c, d, e, f;
                return e = a(b.currentTarget), !e.hasClass("sending") && (d = e.closest("._comment-form"), 
                f = d.find("textarea"), !!(c = a.trim(f.val())) && (e.addClass("sending"), pixiv.api[pixiv.context.type].comment.post(pixiv.context.illustId, pixiv.context.userId, c, d.dataset("parentCommentId")).always(function() {
                    e.removeClass("sending");
                }).done(function(b) {
                    return function(c) {
                        f.val(""), b.noItemContainer.addClass("_hidden"), e = a(c.body.html).hide().prependTo(b.commentItemsContainer).slideDown("fast"), 
                        pixiv.scrollView.update(), colon.d.trigger(pixiv.comment.ns + "Post", [ e ]);
                    };
                }(this)).fail(function(a, b, c) {
                    window.alert(c);
                }), !1));
            },
            postSticker: function(b) {
                var c, d, e;
                return e = a(b.currentTarget), d = e.parents(".tab-content-sticker"), !d.hasClass("sending") && (c = e.closest("._comment-form"), 
                d.addClass("sending"), d.find(".disabler .bar").animate({
                    width: "0%"
                }, 1e4, "linear"), pixiv.api[pixiv.context.type].sticker.post(pixiv.context.illustId, pixiv.context.userId, e.dataset("id"), c.dataset("parentCommentId")).always(function() {
                    window.setTimeout(function() {
                        return d.removeClass("sending"), d.find(".disabler .bar").css("width", "100%");
                    }, 1e4);
                }).done(function(b) {
                    return function(c) {
                        b.noItemContainer.addClass("_hidden"), a(c.body.html).hide().prependTo(b.commentItemsContainer).slideDown("fast"), 
                        pixiv.scrollView.update(), colon.d.trigger(pixiv.comment.ns + "Sticker", [ e ]);
                    };
                }(this)).fail(function(a, b, c) {
                    window.alert(c);
                }), !1);
            },
            delete: function(b) {
                var c, d;
                return d = a(b.currentTarget), !(d.hasClass("sending") || !window.confirm(d.dataset("textConfirm"))) && (c = d.closest("._comment-item, .sticker-item"), 
                d.addClass("sending"), pixiv.api[pixiv.context.type].comment.delete(pixiv.context.illustId, c.dataset("id")).always(function() {
                    d.removeClass("sending");
                }).done(function(b) {
                    return function() {
                        var d;
                        d = function() {
                            c.remove(), a("._comment-item, .sticker-item", b.commentItemsContainer).length || b.noItemContainer.removeClass("_hidden");
                        }, c.hasClass("sticker-item") ? c.animate({
                            width: 0
                        }, "fast", d) : c.slideUp("fast", d);
                    };
                }(this)).fail(function(a, b, c) {
                    return window.alert(c);
                }), !1);
            },
            more: function(b) {
                var c;
                return c = a(this), !c.hasClass("loading") && (c.addClass("loading"), pixiv.api[pixiv.context.type].comment.more(pixiv.context.illustId, pixiv.context.userId, ++pixiv.comment.page).always(function() {
                    return c.removeClass("loading");
                }).done(function(d) {
                    return c = a(d.body.html).appendTo("._comment-items"), d.body.more || a(b.target).remove(), 
                    pixiv.scrollView.update(), colon.d.trigger(pixiv.comment.ns + "More", [ c ]);
                }).fail(function(a, b, c) {
                    return window.alert(c);
                }), !1);
            },
            showComment: function(b, c) {
                var d, e;
                null == b && (b = void 0), null == c && (c = !1), e = a("._comment-form-container"), 
                e.length && (b ? pixiv.api[pixiv.context.type].comment.item(b, c).done(function(a) {
                    return function(b) {
                        a.showReply(b.body.html);
                    };
                }(this)).fail(function() {}) : (d = a("._comment-modal"), a(".content", d).html(e.first().clone()), 
                window.setTimeout(function() {
                    return a("textarea", d).focus();
                }), d.on("uimodalclose", function() {
                    return colon.d.off(".reply");
                }), colon.ui.modal.push(d, {
                    block: !0
                }), colon.d.on("pixivCommentPost.reply pixivCommentSticker.reply", function() {
                    return colon.ui.modal.pop(), pixiv.statusBar({
                        type: "success",
                        text: "コメントしました",
                        link: "#one_comment"
                    });
                }), a(".ui-tab-container.root", d).each(function() {
                    return pixiv.ui.tab.restore(this);
                }), pixiv.scrollView.update()));
            },
            showReply: function(b) {
                var c, d;
                b = a(b), c = a("._comment-modal"), d = a(".user-name", b).text(), a(".body p", b).html(pixiv.emoji.replace(a(".body p", b).html())), 
                a(".content", c).html(a("._comment-form-container").first().clone()).find("._comment-form").dataset("parentCommentId", b.dataset("id") || "").end().prepend(b.clone()), 
                window.setTimeout(function() {
                    a("textarea", c)[0].focus();
                }), c.on("uimodalclose", function() {
                    colon.d.off(".reply");
                }), colon.ui.modal.push(c, {
                    block: !0
                }), colon.d.on("pixivCommentPost.reply pixivCommentSticker.reply", function() {
                    return colon.ui.modal.pop(), pixiv.statusBar({
                        type: "success",
                        text: "コメントしました",
                        link: "#one_comment"
                    });
                }), a(".ui-tab-container.root", c).each(function() {
                    return pixiv.ui.tab.restore(this);
                }), pixiv.scrollView.update();
            }
        }), colon.ns("pixiv", {
            statusBar: function(b) {
                var c, d;
                c = a("#status-bar"), d = a(colon.template("status-item", b)).hide().appendTo(c.show()).slideDown(), 
                window.setTimeout(function(b) {
                    return function() {
                        d.slideUp(function() {
                            d.remove(), a(".status-item", c).length || c.hide();
                        });
                    };
                }(this), 7500);
            }
        }), colon.ns("pixiv.bookmarkModal", {
            initialize: function() {
                var b;
                return !!(this.container = colon.$.find(".bookmark-add-modal")) && (b = a(".bookmark_modal_thumbnail"), 
                b.attr("src", b.dataset("src")), colon.$.find("._list-unit", this.container) && (pixiv.bookmarkTag.setup(".tag-cloud-container"), 
                this.showTag(), this.container.on("click", ".tag", function() {
                    return pixiv.tag.toggle(a(this).dataset("tag")), !1;
                }).on("uimodalopen", function() {
                    a("#input_tag").focus();
                }).on("uimodalclose", function() {
                    a("#input_tag").blur();
                }), pixiv.tag.setup()), colon.w.on("resize", colon.throttle(this.updateHeight, this)), 
                this.open(), void this.updateHeight());
            },
            open: function() {
                return this.container ? colon.ui.modal.push(this.container, {
                    block: !0
                }) : this.initialize();
            },
            showTag: function() {
                var b;
                return b = [], a(".tags-container .tag").each(function() {
                    return b.push({
                        self: !!a(".self-tag", this).length,
                        name: a(".text", this).text()
                    });
                }), b.length ? a(".tag-cloud.work", this.container).append(colon.template("tag-items", {
                    tags: b
                })) : a(".work-tags-container", this.container).remove();
            },
            updateHeight: function() {
                return a("._list-unit", this.container).height(colon.w.height() - a(".layout-fixed", this.container).height() - 20 - 60);
            }
        }), colon.ns("pixiv.emoji", {
            setup: function() {
                var b, c, d, e, f;
                if (pixiv.context.emojiSeries) {
                    for (this.patterns = {}, e = pixiv.context.emojiSeries, c = 0, d = e.length; c < d; c++) b = e[c], 
                    this.patterns[b.name] = b.id;
                    f = function(b) {
                        return function(c, d) {
                            a(".body p", d).each(function(c, d) {
                                d = a(d), d.html(b.replace(d.html()));
                            });
                        };
                    }(this), colon.d.on("click." + this.ns, ".emoji", function(b) {
                        return function(c) {
                            var d, e;
                            d = a(c.target), e = d.closest("._comment-form").find("textarea")[0], b.insert(d.data("name"), e), 
                            e.focus(), null != e.selectionStart ? e.selectionStart = e.selectionEnd = e.value.length : null != e.createTextRange && e.createTextRange().select();
                        };
                    }(this)).on("pixivCommentPost", f).on("pixivCommentMore", f), a("._comment-items").each(f), 
                    colon.ui.shortcut.bind("DELETE", function(a) {
                        return function(b) {
                            return a.delete(b.target);
                        };
                    }(this));
                }
            },
            insert: function(b, c) {
                var d;
                c = a(c), d = a.trim(c.val()), d = (d && d + " ") + ("(" + b + ")"), d.length <= 140 && c.val(d);
            },
            delete: function(b) {
                var c, d;
                if (b = a(b), a(b).closest("._comment-form").length) return d = /\s*?\(([^()]+)\)$/, 
                (c = d.exec(b.val())) && this.patterns[c[1]] ? (b.val(b.val().replace(d, "")), !1) : void 0;
            },
            replace: function(b) {
                var c;
                return b = a.trim(b), c = function(a) {
                    return function(c, d) {
                        var e, f;
                        return f = d.replace(/[():]/g, ""), (e = a.patterns[f]) ? d === b ? '<img src="' + pixiv.commonSourcePath + "images/emoji/" + e + '.png" width="56" height="56">' : '<img src="' + pixiv.commonSourcePath + "images/emoji/" + e + '.png" width="28" height="28" class="emoji-text">' : d;
                    };
                }(this), b.replace(/\s*?(\([^()]+\))/g, c).replace(/\s*?(:[^:]+:)/g, c);
            }
        });
    }(jQuery);
}.call(this);
//# sourceMappingURL=app.min.js.map