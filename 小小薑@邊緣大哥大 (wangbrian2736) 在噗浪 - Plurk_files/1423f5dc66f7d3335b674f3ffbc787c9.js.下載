jQuery(document).ready(function(){Themes.initFixedBackground()});Themes={bgimg_ver:undefined,dark_icons:false,theme_timeout:null,updates:0,fixed_cover_bg:null,setTheme:function(f,b,c,e,a){Themes._updateStyle("T_theme_bg",f);Themes._updateStyle("T_theme_fg",b);Themes._updateStyle("T_theme_db",c);var g=location.pathname.indexOf("/p/")>=0;if(!g){if(Themes.bgimg_ver>0){Themes._appendBGImgStyle();Themes.timedRefreshFixedBackground()}else{Themes._removeBGImgStyle();Themes.clearFixedBackground()}if(e){var d="/Users/getCustomCss?user_id="+GLOBAL.page_user.id;if(a){d+="&updates="+Themes.updates++}Themes._updateStyle("T_custom_theme",d);Themes._updateStyle("T_restrict_theme","//s.plurk.com/072118e7a830f5f7de271be6172dcc90.css");Themes.checkDarkIcons()}}GLOBAL.page_user.theme=f;GLOBAL.page_user.theme_fg=b;GLOBAL.page_user.theme_db=c;if(Themes.dark_icons){document.getElementsByTagName("html")[0].className="dark_icons"}else{document.getElementsByTagName("html")[0].className=""}},timedRefreshFixedBackground:function(){Themes.clearFixedBackground();setTimeout(function(){Themes.initFixedBackground()},2000)},clearFixedBackground:function(){if(Themes.fixed_cover_bg){jQuery(Themes.fixed_cover_bg).remove();Themes.fixed_cover_bg=null}var a=jQuery("#layout_content_html");if(a.length===0){return}a.removeAttr("style")},initFixedBackground:function(){Themes.clearFixedBackground();var d=jQuery("#layout_content_html");if(d.css("background-attachment")==="fixed"&&d.css("background-size")==="cover"){var c={"background-image":"","background-position-x":"","background-position-y":"","background-repeat":"","background-color":""};for(var b in c){c[b]=d.css(b)}d.css("background","none");var a=jQuery('<div style="position:fixed;width:100%;height:100%;top:0;left:0;z-index:-1000;background-size:cover"></div>');for(var b in c){a.css(b,c[b])}jQuery("body").prepend(a);Themes.fixed_cover_bg=a[0]}},initBarStyle:function(){},checkDarkIcons:function(){if(GLOBAL.page_user.use_dark_icons){Themes.dark_icons=true}},_updateStyle:function(a,d){var b=window[a];var c="//s.plurk.com/fe57566874ae091604a241a2109291f4.css";if(d){if(a=="T_theme_bg"){c=$theme_path(d+"/background.css")}else{if(a=="T_theme_fg"){c=$theme_path(d+"/timeline.css")}else{if(a=="T_theme_db"){c=$theme_path(d+"/dashboard.css")}else{c=d}}}}if(!b){b=document.createElement("link");b.setAttribute("rel","stylesheet");b.setAttribute("type","text/css");if(a=="T_custom_theme"){b.id="cstm-css"}document.getElementsByTagName("head")[0].appendChild(b);window[a]=b}b.setAttribute("href",c);if(a=="T_theme_bg"){Themes.timedRefreshFixedBackground()}},_appendBGImgStyle:function(){var d=window.T_theme_bgimg;var b=function(f){var e="._lch_{\n\tbackground: url(//images.plurk.com/bg/"+GLOBAL.page_user.id+"-"+Themes.bgimg_ver+".jpg);\n\tbackground-position: center center;\n\tbackground-size: cover;\n\tbackground-attachment: fixed;\n}\n#timeline_holder{\n\tbackground: none;\n}";if(d.styleSheet){d.styleSheet.cssText=e}else{var g=document.createTextNode(e);d.appendChild(g)}};if(!d){d=document.createElement("style");d.setAttribute("type","text/css");b(d);var c=document.getElementsByTagName("head")[0];var a=document.getElementById("cstm-css");if(a){c.insertBefore(d,a)}else{c.appendChild(d)}window.T_theme_bgimg=d}else{if(d.firstChild){d.removeChild(d.firstChild)}b(d)}},_removeBGImgStyle:function(){var a=window.T_theme_bgimg;if(a){document.getElementsByTagName("head")[0].removeChild(a);delete window.T_theme_bgimg}},useDarkIcons:function(a){if(!GLOBAL.page_user){return false}if(GLOBAL.page_user.theme=="white-theme"){return true}return Themes.dark_icons},_getSrc:function(b,d){d=d.replace("_dark","");if(b){var e=d.match(/[^\/]+?\.\w+$/)[0];var a=e.split(".");var c=a[0]+"_dark."+a[1];return d.replace(e,c)}return d},replaceImages:function(){var b=Themes.dark_icons;var a=[AJS.$("icon_home"),AJS.$("icon_friends"),AJS.$("icon_notifications"),AJS.$("icon_front")];AJS.map(a,function(c){if(c){c.src=Themes._getSrc(b,c.src)}})}};if(!GLOBAL.page_user&&GLOBAL.session_user){GLOBAL.page_user=GLOBAL.session_user}if(GLOBAL.page_user){Themes.bgimg_ver=GLOBAL.page_user.bgimg_ver;Themes.setTheme(GLOBAL.page_user.theme,GLOBAL.page_user.theme_fg,GLOBAL.page_user.theme_db,GLOBAL.page_user.has_custom_theme)};